var zE=i=>{throw TypeError(i)};var Dy=(i,e,t)=>e.has(i)||zE("Cannot "+t);var Tt=(i,e,t)=>(Dy(i,e,"read from private field"),t?t.call(i):e.get(i)),Bs=(i,e,t)=>e.has(i)?zE("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),ti=(i,e,t,n)=>(Dy(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),Us=(i,e,t)=>(Dy(i,e,"access private method"),t);var VE=(i,e,t,n)=>({set _(s){ti(i,e,s,t)},get _(){return Tt(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function Zb(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Oy={exports:{}},Wu={};var qE;function TO(){if(qE)return Wu;qE=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,a){var o=null;if(a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),"key"in s){a={};for(var c in s)c!=="key"&&(a[c]=s[c])}else a=s;return s=a.ref,{$$typeof:i,type:n,key:o,ref:s!==void 0?s:null,props:a}}return Wu.Fragment=e,Wu.jsx=t,Wu.jsxs=t,Wu}var HE;function xO(){return HE||(HE=1,Oy.exports=TO()),Oy.exports}var w=xO(),Py={exports:{}},Le={};var $E;function CO(){if($E)return Le;$E=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),v=Symbol.iterator;function _(H){return H===null||typeof H!="object"?null:(H=v&&H[v]||H["@@iterator"],typeof H=="function"?H:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,T={};function x(H,ee,le){this.props=H,this.context=ee,this.refs=T,this.updater=le||S}x.prototype.isReactComponent={},x.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},x.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function D(){}D.prototype=x.prototype;function I(H,ee,le){this.props=H,this.context=ee,this.refs=T,this.updater=le||S}var U=I.prototype=new D;U.constructor=I,A(U,x.prototype),U.isPureReactComponent=!0;var z=Array.isArray;function F(){}var R={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function P(H,ee,le){var he=le.ref;return{$$typeof:i,type:H,key:ee,ref:he!==void 0?he:null,props:le}}function j(H,ee){return P(H.type,ee,H.props)}function L(H){return typeof H=="object"&&H!==null&&H.$$typeof===i}function V(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(le){return ee[le]})}var B=/\/+/g;function de(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?V(""+H.key):ee.toString(36)}function Ce(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(F,F):(H.status="pending",H.then(function(ee){H.status==="pending"&&(H.status="fulfilled",H.value=ee)},function(ee){H.status==="pending"&&(H.status="rejected",H.reason=ee)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function G(H,ee,le,he,fe){var ke=typeof H;(ke==="undefined"||ke==="boolean")&&(H=null);var Ae=!1;if(H===null)Ae=!0;else switch(ke){case"bigint":case"string":case"number":Ae=!0;break;case"object":switch(H.$$typeof){case i:case e:Ae=!0;break;case p:return Ae=H._init,G(Ae(H._payload),ee,le,he,fe)}}if(Ae)return fe=fe(H),Ae=he===""?"."+de(H,0):he,z(fe)?(le="",Ae!=null&&(le=Ae.replace(B,"$&/")+"/"),G(fe,ee,le,"",function(sr){return sr})):fe!=null&&(L(fe)&&(fe=j(fe,le+(fe.key==null||H&&H.key===fe.key?"":(""+fe.key).replace(B,"$&/")+"/")+Ae)),ee.push(fe)),1;Ae=0;var _t=he===""?".":he+":";if(z(H))for(var ct=0;ct<H.length;ct++)he=H[ct],ke=_t+de(he,ct),Ae+=G(he,ee,le,ke,fe);else if(ct=_(H),typeof ct=="function")for(H=ct.call(H),ct=0;!(he=H.next()).done;)he=he.value,ke=_t+de(he,ct++),Ae+=G(he,ee,le,ke,fe);else if(ke==="object"){if(typeof H.then=="function")return G(Ce(H),ee,le,he,fe);throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Ae}function W(H,ee,le){if(H==null)return H;var he=[],fe=0;return G(H,he,"","",function(ke){return ee.call(le,ke,fe++)}),he}function ae(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(le){(H._status===0||H._status===-1)&&(H._status=1,H._result=le)},function(le){(H._status===0||H._status===-1)&&(H._status=2,H._result=le)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var we=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Oe={map:W,forEach:function(H,ee,le){W(H,function(){ee.apply(this,arguments)},le)},count:function(H){var ee=0;return W(H,function(){ee++}),ee},toArray:function(H){return W(H,function(ee){return ee})||[]},only:function(H){if(!L(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Le.Activity=m,Le.Children=Oe,Le.Component=x,Le.Fragment=t,Le.Profiler=s,Le.PureComponent=I,Le.StrictMode=n,Le.Suspense=h,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Le.__COMPILER_RUNTIME={__proto__:null,c:function(H){return R.H.useMemoCache(H)}},Le.cache=function(H){return function(){return H.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(H,ee,le){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var he=A({},H.props),fe=H.key;if(ee!=null)for(ke in ee.key!==void 0&&(fe=""+ee.key),ee)!O.call(ee,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&ee.ref===void 0||(he[ke]=ee[ke]);var ke=arguments.length-2;if(ke===1)he.children=le;else if(1<ke){for(var Ae=Array(ke),_t=0;_t<ke;_t++)Ae[_t]=arguments[_t+2];he.children=Ae}return P(H.type,fe,he)},Le.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:a,_context:H},H},Le.createElement=function(H,ee,le){var he,fe={},ke=null;if(ee!=null)for(he in ee.key!==void 0&&(ke=""+ee.key),ee)O.call(ee,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(fe[he]=ee[he]);var Ae=arguments.length-2;if(Ae===1)fe.children=le;else if(1<Ae){for(var _t=Array(Ae),ct=0;ct<Ae;ct++)_t[ct]=arguments[ct+2];fe.children=_t}if(H&&H.defaultProps)for(he in Ae=H.defaultProps,Ae)fe[he]===void 0&&(fe[he]=Ae[he]);return P(H,ke,fe)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(H){return{$$typeof:c,render:H}},Le.isValidElement=L,Le.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:ae}},Le.memo=function(H,ee){return{$$typeof:d,type:H,compare:ee===void 0?null:ee}},Le.startTransition=function(H){var ee=R.T,le={};R.T=le;try{var he=H(),fe=R.S;fe!==null&&fe(le,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(F,we)}catch(ke){we(ke)}finally{ee!==null&&le.types!==null&&(ee.types=le.types),R.T=ee}},Le.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Le.use=function(H){return R.H.use(H)},Le.useActionState=function(H,ee,le){return R.H.useActionState(H,ee,le)},Le.useCallback=function(H,ee){return R.H.useCallback(H,ee)},Le.useContext=function(H){return R.H.useContext(H)},Le.useDebugValue=function(){},Le.useDeferredValue=function(H,ee){return R.H.useDeferredValue(H,ee)},Le.useEffect=function(H,ee){return R.H.useEffect(H,ee)},Le.useEffectEvent=function(H){return R.H.useEffectEvent(H)},Le.useId=function(){return R.H.useId()},Le.useImperativeHandle=function(H,ee,le){return R.H.useImperativeHandle(H,ee,le)},Le.useInsertionEffect=function(H,ee){return R.H.useInsertionEffect(H,ee)},Le.useLayoutEffect=function(H,ee){return R.H.useLayoutEffect(H,ee)},Le.useMemo=function(H,ee){return R.H.useMemo(H,ee)},Le.useOptimistic=function(H,ee){return R.H.useOptimistic(H,ee)},Le.useReducer=function(H,ee,le){return R.H.useReducer(H,ee,le)},Le.useRef=function(H){return R.H.useRef(H)},Le.useState=function(H){return R.H.useState(H)},Le.useSyncExternalStore=function(H,ee,le){return R.H.useSyncExternalStore(H,ee,le)},Le.useTransition=function(){return R.H.useTransition()},Le.version="19.2.3",Le}var GE;function e_(){return GE||(GE=1,Py.exports=CO()),Py.exports}var Y=e_();const kO=Zb(Y);var Ny={exports:{}},Ku={},My={exports:{}},Ly={};var WE;function RO(){return WE||(WE=1,(function(i){function e(G,W){var ae=G.length;G.push(W);e:for(;0<ae;){var we=ae-1>>>1,Oe=G[we];if(0<s(Oe,W))G[we]=W,G[ae]=Oe,ae=we;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var W=G[0],ae=G.pop();if(ae!==W){G[0]=ae;e:for(var we=0,Oe=G.length,H=Oe>>>1;we<H;){var ee=2*(we+1)-1,le=G[ee],he=ee+1,fe=G[he];if(0>s(le,ae))he<Oe&&0>s(fe,le)?(G[we]=fe,G[he]=ae,we=he):(G[we]=le,G[ee]=ae,we=ee);else if(he<Oe&&0>s(fe,ae))G[we]=fe,G[he]=ae,we=he;else break e}}return W}function s(G,W){var ae=G.sortIndex-W.sortIndex;return ae!==0?ae:G.id-W.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var h=[],d=[],p=1,m=null,v=3,_=!1,S=!1,A=!1,T=!1,x=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function U(G){for(var W=t(d);W!==null;){if(W.callback===null)n(d);else if(W.startTime<=G)n(d),W.sortIndex=W.expirationTime,e(h,W);else break;W=t(d)}}function z(G){if(A=!1,U(G),!S)if(t(h)!==null)S=!0,F||(F=!0,V());else{var W=t(d);W!==null&&Ce(z,W.startTime-G)}}var F=!1,R=-1,O=5,P=-1;function j(){return T?!0:!(i.unstable_now()-P<O)}function L(){if(T=!1,F){var G=i.unstable_now();P=G;var W=!0;try{e:{S=!1,A&&(A=!1,D(R),R=-1),_=!0;var ae=v;try{t:{for(U(G),m=t(h);m!==null&&!(m.expirationTime>G&&j());){var we=m.callback;if(typeof we=="function"){m.callback=null,v=m.priorityLevel;var Oe=we(m.expirationTime<=G);if(G=i.unstable_now(),typeof Oe=="function"){m.callback=Oe,U(G),W=!0;break t}m===t(h)&&n(h),U(G)}else n(h);m=t(h)}if(m!==null)W=!0;else{var H=t(d);H!==null&&Ce(z,H.startTime-G),W=!1}}break e}finally{m=null,v=ae,_=!1}W=void 0}}finally{W?V():F=!1}}}var V;if(typeof I=="function")V=function(){I(L)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,de=B.port2;B.port1.onmessage=L,V=function(){de.postMessage(null)}}else V=function(){x(L,0)};function Ce(G,W){R=x(function(){G(i.unstable_now())},W)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_next=function(G){switch(v){case 1:case 2:case 3:var W=3;break;default:W=v}var ae=v;v=W;try{return G()}finally{v=ae}},i.unstable_requestPaint=function(){T=!0},i.unstable_runWithPriority=function(G,W){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ae=v;v=G;try{return W()}finally{v=ae}},i.unstable_scheduleCallback=function(G,W,ae){var we=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?we+ae:we):ae=we,G){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=ae+Oe,G={id:p++,callback:W,priorityLevel:G,startTime:ae,expirationTime:Oe,sortIndex:-1},ae>we?(G.sortIndex=ae,e(d,G),t(h)===null&&G===t(d)&&(A?(D(R),R=-1):A=!0,Ce(z,ae-we))):(G.sortIndex=Oe,e(h,G),S||_||(S=!0,F||(F=!0,V()))),G},i.unstable_shouldYield=j,i.unstable_wrapCallback=function(G){var W=v;return function(){var ae=v;v=W;try{return G.apply(this,arguments)}finally{v=ae}}}})(Ly)),Ly}var KE;function IO(){return KE||(KE=1,My.exports=RO()),My.exports}var jy={exports:{}},Mn={};var YE;function DO(){if(YE)return Mn;YE=1;var i=e_();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(h,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:h,containerInfo:d,implementation:p}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Mn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(h,d,null,p)},Mn.flushSync=function(h){var d=o.T,p=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=d,n.p=p,n.d.f()}},Mn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Mn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Mn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:_}):p==="script"&&n.d.X(h,{crossOrigin:m,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Mn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Mn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Mn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=c(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Mn.requestFormReset=function(h){n.d.r(h)},Mn.unstable_batchedUpdates=function(h,d){return h(d)},Mn.useFormState=function(h,d,p){return o.H.useFormState(h,d,p)},Mn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Mn.version="19.2.3",Mn}var XE;function OO(){if(XE)return jy.exports;XE=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),jy.exports=DO(),jy.exports}var QE;function PO(){if(QE)return Ku;QE=1;var i=IO(),e=e_(),t=OO();function n(r){var l="https://react.dev/errors/"+r;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var l=r,u=r;if(r.alternate)for(;l.return;)l=l.return;else{r=l;do l=r,(l.flags&4098)!==0&&(u=l.return),r=l.return;while(r)}return l.tag===3?u:null}function o(r){if(r.tag===13){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function c(r){if(r.tag===31){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function h(r){if(a(r)!==r)throw Error(n(188))}function d(r){var l=r.alternate;if(!l){if(l=a(r),l===null)throw Error(n(188));return l!==r?null:r}for(var u=r,f=l;;){var y=u.return;if(y===null)break;var b=y.alternate;if(b===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===u)return h(y),r;if(b===f)return h(y),l;b=b.sibling}throw Error(n(188))}if(u.return!==f.return)u=y,f=b;else{for(var C=!1,N=y.child;N;){if(N===u){C=!0,u=y,f=b;break}if(N===f){C=!0,f=y,u=b;break}N=N.sibling}if(!C){for(N=b.child;N;){if(N===u){C=!0,u=b,f=y;break}if(N===f){C=!0,f=b,u=y;break}N=N.sibling}if(!C)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:l}function p(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r;for(r=r.child;r!==null;){if(l=p(r),l!==null)return l;r=r.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),I=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function V(r){return r===null||typeof r!="object"?null:(r=L&&r[L]||r["@@iterator"],typeof r=="function"?r:null)}var B=Symbol.for("react.client.reference");function de(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===B?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case x:return"Profiler";case T:return"StrictMode";case z:return"Suspense";case F:return"SuspenseList";case P:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case I:return r.displayName||"Context";case D:return(r._context.displayName||"Context")+".Consumer";case U:var l=r.render;return r=r.displayName,r||(r=l.displayName||l.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case R:return l=r.displayName||null,l!==null?l:de(r.type)||"Memo";case O:l=r._payload,r=r._init;try{return de(r(l))}catch{}}return null}var Ce=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},we=[],Oe=-1;function H(r){return{current:r}}function ee(r){0>Oe||(r.current=we[Oe],we[Oe]=null,Oe--)}function le(r,l){Oe++,we[Oe]=r.current,r.current=l}var he=H(null),fe=H(null),ke=H(null),Ae=H(null);function _t(r,l){switch(le(ke,l),le(fe,r),le(he,null),l.nodeType){case 9:case 11:r=(r=l.documentElement)&&(r=r.namespaceURI)?uE(r):0;break;default:if(r=l.tagName,l=l.namespaceURI)l=uE(l),r=hE(l,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ee(he),le(he,r)}function ct(){ee(he),ee(fe),ee(ke)}function sr(r){r.memoizedState!==null&&le(Ae,r);var l=he.current,u=hE(l,r.type);l!==u&&(le(fe,r),le(he,u))}function ms(r){fe.current===r&&(ee(he),ee(fe)),Ae.current===r&&(ee(Ae),qu._currentValue=ae)}var gs,rr;function Ei(r){if(gs===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);gs=l&&l[1]||"",rr=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gs+r+rr}var qc=!1;function Ga(r,l){if(!r||qc)return"";qc=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(ne){var Z=ne}Reflect.construct(r,[],re)}else{try{re.call()}catch(ne){Z=ne}r.call(re.prototype)}}else{try{throw Error()}catch(ne){Z=ne}(re=r())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(ne){if(ne&&Z&&typeof ne.stack=="string")return[ne.stack,Z.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),C=b[0],N=b[1];if(C&&N){var q=C.split(`
`),J=N.split(`
`);for(y=f=0;f<q.length&&!q[f].includes("DetermineComponentFrameRoot");)f++;for(;y<J.length&&!J[y].includes("DetermineComponentFrameRoot");)y++;if(f===q.length||y===J.length)for(f=q.length-1,y=J.length-1;1<=f&&0<=y&&q[f]!==J[y];)y--;for(;1<=f&&0<=y;f--,y--)if(q[f]!==J[y]){if(f!==1||y!==1)do if(f--,y--,0>y||q[f]!==J[y]){var ie=`
`+q[f].replace(" at new "," at ");return r.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",r.displayName)),ie}while(1<=f&&0<=y);break}}}finally{qc=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?Ei(u):""}function Hc(r,l){switch(r.tag){case 26:case 27:case 5:return Ei(r.type);case 16:return Ei("Lazy");case 13:return r.child!==l&&l!==null?Ei("Suspense Fallback"):Ei("Suspense");case 19:return Ei("SuspenseList");case 0:case 15:return Ga(r.type,!1);case 11:return Ga(r.type.render,!1);case 1:return Ga(r.type,!0);case 31:return Ei("Activity");default:return""}}function $c(r){try{var l="",u=null;do l+=Hc(r,u),u=r,r=r.return;while(r);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var $t=Object.prototype.hasOwnProperty,on=i.unstable_scheduleCallback,Ur=i.unstable_cancelCallback,Pm=i.unstable_shouldYield,rd=i.unstable_requestPaint,Vn=i.unstable_now,Wa=i.unstable_getCurrentPriorityLevel,Gc=i.unstable_ImmediatePriority,Wc=i.unstable_UserBlockingPriority,Fr=i.unstable_NormalPriority,Nm=i.unstable_LowPriority,ad=i.unstable_IdlePriority,od=i.log,ld=i.unstable_setDisableYieldValue,Wi=null,wn=null;function Si(r){if(typeof od=="function"&&ld(r),wn&&typeof wn.setStrictMode=="function")try{wn.setStrictMode(Wi,r)}catch{}}var Bt=Math.clz32?Math.clz32:ud,cd=Math.log,Zo=Math.LN2;function ud(r){return r>>>=0,r===0?32:31-(cd(r)/Zo|0)|0}var ys=256,Ka=262144,Gt=4194304;function vs(r){var l=r&42;if(l!==0)return l;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function bs(r,l,u){var f=r.pendingLanes;if(f===0)return 0;var y=0,b=r.suspendedLanes,C=r.pingedLanes;r=r.warmLanes;var N=f&134217727;return N!==0?(f=N&~b,f!==0?y=vs(f):(C&=N,C!==0?y=vs(C):u||(u=N&~r,u!==0&&(y=vs(u))))):(N=f&~b,N!==0?y=vs(N):C!==0?y=vs(C):u||(u=f&~r,u!==0&&(y=vs(u)))),y===0?0:l!==0&&l!==y&&(l&b)===0&&(b=y&-y,u=l&-l,b>=u||b===32&&(u&4194048)!==0)?l:y}function Ki(r,l){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&l)===0}function Mm(r,l){switch(r){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hd(){var r=Gt;return Gt<<=1,(Gt&62914560)===0&&(Gt=4194304),r}function _s(r){for(var l=[],u=0;31>u;u++)l.push(r);return l}function Ya(r,l){r.pendingLanes|=l,l!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Lm(r,l,u,f,y,b){var C=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var N=r.entanglements,q=r.expirationTimes,J=r.hiddenUpdates;for(u=C&~u;0<u;){var ie=31-Bt(u),re=1<<ie;N[ie]=0,q[ie]=-1;var Z=J[ie];if(Z!==null)for(J[ie]=null,ie=0;ie<Z.length;ie++){var ne=Z[ie];ne!==null&&(ne.lane&=-536870913)}u&=~re}f!==0&&Xa(r,f,0),b!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=b&~(C&~l))}function Xa(r,l,u){r.pendingLanes|=l,r.suspendedLanes&=~l;var f=31-Bt(l);r.entangledLanes|=l,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function Kc(r,l){var u=r.entangledLanes|=l;for(r=r.entanglements;u;){var f=31-Bt(u),y=1<<f;y&l|r[f]&l&&(r[f]|=l),u&=~y}}function Yc(r,l){var u=l&-l;return u=(u&42)!==0?1:Qa(u),(u&(r.suspendedLanes|l))!==0?0:u}function Qa(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ar(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function dd(){var r=W.p;return r!==0?r:(r=window.event,r===void 0?32:NE(r.type))}function Yi(r,l){var u=W.p;try{return W.p=r,l()}finally{W.p=u}}var Xi=Math.random().toString(36).slice(2),Wt="__reactFiber$"+Xi,fn="__reactProps$"+Xi,ws="__reactContainer$"+Xi,el="__reactEvents$"+Xi,jm="__reactListeners$"+Xi,fd="__reactHandles$"+Xi,pd="__reactResources$"+Xi,As="__reactMarker$"+Xi;function tl(r){delete r[Wt],delete r[fn],delete r[el],delete r[jm],delete r[fd]}function Es(r){var l=r[Wt];if(l)return l;for(var u=r.parentNode;u;){if(l=u[ws]||u[Wt]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(r=vE(r);r!==null;){if(u=r[Wt])return u;r=vE(r)}return l}r=u,u=r.parentNode}return null}function Ti(r){if(r=r[Wt]||r[ws]){var l=r.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return r}return null}function ai(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r.stateNode;throw Error(n(33))}function Ss(r){var l=r[pd];return l||(l=r[pd]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Kt(r){r[As]=!0}var Xc=new Set,Qc={};function Ts(r,l){xs(r,l),xs(r+"Capture",l)}function xs(r,l){for(Qc[r]=l,r=0;r<l.length;r++)Xc.add(l[r])}var Jc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zc={},eu={};function md(r){return $t.call(eu,r)?!0:$t.call(Zc,r)?!1:Jc.test(r)?eu[r]=!0:(Zc[r]=!0,!1)}function nl(r,l,u){if(md(l))if(u===null)r.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(l);return}}r.setAttribute(l,""+u)}}function oi(r,l,u){if(u===null)r.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttribute(l,""+u)}}function Yt(r,l,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(l,u,""+f)}}function pn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function zr(r){var l=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function tu(r,l,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,l);if(!r.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,b=f.set;return Object.defineProperty(r,l,{configurable:!0,get:function(){return y.call(this)},set:function(C){u=""+C,b.call(this,C)}}),Object.defineProperty(r,l,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(C){u=""+C},stopTracking:function(){r._valueTracker=null,delete r[l]}}}}function ut(r){if(!r._valueTracker){var l=zr(r)?"checked":"value";r._valueTracker=tu(r,l,""+r[l])}}function Ja(r){if(!r)return!1;var l=r._valueTracker;if(!l)return!0;var u=l.getValue(),f="";return r&&(f=zr(r)?r.checked?"true":"false":r.value),r=f,r!==u?(l.setValue(r),!0):!1}function Cs(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Za=/[\n"\\]/g;function Kn(r){return r.replace(Za,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function il(r,l,u,f,y,b,C,N){r.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?r.type=C:r.removeAttribute("type"),l!=null?C==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+pn(l)):r.value!==""+pn(l)&&(r.value=""+pn(l)):C!=="submit"&&C!=="reset"||r.removeAttribute("value"),l!=null?nu(r,C,pn(l)):u!=null?nu(r,C,pn(u)):f!=null&&r.removeAttribute("value"),y==null&&b!=null&&(r.defaultChecked=!!b),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.name=""+pn(N):r.removeAttribute("name")}function gd(r,l,u,f,y,b,C,N){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.type=b),l!=null||u!=null){if(!(b!=="submit"&&b!=="reset"||l!=null)){ut(r);return}u=u!=null?""+pn(u):"",l=l!=null?""+pn(l):u,N||l===r.value||(r.value=l),r.defaultValue=l}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=N?r.checked:!!f,r.defaultChecked=!!f,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(r.name=C),ut(r)}function nu(r,l,u){l==="number"&&Cs(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Vr(r,l,u,f){if(r=r.options,l){l={};for(var y=0;y<u.length;y++)l["$"+u[y]]=!0;for(u=0;u<r.length;u++)y=l.hasOwnProperty("$"+r[u].value),r[u].selected!==y&&(r[u].selected=y),y&&f&&(r[u].defaultSelected=!0)}else{for(u=""+pn(u),l=null,y=0;y<r.length;y++){if(r[y].value===u){r[y].selected=!0,f&&(r[y].defaultSelected=!0);return}l!==null||r[y].disabled||(l=r[y])}l!==null&&(l.selected=!0)}}function yd(r,l,u){if(l!=null&&(l=""+pn(l),l!==r.value&&(r.value=l),u==null)){r.defaultValue!==l&&(r.defaultValue=l);return}r.defaultValue=u!=null?""+pn(u):""}function qr(r,l,u,f){if(l==null){if(f!=null){if(u!=null)throw Error(n(92));if(Ce(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),l=u}u=pn(l),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),ut(r)}function Yn(r,l){if(l){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=l;return}}r.textContent=l}var vd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function iu(r,l,u){var f=l.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(l,""):l==="float"?r.cssFloat="":r[l]="":f?r.setProperty(l,u):typeof u!="number"||u===0||vd.has(l)?l==="float"?r.cssFloat=u:r[l]=(""+u).trim():r[l]=u+"px"}function su(r,l,u){if(l!=null&&typeof l!="object")throw Error(n(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var y in l)f=l[y],l.hasOwnProperty(y)&&u[y]!==f&&iu(r,y,f)}else for(var b in l)l.hasOwnProperty(b)&&iu(r,b,l[b])}function sl(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rl(r){return Hr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Qi(){}var ru=null;function xi(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var $r=null,ks=null;function eo(r){var l=Ti(r);if(l&&(r=l.stateNode)){var u=r[fn]||null;e:switch(r=l.stateNode,l.type){case"input":if(il(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),l=u.name,u.type==="radio"&&l!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Kn(""+l)+'"][type="radio"]'),l=0;l<u.length;l++){var f=u[l];if(f!==r&&f.form===r.form){var y=f[fn]||null;if(!y)throw Error(n(90));il(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(l=0;l<u.length;l++)f=u[l],f.form===r.form&&Ja(f)}break e;case"textarea":yd(r,u.value,u.defaultValue);break e;case"select":l=u.value,l!=null&&Vr(r,!!u.multiple,l,!1)}}}var al=!1;function Gr(r,l,u){if(al)return r(l,u);al=!0;try{var f=r(l);return f}finally{if(al=!1,($r!==null||ks!==null)&&(ff(),$r&&(l=$r,r=ks,ks=$r=null,eo(l),r)))for(l=0;l<r.length;l++)eo(r[l])}}function Ji(r,l){var u=r.stateNode;if(u===null)return null;var f=u[fn]||null;if(f===null)return null;u=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,l,typeof u));return u}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),to=!1;if(Ci)try{var ft={};Object.defineProperty(ft,"passive",{get:function(){to=!0}}),window.addEventListener("test",ft,ft),window.removeEventListener("test",ft,ft)}catch{to=!1}var Rs=null,au=null,no=null;function ou(){if(no)return no;var r,l=au,u=l.length,f,y="value"in Rs?Rs.value:Rs.textContent,b=y.length;for(r=0;r<u&&l[r]===y[r];r++);var C=u-r;for(f=1;f<=C&&l[u-f]===y[b-f];f++);return no=y.slice(r,1<f?1-f:void 0)}function io(r){var l=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&l===13&&(r=13)):r=l,r===10&&(r=13),32<=r||r===13?r:0}function or(){return!0}function Zi(){return!1}function An(r){function l(u,f,y,b,C){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=b,this.target=C,this.currentTarget=null;for(var N in r)r.hasOwnProperty(N)&&(u=r[N],this[N]=u?u(b):b[N]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?or:Zi,this.isPropagationStopped=Zi,this}return m(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=or)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=or)},persist:function(){},isPersistent:or}),l}var lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Is=An(lr),Wr=m({},lr,{view:0,detail:0}),lu=An(Wr),Kr,ol,Ds,ll=m({},Wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ds&&(Ds&&r.type==="mousemove"?(Kr=r.screenX-Ds.screenX,ol=r.screenY-Ds.screenY):ol=Kr=0,Ds=r),Kr)},movementY:function(r){return"movementY"in r?r.movementY:ol}}),cu=An(ll),so=m({},ll,{dataTransfer:0}),_d=An(so),wd=m({},Wr,{relatedTarget:0}),ro=An(wd),uu=m({},lr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ad=An(uu),cl=m({},lr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ed=An(cl),Sd=m({},lr,{data:0}),Os=An(Sd),Td={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kd(r){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(r):(r=Cd[r])?!!l[r]:!1}function Yr(){return kd}var qn=m({},Wr,{key:function(r){if(r.key){var l=Td[r.key]||r.key;if(l!=="Unidentified")return l}return r.type==="keypress"?(r=io(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?xd[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yr,charCode:function(r){return r.type==="keypress"?io(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?io(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Rd=An(qn),Id=m({},ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cr=An(Id),g=m({},Wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yr}),E=An(g),k=m({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=An(k),X=m({},ll,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),te=An(X),ue=m({},lr,{newState:0,oldState:0}),Fe=An(ue),Ut=[9,13,27,32],nt=Ci&&"CompositionEvent"in window,Et=null;Ci&&"documentMode"in document&&(Et=document.documentMode);var ki=Ci&&"TextEvent"in window&&!Et,Ps=Ci&&(!nt||Et&&8<Et&&11>=Et),es=" ",ts=!1;function ao(r,l){switch(r){case"keyup":return Ut.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ul(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var hl=!1;function YI(r,l){switch(r){case"compositionend":return ul(l);case"keypress":return l.which!==32?null:(ts=!0,es);case"textInput":return r=l.data,r===es&&ts?null:r;default:return null}}function XI(r,l){if(hl)return r==="compositionend"||!nt&&ao(r,l)?(r=ou(),no=au=Rs=null,hl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ps&&l.locale!=="ko"?null:l.data;default:return null}}var QI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function w0(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l==="input"?!!QI[r.type]:l==="textarea"}function A0(r,l,u,f){$r?ks?ks.push(f):ks=[f]:$r=f,l=_f(l,"onChange"),0<l.length&&(u=new Is("onChange","change",null,u,f),r.push({event:u,listeners:l}))}var hu=null,du=null;function JI(r){sE(r,0)}function Dd(r){var l=ai(r);if(Ja(l))return r}function E0(r,l){if(r==="change")return l}var S0=!1;if(Ci){var Bm;if(Ci){var Um="oninput"in document;if(!Um){var T0=document.createElement("div");T0.setAttribute("oninput","return;"),Um=typeof T0.oninput=="function"}Bm=Um}else Bm=!1;S0=Bm&&(!document.documentMode||9<document.documentMode)}function x0(){hu&&(hu.detachEvent("onpropertychange",C0),du=hu=null)}function C0(r){if(r.propertyName==="value"&&Dd(du)){var l=[];A0(l,du,r,xi(r)),Gr(JI,l)}}function ZI(r,l,u){r==="focusin"?(x0(),hu=l,du=u,hu.attachEvent("onpropertychange",C0)):r==="focusout"&&x0()}function eD(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Dd(du)}function tD(r,l){if(r==="click")return Dd(l)}function nD(r,l){if(r==="input"||r==="change")return Dd(l)}function iD(r,l){return r===l&&(r!==0||1/r===1/l)||r!==r&&l!==l}var li=typeof Object.is=="function"?Object.is:iD;function fu(r,l){if(li(r,l))return!0;if(typeof r!="object"||r===null||typeof l!="object"||l===null)return!1;var u=Object.keys(r),f=Object.keys(l);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!$t.call(l,y)||!li(r[y],l[y]))return!1}return!0}function k0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function R0(r,l){var u=k0(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=l&&f>=l)return{node:u,offset:l-r};r=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=k0(u)}}function I0(r,l){return r&&l?r===l?!0:r&&r.nodeType===3?!1:l&&l.nodeType===3?I0(r,l.parentNode):"contains"in r?r.contains(l):r.compareDocumentPosition?!!(r.compareDocumentPosition(l)&16):!1:!1}function D0(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var l=Cs(r.document);l instanceof r.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)r=l.contentWindow;else break;l=Cs(r.document)}return l}function Fm(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l&&(l==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||l==="textarea"||r.contentEditable==="true")}var sD=Ci&&"documentMode"in document&&11>=document.documentMode,dl=null,zm=null,pu=null,Vm=!1;function O0(r,l,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Vm||dl==null||dl!==Cs(f)||(f=dl,"selectionStart"in f&&Fm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),pu&&fu(pu,f)||(pu=f,f=_f(zm,"onSelect"),0<f.length&&(l=new Is("onSelect","select",null,l,u),r.push({event:l,listeners:f}),l.target=dl)))}function oo(r,l){var u={};return u[r.toLowerCase()]=l.toLowerCase(),u["Webkit"+r]="webkit"+l,u["Moz"+r]="moz"+l,u}var fl={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionrun:oo("Transition","TransitionRun"),transitionstart:oo("Transition","TransitionStart"),transitioncancel:oo("Transition","TransitionCancel"),transitionend:oo("Transition","TransitionEnd")},qm={},P0={};Ci&&(P0=document.createElement("div").style,"AnimationEvent"in window||(delete fl.animationend.animation,delete fl.animationiteration.animation,delete fl.animationstart.animation),"TransitionEvent"in window||delete fl.transitionend.transition);function lo(r){if(qm[r])return qm[r];if(!fl[r])return r;var l=fl[r],u;for(u in l)if(l.hasOwnProperty(u)&&u in P0)return qm[r]=l[u];return r}var N0=lo("animationend"),M0=lo("animationiteration"),L0=lo("animationstart"),rD=lo("transitionrun"),aD=lo("transitionstart"),oD=lo("transitioncancel"),j0=lo("transitionend"),B0=new Map,Hm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hm.push("scrollEnd");function ns(r,l){B0.set(r,l),Ts(l,[r])}var Od=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Ri=[],pl=0,$m=0;function Pd(){for(var r=pl,l=$m=pl=0;l<r;){var u=Ri[l];Ri[l++]=null;var f=Ri[l];Ri[l++]=null;var y=Ri[l];Ri[l++]=null;var b=Ri[l];if(Ri[l++]=null,f!==null&&y!==null){var C=f.pending;C===null?y.next=y:(y.next=C.next,C.next=y),f.pending=y}b!==0&&U0(u,y,b)}}function Nd(r,l,u,f){Ri[pl++]=r,Ri[pl++]=l,Ri[pl++]=u,Ri[pl++]=f,$m|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Gm(r,l,u,f){return Nd(r,l,u,f),Md(r)}function co(r,l){return Nd(r,null,null,l),Md(r)}function U0(r,l,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var y=!1,b=r.return;b!==null;)b.childLanes|=u,f=b.alternate,f!==null&&(f.childLanes|=u),b.tag===22&&(r=b.stateNode,r===null||r._visibility&1||(y=!0)),r=b,b=b.return;return r.tag===3?(b=r.stateNode,y&&l!==null&&(y=31-Bt(u),r=b.hiddenUpdates,f=r[y],f===null?r[y]=[l]:f.push(l),l.lane=u|536870912),b):null}function Md(r){if(50<Lu)throw Lu=0,ty=null,Error(n(185));for(var l=r.return;l!==null;)r=l,l=r.return;return r.tag===3?r.stateNode:null}var ml={};function lD(r,l,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(r,l,u,f){return new lD(r,l,u,f)}function Wm(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ur(r,l){var u=r.alternate;return u===null?(u=ci(r.tag,l,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=l,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,l=r.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function F0(r,l){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=l,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,l=u.dependencies,r.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),r}function Ld(r,l,u,f,y,b){var C=0;if(f=r,typeof r=="function")Wm(r)&&(C=1);else if(typeof r=="string")C=fO(r,u,he.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case P:return r=ci(31,u,l,y),r.elementType=P,r.lanes=b,r;case A:return uo(u.children,y,b,l);case T:C=8,y|=24;break;case x:return r=ci(12,u,l,y|2),r.elementType=x,r.lanes=b,r;case z:return r=ci(13,u,l,y),r.elementType=z,r.lanes=b,r;case F:return r=ci(19,u,l,y),r.elementType=F,r.lanes=b,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case I:C=10;break e;case D:C=9;break e;case U:C=11;break e;case R:C=14;break e;case O:C=16,f=null;break e}C=29,u=Error(n(130,r===null?"null":typeof r,"")),f=null}return l=ci(C,u,l,y),l.elementType=r,l.type=f,l.lanes=b,l}function uo(r,l,u,f){return r=ci(7,r,f,l),r.lanes=u,r}function Km(r,l,u){return r=ci(6,r,null,l),r.lanes=u,r}function z0(r){var l=ci(18,null,null,0);return l.stateNode=r,l}function Ym(r,l,u){return l=ci(4,r.children!==null?r.children:[],r.key,l),l.lanes=u,l.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},l}var V0=new WeakMap;function Ii(r,l){if(typeof r=="object"&&r!==null){var u=V0.get(r);return u!==void 0?u:(l={value:r,source:l,stack:$c(l)},V0.set(r,l),l)}return{value:r,source:l,stack:$c(l)}}var gl=[],yl=0,jd=null,mu=0,Di=[],Oi=0,Xr=null,Ns=1,Ms="";function hr(r,l){gl[yl++]=mu,gl[yl++]=jd,jd=r,mu=l}function q0(r,l,u){Di[Oi++]=Ns,Di[Oi++]=Ms,Di[Oi++]=Xr,Xr=r;var f=Ns;r=Ms;var y=32-Bt(f)-1;f&=~(1<<y),u+=1;var b=32-Bt(l)+y;if(30<b){var C=y-y%5;b=(f&(1<<C)-1).toString(32),f>>=C,y-=C,Ns=1<<32-Bt(l)+y|u<<y|f,Ms=b+r}else Ns=1<<b|u<<y|f,Ms=r}function Xm(r){r.return!==null&&(hr(r,1),q0(r,1,0))}function Qm(r){for(;r===jd;)jd=gl[--yl],gl[yl]=null,mu=gl[--yl],gl[yl]=null;for(;r===Xr;)Xr=Di[--Oi],Di[Oi]=null,Ms=Di[--Oi],Di[Oi]=null,Ns=Di[--Oi],Di[Oi]=null}function H0(r,l){Di[Oi++]=Ns,Di[Oi++]=Ms,Di[Oi++]=Xr,Ns=l.id,Ms=l.overflow,Xr=r}var En=null,wt=null,Ke=!1,Qr=null,Pi=!1,Jm=Error(n(519));function Jr(r){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gu(Ii(l,r)),Jm}function $0(r){var l=r.stateNode,u=r.type,f=r.memoizedProps;switch(l[Wt]=r,l[fn]=f,u){case"dialog":He("cancel",l),He("close",l);break;case"iframe":case"object":case"embed":He("load",l);break;case"video":case"audio":for(u=0;u<Bu.length;u++)He(Bu[u],l);break;case"source":He("error",l);break;case"img":case"image":case"link":He("error",l),He("load",l);break;case"details":He("toggle",l);break;case"input":He("invalid",l),gd(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":He("invalid",l);break;case"textarea":He("invalid",l),qr(l,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||l.textContent===""+u||f.suppressHydrationWarning===!0||lE(l.textContent,u)?(f.popover!=null&&(He("beforetoggle",l),He("toggle",l)),f.onScroll!=null&&He("scroll",l),f.onScrollEnd!=null&&He("scrollend",l),f.onClick!=null&&(l.onclick=Qi),l=!0):l=!1,l||Jr(r,!0)}function G0(r){for(En=r.return;En;)switch(En.tag){case 5:case 31:case 13:Pi=!1;return;case 27:case 3:Pi=!0;return;default:En=En.return}}function vl(r){if(r!==En)return!1;if(!Ke)return G0(r),Ke=!0,!1;var l=r.tag,u;if((u=l!==3&&l!==27)&&((u=l===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||gy(r.type,r.memoizedProps)),u=!u),u&&wt&&Jr(r),G0(r),l===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));wt=yE(r)}else if(l===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));wt=yE(r)}else l===27?(l=wt,da(r.type)?(r=wy,wy=null,wt=r):wt=l):wt=En?Mi(r.stateNode.nextSibling):null;return!0}function ho(){wt=En=null,Ke=!1}function Zm(){var r=Qr;return r!==null&&(Zn===null?Zn=r:Zn.push.apply(Zn,r),Qr=null),r}function gu(r){Qr===null?Qr=[r]:Qr.push(r)}var eg=H(null),fo=null,dr=null;function Zr(r,l,u){le(eg,l._currentValue),l._currentValue=u}function fr(r){r._currentValue=eg.current,ee(eg)}function tg(r,l,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&l)!==l?(r.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),r===u)break;r=r.return}}function ng(r,l,u,f){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var b=y.dependencies;if(b!==null){var C=y.child;b=b.firstContext;e:for(;b!==null;){var N=b;b=y;for(var q=0;q<l.length;q++)if(N.context===l[q]){b.lanes|=u,N=b.alternate,N!==null&&(N.lanes|=u),tg(b.return,u,r),f||(C=null);break e}b=N.next}}else if(y.tag===18){if(C=y.return,C===null)throw Error(n(341));C.lanes|=u,b=C.alternate,b!==null&&(b.lanes|=u),tg(C,u,r),C=null}else C=y.child;if(C!==null)C.return=y;else for(C=y;C!==null;){if(C===r){C=null;break}if(y=C.sibling,y!==null){y.return=C.return,C=y;break}C=C.return}y=C}}function bl(r,l,u,f){r=null;for(var y=l,b=!1;y!==null;){if(!b){if((y.flags&524288)!==0)b=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var C=y.alternate;if(C===null)throw Error(n(387));if(C=C.memoizedProps,C!==null){var N=y.type;li(y.pendingProps.value,C.value)||(r!==null?r.push(N):r=[N])}}else if(y===Ae.current){if(C=y.alternate,C===null)throw Error(n(387));C.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(qu):r=[qu])}y=y.return}r!==null&&ng(l,r,u,f),l.flags|=262144}function Bd(r){for(r=r.firstContext;r!==null;){if(!li(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function po(r){fo=r,dr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Sn(r){return W0(fo,r)}function Ud(r,l){return fo===null&&po(r),W0(r,l)}function W0(r,l){var u=l._currentValue;if(l={context:l,memoizedValue:u,next:null},dr===null){if(r===null)throw Error(n(308));dr=l,r.dependencies={lanes:0,firstContext:l},r.flags|=524288}else dr=dr.next=l;return u}var cD=typeof AbortController<"u"?AbortController:function(){var r=[],l=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){l.aborted=!0,r.forEach(function(u){return u()})}},uD=i.unstable_scheduleCallback,hD=i.unstable_NormalPriority,Xt={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ig(){return{controller:new cD,data:new Map,refCount:0}}function yu(r){r.refCount--,r.refCount===0&&uD(hD,function(){r.controller.abort()})}var vu=null,sg=0,_l=0,wl=null;function dD(r,l){if(vu===null){var u=vu=[];sg=0,_l=oy(),wl={status:"pending",value:void 0,then:function(f){u.push(f)}}}return sg++,l.then(K0,K0),l}function K0(){if(--sg===0&&vu!==null){wl!==null&&(wl.status="fulfilled");var r=vu;vu=null,_l=0,wl=null;for(var l=0;l<r.length;l++)(0,r[l])()}}function fD(r,l){var u=[],f={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return r.then(function(){f.status="fulfilled",f.value=l;for(var y=0;y<u.length;y++)(0,u[y])(l)},function(y){for(f.status="rejected",f.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),f}var Y0=G.S;G.S=function(r,l){OA=Vn(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&dD(r,l),Y0!==null&&Y0(r,l)};var mo=H(null);function rg(){var r=mo.current;return r!==null?r:vt.pooledCache}function Fd(r,l){l===null?le(mo,mo.current):le(mo,l.pool)}function X0(){var r=rg();return r===null?null:{parent:Xt._currentValue,pool:r}}var Al=Error(n(460)),ag=Error(n(474)),zd=Error(n(542)),Vd={then:function(){}};function Q0(r){return r=r.status,r==="fulfilled"||r==="rejected"}function J0(r,l,u){switch(u=r[u],u===void 0?r.push(l):u!==l&&(l.then(Qi,Qi),l=u),l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,ew(r),r;default:if(typeof l.status=="string")l.then(Qi,Qi);else{if(r=vt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=l,r.status="pending",r.then(function(f){if(l.status==="pending"){var y=l;y.status="fulfilled",y.value=f}},function(f){if(l.status==="pending"){var y=l;y.status="rejected",y.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,ew(r),r}throw yo=l,Al}}function go(r){try{var l=r._init;return l(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(yo=u,Al):u}}var yo=null;function Z0(){if(yo===null)throw Error(n(459));var r=yo;return yo=null,r}function ew(r){if(r===Al||r===zd)throw Error(n(483))}var El=null,bu=0;function qd(r){var l=bu;return bu+=1,El===null&&(El=[]),J0(El,r,l)}function _u(r,l){l=l.props.ref,r.ref=l!==void 0?l:null}function Hd(r,l){throw l.$$typeof===v?Error(n(525)):(r=Object.prototype.toString.call(l),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":r)))}function tw(r){function l(K,$){if(r){var Q=K.deletions;Q===null?(K.deletions=[$],K.flags|=16):Q.push($)}}function u(K,$){if(!r)return null;for(;$!==null;)l(K,$),$=$.sibling;return null}function f(K){for(var $=new Map;K!==null;)K.key!==null?$.set(K.key,K):$.set(K.index,K),K=K.sibling;return $}function y(K,$){return K=ur(K,$),K.index=0,K.sibling=null,K}function b(K,$,Q){return K.index=Q,r?(Q=K.alternate,Q!==null?(Q=Q.index,Q<$?(K.flags|=67108866,$):Q):(K.flags|=67108866,$)):(K.flags|=1048576,$)}function C(K){return r&&K.alternate===null&&(K.flags|=67108866),K}function N(K,$,Q,se){return $===null||$.tag!==6?($=Km(Q,K.mode,se),$.return=K,$):($=y($,Q),$.return=K,$)}function q(K,$,Q,se){var Ee=Q.type;return Ee===A?ie(K,$,Q.props.children,se,Q.key):$!==null&&($.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===O&&go(Ee)===$.type)?($=y($,Q.props),_u($,Q),$.return=K,$):($=Ld(Q.type,Q.key,Q.props,null,K.mode,se),_u($,Q),$.return=K,$)}function J(K,$,Q,se){return $===null||$.tag!==4||$.stateNode.containerInfo!==Q.containerInfo||$.stateNode.implementation!==Q.implementation?($=Ym(Q,K.mode,se),$.return=K,$):($=y($,Q.children||[]),$.return=K,$)}function ie(K,$,Q,se,Ee){return $===null||$.tag!==7?($=uo(Q,K.mode,se,Ee),$.return=K,$):($=y($,Q),$.return=K,$)}function re(K,$,Q){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Km(""+$,K.mode,Q),$.return=K,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case _:return Q=Ld($.type,$.key,$.props,null,K.mode,Q),_u(Q,$),Q.return=K,Q;case S:return $=Ym($,K.mode,Q),$.return=K,$;case O:return $=go($),re(K,$,Q)}if(Ce($)||V($))return $=uo($,K.mode,Q,null),$.return=K,$;if(typeof $.then=="function")return re(K,qd($),Q);if($.$$typeof===I)return re(K,Ud(K,$),Q);Hd(K,$)}return null}function Z(K,$,Q,se){var Ee=$!==null?$.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Ee!==null?null:N(K,$,""+Q,se);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case _:return Q.key===Ee?q(K,$,Q,se):null;case S:return Q.key===Ee?J(K,$,Q,se):null;case O:return Q=go(Q),Z(K,$,Q,se)}if(Ce(Q)||V(Q))return Ee!==null?null:ie(K,$,Q,se,null);if(typeof Q.then=="function")return Z(K,$,qd(Q),se);if(Q.$$typeof===I)return Z(K,$,Ud(K,Q),se);Hd(K,Q)}return null}function ne(K,$,Q,se,Ee){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return K=K.get(Q)||null,N($,K,""+se,Ee);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case _:return K=K.get(se.key===null?Q:se.key)||null,q($,K,se,Ee);case S:return K=K.get(se.key===null?Q:se.key)||null,J($,K,se,Ee);case O:return se=go(se),ne(K,$,Q,se,Ee)}if(Ce(se)||V(se))return K=K.get(Q)||null,ie($,K,se,Ee,null);if(typeof se.then=="function")return ne(K,$,Q,qd(se),Ee);if(se.$$typeof===I)return ne(K,$,Q,Ud($,se),Ee);Hd($,se)}return null}function ye(K,$,Q,se){for(var Ee=null,et=null,be=$,Ve=$=0,Ge=null;be!==null&&Ve<Q.length;Ve++){be.index>Ve?(Ge=be,be=null):Ge=be.sibling;var tt=Z(K,be,Q[Ve],se);if(tt===null){be===null&&(be=Ge);break}r&&be&&tt.alternate===null&&l(K,be),$=b(tt,$,Ve),et===null?Ee=tt:et.sibling=tt,et=tt,be=Ge}if(Ve===Q.length)return u(K,be),Ke&&hr(K,Ve),Ee;if(be===null){for(;Ve<Q.length;Ve++)be=re(K,Q[Ve],se),be!==null&&($=b(be,$,Ve),et===null?Ee=be:et.sibling=be,et=be);return Ke&&hr(K,Ve),Ee}for(be=f(be);Ve<Q.length;Ve++)Ge=ne(be,K,Ve,Q[Ve],se),Ge!==null&&(r&&Ge.alternate!==null&&be.delete(Ge.key===null?Ve:Ge.key),$=b(Ge,$,Ve),et===null?Ee=Ge:et.sibling=Ge,et=Ge);return r&&be.forEach(function(ya){return l(K,ya)}),Ke&&hr(K,Ve),Ee}function Te(K,$,Q,se){if(Q==null)throw Error(n(151));for(var Ee=null,et=null,be=$,Ve=$=0,Ge=null,tt=Q.next();be!==null&&!tt.done;Ve++,tt=Q.next()){be.index>Ve?(Ge=be,be=null):Ge=be.sibling;var ya=Z(K,be,tt.value,se);if(ya===null){be===null&&(be=Ge);break}r&&be&&ya.alternate===null&&l(K,be),$=b(ya,$,Ve),et===null?Ee=ya:et.sibling=ya,et=ya,be=Ge}if(tt.done)return u(K,be),Ke&&hr(K,Ve),Ee;if(be===null){for(;!tt.done;Ve++,tt=Q.next())tt=re(K,tt.value,se),tt!==null&&($=b(tt,$,Ve),et===null?Ee=tt:et.sibling=tt,et=tt);return Ke&&hr(K,Ve),Ee}for(be=f(be);!tt.done;Ve++,tt=Q.next())tt=ne(be,K,Ve,tt.value,se),tt!==null&&(r&&tt.alternate!==null&&be.delete(tt.key===null?Ve:tt.key),$=b(tt,$,Ve),et===null?Ee=tt:et.sibling=tt,et=tt);return r&&be.forEach(function(SO){return l(K,SO)}),Ke&&hr(K,Ve),Ee}function gt(K,$,Q,se){if(typeof Q=="object"&&Q!==null&&Q.type===A&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case _:e:{for(var Ee=Q.key;$!==null;){if($.key===Ee){if(Ee=Q.type,Ee===A){if($.tag===7){u(K,$.sibling),se=y($,Q.props.children),se.return=K,K=se;break e}}else if($.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===O&&go(Ee)===$.type){u(K,$.sibling),se=y($,Q.props),_u(se,Q),se.return=K,K=se;break e}u(K,$);break}else l(K,$);$=$.sibling}Q.type===A?(se=uo(Q.props.children,K.mode,se,Q.key),se.return=K,K=se):(se=Ld(Q.type,Q.key,Q.props,null,K.mode,se),_u(se,Q),se.return=K,K=se)}return C(K);case S:e:{for(Ee=Q.key;$!==null;){if($.key===Ee)if($.tag===4&&$.stateNode.containerInfo===Q.containerInfo&&$.stateNode.implementation===Q.implementation){u(K,$.sibling),se=y($,Q.children||[]),se.return=K,K=se;break e}else{u(K,$);break}else l(K,$);$=$.sibling}se=Ym(Q,K.mode,se),se.return=K,K=se}return C(K);case O:return Q=go(Q),gt(K,$,Q,se)}if(Ce(Q))return ye(K,$,Q,se);if(V(Q)){if(Ee=V(Q),typeof Ee!="function")throw Error(n(150));return Q=Ee.call(Q),Te(K,$,Q,se)}if(typeof Q.then=="function")return gt(K,$,qd(Q),se);if(Q.$$typeof===I)return gt(K,$,Ud(K,Q),se);Hd(K,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,$!==null&&$.tag===6?(u(K,$.sibling),se=y($,Q),se.return=K,K=se):(u(K,$),se=Km(Q,K.mode,se),se.return=K,K=se),C(K)):u(K,$)}return function(K,$,Q,se){try{bu=0;var Ee=gt(K,$,Q,se);return El=null,Ee}catch(be){if(be===Al||be===zd)throw be;var et=ci(29,be,null,K.mode);return et.lanes=se,et.return=K,et}}}var vo=tw(!0),nw=tw(!1),ea=!1;function og(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lg(r,l){r=r.updateQueue,l.updateQueue===r&&(l.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ta(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function na(r,l,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(it&2)!==0){var y=f.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),f.pending=l,l=Md(r),U0(r,null,u),l}return Nd(r,f,l,u),Md(r)}function wu(r,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194048)!==0)){var f=l.lanes;f&=r.pendingLanes,u|=f,l.lanes=u,Kc(r,u)}}function cg(r,l){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var C={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};b===null?y=b=C:b=b.next=C,u=u.next}while(u!==null);b===null?y=b=l:b=b.next=l}else y=b=l;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=l:r.next=l,u.lastBaseUpdate=l}var ug=!1;function Au(){if(ug){var r=wl;if(r!==null)throw r}}function Eu(r,l,u,f){ug=!1;var y=r.updateQueue;ea=!1;var b=y.firstBaseUpdate,C=y.lastBaseUpdate,N=y.shared.pending;if(N!==null){y.shared.pending=null;var q=N,J=q.next;q.next=null,C===null?b=J:C.next=J,C=q;var ie=r.alternate;ie!==null&&(ie=ie.updateQueue,N=ie.lastBaseUpdate,N!==C&&(N===null?ie.firstBaseUpdate=J:N.next=J,ie.lastBaseUpdate=q))}if(b!==null){var re=y.baseState;C=0,ie=J=q=null,N=b;do{var Z=N.lane&-536870913,ne=Z!==N.lane;if(ne?($e&Z)===Z:(f&Z)===Z){Z!==0&&Z===_l&&(ug=!0),ie!==null&&(ie=ie.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var ye=r,Te=N;Z=l;var gt=u;switch(Te.tag){case 1:if(ye=Te.payload,typeof ye=="function"){re=ye.call(gt,re,Z);break e}re=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=Te.payload,Z=typeof ye=="function"?ye.call(gt,re,Z):ye,Z==null)break e;re=m({},re,Z);break e;case 2:ea=!0}}Z=N.callback,Z!==null&&(r.flags|=64,ne&&(r.flags|=8192),ne=y.callbacks,ne===null?y.callbacks=[Z]:ne.push(Z))}else ne={lane:Z,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ie===null?(J=ie=ne,q=re):ie=ie.next=ne,C|=Z;if(N=N.next,N===null){if(N=y.shared.pending,N===null)break;ne=N,N=ne.next,ne.next=null,y.lastBaseUpdate=ne,y.shared.pending=null}}while(!0);ie===null&&(q=re),y.baseState=q,y.firstBaseUpdate=J,y.lastBaseUpdate=ie,b===null&&(y.shared.lanes=0),oa|=C,r.lanes=C,r.memoizedState=re}}function iw(r,l){if(typeof r!="function")throw Error(n(191,r));r.call(l)}function sw(r,l){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)iw(u[r],l)}var Sl=H(null),$d=H(0);function rw(r,l){r=Ar,le($d,r),le(Sl,l),Ar=r|l.baseLanes}function hg(){le($d,Ar),le(Sl,Sl.current)}function dg(){Ar=$d.current,ee(Sl),ee($d)}var ui=H(null),Ni=null;function ia(r){var l=r.alternate;le(Ft,Ft.current&1),le(ui,r),Ni===null&&(l===null||Sl.current!==null||l.memoizedState!==null)&&(Ni=r)}function fg(r){le(Ft,Ft.current),le(ui,r),Ni===null&&(Ni=r)}function aw(r){r.tag===22?(le(Ft,Ft.current),le(ui,r),Ni===null&&(Ni=r)):sa()}function sa(){le(Ft,Ft.current),le(ui,ui.current)}function hi(r){ee(ui),Ni===r&&(Ni=null),ee(Ft)}var Ft=H(0);function Gd(r){for(var l=r;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||by(u)||_y(u)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var pr=0,ze=null,pt=null,Qt=null,Wd=!1,Tl=!1,bo=!1,Kd=0,Su=0,xl=null,pD=0;function Nt(){throw Error(n(321))}function pg(r,l){if(l===null)return!1;for(var u=0;u<l.length&&u<r.length;u++)if(!li(r[u],l[u]))return!1;return!0}function mg(r,l,u,f,y,b){return pr=b,ze=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,G.H=r===null||r.memoizedState===null?qw:Ig,bo=!1,b=u(f,y),bo=!1,Tl&&(b=lw(l,u,f,y)),ow(r),b}function ow(r){G.H=Cu;var l=pt!==null&&pt.next!==null;if(pr=0,Qt=pt=ze=null,Wd=!1,Su=0,xl=null,l)throw Error(n(300));r===null||Jt||(r=r.dependencies,r!==null&&Bd(r)&&(Jt=!0))}function lw(r,l,u,f){ze=r;var y=0;do{if(Tl&&(xl=null),Su=0,Tl=!1,25<=y)throw Error(n(301));if(y+=1,Qt=pt=null,r.updateQueue!=null){var b=r.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}G.H=Hw,b=l(u,f)}while(Tl);return b}function mD(){var r=G.H,l=r.useState()[0];return l=typeof l.then=="function"?Tu(l):l,r=r.useState()[0],(pt!==null?pt.memoizedState:null)!==r&&(ze.flags|=1024),l}function gg(){var r=Kd!==0;return Kd=0,r}function yg(r,l,u){l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~u}function vg(r){if(Wd){for(r=r.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}Wd=!1}pr=0,Qt=pt=ze=null,Tl=!1,Su=Kd=0,xl=null}function Hn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qt===null?ze.memoizedState=Qt=r:Qt=Qt.next=r,Qt}function zt(){if(pt===null){var r=ze.alternate;r=r!==null?r.memoizedState:null}else r=pt.next;var l=Qt===null?ze.memoizedState:Qt.next;if(l!==null)Qt=l,pt=r;else{if(r===null)throw ze.alternate===null?Error(n(467)):Error(n(310));pt=r,r={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Qt===null?ze.memoizedState=Qt=r:Qt=Qt.next=r}return Qt}function Yd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tu(r){var l=Su;return Su+=1,xl===null&&(xl=[]),r=J0(xl,r,l),l=ze,(Qt===null?l.memoizedState:Qt.next)===null&&(l=l.alternate,G.H=l===null||l.memoizedState===null?qw:Ig),r}function Xd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Tu(r);if(r.$$typeof===I)return Sn(r)}throw Error(n(438,String(r)))}function bg(r){var l=null,u=ze.updateQueue;if(u!==null&&(l=u.memoCache),l==null){var f=ze.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(y){return y.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),u===null&&(u=Yd(),ze.updateQueue=u),u.memoCache=l,u=l.data[l.index],u===void 0)for(u=l.data[l.index]=Array(r),f=0;f<r;f++)u[f]=j;return l.index++,u}function mr(r,l){return typeof l=="function"?l(r):l}function Qd(r){var l=zt();return _g(l,pt,r)}function _g(r,l,u){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var y=r.baseQueue,b=f.pending;if(b!==null){if(y!==null){var C=y.next;y.next=b.next,b.next=C}l.baseQueue=y=b,f.pending=null}if(b=r.baseState,y===null)r.memoizedState=b;else{l=y.next;var N=C=null,q=null,J=l,ie=!1;do{var re=J.lane&-536870913;if(re!==J.lane?($e&re)===re:(pr&re)===re){var Z=J.revertLane;if(Z===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),re===_l&&(ie=!0);else if((pr&Z)===Z){J=J.next,Z===_l&&(ie=!0);continue}else re={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},q===null?(N=q=re,C=b):q=q.next=re,ze.lanes|=Z,oa|=Z;re=J.action,bo&&u(b,re),b=J.hasEagerState?J.eagerState:u(b,re)}else Z={lane:re,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},q===null?(N=q=Z,C=b):q=q.next=Z,ze.lanes|=re,oa|=re;J=J.next}while(J!==null&&J!==l);if(q===null?C=b:q.next=N,!li(b,r.memoizedState)&&(Jt=!0,ie&&(u=wl,u!==null)))throw u;r.memoizedState=b,r.baseState=C,r.baseQueue=q,f.lastRenderedState=b}return y===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function wg(r){var l=zt(),u=l.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var f=u.dispatch,y=u.pending,b=l.memoizedState;if(y!==null){u.pending=null;var C=y=y.next;do b=r(b,C.action),C=C.next;while(C!==y);li(b,l.memoizedState)||(Jt=!0),l.memoizedState=b,l.baseQueue===null&&(l.baseState=b),u.lastRenderedState=b}return[b,f]}function cw(r,l,u){var f=ze,y=zt(),b=Ke;if(b){if(u===void 0)throw Error(n(407));u=u()}else u=l();var C=!li((pt||y).memoizedState,u);if(C&&(y.memoizedState=u,Jt=!0),y=y.queue,Sg(dw.bind(null,f,y,r),[r]),y.getSnapshot!==l||C||Qt!==null&&Qt.memoizedState.tag&1){if(f.flags|=2048,Cl(9,{destroy:void 0},hw.bind(null,f,y,u,l),null),vt===null)throw Error(n(349));b||(pr&127)!==0||uw(f,l,u)}return u}function uw(r,l,u){r.flags|=16384,r={getSnapshot:l,value:u},l=ze.updateQueue,l===null?(l=Yd(),ze.updateQueue=l,l.stores=[r]):(u=l.stores,u===null?l.stores=[r]:u.push(r))}function hw(r,l,u,f){l.value=u,l.getSnapshot=f,fw(l)&&pw(r)}function dw(r,l,u){return u(function(){fw(l)&&pw(r)})}function fw(r){var l=r.getSnapshot;r=r.value;try{var u=l();return!li(r,u)}catch{return!0}}function pw(r){var l=co(r,2);l!==null&&ei(l,r,2)}function Ag(r){var l=Hn();if(typeof r=="function"){var u=r;if(r=u(),bo){Si(!0);try{u()}finally{Si(!1)}}}return l.memoizedState=l.baseState=r,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mr,lastRenderedState:r},l}function mw(r,l,u,f){return r.baseState=u,_g(r,pt,typeof f=="function"?f:mr)}function gD(r,l,u,f,y){if(ef(r))throw Error(n(485));if(r=l.action,r!==null){var b={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){b.listeners.push(C)}};G.T!==null?u(!0):b.isTransition=!1,f(b),u=l.pending,u===null?(b.next=l.pending=b,gw(l,b)):(b.next=u.next,l.pending=u.next=b)}}function gw(r,l){var u=l.action,f=l.payload,y=r.state;if(l.isTransition){var b=G.T,C={};G.T=C;try{var N=u(y,f),q=G.S;q!==null&&q(C,N),yw(r,l,N)}catch(J){Eg(r,l,J)}finally{b!==null&&C.types!==null&&(b.types=C.types),G.T=b}}else try{b=u(y,f),yw(r,l,b)}catch(J){Eg(r,l,J)}}function yw(r,l,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){vw(r,l,f)},function(f){return Eg(r,l,f)}):vw(r,l,u)}function vw(r,l,u){l.status="fulfilled",l.value=u,bw(l),r.state=u,l=r.pending,l!==null&&(u=l.next,u===l?r.pending=null:(u=u.next,l.next=u,gw(r,u)))}function Eg(r,l,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=u,bw(l),l=l.next;while(l!==f)}r.action=null}function bw(r){r=r.listeners;for(var l=0;l<r.length;l++)(0,r[l])()}function _w(r,l){return l}function ww(r,l){if(Ke){var u=vt.formState;if(u!==null){e:{var f=ze;if(Ke){if(wt){t:{for(var y=wt,b=Pi;y.nodeType!==8;){if(!b){y=null;break t}if(y=Mi(y.nextSibling),y===null){y=null;break t}}b=y.data,y=b==="F!"||b==="F"?y:null}if(y){wt=Mi(y.nextSibling),f=y.data==="F!";break e}}Jr(f)}f=!1}f&&(l=u[0])}}return u=Hn(),u.memoizedState=u.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_w,lastRenderedState:l},u.queue=f,u=Fw.bind(null,ze,f),f.dispatch=u,f=Ag(!1),b=Rg.bind(null,ze,!1,f.queue),f=Hn(),y={state:l,dispatch:null,action:r,pending:null},f.queue=y,u=gD.bind(null,ze,y,b,u),y.dispatch=u,f.memoizedState=r,[l,u,!1]}function Aw(r){var l=zt();return Ew(l,pt,r)}function Ew(r,l,u){if(l=_g(r,l,_w)[0],r=Qd(mr)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=Tu(l)}catch(C){throw C===Al?zd:C}else f=l;l=zt();var y=l.queue,b=y.dispatch;return u!==l.memoizedState&&(ze.flags|=2048,Cl(9,{destroy:void 0},yD.bind(null,y,u),null)),[f,b,r]}function yD(r,l){r.action=l}function Sw(r){var l=zt(),u=pt;if(u!==null)return Ew(l,u,r);zt(),l=l.memoizedState,u=zt();var f=u.queue.dispatch;return u.memoizedState=r,[l,f,!1]}function Cl(r,l,u,f){return r={tag:r,create:u,deps:f,inst:l,next:null},l=ze.updateQueue,l===null&&(l=Yd(),ze.updateQueue=l),u=l.lastEffect,u===null?l.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,l.lastEffect=r),r}function Tw(){return zt().memoizedState}function Jd(r,l,u,f){var y=Hn();ze.flags|=r,y.memoizedState=Cl(1|l,{destroy:void 0},u,f===void 0?null:f)}function Zd(r,l,u,f){var y=zt();f=f===void 0?null:f;var b=y.memoizedState.inst;pt!==null&&f!==null&&pg(f,pt.memoizedState.deps)?y.memoizedState=Cl(l,b,u,f):(ze.flags|=r,y.memoizedState=Cl(1|l,b,u,f))}function xw(r,l){Jd(8390656,8,r,l)}function Sg(r,l){Zd(2048,8,r,l)}function vD(r){ze.flags|=4;var l=ze.updateQueue;if(l===null)l=Yd(),ze.updateQueue=l,l.events=[r];else{var u=l.events;u===null?l.events=[r]:u.push(r)}}function Cw(r){var l=zt().memoizedState;return vD({ref:l,nextImpl:r}),function(){if((it&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function kw(r,l){return Zd(4,2,r,l)}function Rw(r,l){return Zd(4,4,r,l)}function Iw(r,l){if(typeof l=="function"){r=r();var u=l(r);return function(){typeof u=="function"?u():l(null)}}if(l!=null)return r=r(),l.current=r,function(){l.current=null}}function Dw(r,l,u){u=u!=null?u.concat([r]):null,Zd(4,4,Iw.bind(null,l,r),u)}function Tg(){}function Ow(r,l){var u=zt();l=l===void 0?null:l;var f=u.memoizedState;return l!==null&&pg(l,f[1])?f[0]:(u.memoizedState=[r,l],r)}function Pw(r,l){var u=zt();l=l===void 0?null:l;var f=u.memoizedState;if(l!==null&&pg(l,f[1]))return f[0];if(f=r(),bo){Si(!0);try{r()}finally{Si(!1)}}return u.memoizedState=[f,l],f}function xg(r,l,u){return u===void 0||(pr&1073741824)!==0&&($e&261930)===0?r.memoizedState=l:(r.memoizedState=u,r=NA(),ze.lanes|=r,oa|=r,u)}function Nw(r,l,u,f){return li(u,l)?u:Sl.current!==null?(r=xg(r,u,f),li(r,l)||(Jt=!0),r):(pr&42)===0||(pr&1073741824)!==0&&($e&261930)===0?(Jt=!0,r.memoizedState=u):(r=NA(),ze.lanes|=r,oa|=r,l)}function Mw(r,l,u,f,y){var b=W.p;W.p=b!==0&&8>b?b:8;var C=G.T,N={};G.T=N,Rg(r,!1,l,u);try{var q=y(),J=G.S;if(J!==null&&J(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ie=fD(q,f);xu(r,l,ie,pi(r))}else xu(r,l,f,pi(r))}catch(re){xu(r,l,{then:function(){},status:"rejected",reason:re},pi())}finally{W.p=b,C!==null&&N.types!==null&&(C.types=N.types),G.T=C}}function bD(){}function Cg(r,l,u,f){if(r.tag!==5)throw Error(n(476));var y=Lw(r).queue;Mw(r,y,l,ae,u===null?bD:function(){return jw(r),u(f)})}function Lw(r){var l=r.memoizedState;if(l!==null)return l;l={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mr,lastRenderedState:ae},next:null};var u={};return l.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mr,lastRenderedState:u},next:null},r.memoizedState=l,r=r.alternate,r!==null&&(r.memoizedState=l),l}function jw(r){var l=Lw(r);l.next===null&&(l=r.alternate.memoizedState),xu(r,l.next.queue,{},pi())}function kg(){return Sn(qu)}function Bw(){return zt().memoizedState}function Uw(){return zt().memoizedState}function _D(r){for(var l=r.return;l!==null;){switch(l.tag){case 24:case 3:var u=pi();r=ta(u);var f=na(l,r,u);f!==null&&(ei(f,l,u),wu(f,l,u)),l={cache:ig()},r.payload=l;return}l=l.return}}function wD(r,l,u){var f=pi();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ef(r)?zw(l,u):(u=Gm(r,l,u,f),u!==null&&(ei(u,r,f),Vw(u,l,f)))}function Fw(r,l,u){var f=pi();xu(r,l,u,f)}function xu(r,l,u,f){var y={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(ef(r))zw(l,y);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=l.lastRenderedReducer,b!==null))try{var C=l.lastRenderedState,N=b(C,u);if(y.hasEagerState=!0,y.eagerState=N,li(N,C))return Nd(r,l,y,0),vt===null&&Pd(),!1}catch{}if(u=Gm(r,l,y,f),u!==null)return ei(u,r,f),Vw(u,l,f),!0}return!1}function Rg(r,l,u,f){if(f={lane:2,revertLane:oy(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},ef(r)){if(l)throw Error(n(479))}else l=Gm(r,u,f,2),l!==null&&ei(l,r,2)}function ef(r){var l=r.alternate;return r===ze||l!==null&&l===ze}function zw(r,l){Tl=Wd=!0;var u=r.pending;u===null?l.next=l:(l.next=u.next,u.next=l),r.pending=l}function Vw(r,l,u){if((u&4194048)!==0){var f=l.lanes;f&=r.pendingLanes,u|=f,l.lanes=u,Kc(r,u)}}var Cu={readContext:Sn,use:Xd,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt};Cu.useEffectEvent=Nt;var qw={readContext:Sn,use:Xd,useCallback:function(r,l){return Hn().memoizedState=[r,l===void 0?null:l],r},useContext:Sn,useEffect:xw,useImperativeHandle:function(r,l,u){u=u!=null?u.concat([r]):null,Jd(4194308,4,Iw.bind(null,l,r),u)},useLayoutEffect:function(r,l){return Jd(4194308,4,r,l)},useInsertionEffect:function(r,l){Jd(4,2,r,l)},useMemo:function(r,l){var u=Hn();l=l===void 0?null:l;var f=r();if(bo){Si(!0);try{r()}finally{Si(!1)}}return u.memoizedState=[f,l],f},useReducer:function(r,l,u){var f=Hn();if(u!==void 0){var y=u(l);if(bo){Si(!0);try{u(l)}finally{Si(!1)}}}else y=l;return f.memoizedState=f.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},f.queue=r,r=r.dispatch=wD.bind(null,ze,r),[f.memoizedState,r]},useRef:function(r){var l=Hn();return r={current:r},l.memoizedState=r},useState:function(r){r=Ag(r);var l=r.queue,u=Fw.bind(null,ze,l);return l.dispatch=u,[r.memoizedState,u]},useDebugValue:Tg,useDeferredValue:function(r,l){var u=Hn();return xg(u,r,l)},useTransition:function(){var r=Ag(!1);return r=Mw.bind(null,ze,r.queue,!0,!1),Hn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,l,u){var f=ze,y=Hn();if(Ke){if(u===void 0)throw Error(n(407));u=u()}else{if(u=l(),vt===null)throw Error(n(349));($e&127)!==0||uw(f,l,u)}y.memoizedState=u;var b={value:u,getSnapshot:l};return y.queue=b,xw(dw.bind(null,f,b,r),[r]),f.flags|=2048,Cl(9,{destroy:void 0},hw.bind(null,f,b,u,l),null),u},useId:function(){var r=Hn(),l=vt.identifierPrefix;if(Ke){var u=Ms,f=Ns;u=(f&~(1<<32-Bt(f)-1)).toString(32)+u,l="_"+l+"R_"+u,u=Kd++,0<u&&(l+="H"+u.toString(32)),l+="_"}else u=pD++,l="_"+l+"r_"+u.toString(32)+"_";return r.memoizedState=l},useHostTransitionStatus:kg,useFormState:ww,useActionState:ww,useOptimistic:function(r){var l=Hn();l.memoizedState=l.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=u,l=Rg.bind(null,ze,!0,u),u.dispatch=l,[r,l]},useMemoCache:bg,useCacheRefresh:function(){return Hn().memoizedState=_D.bind(null,ze)},useEffectEvent:function(r){var l=Hn(),u={impl:r};return l.memoizedState=u,function(){if((it&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},Ig={readContext:Sn,use:Xd,useCallback:Ow,useContext:Sn,useEffect:Sg,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Rw,useMemo:Pw,useReducer:Qd,useRef:Tw,useState:function(){return Qd(mr)},useDebugValue:Tg,useDeferredValue:function(r,l){var u=zt();return Nw(u,pt.memoizedState,r,l)},useTransition:function(){var r=Qd(mr)[0],l=zt().memoizedState;return[typeof r=="boolean"?r:Tu(r),l]},useSyncExternalStore:cw,useId:Bw,useHostTransitionStatus:kg,useFormState:Aw,useActionState:Aw,useOptimistic:function(r,l){var u=zt();return mw(u,pt,r,l)},useMemoCache:bg,useCacheRefresh:Uw};Ig.useEffectEvent=Cw;var Hw={readContext:Sn,use:Xd,useCallback:Ow,useContext:Sn,useEffect:Sg,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Rw,useMemo:Pw,useReducer:wg,useRef:Tw,useState:function(){return wg(mr)},useDebugValue:Tg,useDeferredValue:function(r,l){var u=zt();return pt===null?xg(u,r,l):Nw(u,pt.memoizedState,r,l)},useTransition:function(){var r=wg(mr)[0],l=zt().memoizedState;return[typeof r=="boolean"?r:Tu(r),l]},useSyncExternalStore:cw,useId:Bw,useHostTransitionStatus:kg,useFormState:Sw,useActionState:Sw,useOptimistic:function(r,l){var u=zt();return pt!==null?mw(u,pt,r,l):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:bg,useCacheRefresh:Uw};Hw.useEffectEvent=Cw;function Dg(r,l,u,f){l=r.memoizedState,u=u(f,l),u=u==null?l:m({},l,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var Og={enqueueSetState:function(r,l,u){r=r._reactInternals;var f=pi(),y=ta(f);y.payload=l,u!=null&&(y.callback=u),l=na(r,y,f),l!==null&&(ei(l,r,f),wu(l,r,f))},enqueueReplaceState:function(r,l,u){r=r._reactInternals;var f=pi(),y=ta(f);y.tag=1,y.payload=l,u!=null&&(y.callback=u),l=na(r,y,f),l!==null&&(ei(l,r,f),wu(l,r,f))},enqueueForceUpdate:function(r,l){r=r._reactInternals;var u=pi(),f=ta(u);f.tag=2,l!=null&&(f.callback=l),l=na(r,f,u),l!==null&&(ei(l,r,u),wu(l,r,u))}};function $w(r,l,u,f,y,b,C){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,b,C):l.prototype&&l.prototype.isPureReactComponent?!fu(u,f)||!fu(y,b):!0}function Gw(r,l,u,f){r=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,f),l.state!==r&&Og.enqueueReplaceState(l,l.state,null)}function _o(r,l){var u=l;if("ref"in l){u={};for(var f in l)f!=="ref"&&(u[f]=l[f])}if(r=r.defaultProps){u===l&&(u=m({},u));for(var y in r)u[y]===void 0&&(u[y]=r[y])}return u}function Ww(r){Od(r)}function Kw(r){console.error(r)}function Yw(r){Od(r)}function tf(r,l){try{var u=r.onUncaughtError;u(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function Xw(r,l,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Pg(r,l,u){return u=ta(u),u.tag=3,u.payload={element:null},u.callback=function(){tf(r,l)},u}function Qw(r){return r=ta(r),r.tag=3,r}function Jw(r,l,u,f){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var b=f.value;r.payload=function(){return y(b)},r.callback=function(){Xw(l,u,f)}}var C=u.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(r.callback=function(){Xw(l,u,f),typeof y!="function"&&(la===null?la=new Set([this]):la.add(this));var N=f.stack;this.componentDidCatch(f.value,{componentStack:N!==null?N:""})})}function AD(r,l,u,f,y){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=u.alternate,l!==null&&bl(l,u,y,!0),u=ui.current,u!==null){switch(u.tag){case 31:case 13:return Ni===null?pf():u.alternate===null&&Mt===0&&(Mt=3),u.flags&=-257,u.flags|=65536,u.lanes=y,f===Vd?u.flags|=16384:(l=u.updateQueue,l===null?u.updateQueue=new Set([f]):l.add(f),sy(r,f,y)),!1;case 22:return u.flags|=65536,f===Vd?u.flags|=16384:(l=u.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=l):(u=l.retryQueue,u===null?l.retryQueue=new Set([f]):u.add(f)),sy(r,f,y)),!1}throw Error(n(435,u.tag))}return sy(r,f,y),pf(),!1}if(Ke)return l=ui.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=y,f!==Jm&&(r=Error(n(422),{cause:f}),gu(Ii(r,u)))):(f!==Jm&&(l=Error(n(423),{cause:f}),gu(Ii(l,u))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,f=Ii(f,u),y=Pg(r.stateNode,f,y),cg(r,y),Mt!==4&&(Mt=2)),!1;var b=Error(n(520),{cause:f});if(b=Ii(b,u),Mu===null?Mu=[b]:Mu.push(b),Mt!==4&&(Mt=2),l===null)return!0;f=Ii(f,u),u=l;do{switch(u.tag){case 3:return u.flags|=65536,r=y&-y,u.lanes|=r,r=Pg(u.stateNode,f,r),cg(u,r),!1;case 1:if(l=u.type,b=u.stateNode,(u.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(la===null||!la.has(b))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Qw(y),Jw(y,r,u,f),cg(u,y),!1}u=u.return}while(u!==null);return!1}var Ng=Error(n(461)),Jt=!1;function Tn(r,l,u,f){l.child=r===null?nw(l,null,u,f):vo(l,r.child,u,f)}function Zw(r,l,u,f,y){u=u.render;var b=l.ref;if("ref"in f){var C={};for(var N in f)N!=="ref"&&(C[N]=f[N])}else C=f;return po(l),f=mg(r,l,u,C,b,y),N=gg(),r!==null&&!Jt?(yg(r,l,y),gr(r,l,y)):(Ke&&N&&Xm(l),l.flags|=1,Tn(r,l,f,y),l.child)}function eA(r,l,u,f,y){if(r===null){var b=u.type;return typeof b=="function"&&!Wm(b)&&b.defaultProps===void 0&&u.compare===null?(l.tag=15,l.type=b,tA(r,l,b,f,y)):(r=Ld(u.type,null,f,l,l.mode,y),r.ref=l.ref,r.return=l,l.child=r)}if(b=r.child,!Vg(r,y)){var C=b.memoizedProps;if(u=u.compare,u=u!==null?u:fu,u(C,f)&&r.ref===l.ref)return gr(r,l,y)}return l.flags|=1,r=ur(b,f),r.ref=l.ref,r.return=l,l.child=r}function tA(r,l,u,f,y){if(r!==null){var b=r.memoizedProps;if(fu(b,f)&&r.ref===l.ref)if(Jt=!1,l.pendingProps=f=b,Vg(r,y))(r.flags&131072)!==0&&(Jt=!0);else return l.lanes=r.lanes,gr(r,l,y)}return Mg(r,l,u,f,y)}function nA(r,l,u,f){var y=f.children,b=r!==null?r.memoizedState:null;if(r===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(b=b!==null?b.baseLanes|u:u,r!==null){for(f=l.child=r.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~b}else f=0,l.child=null;return iA(r,l,b,u,f)}if((u&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},r!==null&&Fd(l,b!==null?b.cachePool:null),b!==null?rw(l,b):hg(),aw(l);else return f=l.lanes=536870912,iA(r,l,b!==null?b.baseLanes|u:u,u,f)}else b!==null?(Fd(l,b.cachePool),rw(l,b),sa(),l.memoizedState=null):(r!==null&&Fd(l,null),hg(),sa());return Tn(r,l,y,u),l.child}function ku(r,l){return r!==null&&r.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function iA(r,l,u,f,y){var b=rg();return b=b===null?null:{parent:Xt._currentValue,pool:b},l.memoizedState={baseLanes:u,cachePool:b},r!==null&&Fd(l,null),hg(),aw(l),r!==null&&bl(r,l,f,!0),l.childLanes=y,null}function nf(r,l){return l=rf({mode:l.mode,children:l.children},r.mode),l.ref=r.ref,r.child=l,l.return=r,l}function sA(r,l,u){return vo(l,r.child,null,u),r=nf(l,l.pendingProps),r.flags|=2,hi(l),l.memoizedState=null,r}function ED(r,l,u){var f=l.pendingProps,y=(l.flags&128)!==0;if(l.flags&=-129,r===null){if(Ke){if(f.mode==="hidden")return r=nf(l,f),l.lanes=536870912,ku(null,r);if(fg(l),(r=wt)?(r=gE(r,Pi),r=r!==null&&r.data==="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:Xr!==null?{id:Ns,overflow:Ms}:null,retryLane:536870912,hydrationErrors:null},u=z0(r),u.return=l,l.child=u,En=l,wt=null)):r=null,r===null)throw Jr(l);return l.lanes=536870912,null}return nf(l,f)}var b=r.memoizedState;if(b!==null){var C=b.dehydrated;if(fg(l),y)if(l.flags&256)l.flags&=-257,l=sA(r,l,u);else if(l.memoizedState!==null)l.child=r.child,l.flags|=128,l=null;else throw Error(n(558));else if(Jt||bl(r,l,u,!1),y=(u&r.childLanes)!==0,Jt||y){if(f=vt,f!==null&&(C=Yc(f,u),C!==0&&C!==b.retryLane))throw b.retryLane=C,co(r,C),ei(f,r,C),Ng;pf(),l=sA(r,l,u)}else r=b.treeContext,wt=Mi(C.nextSibling),En=l,Ke=!0,Qr=null,Pi=!1,r!==null&&H0(l,r),l=nf(l,f),l.flags|=4096;return l}return r=ur(r.child,{mode:f.mode,children:f.children}),r.ref=l.ref,l.child=r,r.return=l,r}function sf(r,l){var u=l.ref;if(u===null)r!==null&&r.ref!==null&&(l.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(l.flags|=4194816)}}function Mg(r,l,u,f,y){return po(l),u=mg(r,l,u,f,void 0,y),f=gg(),r!==null&&!Jt?(yg(r,l,y),gr(r,l,y)):(Ke&&f&&Xm(l),l.flags|=1,Tn(r,l,u,y),l.child)}function rA(r,l,u,f,y,b){return po(l),l.updateQueue=null,u=lw(l,f,u,y),ow(r),f=gg(),r!==null&&!Jt?(yg(r,l,b),gr(r,l,b)):(Ke&&f&&Xm(l),l.flags|=1,Tn(r,l,u,b),l.child)}function aA(r,l,u,f,y){if(po(l),l.stateNode===null){var b=ml,C=u.contextType;typeof C=="object"&&C!==null&&(b=Sn(C)),b=new u(f,b),l.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Og,l.stateNode=b,b._reactInternals=l,b=l.stateNode,b.props=f,b.state=l.memoizedState,b.refs={},og(l),C=u.contextType,b.context=typeof C=="object"&&C!==null?Sn(C):ml,b.state=l.memoizedState,C=u.getDerivedStateFromProps,typeof C=="function"&&(Dg(l,u,C,f),b.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(C=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),C!==b.state&&Og.enqueueReplaceState(b,b.state,null),Eu(l,f,b,y),Au(),b.state=l.memoizedState),typeof b.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(r===null){b=l.stateNode;var N=l.memoizedProps,q=_o(u,N);b.props=q;var J=b.context,ie=u.contextType;C=ml,typeof ie=="object"&&ie!==null&&(C=Sn(ie));var re=u.getDerivedStateFromProps;ie=typeof re=="function"||typeof b.getSnapshotBeforeUpdate=="function",N=l.pendingProps!==N,ie||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(N||J!==C)&&Gw(l,b,f,C),ea=!1;var Z=l.memoizedState;b.state=Z,Eu(l,f,b,y),Au(),J=l.memoizedState,N||Z!==J||ea?(typeof re=="function"&&(Dg(l,u,re,f),J=l.memoizedState),(q=ea||$w(l,u,q,f,Z,J,C))?(ie||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=J),b.props=f,b.state=J,b.context=C,f=q):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{b=l.stateNode,lg(r,l),C=l.memoizedProps,ie=_o(u,C),b.props=ie,re=l.pendingProps,Z=b.context,J=u.contextType,q=ml,typeof J=="object"&&J!==null&&(q=Sn(J)),N=u.getDerivedStateFromProps,(J=typeof N=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(C!==re||Z!==q)&&Gw(l,b,f,q),ea=!1,Z=l.memoizedState,b.state=Z,Eu(l,f,b,y),Au();var ne=l.memoizedState;C!==re||Z!==ne||ea||r!==null&&r.dependencies!==null&&Bd(r.dependencies)?(typeof N=="function"&&(Dg(l,u,N,f),ne=l.memoizedState),(ie=ea||$w(l,u,ie,f,Z,ne,q)||r!==null&&r.dependencies!==null&&Bd(r.dependencies))?(J||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,ne,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,ne,q)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||C===r.memoizedProps&&Z===r.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&Z===r.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=ne),b.props=f,b.state=ne,b.context=q,f=ie):(typeof b.componentDidUpdate!="function"||C===r.memoizedProps&&Z===r.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&Z===r.memoizedState||(l.flags|=1024),f=!1)}return b=f,sf(r,l),f=(l.flags&128)!==0,b||f?(b=l.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:b.render(),l.flags|=1,r!==null&&f?(l.child=vo(l,r.child,null,y),l.child=vo(l,null,u,y)):Tn(r,l,u,y),l.memoizedState=b.state,r=l.child):r=gr(r,l,y),r}function oA(r,l,u,f){return ho(),l.flags|=256,Tn(r,l,u,f),l.child}var Lg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jg(r){return{baseLanes:r,cachePool:X0()}}function Bg(r,l,u){return r=r!==null?r.childLanes&~u:0,l&&(r|=fi),r}function lA(r,l,u){var f=l.pendingProps,y=!1,b=(l.flags&128)!==0,C;if((C=b)||(C=r!==null&&r.memoizedState===null?!1:(Ft.current&2)!==0),C&&(y=!0,l.flags&=-129),C=(l.flags&32)!==0,l.flags&=-33,r===null){if(Ke){if(y?ia(l):sa(),(r=wt)?(r=gE(r,Pi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:Xr!==null?{id:Ns,overflow:Ms}:null,retryLane:536870912,hydrationErrors:null},u=z0(r),u.return=l,l.child=u,En=l,wt=null)):r=null,r===null)throw Jr(l);return _y(r)?l.lanes=32:l.lanes=536870912,null}var N=f.children;return f=f.fallback,y?(sa(),y=l.mode,N=rf({mode:"hidden",children:N},y),f=uo(f,y,u,null),N.return=l,f.return=l,N.sibling=f,l.child=N,f=l.child,f.memoizedState=jg(u),f.childLanes=Bg(r,C,u),l.memoizedState=Lg,ku(null,f)):(ia(l),Ug(l,N))}var q=r.memoizedState;if(q!==null&&(N=q.dehydrated,N!==null)){if(b)l.flags&256?(ia(l),l.flags&=-257,l=Fg(r,l,u)):l.memoizedState!==null?(sa(),l.child=r.child,l.flags|=128,l=null):(sa(),N=f.fallback,y=l.mode,f=rf({mode:"visible",children:f.children},y),N=uo(N,y,u,null),N.flags|=2,f.return=l,N.return=l,f.sibling=N,l.child=f,vo(l,r.child,null,u),f=l.child,f.memoizedState=jg(u),f.childLanes=Bg(r,C,u),l.memoizedState=Lg,l=ku(null,f));else if(ia(l),_y(N)){if(C=N.nextSibling&&N.nextSibling.dataset,C)var J=C.dgst;C=J,f=Error(n(419)),f.stack="",f.digest=C,gu({value:f,source:null,stack:null}),l=Fg(r,l,u)}else if(Jt||bl(r,l,u,!1),C=(u&r.childLanes)!==0,Jt||C){if(C=vt,C!==null&&(f=Yc(C,u),f!==0&&f!==q.retryLane))throw q.retryLane=f,co(r,f),ei(C,r,f),Ng;by(N)||pf(),l=Fg(r,l,u)}else by(N)?(l.flags|=192,l.child=r.child,l=null):(r=q.treeContext,wt=Mi(N.nextSibling),En=l,Ke=!0,Qr=null,Pi=!1,r!==null&&H0(l,r),l=Ug(l,f.children),l.flags|=4096);return l}return y?(sa(),N=f.fallback,y=l.mode,q=r.child,J=q.sibling,f=ur(q,{mode:"hidden",children:f.children}),f.subtreeFlags=q.subtreeFlags&65011712,J!==null?N=ur(J,N):(N=uo(N,y,u,null),N.flags|=2),N.return=l,f.return=l,f.sibling=N,l.child=f,ku(null,f),f=l.child,N=r.child.memoizedState,N===null?N=jg(u):(y=N.cachePool,y!==null?(q=Xt._currentValue,y=y.parent!==q?{parent:q,pool:q}:y):y=X0(),N={baseLanes:N.baseLanes|u,cachePool:y}),f.memoizedState=N,f.childLanes=Bg(r,C,u),l.memoizedState=Lg,ku(r.child,f)):(ia(l),u=r.child,r=u.sibling,u=ur(u,{mode:"visible",children:f.children}),u.return=l,u.sibling=null,r!==null&&(C=l.deletions,C===null?(l.deletions=[r],l.flags|=16):C.push(r)),l.child=u,l.memoizedState=null,u)}function Ug(r,l){return l=rf({mode:"visible",children:l},r.mode),l.return=r,r.child=l}function rf(r,l){return r=ci(22,r,null,l),r.lanes=0,r}function Fg(r,l,u){return vo(l,r.child,null,u),r=Ug(l,l.pendingProps.children),r.flags|=2,l.memoizedState=null,r}function cA(r,l,u){r.lanes|=l;var f=r.alternate;f!==null&&(f.lanes|=l),tg(r.return,l,u)}function zg(r,l,u,f,y,b){var C=r.memoizedState;C===null?r.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y,treeForkCount:b}:(C.isBackwards=l,C.rendering=null,C.renderingStartTime=0,C.last=f,C.tail=u,C.tailMode=y,C.treeForkCount=b)}function uA(r,l,u){var f=l.pendingProps,y=f.revealOrder,b=f.tail;f=f.children;var C=Ft.current,N=(C&2)!==0;if(N?(C=C&1|2,l.flags|=128):C&=1,le(Ft,C),Tn(r,l,f,u),f=Ke?mu:0,!N&&r!==null&&(r.flags&128)!==0)e:for(r=l.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&cA(r,u,l);else if(r.tag===19)cA(r,u,l);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===l)break e;for(;r.sibling===null;){if(r.return===null||r.return===l)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(y){case"forwards":for(u=l.child,y=null;u!==null;)r=u.alternate,r!==null&&Gd(r)===null&&(y=u),u=u.sibling;u=y,u===null?(y=l.child,l.child=null):(y=u.sibling,u.sibling=null),zg(l,!1,y,u,b,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=l.child,l.child=null;y!==null;){if(r=y.alternate,r!==null&&Gd(r)===null){l.child=y;break}r=y.sibling,y.sibling=u,u=y,y=r}zg(l,!0,u,null,b,f);break;case"together":zg(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function gr(r,l,u){if(r!==null&&(l.dependencies=r.dependencies),oa|=l.lanes,(u&l.childLanes)===0)if(r!==null){if(bl(r,l,u,!1),(u&l.childLanes)===0)return null}else return null;if(r!==null&&l.child!==r.child)throw Error(n(153));if(l.child!==null){for(r=l.child,u=ur(r,r.pendingProps),l.child=u,u.return=l;r.sibling!==null;)r=r.sibling,u=u.sibling=ur(r,r.pendingProps),u.return=l;u.sibling=null}return l.child}function Vg(r,l){return(r.lanes&l)!==0?!0:(r=r.dependencies,!!(r!==null&&Bd(r)))}function SD(r,l,u){switch(l.tag){case 3:_t(l,l.stateNode.containerInfo),Zr(l,Xt,r.memoizedState.cache),ho();break;case 27:case 5:sr(l);break;case 4:_t(l,l.stateNode.containerInfo);break;case 10:Zr(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,fg(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(ia(l),l.flags|=128,null):(u&l.child.childLanes)!==0?lA(r,l,u):(ia(l),r=gr(r,l,u),r!==null?r.sibling:null);ia(l);break;case 19:var y=(r.flags&128)!==0;if(f=(u&l.childLanes)!==0,f||(bl(r,l,u,!1),f=(u&l.childLanes)!==0),y){if(f)return uA(r,l,u);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),le(Ft,Ft.current),f)break;return null;case 22:return l.lanes=0,nA(r,l,u,l.pendingProps);case 24:Zr(l,Xt,r.memoizedState.cache)}return gr(r,l,u)}function hA(r,l,u){if(r!==null)if(r.memoizedProps!==l.pendingProps)Jt=!0;else{if(!Vg(r,u)&&(l.flags&128)===0)return Jt=!1,SD(r,l,u);Jt=(r.flags&131072)!==0}else Jt=!1,Ke&&(l.flags&1048576)!==0&&q0(l,mu,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(r=go(l.elementType),l.type=r,typeof r=="function")Wm(r)?(f=_o(r,f),l.tag=1,l=aA(null,l,r,f,u)):(l.tag=0,l=Mg(null,l,r,f,u));else{if(r!=null){var y=r.$$typeof;if(y===U){l.tag=11,l=Zw(null,l,r,f,u);break e}else if(y===R){l.tag=14,l=eA(null,l,r,f,u);break e}}throw l=de(r)||r,Error(n(306,l,""))}}return l;case 0:return Mg(r,l,l.type,l.pendingProps,u);case 1:return f=l.type,y=_o(f,l.pendingProps),aA(r,l,f,y,u);case 3:e:{if(_t(l,l.stateNode.containerInfo),r===null)throw Error(n(387));f=l.pendingProps;var b=l.memoizedState;y=b.element,lg(r,l),Eu(l,f,null,u);var C=l.memoizedState;if(f=C.cache,Zr(l,Xt,f),f!==b.cache&&ng(l,[Xt],u,!0),Au(),f=C.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:C.cache},l.updateQueue.baseState=b,l.memoizedState=b,l.flags&256){l=oA(r,l,f,u);break e}else if(f!==y){y=Ii(Error(n(424)),l),gu(y),l=oA(r,l,f,u);break e}else for(r=l.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,wt=Mi(r.firstChild),En=l,Ke=!0,Qr=null,Pi=!0,u=nw(l,null,f,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ho(),f===y){l=gr(r,l,u);break e}Tn(r,l,f,u)}l=l.child}return l;case 26:return sf(r,l),r===null?(u=AE(l.type,null,l.pendingProps,null))?l.memoizedState=u:Ke||(u=l.type,r=l.pendingProps,f=wf(ke.current).createElement(u),f[Wt]=l,f[fn]=r,xn(f,u,r),Kt(f),l.stateNode=f):l.memoizedState=AE(l.type,r.memoizedProps,l.pendingProps,r.memoizedState),null;case 27:return sr(l),r===null&&Ke&&(f=l.stateNode=bE(l.type,l.pendingProps,ke.current),En=l,Pi=!0,y=wt,da(l.type)?(wy=y,wt=Mi(f.firstChild)):wt=y),Tn(r,l,l.pendingProps.children,u),sf(r,l),r===null&&(l.flags|=4194304),l.child;case 5:return r===null&&Ke&&((y=f=wt)&&(f=eO(f,l.type,l.pendingProps,Pi),f!==null?(l.stateNode=f,En=l,wt=Mi(f.firstChild),Pi=!1,y=!0):y=!1),y||Jr(l)),sr(l),y=l.type,b=l.pendingProps,C=r!==null?r.memoizedProps:null,f=b.children,gy(y,b)?f=null:C!==null&&gy(y,C)&&(l.flags|=32),l.memoizedState!==null&&(y=mg(r,l,mD,null,null,u),qu._currentValue=y),sf(r,l),Tn(r,l,f,u),l.child;case 6:return r===null&&Ke&&((r=u=wt)&&(u=tO(u,l.pendingProps,Pi),u!==null?(l.stateNode=u,En=l,wt=null,r=!0):r=!1),r||Jr(l)),null;case 13:return lA(r,l,u);case 4:return _t(l,l.stateNode.containerInfo),f=l.pendingProps,r===null?l.child=vo(l,null,f,u):Tn(r,l,f,u),l.child;case 11:return Zw(r,l,l.type,l.pendingProps,u);case 7:return Tn(r,l,l.pendingProps,u),l.child;case 8:return Tn(r,l,l.pendingProps.children,u),l.child;case 12:return Tn(r,l,l.pendingProps.children,u),l.child;case 10:return f=l.pendingProps,Zr(l,l.type,f.value),Tn(r,l,f.children,u),l.child;case 9:return y=l.type._context,f=l.pendingProps.children,po(l),y=Sn(y),f=f(y),l.flags|=1,Tn(r,l,f,u),l.child;case 14:return eA(r,l,l.type,l.pendingProps,u);case 15:return tA(r,l,l.type,l.pendingProps,u);case 19:return uA(r,l,u);case 31:return ED(r,l,u);case 22:return nA(r,l,u,l.pendingProps);case 24:return po(l),f=Sn(Xt),r===null?(y=rg(),y===null&&(y=vt,b=ig(),y.pooledCache=b,b.refCount++,b!==null&&(y.pooledCacheLanes|=u),y=b),l.memoizedState={parent:f,cache:y},og(l),Zr(l,Xt,y)):((r.lanes&u)!==0&&(lg(r,l),Eu(l,null,null,u),Au()),y=r.memoizedState,b=l.memoizedState,y.parent!==f?(y={parent:f,cache:f},l.memoizedState=y,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=y),Zr(l,Xt,f)):(f=b.cache,Zr(l,Xt,f),f!==y.cache&&ng(l,[Xt],u,!0))),Tn(r,l,l.pendingProps.children,u),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function yr(r){r.flags|=4}function qg(r,l,u,f,y){if((l=(r.mode&32)!==0)&&(l=!1),l){if(r.flags|=16777216,(y&335544128)===y)if(r.stateNode.complete)r.flags|=8192;else if(BA())r.flags|=8192;else throw yo=Vd,ag}else r.flags&=-16777217}function dA(r,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!CE(l))if(BA())r.flags|=8192;else throw yo=Vd,ag}function af(r,l){l!==null&&(r.flags|=4),r.flags&16384&&(l=r.tag!==22?hd():536870912,r.lanes|=l,Dl|=l)}function Ru(r,l){if(!Ke)switch(r.tailMode){case"hidden":l=r.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function At(r){var l=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(l)for(var y=r.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=f,r.childLanes=u,l}function TD(r,l,u){var f=l.pendingProps;switch(Qm(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(l),null;case 1:return At(l),null;case 3:return u=l.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),fr(Xt),ct(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(vl(l)?yr(l):r===null||r.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Zm())),At(l),null;case 26:var y=l.type,b=l.memoizedState;return r===null?(yr(l),b!==null?(At(l),dA(l,b)):(At(l),qg(l,y,null,f,u))):b?b!==r.memoizedState?(yr(l),At(l),dA(l,b)):(At(l),l.flags&=-16777217):(r=r.memoizedProps,r!==f&&yr(l),At(l),qg(l,y,r,f,u)),null;case 27:if(ms(l),u=ke.current,y=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==f&&yr(l);else{if(!f){if(l.stateNode===null)throw Error(n(166));return At(l),null}r=he.current,vl(l)?$0(l):(r=bE(y,f,u),l.stateNode=r,yr(l))}return At(l),null;case 5:if(ms(l),y=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==f&&yr(l);else{if(!f){if(l.stateNode===null)throw Error(n(166));return At(l),null}if(b=he.current,vl(l))$0(l);else{var C=wf(ke.current);switch(b){case 1:b=C.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:b=C.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":b=C.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":b=C.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":b=C.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof f.is=="string"?C.createElement("select",{is:f.is}):C.createElement("select"),f.multiple?b.multiple=!0:f.size&&(b.size=f.size);break;default:b=typeof f.is=="string"?C.createElement(y,{is:f.is}):C.createElement(y)}}b[Wt]=l,b[fn]=f;e:for(C=l.child;C!==null;){if(C.tag===5||C.tag===6)b.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===l)break e;for(;C.sibling===null;){if(C.return===null||C.return===l)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}l.stateNode=b;e:switch(xn(b,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&yr(l)}}return At(l),qg(l,l.type,r===null?null:r.memoizedProps,l.pendingProps,u),null;case 6:if(r&&l.stateNode!=null)r.memoizedProps!==f&&yr(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(n(166));if(r=ke.current,vl(l)){if(r=l.stateNode,u=l.memoizedProps,f=null,y=En,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}r[Wt]=l,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||lE(r.nodeValue,u)),r||Jr(l,!0)}else r=wf(r).createTextNode(f),r[Wt]=l,l.stateNode=r}return At(l),null;case 31:if(u=l.memoizedState,r===null||r.memoizedState!==null){if(f=vl(l),u!==null){if(r===null){if(!f)throw Error(n(318));if(r=l.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Wt]=l}else ho(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;At(l),r=!1}else u=Zm(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return l.flags&256?(hi(l),l):(hi(l),null);if((l.flags&128)!==0)throw Error(n(558))}return At(l),null;case 13:if(f=l.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=vl(l),f!==null&&f.dehydrated!==null){if(r===null){if(!y)throw Error(n(318));if(y=l.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Wt]=l}else ho(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;At(l),y=!1}else y=Zm(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return l.flags&256?(hi(l),l):(hi(l),null)}return hi(l),(l.flags&128)!==0?(l.lanes=u,l):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=l.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),b=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==y&&(f.flags|=2048)),u!==r&&u&&(l.child.flags|=8192),af(l,l.updateQueue),At(l),null);case 4:return ct(),r===null&&hy(l.stateNode.containerInfo),At(l),null;case 10:return fr(l.type),At(l),null;case 19:if(ee(Ft),f=l.memoizedState,f===null)return At(l),null;if(y=(l.flags&128)!==0,b=f.rendering,b===null)if(y)Ru(f,!1);else{if(Mt!==0||r!==null&&(r.flags&128)!==0)for(r=l.child;r!==null;){if(b=Gd(r),b!==null){for(l.flags|=128,Ru(f,!1),r=b.updateQueue,l.updateQueue=r,af(l,r),l.subtreeFlags=0,r=u,u=l.child;u!==null;)F0(u,r),u=u.sibling;return le(Ft,Ft.current&1|2),Ke&&hr(l,f.treeForkCount),l.child}r=r.sibling}f.tail!==null&&Vn()>hf&&(l.flags|=128,y=!0,Ru(f,!1),l.lanes=4194304)}else{if(!y)if(r=Gd(b),r!==null){if(l.flags|=128,y=!0,r=r.updateQueue,l.updateQueue=r,af(l,r),Ru(f,!0),f.tail===null&&f.tailMode==="hidden"&&!b.alternate&&!Ke)return At(l),null}else 2*Vn()-f.renderingStartTime>hf&&u!==536870912&&(l.flags|=128,y=!0,Ru(f,!1),l.lanes=4194304);f.isBackwards?(b.sibling=l.child,l.child=b):(r=f.last,r!==null?r.sibling=b:l.child=b,f.last=b)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=Vn(),r.sibling=null,u=Ft.current,le(Ft,y?u&1|2:u&1),Ke&&hr(l,f.treeForkCount),r):(At(l),null);case 22:case 23:return hi(l),dg(),f=l.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(u&536870912)!==0&&(l.flags&128)===0&&(At(l),l.subtreeFlags&6&&(l.flags|=8192)):At(l),u=l.updateQueue,u!==null&&af(l,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==u&&(l.flags|=2048),r!==null&&ee(mo),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),l.memoizedState.cache!==u&&(l.flags|=2048),fr(Xt),At(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function xD(r,l){switch(Qm(l),l.tag){case 1:return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 3:return fr(Xt),ct(),r=l.flags,(r&65536)!==0&&(r&128)===0?(l.flags=r&-65537|128,l):null;case 26:case 27:case 5:return ms(l),null;case 31:if(l.memoizedState!==null){if(hi(l),l.alternate===null)throw Error(n(340));ho()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 13:if(hi(l),r=l.memoizedState,r!==null&&r.dehydrated!==null){if(l.alternate===null)throw Error(n(340));ho()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 19:return ee(Ft),null;case 4:return ct(),null;case 10:return fr(l.type),null;case 22:case 23:return hi(l),dg(),r!==null&&ee(mo),r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 24:return fr(Xt),null;case 25:return null;default:return null}}function fA(r,l){switch(Qm(l),l.tag){case 3:fr(Xt),ct();break;case 26:case 27:case 5:ms(l);break;case 4:ct();break;case 31:l.memoizedState!==null&&hi(l);break;case 13:hi(l);break;case 19:ee(Ft);break;case 10:fr(l.type);break;case 22:case 23:hi(l),dg(),r!==null&&ee(mo);break;case 24:fr(Xt)}}function Iu(r,l){try{var u=l.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var y=f.next;u=y;do{if((u.tag&r)===r){f=void 0;var b=u.create,C=u.inst;f=b(),C.destroy=f}u=u.next}while(u!==y)}}catch(N){dt(l,l.return,N)}}function ra(r,l,u){try{var f=l.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var b=y.next;f=b;do{if((f.tag&r)===r){var C=f.inst,N=C.destroy;if(N!==void 0){C.destroy=void 0,y=l;var q=u,J=N;try{J()}catch(ie){dt(y,q,ie)}}}f=f.next}while(f!==b)}}catch(ie){dt(l,l.return,ie)}}function pA(r){var l=r.updateQueue;if(l!==null){var u=r.stateNode;try{sw(l,u)}catch(f){dt(r,r.return,f)}}}function mA(r,l,u){u.props=_o(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){dt(r,l,f)}}function Du(r,l){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(y){dt(r,l,y)}}function Ls(r,l){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(y){dt(r,l,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){dt(r,l,y)}else u.current=null}function gA(r){var l=r.type,u=r.memoizedProps,f=r.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(y){dt(r,r.return,y)}}function Hg(r,l,u){try{var f=r.stateNode;KD(f,r.type,u,l),f[fn]=l}catch(y){dt(r,r.return,y)}}function yA(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&da(r.type)||r.tag===4}function $g(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||yA(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&da(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Gg(r,l,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,l?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,l):(l=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,l.appendChild(r),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=Qi));else if(f!==4&&(f===27&&da(r.type)&&(u=r.stateNode,l=null),r=r.child,r!==null))for(Gg(r,l,u),r=r.sibling;r!==null;)Gg(r,l,u),r=r.sibling}function of(r,l,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,l?u.insertBefore(r,l):u.appendChild(r);else if(f!==4&&(f===27&&da(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(of(r,l,u),r=r.sibling;r!==null;)of(r,l,u),r=r.sibling}function vA(r){var l=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,y=l.attributes;y.length;)l.removeAttributeNode(y[0]);xn(l,f,u),l[Wt]=r,l[fn]=u}catch(b){dt(r,r.return,b)}}var vr=!1,Zt=!1,Wg=!1,bA=typeof WeakSet=="function"?WeakSet:Set,mn=null;function CD(r,l){if(r=r.containerInfo,py=kf,r=D0(r),Fm(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var C=0,N=-1,q=-1,J=0,ie=0,re=r,Z=null;t:for(;;){for(var ne;re!==u||y!==0&&re.nodeType!==3||(N=C+y),re!==b||f!==0&&re.nodeType!==3||(q=C+f),re.nodeType===3&&(C+=re.nodeValue.length),(ne=re.firstChild)!==null;)Z=re,re=ne;for(;;){if(re===r)break t;if(Z===u&&++J===y&&(N=C),Z===b&&++ie===f&&(q=C),(ne=re.nextSibling)!==null)break;re=Z,Z=re.parentNode}re=ne}u=N===-1||q===-1?null:{start:N,end:q}}else u=null}u=u||{start:0,end:0}}else u=null;for(my={focusedElem:r,selectionRange:u},kf=!1,mn=l;mn!==null;)if(l=mn,r=l.child,(l.subtreeFlags&1028)!==0&&r!==null)r.return=l,mn=r;else for(;mn!==null;){switch(l=mn,b=l.alternate,r=l.flags,l.tag){case 0:if((r&4)!==0&&(r=l.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)y=r[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&b!==null){r=void 0,u=l,y=b.memoizedProps,b=b.memoizedState,f=u.stateNode;try{var ye=_o(u.type,y);r=f.getSnapshotBeforeUpdate(ye,b),f.__reactInternalSnapshotBeforeUpdate=r}catch(Te){dt(u,u.return,Te)}}break;case 3:if((r&1024)!==0){if(r=l.stateNode.containerInfo,u=r.nodeType,u===9)vy(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":vy(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=l.sibling,r!==null){r.return=l.return,mn=r;break}mn=l.return}}function _A(r,l,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:_r(r,u),f&4&&Iu(5,u);break;case 1:if(_r(r,u),f&4)if(r=u.stateNode,l===null)try{r.componentDidMount()}catch(C){dt(u,u.return,C)}else{var y=_o(u.type,l.memoizedProps);l=l.memoizedState;try{r.componentDidUpdate(y,l,r.__reactInternalSnapshotBeforeUpdate)}catch(C){dt(u,u.return,C)}}f&64&&pA(u),f&512&&Du(u,u.return);break;case 3:if(_r(r,u),f&64&&(r=u.updateQueue,r!==null)){if(l=null,u.child!==null)switch(u.child.tag){case 27:case 5:l=u.child.stateNode;break;case 1:l=u.child.stateNode}try{sw(r,l)}catch(C){dt(u,u.return,C)}}break;case 27:l===null&&f&4&&vA(u);case 26:case 5:_r(r,u),l===null&&f&4&&gA(u),f&512&&Du(u,u.return);break;case 12:_r(r,u);break;case 31:_r(r,u),f&4&&EA(r,u);break;case 13:_r(r,u),f&4&&SA(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=LD.bind(null,u),nO(r,u))));break;case 22:if(f=u.memoizedState!==null||vr,!f){l=l!==null&&l.memoizedState!==null||Zt,y=vr;var b=Zt;vr=f,(Zt=l)&&!b?wr(r,u,(u.subtreeFlags&8772)!==0):_r(r,u),vr=y,Zt=b}break;case 30:break;default:_r(r,u)}}function wA(r){var l=r.alternate;l!==null&&(r.alternate=null,wA(l)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(l=r.stateNode,l!==null&&tl(l)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var St=null,Xn=!1;function br(r,l,u){for(u=u.child;u!==null;)AA(r,l,u),u=u.sibling}function AA(r,l,u){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount(Wi,u)}catch{}switch(u.tag){case 26:Zt||Ls(u,l),br(r,l,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Zt||Ls(u,l);var f=St,y=Xn;da(u.type)&&(St=u.stateNode,Xn=!1),br(r,l,u),Fu(u.stateNode),St=f,Xn=y;break;case 5:Zt||Ls(u,l);case 6:if(f=St,y=Xn,St=null,br(r,l,u),St=f,Xn=y,St!==null)if(Xn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(u.stateNode)}catch(b){dt(u,l,b)}else try{St.removeChild(u.stateNode)}catch(b){dt(u,l,b)}break;case 18:St!==null&&(Xn?(r=St,pE(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Ul(r)):pE(St,u.stateNode));break;case 4:f=St,y=Xn,St=u.stateNode.containerInfo,Xn=!0,br(r,l,u),St=f,Xn=y;break;case 0:case 11:case 14:case 15:ra(2,u,l),Zt||ra(4,u,l),br(r,l,u);break;case 1:Zt||(Ls(u,l),f=u.stateNode,typeof f.componentWillUnmount=="function"&&mA(u,l,f)),br(r,l,u);break;case 21:br(r,l,u);break;case 22:Zt=(f=Zt)||u.memoizedState!==null,br(r,l,u),Zt=f;break;default:br(r,l,u)}}function EA(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ul(r)}catch(u){dt(l,l.return,u)}}}function SA(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ul(r)}catch(u){dt(l,l.return,u)}}function kD(r){switch(r.tag){case 31:case 13:case 19:var l=r.stateNode;return l===null&&(l=r.stateNode=new bA),l;case 22:return r=r.stateNode,l=r._retryCache,l===null&&(l=r._retryCache=new bA),l;default:throw Error(n(435,r.tag))}}function lf(r,l){var u=kD(r);l.forEach(function(f){if(!u.has(f)){u.add(f);var y=jD.bind(null,r,f);f.then(y,y)}})}function Qn(r,l){var u=l.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f],b=r,C=l,N=C;e:for(;N!==null;){switch(N.tag){case 27:if(da(N.type)){St=N.stateNode,Xn=!1;break e}break;case 5:St=N.stateNode,Xn=!1;break e;case 3:case 4:St=N.stateNode.containerInfo,Xn=!0;break e}N=N.return}if(St===null)throw Error(n(160));AA(b,C,y),St=null,Xn=!1,b=y.alternate,b!==null&&(b.return=null),y.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)TA(l,r),l=l.sibling}var is=null;function TA(r,l){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Qn(l,r),Jn(r),f&4&&(ra(3,r,r.return),Iu(3,r),ra(5,r,r.return));break;case 1:Qn(l,r),Jn(r),f&512&&(Zt||u===null||Ls(u,u.return)),f&64&&vr&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var y=is;if(Qn(l,r),Jn(r),f&512&&(Zt||u===null||Ls(u,u.return)),f&4){var b=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){e:{f=r.type,u=r.memoizedProps,y=y.ownerDocument||y;t:switch(f){case"title":b=y.getElementsByTagName("title")[0],(!b||b[As]||b[Wt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=y.createElement(f),y.head.insertBefore(b,y.querySelector("head > title"))),xn(b,f,u),b[Wt]=r,Kt(b),f=b;break e;case"link":var C=TE("link","href",y).get(f+(u.href||""));if(C){for(var N=0;N<C.length;N++)if(b=C[N],b.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&b.getAttribute("rel")===(u.rel==null?null:u.rel)&&b.getAttribute("title")===(u.title==null?null:u.title)&&b.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){C.splice(N,1);break t}}b=y.createElement(f),xn(b,f,u),y.head.appendChild(b);break;case"meta":if(C=TE("meta","content",y).get(f+(u.content||""))){for(N=0;N<C.length;N++)if(b=C[N],b.getAttribute("content")===(u.content==null?null:""+u.content)&&b.getAttribute("name")===(u.name==null?null:u.name)&&b.getAttribute("property")===(u.property==null?null:u.property)&&b.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&b.getAttribute("charset")===(u.charSet==null?null:u.charSet)){C.splice(N,1);break t}}b=y.createElement(f),xn(b,f,u),y.head.appendChild(b);break;default:throw Error(n(468,f))}b[Wt]=r,Kt(b),f=b}r.stateNode=f}else xE(y,r.type,r.stateNode);else r.stateNode=SE(y,f,r.memoizedProps);else b!==f?(b===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):b.count--,f===null?xE(y,r.type,r.stateNode):SE(y,f,r.memoizedProps)):f===null&&r.stateNode!==null&&Hg(r,r.memoizedProps,u.memoizedProps)}break;case 27:Qn(l,r),Jn(r),f&512&&(Zt||u===null||Ls(u,u.return)),u!==null&&f&4&&Hg(r,r.memoizedProps,u.memoizedProps);break;case 5:if(Qn(l,r),Jn(r),f&512&&(Zt||u===null||Ls(u,u.return)),r.flags&32){y=r.stateNode;try{Yn(y,"")}catch(ye){dt(r,r.return,ye)}}f&4&&r.stateNode!=null&&(y=r.memoizedProps,Hg(r,y,u!==null?u.memoizedProps:y)),f&1024&&(Wg=!0);break;case 6:if(Qn(l,r),Jn(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(ye){dt(r,r.return,ye)}}break;case 3:if(Sf=null,y=is,is=Af(l.containerInfo),Qn(l,r),is=y,Jn(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Ul(l.containerInfo)}catch(ye){dt(r,r.return,ye)}Wg&&(Wg=!1,xA(r));break;case 4:f=is,is=Af(r.stateNode.containerInfo),Qn(l,r),Jn(r),is=f;break;case 12:Qn(l,r),Jn(r);break;case 31:Qn(l,r),Jn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,lf(r,f)));break;case 13:Qn(l,r),Jn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(uf=Vn()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,lf(r,f)));break;case 22:y=r.memoizedState!==null;var q=u!==null&&u.memoizedState!==null,J=vr,ie=Zt;if(vr=J||y,Zt=ie||q,Qn(l,r),Zt=ie,vr=J,Jn(r),f&8192)e:for(l=r.stateNode,l._visibility=y?l._visibility&-2:l._visibility|1,y&&(u===null||q||vr||Zt||wo(r)),u=null,l=r;;){if(l.tag===5||l.tag===26){if(u===null){q=u=l;try{if(b=q.stateNode,y)C=b.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{N=q.stateNode;var re=q.memoizedProps.style,Z=re!=null&&re.hasOwnProperty("display")?re.display:null;N.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(ye){dt(q,q.return,ye)}}}else if(l.tag===6){if(u===null){q=l;try{q.stateNode.nodeValue=y?"":q.memoizedProps}catch(ye){dt(q,q.return,ye)}}}else if(l.tag===18){if(u===null){q=l;try{var ne=q.stateNode;y?mE(ne,!0):mE(q.stateNode,!1)}catch(ye){dt(q,q.return,ye)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===r)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break e;for(;l.sibling===null;){if(l.return===null||l.return===r)break e;u===l&&(u=null),l=l.return}u===l&&(u=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,lf(r,u))));break;case 19:Qn(l,r),Jn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,lf(r,f)));break;case 30:break;case 21:break;default:Qn(l,r),Jn(r)}}function Jn(r){var l=r.flags;if(l&2){try{for(var u,f=r.return;f!==null;){if(yA(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var y=u.stateNode,b=$g(r);of(r,b,y);break;case 5:var C=u.stateNode;u.flags&32&&(Yn(C,""),u.flags&=-33);var N=$g(r);of(r,N,C);break;case 3:case 4:var q=u.stateNode.containerInfo,J=$g(r);Gg(r,J,q);break;default:throw Error(n(161))}}catch(ie){dt(r,r.return,ie)}r.flags&=-3}l&4096&&(r.flags&=-4097)}function xA(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var l=r;xA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),r=r.sibling}}function _r(r,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)_A(r,l.alternate,l),l=l.sibling}function wo(r){for(r=r.child;r!==null;){var l=r;switch(l.tag){case 0:case 11:case 14:case 15:ra(4,l,l.return),wo(l);break;case 1:Ls(l,l.return);var u=l.stateNode;typeof u.componentWillUnmount=="function"&&mA(l,l.return,u),wo(l);break;case 27:Fu(l.stateNode);case 26:case 5:Ls(l,l.return),wo(l);break;case 22:l.memoizedState===null&&wo(l);break;case 30:wo(l);break;default:wo(l)}r=r.sibling}}function wr(r,l,u){for(u=u&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,y=r,b=l,C=b.flags;switch(b.tag){case 0:case 11:case 15:wr(y,b,u),Iu(4,b);break;case 1:if(wr(y,b,u),f=b,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(J){dt(f,f.return,J)}if(f=b,y=f.updateQueue,y!==null){var N=f.stateNode;try{var q=y.shared.hiddenCallbacks;if(q!==null)for(y.shared.hiddenCallbacks=null,y=0;y<q.length;y++)iw(q[y],N)}catch(J){dt(f,f.return,J)}}u&&C&64&&pA(b),Du(b,b.return);break;case 27:vA(b);case 26:case 5:wr(y,b,u),u&&f===null&&C&4&&gA(b),Du(b,b.return);break;case 12:wr(y,b,u);break;case 31:wr(y,b,u),u&&C&4&&EA(y,b);break;case 13:wr(y,b,u),u&&C&4&&SA(y,b);break;case 22:b.memoizedState===null&&wr(y,b,u),Du(b,b.return);break;case 30:break;default:wr(y,b,u)}l=l.sibling}}function Kg(r,l){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&yu(u))}function Yg(r,l){r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&yu(r))}function ss(r,l,u,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)CA(r,l,u,f),l=l.sibling}function CA(r,l,u,f){var y=l.flags;switch(l.tag){case 0:case 11:case 15:ss(r,l,u,f),y&2048&&Iu(9,l);break;case 1:ss(r,l,u,f);break;case 3:ss(r,l,u,f),y&2048&&(r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&yu(r)));break;case 12:if(y&2048){ss(r,l,u,f),r=l.stateNode;try{var b=l.memoizedProps,C=b.id,N=b.onPostCommit;typeof N=="function"&&N(C,l.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(q){dt(l,l.return,q)}}else ss(r,l,u,f);break;case 31:ss(r,l,u,f);break;case 13:ss(r,l,u,f);break;case 23:break;case 22:b=l.stateNode,C=l.alternate,l.memoizedState!==null?b._visibility&2?ss(r,l,u,f):Ou(r,l):b._visibility&2?ss(r,l,u,f):(b._visibility|=2,kl(r,l,u,f,(l.subtreeFlags&10256)!==0||!1)),y&2048&&Kg(C,l);break;case 24:ss(r,l,u,f),y&2048&&Yg(l.alternate,l);break;default:ss(r,l,u,f)}}function kl(r,l,u,f,y){for(y=y&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var b=r,C=l,N=u,q=f,J=C.flags;switch(C.tag){case 0:case 11:case 15:kl(b,C,N,q,y),Iu(8,C);break;case 23:break;case 22:var ie=C.stateNode;C.memoizedState!==null?ie._visibility&2?kl(b,C,N,q,y):Ou(b,C):(ie._visibility|=2,kl(b,C,N,q,y)),y&&J&2048&&Kg(C.alternate,C);break;case 24:kl(b,C,N,q,y),y&&J&2048&&Yg(C.alternate,C);break;default:kl(b,C,N,q,y)}l=l.sibling}}function Ou(r,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var u=r,f=l,y=f.flags;switch(f.tag){case 22:Ou(u,f),y&2048&&Kg(f.alternate,f);break;case 24:Ou(u,f),y&2048&&Yg(f.alternate,f);break;default:Ou(u,f)}l=l.sibling}}var Pu=8192;function Rl(r,l,u){if(r.subtreeFlags&Pu)for(r=r.child;r!==null;)kA(r,l,u),r=r.sibling}function kA(r,l,u){switch(r.tag){case 26:Rl(r,l,u),r.flags&Pu&&r.memoizedState!==null&&pO(u,is,r.memoizedState,r.memoizedProps);break;case 5:Rl(r,l,u);break;case 3:case 4:var f=is;is=Af(r.stateNode.containerInfo),Rl(r,l,u),is=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=Pu,Pu=16777216,Rl(r,l,u),Pu=f):Rl(r,l,u));break;default:Rl(r,l,u)}}function RA(r){var l=r.alternate;if(l!==null&&(r=l.child,r!==null)){l.child=null;do l=r.sibling,r.sibling=null,r=l;while(r!==null)}}function Nu(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var f=l[u];mn=f,DA(f,r)}RA(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)IA(r),r=r.sibling}function IA(r){switch(r.tag){case 0:case 11:case 15:Nu(r),r.flags&2048&&ra(9,r,r.return);break;case 3:Nu(r);break;case 12:Nu(r);break;case 22:var l=r.stateNode;r.memoizedState!==null&&l._visibility&2&&(r.return===null||r.return.tag!==13)?(l._visibility&=-3,cf(r)):Nu(r);break;default:Nu(r)}}function cf(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var f=l[u];mn=f,DA(f,r)}RA(r)}for(r=r.child;r!==null;){switch(l=r,l.tag){case 0:case 11:case 15:ra(8,l,l.return),cf(l);break;case 22:u=l.stateNode,u._visibility&2&&(u._visibility&=-3,cf(l));break;default:cf(l)}r=r.sibling}}function DA(r,l){for(;mn!==null;){var u=mn;switch(u.tag){case 0:case 11:case 15:ra(8,u,l);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:yu(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,mn=f;else e:for(u=r;mn!==null;){f=mn;var y=f.sibling,b=f.return;if(wA(f),f===u){mn=null;break e}if(y!==null){y.return=b,mn=y;break e}mn=b}}}var RD={getCacheForType:function(r){var l=Sn(Xt),u=l.data.get(r);return u===void 0&&(u=r(),l.data.set(r,u)),u},cacheSignal:function(){return Sn(Xt).controller.signal}},ID=typeof WeakMap=="function"?WeakMap:Map,it=0,vt=null,qe=null,$e=0,ht=0,di=null,aa=!1,Il=!1,Xg=!1,Ar=0,Mt=0,oa=0,Ao=0,Qg=0,fi=0,Dl=0,Mu=null,Zn=null,Jg=!1,uf=0,OA=0,hf=1/0,df=null,la=null,ln=0,ca=null,Ol=null,Er=0,Zg=0,ey=null,PA=null,Lu=0,ty=null;function pi(){return(it&2)!==0&&$e!==0?$e&-$e:G.T!==null?oy():dd()}function NA(){if(fi===0)if(($e&536870912)===0||Ke){var r=Ka;Ka<<=1,(Ka&3932160)===0&&(Ka=262144),fi=r}else fi=536870912;return r=ui.current,r!==null&&(r.flags|=32),fi}function ei(r,l,u){(r===vt&&(ht===2||ht===9)||r.cancelPendingCommit!==null)&&(Pl(r,0),ua(r,$e,fi,!1)),Ya(r,u),((it&2)===0||r!==vt)&&(r===vt&&((it&2)===0&&(Ao|=u),Mt===4&&ua(r,$e,fi,!1)),js(r))}function MA(r,l,u){if((it&6)!==0)throw Error(n(327));var f=!u&&(l&127)===0&&(l&r.expiredLanes)===0||Ki(r,l),y=f?PD(r,l):iy(r,l,!0),b=f;do{if(y===0){Il&&!f&&ua(r,l,0,!1);break}else{if(u=r.current.alternate,b&&!DD(u)){y=iy(r,l,!1),b=!1;continue}if(y===2){if(b=l,r.errorRecoveryDisabledLanes&b)var C=0;else C=r.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){l=C;e:{var N=r;y=Mu;var q=N.current.memoizedState.isDehydrated;if(q&&(Pl(N,C).flags|=256),C=iy(N,C,!1),C!==2){if(Xg&&!q){N.errorRecoveryDisabledLanes|=b,Ao|=b,y=4;break e}b=Zn,Zn=y,b!==null&&(Zn===null?Zn=b:Zn.push.apply(Zn,b))}y=C}if(b=!1,y!==2)continue}}if(y===1){Pl(r,0),ua(r,l,0,!0);break}e:{switch(f=r,b=y,b){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:ua(f,l,fi,!aa);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(y=uf+300-Vn(),10<y)){if(ua(f,l,fi,!aa),bs(f,0,!0)!==0)break e;Er=l,f.timeoutHandle=dE(LA.bind(null,f,u,Zn,df,Jg,l,fi,Ao,Dl,aa,b,"Throttled",-0,0),y);break e}LA(f,u,Zn,df,Jg,l,fi,Ao,Dl,aa,b,null,-0,0)}}break}while(!0);js(r)}function LA(r,l,u,f,y,b,C,N,q,J,ie,re,Z,ne){if(r.timeoutHandle=-1,re=l.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qi},kA(l,b,re);var ye=(b&62914560)===b?uf-Vn():(b&4194048)===b?OA-Vn():0;if(ye=mO(re,ye),ye!==null){Er=b,r.cancelPendingCommit=ye(HA.bind(null,r,l,b,u,f,y,C,N,q,ie,re,null,Z,ne)),ua(r,b,C,!J);return}}HA(r,l,b,u,f,y,C,N,q)}function DD(r){for(var l=r;;){var u=l.tag;if((u===0||u===11||u===15)&&l.flags&16384&&(u=l.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var y=u[f],b=y.getSnapshot;y=y.value;try{if(!li(b(),y))return!1}catch{return!1}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ua(r,l,u,f){l&=~Qg,l&=~Ao,r.suspendedLanes|=l,r.pingedLanes&=~l,f&&(r.warmLanes|=l),f=r.expirationTimes;for(var y=l;0<y;){var b=31-Bt(y),C=1<<b;f[b]=-1,y&=~C}u!==0&&Xa(r,u,l)}function ff(){return(it&6)===0?(ju(0),!1):!0}function ny(){if(qe!==null){if(ht===0)var r=qe.return;else r=qe,dr=fo=null,vg(r),El=null,bu=0,r=qe;for(;r!==null;)fA(r.alternate,r),r=r.return;qe=null}}function Pl(r,l){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,QD(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Er=0,ny(),vt=r,qe=u=ur(r.current,null),$e=l,ht=0,di=null,aa=!1,Il=Ki(r,l),Xg=!1,Dl=fi=Qg=Ao=oa=Mt=0,Zn=Mu=null,Jg=!1,(l&8)!==0&&(l|=l&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=l;0<f;){var y=31-Bt(f),b=1<<y;l|=r[y],f&=~b}return Ar=l,Pd(),u}function jA(r,l){ze=null,G.H=Cu,l===Al||l===zd?(l=Z0(),ht=3):l===ag?(l=Z0(),ht=4):ht=l===Ng?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,di=l,qe===null&&(Mt=1,tf(r,Ii(l,r.current)))}function BA(){var r=ui.current;return r===null?!0:($e&4194048)===$e?Ni===null:($e&62914560)===$e||($e&536870912)!==0?r===Ni:!1}function UA(){var r=G.H;return G.H=Cu,r===null?Cu:r}function FA(){var r=G.A;return G.A=RD,r}function pf(){Mt=4,aa||($e&4194048)!==$e&&ui.current!==null||(Il=!0),(oa&134217727)===0&&(Ao&134217727)===0||vt===null||ua(vt,$e,fi,!1)}function iy(r,l,u){var f=it;it|=2;var y=UA(),b=FA();(vt!==r||$e!==l)&&(df=null,Pl(r,l)),l=!1;var C=Mt;e:do try{if(ht!==0&&qe!==null){var N=qe,q=di;switch(ht){case 8:ny(),C=6;break e;case 3:case 2:case 9:case 6:ui.current===null&&(l=!0);var J=ht;if(ht=0,di=null,Nl(r,N,q,J),u&&Il){C=0;break e}break;default:J=ht,ht=0,di=null,Nl(r,N,q,J)}}OD(),C=Mt;break}catch(ie){jA(r,ie)}while(!0);return l&&r.shellSuspendCounter++,dr=fo=null,it=f,G.H=y,G.A=b,qe===null&&(vt=null,$e=0,Pd()),C}function OD(){for(;qe!==null;)zA(qe)}function PD(r,l){var u=it;it|=2;var f=UA(),y=FA();vt!==r||$e!==l?(df=null,hf=Vn()+500,Pl(r,l)):Il=Ki(r,l);e:do try{if(ht!==0&&qe!==null){l=qe;var b=di;t:switch(ht){case 1:ht=0,di=null,Nl(r,l,b,1);break;case 2:case 9:if(Q0(b)){ht=0,di=null,VA(l);break}l=function(){ht!==2&&ht!==9||vt!==r||(ht=7),js(r)},b.then(l,l);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:Q0(b)?(ht=0,di=null,VA(l)):(ht=0,di=null,Nl(r,l,b,7));break;case 5:var C=null;switch(qe.tag){case 26:C=qe.memoizedState;case 5:case 27:var N=qe;if(C?CE(C):N.stateNode.complete){ht=0,di=null;var q=N.sibling;if(q!==null)qe=q;else{var J=N.return;J!==null?(qe=J,mf(J)):qe=null}break t}}ht=0,di=null,Nl(r,l,b,5);break;case 6:ht=0,di=null,Nl(r,l,b,6);break;case 8:ny(),Mt=6;break e;default:throw Error(n(462))}}ND();break}catch(ie){jA(r,ie)}while(!0);return dr=fo=null,G.H=f,G.A=y,it=u,qe!==null?0:(vt=null,$e=0,Pd(),Mt)}function ND(){for(;qe!==null&&!Pm();)zA(qe)}function zA(r){var l=hA(r.alternate,r,Ar);r.memoizedProps=r.pendingProps,l===null?mf(r):qe=l}function VA(r){var l=r,u=l.alternate;switch(l.tag){case 15:case 0:l=rA(u,l,l.pendingProps,l.type,void 0,$e);break;case 11:l=rA(u,l,l.pendingProps,l.type.render,l.ref,$e);break;case 5:vg(l);default:fA(u,l),l=qe=F0(l,Ar),l=hA(u,l,Ar)}r.memoizedProps=r.pendingProps,l===null?mf(r):qe=l}function Nl(r,l,u,f){dr=fo=null,vg(l),El=null,bu=0;var y=l.return;try{if(AD(r,y,l,u,$e)){Mt=1,tf(r,Ii(u,r.current)),qe=null;return}}catch(b){if(y!==null)throw qe=y,b;Mt=1,tf(r,Ii(u,r.current)),qe=null;return}l.flags&32768?(Ke||f===1?r=!0:Il||($e&536870912)!==0?r=!1:(aa=r=!0,(f===2||f===9||f===3||f===6)&&(f=ui.current,f!==null&&f.tag===13&&(f.flags|=16384))),qA(l,r)):mf(l)}function mf(r){var l=r;do{if((l.flags&32768)!==0){qA(l,aa);return}r=l.return;var u=TD(l.alternate,l,Ar);if(u!==null){qe=u;return}if(l=l.sibling,l!==null){qe=l;return}qe=l=r}while(l!==null);Mt===0&&(Mt=5)}function qA(r,l){do{var u=xD(r.alternate,r);if(u!==null){u.flags&=32767,qe=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!l&&(r=r.sibling,r!==null)){qe=r;return}qe=r=u}while(r!==null);Mt=6,qe=null}function HA(r,l,u,f,y,b,C,N,q){r.cancelPendingCommit=null;do gf();while(ln!==0);if((it&6)!==0)throw Error(n(327));if(l!==null){if(l===r.current)throw Error(n(177));if(b=l.lanes|l.childLanes,b|=$m,Lm(r,u,b,C,N,q),r===vt&&(qe=vt=null,$e=0),Ol=l,ca=r,Er=u,Zg=b,ey=y,PA=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,BD(Fr,function(){return YA(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=G.T,G.T=null,y=W.p,W.p=2,C=it,it|=4;try{CD(r,l,u)}finally{it=C,W.p=y,G.T=f}}ln=1,$A(),GA(),WA()}}function $A(){if(ln===1){ln=0;var r=ca,l=Ol,u=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||u){u=G.T,G.T=null;var f=W.p;W.p=2;var y=it;it|=4;try{TA(l,r);var b=my,C=D0(r.containerInfo),N=b.focusedElem,q=b.selectionRange;if(C!==N&&N&&N.ownerDocument&&I0(N.ownerDocument.documentElement,N)){if(q!==null&&Fm(N)){var J=q.start,ie=q.end;if(ie===void 0&&(ie=J),"selectionStart"in N)N.selectionStart=J,N.selectionEnd=Math.min(ie,N.value.length);else{var re=N.ownerDocument||document,Z=re&&re.defaultView||window;if(Z.getSelection){var ne=Z.getSelection(),ye=N.textContent.length,Te=Math.min(q.start,ye),gt=q.end===void 0?Te:Math.min(q.end,ye);!ne.extend&&Te>gt&&(C=gt,gt=Te,Te=C);var K=R0(N,Te),$=R0(N,gt);if(K&&$&&(ne.rangeCount!==1||ne.anchorNode!==K.node||ne.anchorOffset!==K.offset||ne.focusNode!==$.node||ne.focusOffset!==$.offset)){var Q=re.createRange();Q.setStart(K.node,K.offset),ne.removeAllRanges(),Te>gt?(ne.addRange(Q),ne.extend($.node,$.offset)):(Q.setEnd($.node,$.offset),ne.addRange(Q))}}}}for(re=[],ne=N;ne=ne.parentNode;)ne.nodeType===1&&re.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<re.length;N++){var se=re[N];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}kf=!!py,my=py=null}finally{it=y,W.p=f,G.T=u}}r.current=l,ln=2}}function GA(){if(ln===2){ln=0;var r=ca,l=Ol,u=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||u){u=G.T,G.T=null;var f=W.p;W.p=2;var y=it;it|=4;try{_A(r,l.alternate,l)}finally{it=y,W.p=f,G.T=u}}ln=3}}function WA(){if(ln===4||ln===3){ln=0,rd();var r=ca,l=Ol,u=Er,f=PA;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ln=5:(ln=0,Ol=ca=null,KA(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(la=null),ar(u),l=l.stateNode,wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot(Wi,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=G.T,y=W.p,W.p=2,G.T=null;try{for(var b=r.onRecoverableError,C=0;C<f.length;C++){var N=f[C];b(N.value,{componentStack:N.stack})}}finally{G.T=l,W.p=y}}(Er&3)!==0&&gf(),js(r),y=r.pendingLanes,(u&261930)!==0&&(y&42)!==0?r===ty?Lu++:(Lu=0,ty=r):Lu=0,ju(0)}}function KA(r,l){(r.pooledCacheLanes&=l)===0&&(l=r.pooledCache,l!=null&&(r.pooledCache=null,yu(l)))}function gf(){return $A(),GA(),WA(),YA()}function YA(){if(ln!==5)return!1;var r=ca,l=Zg;Zg=0;var u=ar(Er),f=G.T,y=W.p;try{W.p=32>u?32:u,G.T=null,u=ey,ey=null;var b=ca,C=Er;if(ln=0,Ol=ca=null,Er=0,(it&6)!==0)throw Error(n(331));var N=it;if(it|=4,IA(b.current),CA(b,b.current,C,u),it=N,ju(0,!1),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot(Wi,b)}catch{}return!0}finally{W.p=y,G.T=f,KA(r,l)}}function XA(r,l,u){l=Ii(u,l),l=Pg(r.stateNode,l,2),r=na(r,l,2),r!==null&&(Ya(r,2),js(r))}function dt(r,l,u){if(r.tag===3)XA(r,r,u);else for(;l!==null;){if(l.tag===3){XA(l,r,u);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(la===null||!la.has(f))){r=Ii(u,r),u=Qw(2),f=na(l,u,2),f!==null&&(Jw(u,f,l,r),Ya(f,2),js(f));break}}l=l.return}}function sy(r,l,u){var f=r.pingCache;if(f===null){f=r.pingCache=new ID;var y=new Set;f.set(l,y)}else y=f.get(l),y===void 0&&(y=new Set,f.set(l,y));y.has(u)||(Xg=!0,y.add(u),r=MD.bind(null,r,l,u),l.then(r,r))}function MD(r,l,u){var f=r.pingCache;f!==null&&f.delete(l),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,vt===r&&($e&u)===u&&(Mt===4||Mt===3&&($e&62914560)===$e&&300>Vn()-uf?(it&2)===0&&Pl(r,0):Qg|=u,Dl===$e&&(Dl=0)),js(r)}function QA(r,l){l===0&&(l=hd()),r=co(r,l),r!==null&&(Ya(r,l),js(r))}function LD(r){var l=r.memoizedState,u=0;l!==null&&(u=l.retryLane),QA(r,u)}function jD(r,l){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,y=r.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(l),QA(r,u)}function BD(r,l){return on(r,l)}var yf=null,Ml=null,ry=!1,vf=!1,ay=!1,ha=0;function js(r){r!==Ml&&r.next===null&&(Ml===null?yf=Ml=r:Ml=Ml.next=r),vf=!0,ry||(ry=!0,FD())}function ju(r,l){if(!ay&&vf){ay=!0;do for(var u=!1,f=yf;f!==null;){if(r!==0){var y=f.pendingLanes;if(y===0)var b=0;else{var C=f.suspendedLanes,N=f.pingedLanes;b=(1<<31-Bt(42|r)+1)-1,b&=y&~(C&~N),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(u=!0,tE(f,b))}else b=$e,b=bs(f,f===vt?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||Ki(f,b)||(u=!0,tE(f,b));f=f.next}while(u);ay=!1}}function UD(){JA()}function JA(){vf=ry=!1;var r=0;ha!==0&&XD()&&(r=ha);for(var l=Vn(),u=null,f=yf;f!==null;){var y=f.next,b=ZA(f,l);b===0?(f.next=null,u===null?yf=y:u.next=y,y===null&&(Ml=u)):(u=f,(r!==0||(b&3)!==0)&&(vf=!0)),f=y}ln!==0&&ln!==5||ju(r),ha!==0&&(ha=0)}function ZA(r,l){for(var u=r.suspendedLanes,f=r.pingedLanes,y=r.expirationTimes,b=r.pendingLanes&-62914561;0<b;){var C=31-Bt(b),N=1<<C,q=y[C];q===-1?((N&u)===0||(N&f)!==0)&&(y[C]=Mm(N,l)):q<=l&&(r.expiredLanes|=N),b&=~N}if(l=vt,u=$e,u=bs(r,r===l?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===l&&(ht===2||ht===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Ur(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Ki(r,u)){if(l=u&-u,l===r.callbackPriority)return l;switch(f!==null&&Ur(f),ar(u)){case 2:case 8:u=Wc;break;case 32:u=Fr;break;case 268435456:u=ad;break;default:u=Fr}return f=eE.bind(null,r),u=on(u,f),r.callbackPriority=l,r.callbackNode=u,l}return f!==null&&f!==null&&Ur(f),r.callbackPriority=2,r.callbackNode=null,2}function eE(r,l){if(ln!==0&&ln!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(gf()&&r.callbackNode!==u)return null;var f=$e;return f=bs(r,r===vt?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(MA(r,f,l),ZA(r,Vn()),r.callbackNode!=null&&r.callbackNode===u?eE.bind(null,r):null)}function tE(r,l){if(gf())return null;MA(r,l,!0)}function FD(){JD(function(){(it&6)!==0?on(Gc,UD):JA()})}function oy(){if(ha===0){var r=_l;r===0&&(r=ys,ys<<=1,(ys&261888)===0&&(ys=256)),ha=r}return ha}function nE(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:rl(""+r)}function iE(r,l){var u=l.ownerDocument.createElement("input");return u.name=l.name,u.value=l.value,r.id&&u.setAttribute("form",r.id),l.parentNode.insertBefore(u,l),r=new FormData(r),u.parentNode.removeChild(u),r}function zD(r,l,u,f,y){if(l==="submit"&&u&&u.stateNode===y){var b=nE((y[fn]||null).action),C=f.submitter;C&&(l=(l=C[fn]||null)?nE(l.formAction):C.getAttribute("formAction"),l!==null&&(b=l,C=null));var N=new Is("action","action",null,f,y);r.push({event:N,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ha!==0){var q=C?iE(y,C):new FormData(y);Cg(u,{pending:!0,data:q,method:y.method,action:b},null,q)}}else typeof b=="function"&&(N.preventDefault(),q=C?iE(y,C):new FormData(y),Cg(u,{pending:!0,data:q,method:y.method,action:b},b,q))},currentTarget:y}]})}}for(var ly=0;ly<Hm.length;ly++){var cy=Hm[ly],VD=cy.toLowerCase(),qD=cy[0].toUpperCase()+cy.slice(1);ns(VD,"on"+qD)}ns(N0,"onAnimationEnd"),ns(M0,"onAnimationIteration"),ns(L0,"onAnimationStart"),ns("dblclick","onDoubleClick"),ns("focusin","onFocus"),ns("focusout","onBlur"),ns(rD,"onTransitionRun"),ns(aD,"onTransitionStart"),ns(oD,"onTransitionCancel"),ns(j0,"onTransitionEnd"),xs("onMouseEnter",["mouseout","mouseover"]),xs("onMouseLeave",["mouseout","mouseover"]),xs("onPointerEnter",["pointerout","pointerover"]),xs("onPointerLeave",["pointerout","pointerover"]),Ts("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ts("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ts("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ts("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ts("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ts("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bu));function sE(r,l){l=(l&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],y=f.event;f=f.listeners;e:{var b=void 0;if(l)for(var C=f.length-1;0<=C;C--){var N=f[C],q=N.instance,J=N.currentTarget;if(N=N.listener,q!==b&&y.isPropagationStopped())break e;b=N,y.currentTarget=J;try{b(y)}catch(ie){Od(ie)}y.currentTarget=null,b=q}else for(C=0;C<f.length;C++){if(N=f[C],q=N.instance,J=N.currentTarget,N=N.listener,q!==b&&y.isPropagationStopped())break e;b=N,y.currentTarget=J;try{b(y)}catch(ie){Od(ie)}y.currentTarget=null,b=q}}}}function He(r,l){var u=l[el];u===void 0&&(u=l[el]=new Set);var f=r+"__bubble";u.has(f)||(rE(l,r,2,!1),u.add(f))}function uy(r,l,u){var f=0;l&&(f|=4),rE(u,r,f,l)}var bf="_reactListening"+Math.random().toString(36).slice(2);function hy(r){if(!r[bf]){r[bf]=!0,Xc.forEach(function(u){u!=="selectionchange"&&(HD.has(u)||uy(u,!1,r),uy(u,!0,r))});var l=r.nodeType===9?r:r.ownerDocument;l===null||l[bf]||(l[bf]=!0,uy("selectionchange",!1,l))}}function rE(r,l,u,f){switch(NE(l)){case 2:var y=vO;break;case 8:y=bO;break;default:y=xy}u=y.bind(null,l,u,r),y=void 0,!to||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),f?y!==void 0?r.addEventListener(l,u,{capture:!0,passive:y}):r.addEventListener(l,u,!0):y!==void 0?r.addEventListener(l,u,{passive:y}):r.addEventListener(l,u,!1)}function dy(r,l,u,f,y){var b=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var C=f.tag;if(C===3||C===4){var N=f.stateNode.containerInfo;if(N===y)break;if(C===4)for(C=f.return;C!==null;){var q=C.tag;if((q===3||q===4)&&C.stateNode.containerInfo===y)return;C=C.return}for(;N!==null;){if(C=Es(N),C===null)return;if(q=C.tag,q===5||q===6||q===26||q===27){f=b=C;continue e}N=N.parentNode}}f=f.return}Gr(function(){var J=b,ie=xi(u),re=[];e:{var Z=B0.get(r);if(Z!==void 0){var ne=Is,ye=r;switch(r){case"keypress":if(io(u)===0)break e;case"keydown":case"keyup":ne=Rd;break;case"focusin":ye="focus",ne=ro;break;case"focusout":ye="blur",ne=ro;break;case"beforeblur":case"afterblur":ne=ro;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=cu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=_d;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=E;break;case N0:case M0:case L0:ne=Ad;break;case j0:ne=M;break;case"scroll":case"scrollend":ne=lu;break;case"wheel":ne=te;break;case"copy":case"cut":case"paste":ne=Ed;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=cr;break;case"toggle":case"beforetoggle":ne=Fe}var Te=(l&4)!==0,gt=!Te&&(r==="scroll"||r==="scrollend"),K=Te?Z!==null?Z+"Capture":null:Z;Te=[];for(var $=J,Q;$!==null;){var se=$;if(Q=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||Q===null||K===null||(se=Ji($,K),se!=null&&Te.push(Uu($,se,Q))),gt)break;$=$.return}0<Te.length&&(Z=new ne(Z,ye,null,u,ie),re.push({event:Z,listeners:Te}))}}if((l&7)===0){e:{if(Z=r==="mouseover"||r==="pointerover",ne=r==="mouseout"||r==="pointerout",Z&&u!==ru&&(ye=u.relatedTarget||u.fromElement)&&(Es(ye)||ye[ws]))break e;if((ne||Z)&&(Z=ie.window===ie?ie:(Z=ie.ownerDocument)?Z.defaultView||Z.parentWindow:window,ne?(ye=u.relatedTarget||u.toElement,ne=J,ye=ye?Es(ye):null,ye!==null&&(gt=a(ye),Te=ye.tag,ye!==gt||Te!==5&&Te!==27&&Te!==6)&&(ye=null)):(ne=null,ye=J),ne!==ye)){if(Te=cu,se="onMouseLeave",K="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(Te=cr,se="onPointerLeave",K="onPointerEnter",$="pointer"),gt=ne==null?Z:ai(ne),Q=ye==null?Z:ai(ye),Z=new Te(se,$+"leave",ne,u,ie),Z.target=gt,Z.relatedTarget=Q,se=null,Es(ie)===J&&(Te=new Te(K,$+"enter",ye,u,ie),Te.target=Q,Te.relatedTarget=gt,se=Te),gt=se,ne&&ye)t:{for(Te=$D,K=ne,$=ye,Q=0,se=K;se;se=Te(se))Q++;se=0;for(var Ee=$;Ee;Ee=Te(Ee))se++;for(;0<Q-se;)K=Te(K),Q--;for(;0<se-Q;)$=Te($),se--;for(;Q--;){if(K===$||$!==null&&K===$.alternate){Te=K;break t}K=Te(K),$=Te($)}Te=null}else Te=null;ne!==null&&aE(re,Z,ne,Te,!1),ye!==null&&gt!==null&&aE(re,gt,ye,Te,!0)}}e:{if(Z=J?ai(J):window,ne=Z.nodeName&&Z.nodeName.toLowerCase(),ne==="select"||ne==="input"&&Z.type==="file")var et=E0;else if(w0(Z))if(S0)et=nD;else{et=eD;var be=ZI}else ne=Z.nodeName,!ne||ne.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?J&&sl(J.elementType)&&(et=E0):et=tD;if(et&&(et=et(r,J))){A0(re,et,u,ie);break e}be&&be(r,Z,J),r==="focusout"&&J&&Z.type==="number"&&J.memoizedProps.value!=null&&nu(Z,"number",Z.value)}switch(be=J?ai(J):window,r){case"focusin":(w0(be)||be.contentEditable==="true")&&(dl=be,zm=J,pu=null);break;case"focusout":pu=zm=dl=null;break;case"mousedown":Vm=!0;break;case"contextmenu":case"mouseup":case"dragend":Vm=!1,O0(re,u,ie);break;case"selectionchange":if(sD)break;case"keydown":case"keyup":O0(re,u,ie)}var Ve;if(nt)e:{switch(r){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else hl?ao(r,u)&&(Ge="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Ge="onCompositionStart");Ge&&(Ps&&u.locale!=="ko"&&(hl||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&hl&&(Ve=ou()):(Rs=ie,au="value"in Rs?Rs.value:Rs.textContent,hl=!0)),be=_f(J,Ge),0<be.length&&(Ge=new Os(Ge,r,null,u,ie),re.push({event:Ge,listeners:be}),Ve?Ge.data=Ve:(Ve=ul(u),Ve!==null&&(Ge.data=Ve)))),(Ve=ki?YI(r,u):XI(r,u))&&(Ge=_f(J,"onBeforeInput"),0<Ge.length&&(be=new Os("onBeforeInput","beforeinput",null,u,ie),re.push({event:be,listeners:Ge}),be.data=Ve)),zD(re,r,J,u,ie)}sE(re,l)})}function Uu(r,l,u){return{instance:r,listener:l,currentTarget:u}}function _f(r,l){for(var u=l+"Capture",f=[];r!==null;){var y=r,b=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||b===null||(y=Ji(r,u),y!=null&&f.unshift(Uu(r,y,b)),y=Ji(r,l),y!=null&&f.push(Uu(r,y,b))),r.tag===3)return f;r=r.return}return[]}function $D(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function aE(r,l,u,f,y){for(var b=l._reactName,C=[];u!==null&&u!==f;){var N=u,q=N.alternate,J=N.stateNode;if(N=N.tag,q!==null&&q===f)break;N!==5&&N!==26&&N!==27||J===null||(q=J,y?(J=Ji(u,b),J!=null&&C.unshift(Uu(u,J,q))):y||(J=Ji(u,b),J!=null&&C.push(Uu(u,J,q)))),u=u.return}C.length!==0&&r.push({event:l,listeners:C})}var GD=/\r\n?/g,WD=/\u0000|\uFFFD/g;function oE(r){return(typeof r=="string"?r:""+r).replace(GD,`
`).replace(WD,"")}function lE(r,l){return l=oE(l),oE(r)===l}function mt(r,l,u,f,y,b){switch(u){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||Yn(r,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&Yn(r,""+f);break;case"className":oi(r,"class",f);break;case"tabIndex":oi(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":oi(r,u,f);break;case"style":su(r,f,b);break;case"data":if(l!=="object"){oi(r,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=rl(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(u==="formAction"?(l!=="input"&&mt(r,l,"name",y.name,y,null),mt(r,l,"formEncType",y.formEncType,y,null),mt(r,l,"formMethod",y.formMethod,y,null),mt(r,l,"formTarget",y.formTarget,y,null)):(mt(r,l,"encType",y.encType,y,null),mt(r,l,"method",y.method,y,null),mt(r,l,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=rl(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=Qi);break;case"onScroll":f!=null&&He("scroll",r);break;case"onScrollEnd":f!=null&&He("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=rl(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":He("beforetoggle",r),He("toggle",r),nl(r,"popover",f);break;case"xlinkActuate":Yt(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Yt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Yt(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Yt(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Yt(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Yt(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Yt(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Yt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Yt(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":nl(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=bd.get(u)||u,nl(r,u,f))}}function fy(r,l,u,f,y,b){switch(u){case"style":su(r,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof f=="string"?Yn(r,f):(typeof f=="number"||typeof f=="bigint")&&Yn(r,""+f);break;case"onScroll":f!=null&&He("scroll",r);break;case"onScrollEnd":f!=null&&He("scrollend",r);break;case"onClick":f!=null&&(r.onclick=Qi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qc.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),l=u.slice(2,y?u.length-7:void 0),b=r[fn]||null,b=b!=null?b[u]:null,typeof b=="function"&&r.removeEventListener(l,b,y),typeof f=="function")){typeof b!="function"&&b!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(l,f,y);break e}u in r?r[u]=f:f===!0?r.setAttribute(u,""):nl(r,u,f)}}}function xn(r,l,u){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",r),He("load",r);var f=!1,y=!1,b;for(b in u)if(u.hasOwnProperty(b)){var C=u[b];if(C!=null)switch(b){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:mt(r,l,b,C,u,null)}}y&&mt(r,l,"srcSet",u.srcSet,u,null),f&&mt(r,l,"src",u.src,u,null);return;case"input":He("invalid",r);var N=b=C=y=null,q=null,J=null;for(f in u)if(u.hasOwnProperty(f)){var ie=u[f];if(ie!=null)switch(f){case"name":y=ie;break;case"type":C=ie;break;case"checked":q=ie;break;case"defaultChecked":J=ie;break;case"value":b=ie;break;case"defaultValue":N=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,l));break;default:mt(r,l,f,ie,u,null)}}gd(r,b,N,q,J,C,y,!1);return;case"select":He("invalid",r),f=C=b=null;for(y in u)if(u.hasOwnProperty(y)&&(N=u[y],N!=null))switch(y){case"value":b=N;break;case"defaultValue":C=N;break;case"multiple":f=N;default:mt(r,l,y,N,u,null)}l=b,u=C,r.multiple=!!f,l!=null?Vr(r,!!f,l,!1):u!=null&&Vr(r,!!f,u,!0);return;case"textarea":He("invalid",r),b=y=f=null;for(C in u)if(u.hasOwnProperty(C)&&(N=u[C],N!=null))switch(C){case"value":f=N;break;case"defaultValue":y=N;break;case"children":b=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(n(91));break;default:mt(r,l,C,N,u,null)}qr(r,f,y,b);return;case"option":for(q in u)u.hasOwnProperty(q)&&(f=u[q],f!=null)&&(q==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":mt(r,l,q,f,u,null));return;case"dialog":He("beforetoggle",r),He("toggle",r),He("cancel",r),He("close",r);break;case"iframe":case"object":He("load",r);break;case"video":case"audio":for(f=0;f<Bu.length;f++)He(Bu[f],r);break;case"image":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"embed":case"source":case"link":He("error",r),He("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in u)if(u.hasOwnProperty(J)&&(f=u[J],f!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:mt(r,l,J,f,u,null)}return;default:if(sl(l)){for(ie in u)u.hasOwnProperty(ie)&&(f=u[ie],f!==void 0&&fy(r,l,ie,f,u,void 0));return}}for(N in u)u.hasOwnProperty(N)&&(f=u[N],f!=null&&mt(r,l,N,f,u,null))}function KD(r,l,u,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,b=null,C=null,N=null,q=null,J=null,ie=null;for(ne in u){var re=u[ne];if(u.hasOwnProperty(ne)&&re!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":q=re;default:f.hasOwnProperty(ne)||mt(r,l,ne,null,f,re)}}for(var Z in f){var ne=f[Z];if(re=u[Z],f.hasOwnProperty(Z)&&(ne!=null||re!=null))switch(Z){case"type":b=ne;break;case"name":y=ne;break;case"checked":J=ne;break;case"defaultChecked":ie=ne;break;case"value":C=ne;break;case"defaultValue":N=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(n(137,l));break;default:ne!==re&&mt(r,l,Z,ne,f,re)}}il(r,C,N,q,J,ie,b,y);return;case"select":ne=C=N=Z=null;for(b in u)if(q=u[b],u.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":ne=q;default:f.hasOwnProperty(b)||mt(r,l,b,null,f,q)}for(y in f)if(b=f[y],q=u[y],f.hasOwnProperty(y)&&(b!=null||q!=null))switch(y){case"value":Z=b;break;case"defaultValue":N=b;break;case"multiple":C=b;default:b!==q&&mt(r,l,y,b,f,q)}l=N,u=C,f=ne,Z!=null?Vr(r,!!u,Z,!1):!!f!=!!u&&(l!=null?Vr(r,!!u,l,!0):Vr(r,!!u,u?[]:"",!1));return;case"textarea":ne=Z=null;for(N in u)if(y=u[N],u.hasOwnProperty(N)&&y!=null&&!f.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:mt(r,l,N,null,f,y)}for(C in f)if(y=f[C],b=u[C],f.hasOwnProperty(C)&&(y!=null||b!=null))switch(C){case"value":Z=y;break;case"defaultValue":ne=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==b&&mt(r,l,C,y,f,b)}yd(r,Z,ne);return;case"option":for(var ye in u)Z=u[ye],u.hasOwnProperty(ye)&&Z!=null&&!f.hasOwnProperty(ye)&&(ye==="selected"?r.selected=!1:mt(r,l,ye,null,f,Z));for(q in f)Z=f[q],ne=u[q],f.hasOwnProperty(q)&&Z!==ne&&(Z!=null||ne!=null)&&(q==="selected"?r.selected=Z&&typeof Z!="function"&&typeof Z!="symbol":mt(r,l,q,Z,f,ne));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Te in u)Z=u[Te],u.hasOwnProperty(Te)&&Z!=null&&!f.hasOwnProperty(Te)&&mt(r,l,Te,null,f,Z);for(J in f)if(Z=f[J],ne=u[J],f.hasOwnProperty(J)&&Z!==ne&&(Z!=null||ne!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(137,l));break;default:mt(r,l,J,Z,f,ne)}return;default:if(sl(l)){for(var gt in u)Z=u[gt],u.hasOwnProperty(gt)&&Z!==void 0&&!f.hasOwnProperty(gt)&&fy(r,l,gt,void 0,f,Z);for(ie in f)Z=f[ie],ne=u[ie],!f.hasOwnProperty(ie)||Z===ne||Z===void 0&&ne===void 0||fy(r,l,ie,Z,f,ne);return}}for(var K in u)Z=u[K],u.hasOwnProperty(K)&&Z!=null&&!f.hasOwnProperty(K)&&mt(r,l,K,null,f,Z);for(re in f)Z=f[re],ne=u[re],!f.hasOwnProperty(re)||Z===ne||Z==null&&ne==null||mt(r,l,re,Z,f,ne)}function cE(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YD(){if(typeof performance.getEntriesByType=="function"){for(var r=0,l=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var y=u[f],b=y.transferSize,C=y.initiatorType,N=y.duration;if(b&&N&&cE(C)){for(C=0,N=y.responseEnd,f+=1;f<u.length;f++){var q=u[f],J=q.startTime;if(J>N)break;var ie=q.transferSize,re=q.initiatorType;ie&&cE(re)&&(q=q.responseEnd,C+=ie*(q<N?1:(N-J)/(q-J)))}if(--f,l+=8*(b+C)/(y.duration/1e3),r++,10<r)break}}if(0<r)return l/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var py=null,my=null;function wf(r){return r.nodeType===9?r:r.ownerDocument}function uE(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hE(r,l){if(r===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&l==="foreignObject"?0:r}function gy(r,l){return r==="textarea"||r==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var yy=null;function XD(){var r=window.event;return r&&r.type==="popstate"?r===yy?!1:(yy=r,!0):(yy=null,!1)}var dE=typeof setTimeout=="function"?setTimeout:void 0,QD=typeof clearTimeout=="function"?clearTimeout:void 0,fE=typeof Promise=="function"?Promise:void 0,JD=typeof queueMicrotask=="function"?queueMicrotask:typeof fE<"u"?function(r){return fE.resolve(null).then(r).catch(ZD)}:dE;function ZD(r){setTimeout(function(){throw r})}function da(r){return r==="head"}function pE(r,l){var u=l,f=0;do{var y=u.nextSibling;if(r.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(y),Ul(l);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Fu(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Fu(u);for(var b=u.firstChild;b;){var C=b.nextSibling,N=b.nodeName;b[As]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&b.rel.toLowerCase()==="stylesheet"||u.removeChild(b),b=C}}else u==="body"&&Fu(r.ownerDocument.body);u=y}while(u);Ul(l)}function mE(r,l){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?l?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(l?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function vy(r){var l=r.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var u=l;switch(l=l.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":vy(u),tl(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function eO(r,l,u,f){for(;r.nodeType===1;){var y=u;if(r.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[As])switch(l){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(b=r.getAttribute("rel"),b==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(b!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(b=r.getAttribute("src"),(b!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&b&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(l==="input"&&r.type==="hidden"){var b=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===b)return r}else return r;if(r=Mi(r.nextSibling),r===null)break}return null}function tO(r,l,u){if(l==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Mi(r.nextSibling),r===null))return null;return r}function gE(r,l){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Mi(r.nextSibling),r===null))return null;return r}function by(r){return r.data==="$?"||r.data==="$~"}function _y(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function nO(r,l){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=l;else if(r.data!=="$?"||u.readyState!=="loading")l();else{var f=function(){l(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Mi(r){for(;r!=null;r=r.nextSibling){var l=r.nodeType;if(l===1||l===3)break;if(l===8){if(l=r.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return r}var wy=null;function yE(r){r=r.nextSibling;for(var l=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(l===0)return Mi(r.nextSibling);l--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||l++}r=r.nextSibling}return null}function vE(r){r=r.previousSibling;for(var l=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(l===0)return r;l--}else u!=="/$"&&u!=="/&"||l++}r=r.previousSibling}return null}function bE(r,l,u){switch(l=wf(u),r){case"html":if(r=l.documentElement,!r)throw Error(n(452));return r;case"head":if(r=l.head,!r)throw Error(n(453));return r;case"body":if(r=l.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Fu(r){for(var l=r.attributes;l.length;)r.removeAttributeNode(l[0]);tl(r)}var Li=new Map,_E=new Set;function Af(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Sr=W.d;W.d={f:iO,r:sO,D:rO,C:aO,L:oO,m:lO,X:uO,S:cO,M:hO};function iO(){var r=Sr.f(),l=ff();return r||l}function sO(r){var l=Ti(r);l!==null&&l.tag===5&&l.type==="form"?jw(l):Sr.r(r)}var Ll=typeof document>"u"?null:document;function wE(r,l,u){var f=Ll;if(f&&typeof l=="string"&&l){var y=Kn(l);y='link[rel="'+r+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),_E.has(y)||(_E.add(y),r={rel:r,crossOrigin:u,href:l},f.querySelector(y)===null&&(l=f.createElement("link"),xn(l,"link",r),Kt(l),f.head.appendChild(l)))}}function rO(r){Sr.D(r),wE("dns-prefetch",r,null)}function aO(r,l){Sr.C(r,l),wE("preconnect",r,l)}function oO(r,l,u){Sr.L(r,l,u);var f=Ll;if(f&&r&&l){var y='link[rel="preload"][as="'+Kn(l)+'"]';l==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Kn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Kn(u.imageSizes)+'"]')):y+='[href="'+Kn(r)+'"]';var b=y;switch(l){case"style":b=jl(r);break;case"script":b=Bl(r)}Li.has(b)||(r=m({rel:"preload",href:l==="image"&&u&&u.imageSrcSet?void 0:r,as:l},u),Li.set(b,r),f.querySelector(y)!==null||l==="style"&&f.querySelector(zu(b))||l==="script"&&f.querySelector(Vu(b))||(l=f.createElement("link"),xn(l,"link",r),Kt(l),f.head.appendChild(l)))}}function lO(r,l){Sr.m(r,l);var u=Ll;if(u&&r){var f=l&&typeof l.as=="string"?l.as:"script",y='link[rel="modulepreload"][as="'+Kn(f)+'"][href="'+Kn(r)+'"]',b=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Bl(r)}if(!Li.has(b)&&(r=m({rel:"modulepreload",href:r},l),Li.set(b,r),u.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Vu(b)))return}f=u.createElement("link"),xn(f,"link",r),Kt(f),u.head.appendChild(f)}}}function cO(r,l,u){Sr.S(r,l,u);var f=Ll;if(f&&r){var y=Ss(f).hoistableStyles,b=jl(r);l=l||"default";var C=y.get(b);if(!C){var N={loading:0,preload:null};if(C=f.querySelector(zu(b)))N.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":l},u),(u=Li.get(b))&&Ay(r,u);var q=C=f.createElement("link");Kt(q),xn(q,"link",r),q._p=new Promise(function(J,ie){q.onload=J,q.onerror=ie}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Ef(C,l,f)}C={type:"stylesheet",instance:C,count:1,state:N},y.set(b,C)}}}function uO(r,l){Sr.X(r,l);var u=Ll;if(u&&r){var f=Ss(u).hoistableScripts,y=Bl(r),b=f.get(y);b||(b=u.querySelector(Vu(y)),b||(r=m({src:r,async:!0},l),(l=Li.get(y))&&Ey(r,l),b=u.createElement("script"),Kt(b),xn(b,"link",r),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(y,b))}}function hO(r,l){Sr.M(r,l);var u=Ll;if(u&&r){var f=Ss(u).hoistableScripts,y=Bl(r),b=f.get(y);b||(b=u.querySelector(Vu(y)),b||(r=m({src:r,async:!0,type:"module"},l),(l=Li.get(y))&&Ey(r,l),b=u.createElement("script"),Kt(b),xn(b,"link",r),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(y,b))}}function AE(r,l,u,f){var y=(y=ke.current)?Af(y):null;if(!y)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(l=jl(u.href),u=Ss(y).hoistableStyles,f=u.get(l),f||(f={type:"style",instance:null,count:0,state:null},u.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=jl(u.href);var b=Ss(y).hoistableStyles,C=b.get(r);if(C||(y=y.ownerDocument||y,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(r,C),(b=y.querySelector(zu(r)))&&!b._p&&(C.instance=b,C.state.loading=5),Li.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Li.set(r,u),b||dO(y,r,u,C.state))),l&&f===null)throw Error(n(528,""));return C}if(l&&f!==null)throw Error(n(529,""));return null;case"script":return l=u.async,u=u.src,typeof u=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Bl(u),u=Ss(y).hoistableScripts,f=u.get(l),f||(f={type:"script",instance:null,count:0,state:null},u.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function jl(r){return'href="'+Kn(r)+'"'}function zu(r){return'link[rel="stylesheet"]['+r+"]"}function EE(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function dO(r,l,u,f){r.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=r.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),xn(l,"link",u),Kt(l),r.head.appendChild(l))}function Bl(r){return'[src="'+Kn(r)+'"]'}function Vu(r){return"script[async]"+r}function SE(r,l,u){if(l.count++,l.instance===null)switch(l.type){case"style":var f=r.querySelector('style[data-href~="'+Kn(u.href)+'"]');if(f)return l.instance=f,Kt(f),f;var y=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),Kt(f),xn(f,"style",y),Ef(f,u.precedence,r),l.instance=f;case"stylesheet":y=jl(u.href);var b=r.querySelector(zu(y));if(b)return l.state.loading|=4,l.instance=b,Kt(b),b;f=EE(u),(y=Li.get(y))&&Ay(f,y),b=(r.ownerDocument||r).createElement("link"),Kt(b);var C=b;return C._p=new Promise(function(N,q){C.onload=N,C.onerror=q}),xn(b,"link",f),l.state.loading|=4,Ef(b,u.precedence,r),l.instance=b;case"script":return b=Bl(u.src),(y=r.querySelector(Vu(b)))?(l.instance=y,Kt(y),y):(f=u,(y=Li.get(b))&&(f=m({},u),Ey(f,y)),r=r.ownerDocument||r,y=r.createElement("script"),Kt(y),xn(y,"link",f),r.head.appendChild(y),l.instance=y);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,Ef(f,u.precedence,r));return l.instance}function Ef(r,l,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,b=y,C=0;C<f.length;C++){var N=f[C];if(N.dataset.precedence===l)b=N;else if(b!==y)break}b?b.parentNode.insertBefore(r,b.nextSibling):(l=u.nodeType===9?u.head:u,l.insertBefore(r,l.firstChild))}function Ay(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.title==null&&(r.title=l.title)}function Ey(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.integrity==null&&(r.integrity=l.integrity)}var Sf=null;function TE(r,l,u){if(Sf===null){var f=new Map,y=Sf=new Map;y.set(u,f)}else y=Sf,f=y.get(u),f||(f=new Map,y.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),y=0;y<u.length;y++){var b=u[y];if(!(b[As]||b[Wt]||r==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var C=b.getAttribute(l)||"";C=r+C;var N=f.get(C);N?N.push(b):f.set(C,[b])}}return f}function xE(r,l,u){r=r.ownerDocument||r,r.head.insertBefore(u,l==="title"?r.querySelector("head > title"):null)}function fO(r,l,u){if(u===1||l.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(r=l.disabled,typeof l.precedence=="string"&&r==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function CE(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function pO(r,l,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=jl(f.href),b=l.querySelector(zu(y));if(b){l=b._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(r.count++,r=Tf.bind(r),l.then(r,r)),u.state.loading|=4,u.instance=b,Kt(b);return}b=l.ownerDocument||l,f=EE(f),(y=Li.get(y))&&Ay(f,y),b=b.createElement("link"),Kt(b);var C=b;C._p=new Promise(function(N,q){C.onload=N,C.onerror=q}),xn(b,"link",f),u.instance=b}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,l),(l=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=Tf.bind(r),l.addEventListener("load",u),l.addEventListener("error",u))}}var Sy=0;function mO(r,l){return r.stylesheets&&r.count===0&&Cf(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&Cf(r,r.stylesheets),r.unsuspend){var b=r.unsuspend;r.unsuspend=null,b()}},6e4+l);0<r.imgBytes&&Sy===0&&(Sy=62500*YD());var y=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Cf(r,r.stylesheets),r.unsuspend)){var b=r.unsuspend;r.unsuspend=null,b()}},(r.imgBytes>Sy?50:800)+l);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function Tf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var xf=null;function Cf(r,l){r.stylesheets=null,r.unsuspend!==null&&(r.count++,xf=new Map,l.forEach(gO,r),xf=null,Tf.call(r))}function gO(r,l){if(!(l.state.loading&4)){var u=xf.get(r);if(u)var f=u.get(null);else{u=new Map,xf.set(r,u);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<y.length;b++){var C=y[b];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(u.set(C.dataset.precedence,C),f=C)}f&&u.set(null,f)}y=l.instance,C=y.getAttribute("data-precedence"),b=u.get(C)||f,b===f&&u.set(null,y),u.set(C,y),this.count++,f=Tf.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),b?b.parentNode.insertBefore(y,b.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),l.state.loading|=4}}var qu={$$typeof:I,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function yO(r,l,u,f,y,b,C,N,q){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_s(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_s(0),this.hiddenUpdates=_s(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=b,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function kE(r,l,u,f,y,b,C,N,q,J,ie,re){return r=new yO(r,l,u,C,q,J,ie,re,N),l=1,b===!0&&(l|=24),b=ci(3,null,null,l),r.current=b,b.stateNode=r,l=ig(),l.refCount++,r.pooledCache=l,l.refCount++,b.memoizedState={element:f,isDehydrated:u,cache:l},og(b),r}function RE(r){return r?(r=ml,r):ml}function IE(r,l,u,f,y,b){y=RE(y),f.context===null?f.context=y:f.pendingContext=y,f=ta(l),f.payload={element:u},b=b===void 0?null:b,b!==null&&(f.callback=b),u=na(r,f,l),u!==null&&(ei(u,r,l),wu(u,r,l))}function DE(r,l){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<l?u:l}}function Ty(r,l){DE(r,l),(r=r.alternate)&&DE(r,l)}function OE(r){if(r.tag===13||r.tag===31){var l=co(r,67108864);l!==null&&ei(l,r,67108864),Ty(r,67108864)}}function PE(r){if(r.tag===13||r.tag===31){var l=pi();l=Qa(l);var u=co(r,l);u!==null&&ei(u,r,l),Ty(r,l)}}var kf=!0;function vO(r,l,u,f){var y=G.T;G.T=null;var b=W.p;try{W.p=2,xy(r,l,u,f)}finally{W.p=b,G.T=y}}function bO(r,l,u,f){var y=G.T;G.T=null;var b=W.p;try{W.p=8,xy(r,l,u,f)}finally{W.p=b,G.T=y}}function xy(r,l,u,f){if(kf){var y=Cy(f);if(y===null)dy(r,l,f,Rf,u),ME(r,f);else if(wO(y,r,l,u,f))f.stopPropagation();else if(ME(r,f),l&4&&-1<_O.indexOf(r)){for(;y!==null;){var b=Ti(y);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var C=vs(b.pendingLanes);if(C!==0){var N=b;for(N.pendingLanes|=2,N.entangledLanes|=2;C;){var q=1<<31-Bt(C);N.entanglements[1]|=q,C&=~q}js(b),(it&6)===0&&(hf=Vn()+500,ju(0))}}break;case 31:case 13:N=co(b,2),N!==null&&ei(N,b,2),ff(),Ty(b,2)}if(b=Cy(f),b===null&&dy(r,l,f,Rf,u),b===y)break;y=b}y!==null&&f.stopPropagation()}else dy(r,l,f,null,u)}}function Cy(r){return r=xi(r),ky(r)}var Rf=null;function ky(r){if(Rf=null,r=Es(r),r!==null){var l=a(r);if(l===null)r=null;else{var u=l.tag;if(u===13){if(r=o(l),r!==null)return r;r=null}else if(u===31){if(r=c(l),r!==null)return r;r=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null)}}return Rf=r,null}function NE(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wa()){case Gc:return 2;case Wc:return 8;case Fr:case Nm:return 32;case ad:return 268435456;default:return 32}default:return 32}}var Ry=!1,fa=null,pa=null,ma=null,Hu=new Map,$u=new Map,ga=[],_O="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ME(r,l){switch(r){case"focusin":case"focusout":fa=null;break;case"dragenter":case"dragleave":pa=null;break;case"mouseover":case"mouseout":ma=null;break;case"pointerover":case"pointerout":Hu.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":$u.delete(l.pointerId)}}function Gu(r,l,u,f,y,b){return r===null||r.nativeEvent!==b?(r={blockedOn:l,domEventName:u,eventSystemFlags:f,nativeEvent:b,targetContainers:[y]},l!==null&&(l=Ti(l),l!==null&&OE(l)),r):(r.eventSystemFlags|=f,l=r.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),r)}function wO(r,l,u,f,y){switch(l){case"focusin":return fa=Gu(fa,r,l,u,f,y),!0;case"dragenter":return pa=Gu(pa,r,l,u,f,y),!0;case"mouseover":return ma=Gu(ma,r,l,u,f,y),!0;case"pointerover":var b=y.pointerId;return Hu.set(b,Gu(Hu.get(b)||null,r,l,u,f,y)),!0;case"gotpointercapture":return b=y.pointerId,$u.set(b,Gu($u.get(b)||null,r,l,u,f,y)),!0}return!1}function LE(r){var l=Es(r.target);if(l!==null){var u=a(l);if(u!==null){if(l=u.tag,l===13){if(l=o(u),l!==null){r.blockedOn=l,Yi(r.priority,function(){PE(u)});return}}else if(l===31){if(l=c(u),l!==null){r.blockedOn=l,Yi(r.priority,function(){PE(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function If(r){if(r.blockedOn!==null)return!1;for(var l=r.targetContainers;0<l.length;){var u=Cy(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);ru=f,u.target.dispatchEvent(f),ru=null}else return l=Ti(u),l!==null&&OE(l),r.blockedOn=u,!1;l.shift()}return!0}function jE(r,l,u){If(r)&&u.delete(l)}function AO(){Ry=!1,fa!==null&&If(fa)&&(fa=null),pa!==null&&If(pa)&&(pa=null),ma!==null&&If(ma)&&(ma=null),Hu.forEach(jE),$u.forEach(jE)}function Df(r,l){r.blockedOn===l&&(r.blockedOn=null,Ry||(Ry=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,AO)))}var Of=null;function BE(r){Of!==r&&(Of=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Of===r&&(Of=null);for(var l=0;l<r.length;l+=3){var u=r[l],f=r[l+1],y=r[l+2];if(typeof f!="function"){if(ky(f||u)===null)continue;break}var b=Ti(u);b!==null&&(r.splice(l,3),l-=3,Cg(b,{pending:!0,data:y,method:u.method,action:f},f,y))}}))}function Ul(r){function l(q){return Df(q,r)}fa!==null&&Df(fa,r),pa!==null&&Df(pa,r),ma!==null&&Df(ma,r),Hu.forEach(l),$u.forEach(l);for(var u=0;u<ga.length;u++){var f=ga[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<ga.length&&(u=ga[0],u.blockedOn===null);)LE(u),u.blockedOn===null&&ga.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var y=u[f],b=u[f+1],C=y[fn]||null;if(typeof b=="function")C||BE(u);else if(C){var N=null;if(b&&b.hasAttribute("formAction")){if(y=b,C=b[fn]||null)N=C.formAction;else if(ky(y)!==null)continue}else N=C.action;typeof N=="function"?u[f+1]=N:(u.splice(f,3),f-=3),BE(u)}}}function UE(){function r(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(C){return y=C})},focusReset:"manual",scroll:"manual"})}function l(){y!==null&&(y(),y=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),y!==null&&(y(),y=null)}}}function Iy(r){this._internalRoot=r}Pf.prototype.render=Iy.prototype.render=function(r){var l=this._internalRoot;if(l===null)throw Error(n(409));var u=l.current,f=pi();IE(u,f,r,l,null,null)},Pf.prototype.unmount=Iy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var l=r.containerInfo;IE(r.current,2,null,r,null,null),ff(),l[ws]=null}};function Pf(r){this._internalRoot=r}Pf.prototype.unstable_scheduleHydration=function(r){if(r){var l=dd();r={blockedOn:null,target:r,priority:l};for(var u=0;u<ga.length&&l!==0&&l<ga[u].priority;u++);ga.splice(u,0,r),u===0&&LE(r)}};var FE=e.version;if(FE!=="19.2.3")throw Error(n(527,FE,"19.2.3"));W.findDOMNode=function(r){var l=r._reactInternals;if(l===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=d(l),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var EO={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nf.isDisabled&&Nf.supportsFiber)try{Wi=Nf.inject(EO),wn=Nf}catch{}}return Ku.createRoot=function(r,l){if(!s(r))throw Error(n(299));var u=!1,f="",y=Ww,b=Kw,C=Yw;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError)),l=kE(r,1,!1,null,null,u,f,null,y,b,C,UE),r[ws]=l.current,hy(r),new Iy(l)},Ku.hydrateRoot=function(r,l,u){if(!s(r))throw Error(n(299));var f=!1,y="",b=Ww,C=Kw,N=Yw,q=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(b=u.onUncaughtError),u.onCaughtError!==void 0&&(C=u.onCaughtError),u.onRecoverableError!==void 0&&(N=u.onRecoverableError),u.formState!==void 0&&(q=u.formState)),l=kE(r,1,!0,l,u??null,f,y,q,b,C,N,UE),l.context=RE(null),u=l.current,f=pi(),f=Qa(f),y=ta(f),y.callback=null,na(u,y,f),u=f,l.current.lanes=u,Ya(l,u),js(l),r[ws]=l.current,hy(r),new Pf(l)},Ku.version="19.2.3",Ku}var JE;function NO(){if(JE)return Ny.exports;JE=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Ny.exports=PO(),Ny.exports}var MO=NO();const LO=Zb(MO);var ZE="popstate";function jO(i={}){function e(n,s){let{pathname:a,search:o,hash:c}=n.location;return $v("",{pathname:a,search:o,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:_h(s)}return UO(e,t,null,i)}function Dt(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Js(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function BO(){return Math.random().toString(36).substring(2,10)}function eS(i,e){return{usr:i.state,key:i.key,idx:e}}function $v(i,e,t=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Oc(e):e,state:t,key:e&&e.key||n||BO()}}function _h({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Oc(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substring(n),i=i.substring(0,n)),i&&(e.pathname=i)}return e}function UO(i,e,t,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,c="POP",h=null,d=p();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function p(){return(o.state||{idx:null}).idx}function m(){c="POP";let T=p(),x=T==null?null:T-d;d=T,h&&h({action:c,location:A.location,delta:x})}function v(T,x){c="PUSH";let D=$v(A.location,T,x);d=p()+1;let I=eS(D,d),U=A.createHref(D);try{o.pushState(I,"",U)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;s.location.assign(U)}a&&h&&h({action:c,location:A.location,delta:1})}function _(T,x){c="REPLACE";let D=$v(A.location,T,x);d=p();let I=eS(D,d),U=A.createHref(D);o.replaceState(I,"",U),a&&h&&h({action:c,location:A.location,delta:0})}function S(T){return FO(T)}let A={get action(){return c},get location(){return i(s,o)},listen(T){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(ZE,m),h=T,()=>{s.removeEventListener(ZE,m),h=null}},createHref(T){return e(s,T)},createURL:S,encodeLocation(T){let x=S(T);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:v,replace:_,go(T){return o.go(T)}};return A}function FO(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Dt(t,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:_h(i);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Ex(i,e,t="/"){return zO(i,e,t,!1)}function zO(i,e,t,n){let s=typeof e=="string"?Oc(e):e,a=Or(s.pathname||"/",t);if(a==null)return null;let o=Sx(i);VO(o);let c=null;for(let h=0;c==null&&h<o.length;++h){let d=ZO(a);c=QO(o[h],d,n)}return c}function Sx(i,e=[],t=[],n="",s=!1){let a=(o,c,h=s,d)=>{let p={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&h)return;Dt(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let m=Dr([n,p.relativePath]),v=t.concat(p);o.children&&o.children.length>0&&(Dt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Sx(o.children,e,v,m,h)),!(o.path==null&&!o.index)&&e.push({path:m,score:YO(m,o.index),routesMeta:v})};return i.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let h of Tx(o.path))a(o,c,!0,h)}),e}function Tx(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=Tx(n.join("/")),c=[];return c.push(...o.map(h=>h===""?a:[a,h].join("/"))),s&&c.push(...o),c.map(h=>i.startsWith("/")&&h===""?"/":h)}function VO(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:XO(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var qO=/^:[\w-]+$/,HO=3,$O=2,GO=1,WO=10,KO=-2,tS=i=>i==="*";function YO(i,e){let t=i.split("/"),n=t.length;return t.some(tS)&&(n+=KO),e&&(n+=$O),t.filter(s=>!tS(s)).reduce((s,a)=>s+(qO.test(a)?HO:a===""?GO:WO),n)}function XO(i,e){return i.length===e.length&&i.slice(0,-1).every((n,s)=>n===e[s])?i[i.length-1]-e[e.length-1]:0}function QO(i,e,t=!1){let{routesMeta:n}=i,s={},a="/",o=[];for(let c=0;c<n.length;++c){let h=n[c],d=c===n.length-1,p=a==="/"?e:e.slice(a.length)||"/",m=bp({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},p),v=h.route;if(!m&&d&&t&&!n[n.length-1].route.index&&(m=bp({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:Dr([a,m.pathname]),pathnameBase:iP(Dr([a,m.pathnameBase])),route:v}),m.pathnameBase!=="/"&&(a=Dr([a,m.pathnameBase]))}return o}function bp(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=JO(i.path,i.caseSensitive,i.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:m},v)=>{if(p==="*"){let S=c[v]||"";o=a.slice(0,a.length-S.length).replace(/(.)\/+$/,"$1")}const _=c[v];return m&&!_?d[p]=void 0:d[p]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:i}}function JO(i,e=!1,t=!0){Js(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,h)=>(n.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function ZO(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Js(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Or(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}var eP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function tP(i,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof i=="string"?Oc(i):i,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=nS(t.substring(1),"/"):a=nS(t,e)):a=e,{pathname:a,search:sP(n),hash:rP(s)}}function nS(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function By(i,e,t,n){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nP(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function xx(i){let e=nP(i);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Cx(i,e,t,n=!1){let s;typeof i=="string"?s=Oc(i):(s={...i},Dt(!s.pathname||!s.pathname.includes("?"),By("?","pathname","search",s)),Dt(!s.pathname||!s.pathname.includes("#"),By("#","pathname","hash",s)),Dt(!s.search||!s.search.includes("#"),By("#","search","hash",s)));let a=i===""||s.pathname==="",o=a?"/":s.pathname,c;if(o==null)c=t;else{let m=e.length-1;if(!n&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),m-=1;s.pathname=v.join("/")}c=m>=0?e[m]:"/"}let h=tP(s,c),d=o&&o!=="/"&&o.endsWith("/"),p=(a||o===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(d||p)&&(h.pathname+="/"),h}var Dr=i=>i.join("/").replace(/\/\/+/g,"/"),iP=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),sP=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,rP=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,aP=class{constructor(i,e,t,n=!1){this.status=i,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function oP(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function lP(i){return i.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var kx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Rx(i,e){let t=i;if(typeof t!="string"||!eP.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,s=!1;if(kx)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Or(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:s=!0}catch{Js(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ix=["POST","PUT","PATCH","DELETE"];new Set(Ix);var cP=["GET",...Ix];new Set(cP);var Pc=Y.createContext(null);Pc.displayName="DataRouter";var Yp=Y.createContext(null);Yp.displayName="DataRouterState";var uP=Y.createContext(!1),Dx=Y.createContext({isTransitioning:!1});Dx.displayName="ViewTransition";var hP=Y.createContext(new Map);hP.displayName="Fetchers";var dP=Y.createContext(null);dP.displayName="Await";var $i=Y.createContext(null);$i.displayName="Navigation";var Fh=Y.createContext(null);Fh.displayName="Location";var nr=Y.createContext({outlet:null,matches:[],isDataRoute:!1});nr.displayName="Route";var t_=Y.createContext(null);t_.displayName="RouteError";var Ox="REACT_ROUTER_ERROR",fP="REDIRECT",pP="ROUTE_ERROR_RESPONSE";function mP(i){if(i.startsWith(`${Ox}:${fP}:{`))try{let e=JSON.parse(i.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function gP(i){if(i.startsWith(`${Ox}:${pP}:{`))try{let e=JSON.parse(i.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new aP(e.status,e.statusText,e.data)}catch{}}function yP(i,{relative:e}={}){Dt(zh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=Y.useContext($i),{hash:s,pathname:a,search:o}=Vh(i,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Dr([t,a])),n.createHref({pathname:c,search:o,hash:s})}function zh(){return Y.useContext(Fh)!=null}function jr(){return Dt(zh(),"useLocation() may be used only in the context of a <Router> component."),Y.useContext(Fh).location}var Px="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Nx(i){Y.useContext($i).static||Y.useLayoutEffect(i)}function Mx(){let{isDataRoute:i}=Y.useContext(nr);return i?DP():vP()}function vP(){Dt(zh(),"useNavigate() may be used only in the context of a <Router> component.");let i=Y.useContext(Pc),{basename:e,navigator:t}=Y.useContext($i),{matches:n}=Y.useContext(nr),{pathname:s}=jr(),a=JSON.stringify(xx(n)),o=Y.useRef(!1);return Nx(()=>{o.current=!0}),Y.useCallback((h,d={})=>{if(Js(o.current,Px),!o.current)return;if(typeof h=="number"){t.go(h);return}let p=Cx(h,JSON.parse(a),s,d.relative==="path");i==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Dr([e,p.pathname])),(d.replace?t.replace:t.push)(p,d.state,d)},[e,t,a,s,i])}Y.createContext(null);function bP(){let{matches:i}=Y.useContext(nr),e=i[i.length-1];return e?e.params:{}}function Vh(i,{relative:e}={}){let{matches:t}=Y.useContext(nr),{pathname:n}=jr(),s=JSON.stringify(xx(t));return Y.useMemo(()=>Cx(i,JSON.parse(s),n,e==="path"),[i,s,n,e])}function _P(i,e){return Lx(i,e)}function Lx(i,e,t,n,s){Dt(zh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=Y.useContext($i),{matches:o}=Y.useContext(nr),c=o[o.length-1],h=c?c.params:{},d=c?c.pathname:"/",p=c?c.pathnameBase:"/",m=c&&c.route;{let D=m&&m.path||"";Bx(d,!m||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let v=jr(),_;if(e){let D=typeof e=="string"?Oc(e):e;Dt(p==="/"||D.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${D.pathname}" was given in the \`location\` prop.`),_=D}else _=v;let S=_.pathname||"/",A=S;if(p!=="/"){let D=p.replace(/^\//,"").split("/");A="/"+S.replace(/^\//,"").split("/").slice(D.length).join("/")}let T=Ex(i,{pathname:A});Js(m||T!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Js(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=TP(T&&T.map(D=>Object.assign({},D,{params:Object.assign({},h,D.params),pathname:Dr([p,a.encodeLocation?a.encodeLocation(D.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?p:Dr([p,a.encodeLocation?a.encodeLocation(D.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathnameBase])})),o,t,n,s);return e&&x?Y.createElement(Fh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},x):x}function wP(){let i=IP(),e=oP(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",i),o=Y.createElement(Y.Fragment,null,Y.createElement("p",null," Hey developer "),Y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Y.createElement("code",{style:a},"ErrorBoundary")," or"," ",Y.createElement("code",{style:a},"errorElement")," prop on your route.")),Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},e),t?Y.createElement("pre",{style:s},t):null,o)}var AP=Y.createElement(wP,null),jx=class extends Y.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.onError?this.props.onError(i,e):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const t=gP(i.digest);t&&(i=t)}let e=i!==void 0?Y.createElement(nr.Provider,{value:this.props.routeContext},Y.createElement(t_.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?Y.createElement(EP,{error:i},e):e}};jx.contextType=uP;var Uy=new WeakMap;function EP({children:i,error:e}){let{basename:t}=Y.useContext($i);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=mP(e.digest);if(n){let s=Uy.get(e);if(s)throw s;let a=Rx(n.location,t);if(kx&&!Uy.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw Uy.set(e,o),o}return Y.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return i}function SP({routeContext:i,match:e,children:t}){let n=Y.useContext(Pc);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),Y.createElement(nr.Provider,{value:i},t)}function TP(i,e=[],t=null,n=null,s=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let a=i,o=t?.errors;if(o!=null){let p=a.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);Dt(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,p+1))}let c=!1,h=-1;if(t)for(let p=0;p<a.length;p++){let m=a[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=p),m.route.id){let{loaderData:v,errors:_}=t,S=m.route.loader&&!v.hasOwnProperty(m.route.id)&&(!_||_[m.route.id]===void 0);if(m.route.lazy||S){c=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}let d=t&&n?(p,m)=>{n(p,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:lP(t.matches),errorInfo:m})}:void 0;return a.reduceRight((p,m,v)=>{let _,S=!1,A=null,T=null;t&&(_=o&&m.route.id?o[m.route.id]:void 0,A=m.route.errorElement||AP,c&&(h<0&&v===0?(Bx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,T=null):h===v&&(S=!0,T=m.route.hydrateFallbackElement||null)));let x=e.concat(a.slice(0,v+1)),D=()=>{let I;return _?I=A:S?I=T:m.route.Component?I=Y.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=p,Y.createElement(SP,{match:m,routeContext:{outlet:p,matches:x,isDataRoute:t!=null},children:I})};return t&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?Y.createElement(jx,{location:t.location,revalidation:t.revalidation,component:A,error:_,children:D(),routeContext:{outlet:null,matches:x,isDataRoute:!0},onError:d}):D()},null)}function n_(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xP(i){let e=Y.useContext(Pc);return Dt(e,n_(i)),e}function CP(i){let e=Y.useContext(Yp);return Dt(e,n_(i)),e}function kP(i){let e=Y.useContext(nr);return Dt(e,n_(i)),e}function i_(i){let e=kP(i),t=e.matches[e.matches.length-1];return Dt(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function RP(){return i_("useRouteId")}function IP(){let i=Y.useContext(t_),e=CP("useRouteError"),t=i_("useRouteError");return i!==void 0?i:e.errors?.[t]}function DP(){let{router:i}=xP("useNavigate"),e=i_("useNavigate"),t=Y.useRef(!1);return Nx(()=>{t.current=!0}),Y.useCallback(async(s,a={})=>{Js(t.current,Px),t.current&&(typeof s=="number"?await i.navigate(s):await i.navigate(s,{fromRouteId:e,...a}))},[i,e])}var iS={};function Bx(i,e,t){!e&&!iS[i]&&(iS[i]=!0,Js(!1,t))}Y.memo(OP);function OP({routes:i,future:e,state:t,onError:n}){return Lx(i,void 0,t,n,e)}function ba(i){Dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function PP({basename:i="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:a=!1,unstable_useTransitions:o}){Dt(!zh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=i.replace(/^\/*/,"/"),h=Y.useMemo(()=>({basename:c,navigator:s,static:a,unstable_useTransitions:o,future:{}}),[c,s,a,o]);typeof t=="string"&&(t=Oc(t));let{pathname:d="/",search:p="",hash:m="",state:v=null,key:_="default"}=t,S=Y.useMemo(()=>{let A=Or(d,c);return A==null?null:{location:{pathname:A,search:p,hash:m,state:v,key:_},navigationType:n}},[c,d,p,m,v,_,n]);return Js(S!=null,`<Router basename="${c}"> is not able to match the URL "${d}${p}${m}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:Y.createElement($i.Provider,{value:h},Y.createElement(Fh.Provider,{children:e,value:S}))}function NP({children:i,location:e}){return _P(Gv(i),e)}function Gv(i,e=[]){let t=[];return Y.Children.forEach(i,(n,s)=>{if(!Y.isValidElement(n))return;let a=[...e,s];if(n.type===Y.Fragment){t.push.apply(t,Gv(n.props.children,a));return}Dt(n.type===ba,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Dt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Gv(n.props.children,a)),t.push(o)}),t}var sp="get",rp="application/x-www-form-urlencoded";function Xp(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function MP(i){return Xp(i)&&i.tagName.toLowerCase()==="button"}function LP(i){return Xp(i)&&i.tagName.toLowerCase()==="form"}function jP(i){return Xp(i)&&i.tagName.toLowerCase()==="input"}function BP(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function UP(i,e){return i.button===0&&(!e||e==="_self")&&!BP(i)}var Mf=null;function FP(){if(Mf===null)try{new FormData(document.createElement("form"),0),Mf=!1}catch{Mf=!0}return Mf}var zP=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Fy(i){return i!=null&&!zP.has(i)?(Js(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${rp}"`),null):i}function VP(i,e){let t,n,s,a,o;if(LP(i)){let c=i.getAttribute("action");n=c?Or(c,e):null,t=i.getAttribute("method")||sp,s=Fy(i.getAttribute("enctype"))||rp,a=new FormData(i)}else if(MP(i)||jP(i)&&(i.type==="submit"||i.type==="image")){let c=i.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=i.getAttribute("formaction")||c.getAttribute("action");if(n=h?Or(h,e):null,t=i.getAttribute("formmethod")||c.getAttribute("method")||sp,s=Fy(i.getAttribute("formenctype"))||Fy(c.getAttribute("enctype"))||rp,a=new FormData(c,i),!FP()){let{name:d,type:p,value:m}=i;if(p==="image"){let v=d?`${d}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else d&&a.append(d,m)}}else{if(Xp(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=sp,n=null,s=rp,o=i}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function s_(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function qP(i,e,t,n){let s=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${n}`:s.pathname=`${s.pathname}.${n}`:s.pathname==="/"?s.pathname=`_root.${n}`:e&&Or(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function HP(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $P(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function GP(i,e,t){let n=await Promise.all(i.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await HP(a,t);return o.links?o.links():[]}return[]}));return XP(n.flat(1).filter($P).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function sS(i,e,t,n,s,a){let o=(h,d)=>t[d]?h.route.id!==t[d].route.id:!0,c=(h,d)=>t[d].pathname!==h.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==h.params["*"];return a==="assets"?e.filter((h,d)=>o(h,d)||c(h,d)):a==="data"?e.filter((h,d)=>{let p=n.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(o(h,d)||c(h,d))return!0;if(h.route.shouldRevalidate){let m=h.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function WP(i,e,{includeHydrateFallback:t}={}){return KP(i.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function KP(i){return[...new Set(i)]}function YP(i){let e={},t=Object.keys(i).sort();for(let n of t)e[n]=i[n];return e}function XP(i,e){let t=new Set;return new Set(e),i.reduce((n,s)=>{let a=JSON.stringify(YP(s));return t.has(a)||(t.add(a),n.push({key:a,link:s})),n},[])}function Ux(){let i=Y.useContext(Pc);return s_(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function QP(){let i=Y.useContext(Yp);return s_(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var r_=Y.createContext(void 0);r_.displayName="FrameworkContext";function Fx(){let i=Y.useContext(r_);return s_(i,"You must render this element inside a <HydratedRouter> element"),i}function JP(i,e){let t=Y.useContext(r_),[n,s]=Y.useState(!1),[a,o]=Y.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:d,onMouseLeave:p,onTouchStart:m}=e,v=Y.useRef(null);Y.useEffect(()=>{if(i==="render"&&o(!0),i==="viewport"){let A=x=>{x.forEach(D=>{o(D.isIntersecting)})},T=new IntersectionObserver(A,{threshold:.5});return v.current&&T.observe(v.current),()=>{T.disconnect()}}},[i]),Y.useEffect(()=>{if(n){let A=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(A)}}},[n]);let _=()=>{s(!0)},S=()=>{s(!1),o(!1)};return t?i!=="intent"?[a,v,{}]:[a,v,{onFocus:Yu(c,_),onBlur:Yu(h,S),onMouseEnter:Yu(d,_),onMouseLeave:Yu(p,S),onTouchStart:Yu(m,_)}]:[!1,v,{}]}function Yu(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function ZP({page:i,...e}){let{router:t}=Ux(),n=Y.useMemo(()=>Ex(t.routes,i,t.basename),[t.routes,i,t.basename]);return n?Y.createElement(t2,{page:i,matches:n,...e}):null}function e2(i){let{manifest:e,routeModules:t}=Fx(),[n,s]=Y.useState([]);return Y.useEffect(()=>{let a=!1;return GP(i,e,t).then(o=>{a||s(o)}),()=>{a=!0}},[i,e,t]),n}function t2({page:i,matches:e,...t}){let n=jr(),{future:s,manifest:a,routeModules:o}=Fx(),{basename:c}=Ux(),{loaderData:h,matches:d}=QP(),p=Y.useMemo(()=>sS(i,e,d,a,n,"data"),[i,e,d,a,n]),m=Y.useMemo(()=>sS(i,e,d,a,n,"assets"),[i,e,d,a,n]),v=Y.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let A=new Set,T=!1;if(e.forEach(D=>{let I=a.routes[D.route.id];!I||!I.hasLoader||(!p.some(U=>U.route.id===D.route.id)&&D.route.id in h&&o[D.route.id]?.shouldRevalidate||I.hasClientLoader?T=!0:A.add(D.route.id))}),A.size===0)return[];let x=qP(i,c,s.unstable_trailingSlashAwareDataRequests,"data");return T&&A.size>0&&x.searchParams.set("_routes",e.filter(D=>A.has(D.route.id)).map(D=>D.route.id).join(",")),[x.pathname+x.search]},[c,s.unstable_trailingSlashAwareDataRequests,h,n,a,p,e,i,o]),_=Y.useMemo(()=>WP(m,a),[m,a]),S=e2(m);return Y.createElement(Y.Fragment,null,v.map(A=>Y.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...t})),_.map(A=>Y.createElement("link",{key:A,rel:"modulepreload",href:A,...t})),S.map(({key:A,link:T})=>Y.createElement("link",{key:A,nonce:t.nonce,...T,crossOrigin:T.crossOrigin??t.crossOrigin})))}function n2(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var i2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{i2&&(window.__reactRouterVersion="7.13.0")}catch{}function s2({basename:i,children:e,unstable_useTransitions:t,window:n}){let s=Y.useRef();s.current==null&&(s.current=jO({window:n,v5Compat:!0}));let a=s.current,[o,c]=Y.useState({action:a.action,location:a.location}),h=Y.useCallback(d=>{t===!1?c(d):Y.startTransition(()=>c(d))},[t]);return Y.useLayoutEffect(()=>a.listen(h),[a,h]),Y.createElement(PP,{basename:i,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var zx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bn=Y.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:c,target:h,to:d,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:v,..._},S){let{basename:A,unstable_useTransitions:T}=Y.useContext($i),x=typeof d=="string"&&zx.test(d),D=Rx(d,A);d=D.to;let I=yP(d,{relative:s}),[U,z,F]=JP(n,_),R=l2(d,{replace:o,state:c,target:h,preventScrollReset:p,relative:s,viewTransition:m,unstable_defaultShouldRevalidate:v,unstable_useTransitions:T});function O(j){e&&e(j),j.defaultPrevented||R(j)}let P=Y.createElement("a",{..._,...F,href:D.absoluteURL||I,onClick:D.isExternal||a?e:O,ref:n2(S,z),target:h,"data-discover":!x&&t==="render"?"true":void 0});return U&&!x?Y.createElement(Y.Fragment,null,P,Y.createElement(ZP,{page:I})):P});bn.displayName="Link";var r2=Y.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:c,children:h,...d},p){let m=Vh(o,{relative:d.relative}),v=jr(),_=Y.useContext(Yp),{navigator:S,basename:A}=Y.useContext($i),T=_!=null&&f2(m)&&c===!0,x=S.encodeLocation?S.encodeLocation(m).pathname:m.pathname,D=v.pathname,I=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;t||(D=D.toLowerCase(),I=I?I.toLowerCase():null,x=x.toLowerCase()),I&&A&&(I=Or(I,A)||I);const U=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let z=D===x||!s&&D.startsWith(x)&&D.charAt(U)==="/",F=I!=null&&(I===x||!s&&I.startsWith(x)&&I.charAt(x.length)==="/"),R={isActive:z,isPending:F,isTransitioning:T},O=z?e:void 0,P;typeof n=="function"?P=n(R):P=[n,z?"active":null,F?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let j=typeof a=="function"?a(R):a;return Y.createElement(bn,{...d,"aria-current":O,className:P,ref:p,style:j,to:o,viewTransition:c},typeof h=="function"?h(R):h)});r2.displayName="NavLink";var a2=Y.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:a,method:o=sp,action:c,onSubmit:h,relative:d,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:v,..._},S)=>{let{unstable_useTransitions:A}=Y.useContext($i),T=h2(),x=d2(c,{relative:d}),D=o.toLowerCase()==="get"?"get":"post",I=typeof c=="string"&&zx.test(c),U=z=>{if(h&&h(z),z.defaultPrevented)return;z.preventDefault();let F=z.nativeEvent.submitter,R=F?.getAttribute("formmethod")||o,O=()=>T(F||z.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:s,state:a,relative:d,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:v});A&&t!==!1?Y.startTransition(()=>O()):O()};return Y.createElement("form",{ref:S,method:D,action:x,onSubmit:n?h:U,..._,"data-discover":!I&&i==="render"?"true":void 0})});a2.displayName="Form";function o2(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Vx(i){let e=Y.useContext(Pc);return Dt(e,o2(i)),e}function l2(i,{target:e,replace:t,state:n,preventScrollReset:s,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:h}={}){let d=Mx(),p=jr(),m=Vh(i,{relative:a});return Y.useCallback(v=>{if(UP(v,e)){v.preventDefault();let _=t!==void 0?t:_h(p)===_h(m),S=()=>d(i,{replace:_,state:n,preventScrollReset:s,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});h?Y.startTransition(()=>S()):S()}},[p,d,m,t,n,e,i,s,a,o,c,h])}var c2=0,u2=()=>`__${String(++c2)}__`;function h2(){let{router:i}=Vx("useSubmit"),{basename:e}=Y.useContext($i),t=RP(),n=i.fetch,s=i.navigate;return Y.useCallback(async(a,o={})=>{let{action:c,method:h,encType:d,formData:p,body:m}=VP(a,e);if(o.navigate===!1){let v=o.fetcherKey||u2();await n(v,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:p,body:m,formMethod:o.method||h,formEncType:o.encType||d,flushSync:o.flushSync})}else await s(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:p,body:m,formMethod:o.method||h,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,s,e,t])}function d2(i,{relative:e}={}){let{basename:t}=Y.useContext($i),n=Y.useContext(nr);Dt(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...Vh(i||".",{relative:e})},o=jr();if(i==null){a.search=o.search;let c=new URLSearchParams(a.search),h=c.getAll("index");if(h.some(p=>p==="")){c.delete("index"),h.filter(m=>m).forEach(m=>c.append("index",m));let p=c.toString();a.search=p?`?${p}`:""}}return(!i||i===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Dr([t,a.pathname])),_h(a)}function f2(i,{relative:e}={}){let t=Y.useContext(Dx);Dt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Vx("useViewTransitionState"),s=Vh(i,{relative:e});if(!t.isTransitioning)return!1;let a=Or(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=Or(t.nextLocation.pathname,n)||t.nextLocation.pathname;return bp(s.pathname,o)!=null||bp(s.pathname,a)!=null}const qx="/assets/christ-logo-CVg186ow.png",Hx="/assets/dataart-museum-logo-PpA6Cx0U.jpg";function p2(){const e=jr().pathname,t=n=>e===n?"active":"";return w.jsx("header",{children:w.jsxs("nav",{children:[w.jsxs("div",{className:"logo-container",children:[w.jsx("img",{src:qx,alt:"Christ University Logo",className:"logo-christ"}),w.jsx("div",{className:"logo-separator"}),w.jsx("img",{src:Hx,alt:"IT Museum Logo",className:"logo-museum"})]}),w.jsxs("ul",{className:"nav-links",children:[w.jsx("li",{children:w.jsx(bn,{to:"/",className:t("/"),children:"Home"})}),w.jsx("li",{children:w.jsx(bn,{to:"/collection",className:t("/collection"),children:"Collection"})}),w.jsx("li",{children:w.jsx(bn,{to:"/team",className:t("/team"),children:"Team"})}),w.jsx("li",{children:w.jsx(bn,{to:"/contact",className:t("/contact"),children:"Contact"})}),w.jsx("li",{children:w.jsx(bn,{to:"/submission",style:{color:"var(--primary)",fontWeight:600},children:"Submit Article"})}),w.jsx("li",{children:w.jsx(bn,{to:"/admin",className:"admin-btn",children:"Admin"})})]})]})})}function m2(){return w.jsxs("footer",{className:"footer-retrospect",children:[w.jsxs("div",{className:"footer-content",children:[w.jsxs("div",{className:"footer-col",children:[w.jsx("h3",{children:"About the Project"}),w.jsx(bn,{to:"/",className:"footer-link",children:"Home"}),w.jsx(bn,{to:"/collection",className:"footer-link",children:"Digital Archive"}),w.jsx(bn,{to:"/team",className:"footer-link",children:"Curators"}),w.jsx(bn,{to:"/submission",className:"footer-link",children:"Submit Research"}),w.jsx(bn,{to:"/admin",className:"footer-link",children:"Admin Portal"})]}),w.jsxs("div",{className:"footer-col",children:[w.jsx("h3",{children:"About the Museum"}),w.jsx("p",{className:"footer-text",children:"The Christ University IT Museum is a historical project dedicated to exploring and promoting the IT engineering heritage in India. We aim to reconstruct the historical landscape surrounding significant engineering achievements and preserve the algorithmic beauty of Indian heritage."}),w.jsx("p",{className:"footer-text",children:"Where Tradition Meets Computation."}),w.jsx("a",{href:"https://retrospect.dataart.com",target:"_blank",rel:"noopener noreferrer",className:"retrospect-link",children:"Explore the history of data and computing at DataArt IT Museum"})]}),w.jsxs("div",{className:"footer-col",children:[w.jsx("h3",{children:"About Partners"}),w.jsx("div",{className:"footer-logo-container",children:w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px",marginBottom:"20px"},children:[w.jsx("img",{src:qx,alt:"Christ University",className:"footer-logo-img",style:{background:"white",padding:"5px",borderRadius:"4px",filter:"none"}}),w.jsx("img",{src:Hx,alt:"DataArt",className:"footer-logo-img",style:{borderRadius:"4px"}})]})}),w.jsxs("div",{className:"footer-text",style:{fontSize:"0.9rem"},children:[" Bangalore Yeshwanthpur Campus",w.jsx("br",{})," itmuseum@christuniversity.in",w.jsx("br",{})," 080 6989 6666"]}),w.jsxs("div",{style:{marginTop:"20px",display:"flex",gap:"15px"},children:[w.jsx("div",{className:"social-dot",style:{width:"25px",height:"25px"}}),w.jsx("div",{className:"social-dot",style:{width:"25px",height:"25px"}}),w.jsx("div",{className:"social-dot",style:{width:"25px",height:"25px"}})]})]})]}),w.jsxs("div",{className:"footer-bottom",children:[w.jsxs("p",{children:[" ",new Date().getFullYear()," IT Museum Christ University. All rights reserved."]}),w.jsx("p",{children:"Designed with algorithmic beauty and Gemini AI."})]})]})}function g2({children:i}){const t=jr().pathname==="/";return w.jsxs(w.Fragment,{children:[w.jsx(p2,{}),w.jsx("main",{className:t?"fade-in":"blue-theme fade-in",children:i}),w.jsx(m2,{})]})}function Nc(){Y.useEffect(()=>{const i={threshold:.1,rootMargin:"0px 0px -50px 0px"},e=new IntersectionObserver(n=>{n.forEach(s=>{s.isIntersecting&&(s.target.style.opacity="1",s.target.style.transform="translateY(0)")})},i);return document.querySelectorAll(".fade-in, .profile-card, .gallery-item, .card-premium").forEach(n=>{n.style.opacity||(n.style.opacity="0",n.style.transform="translateY(30px)",n.style.transition="opacity 0.6s ease, transform 0.6s ease"),e.observe(n)}),()=>e.disconnect()})}function Qp(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function y2(i,e,t,n){function s(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{d(n.next(p))}catch(m){o(m)}}function h(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(c,h)}d((n=n.apply(i,e||[])).next())})}const v2=i=>i?(...e)=>i(...e):(...e)=>fetch(...e);class a_ extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class b2 extends a_{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class rS extends a_{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class aS extends a_{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Wv;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Wv||(Wv={}));class _2{constructor(e,{headers:t={},customFetch:n,region:s=Wv.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=v2(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return y2(this,arguments,void 0,function*(t,n={}){var s;let a,o;try{const{headers:c,method:h,body:d,signal:p,timeout:m}=n;let v={},{region:_}=n;_||(_=this.region);const S=new URL(`${this.url}/${t}`);_&&_!=="any"&&(v["x-region"]=_,S.searchParams.set("forceFunctionRegion",_));let A;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",A=d):typeof d=="string"?(v["Content-Type"]="text/plain",A=d):typeof FormData<"u"&&d instanceof FormData?A=d:(v["Content-Type"]="application/json",A=JSON.stringify(d)):A=d;let T=p;m&&(o=new AbortController,a=setTimeout(()=>o.abort(),m),p?(T=o.signal,p.addEventListener("abort",()=>o.abort())):T=o.signal);const x=yield this.fetch(S.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),c),body:A,signal:T}).catch(z=>{throw new b2(z)}),D=x.headers.get("x-relay-error");if(D&&D==="true")throw new rS(x);if(!x.ok)throw new aS(x);let I=((s=x.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),U;return I==="application/json"?U=yield x.json():I==="application/octet-stream"||I==="application/pdf"?U=yield x.blob():I==="text/event-stream"?U=x:I==="multipart/form-data"?U=yield x.formData():U=yield x.text(),{data:U,error:null,response:x}}catch(c){return{data:null,error:c,response:c instanceof aS||c instanceof rS?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var w2=class extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}},A2=class{constructor(i){var e,t;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(e=i.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=i.signal,this.isMaybeSingle=(t=i.isMaybeSingle)!==null&&t!==void 0?t:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,e){return this.headers=new Headers(this.headers),this.headers.set(i,e),this}then(i,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let o=null,c=null,h=null,d=a.status,p=a.statusText;if(a.ok){var m,v;if(t.method!=="HEAD"){var _;const x=await a.text();x===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((_=t.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?c=x:c=JSON.parse(x))}const A=(m=t.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),T=(v=a.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");A&&T&&T.length>1&&(h=parseInt(T[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var S;const A=await a.text();try{o=JSON.parse(A),Array.isArray(o)&&a.status===404&&(c=[],o=null,d=200,p="OK")}catch{a.status===404&&A===""?(d=204,p="No Content"):o={message:A}}if(o&&t.isMaybeSingle&&(!(o==null||(S=o.details)===null||S===void 0)&&S.includes("0 rows"))&&(o=null,d=200,p="OK"),o&&t.shouldThrowOnError)throw new w2(o)}return{error:o,data:c,count:h,status:d,statusText:p}});return this.shouldThrowOnError||(s=s.catch(a=>{var o;let c="";const h=a?.cause;if(h){var d,p,m,v;const S=(d=h?.message)!==null&&d!==void 0?d:"",A=(p=h?.code)!==null&&p!==void 0?p:"";c=`${(m=a?.name)!==null&&m!==void 0?m:"FetchError"}: ${a?.message}`,c+=`

Caused by: ${(v=h?.name)!==null&&v!==void 0?v:"Error"}: ${S}`,A&&(c+=` (${A})`),h?.stack&&(c+=`
${h.stack}`)}else{var _;c=(_=a?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(o=a?.name)!==null&&o!==void 0?o:"FetchError"}: ${a?.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(i,e)}returns(){return this}overrideTypes(){return this}},E2=class extends A2{select(i){let e=!1;const t=(i??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:e=!0,nullsFirst:t,foreignTable:n,referencedTable:s=n}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${i}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:e,referencedTable:t=e}={}){const n=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(n,`${i}`),this}range(i,e,{foreignTable:t,referencedTable:n=t}={}){const s=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${i}`),this.url.searchParams.set(a,`${e-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:e=!1,settings:t=!1,buffers:n=!1,wal:s=!1,format:a="text"}={}){var o;const c=[i?"analyze":null,e?"verbose":null,t?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${h}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};const oS=new RegExp("[,()]");var Wl=class extends E2{eq(i,e){return this.url.searchParams.append(i,`eq.${e}`),this}neq(i,e){return this.url.searchParams.append(i,`neq.${e}`),this}gt(i,e){return this.url.searchParams.append(i,`gt.${e}`),this}gte(i,e){return this.url.searchParams.append(i,`gte.${e}`),this}lt(i,e){return this.url.searchParams.append(i,`lt.${e}`),this}lte(i,e){return this.url.searchParams.append(i,`lte.${e}`),this}like(i,e){return this.url.searchParams.append(i,`like.${e}`),this}likeAllOf(i,e){return this.url.searchParams.append(i,`like(all).{${e.join(",")}}`),this}likeAnyOf(i,e){return this.url.searchParams.append(i,`like(any).{${e.join(",")}}`),this}ilike(i,e){return this.url.searchParams.append(i,`ilike.${e}`),this}ilikeAllOf(i,e){return this.url.searchParams.append(i,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(i,e){return this.url.searchParams.append(i,`ilike(any).{${e.join(",")}}`),this}regexMatch(i,e){return this.url.searchParams.append(i,`match.${e}`),this}regexIMatch(i,e){return this.url.searchParams.append(i,`imatch.${e}`),this}is(i,e){return this.url.searchParams.append(i,`is.${e}`),this}isDistinct(i,e){return this.url.searchParams.append(i,`isdistinct.${e}`),this}in(i,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&oS.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(i,`in.(${t})`),this}notIn(i,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&oS.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(i,`not.in.(${t})`),this}contains(i,e){return typeof e=="string"?this.url.searchParams.append(i,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(i,`cs.{${e.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(e)}`),this}containedBy(i,e){return typeof e=="string"?this.url.searchParams.append(i,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(i,`cd.{${e.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(e)}`),this}rangeGt(i,e){return this.url.searchParams.append(i,`sr.${e}`),this}rangeGte(i,e){return this.url.searchParams.append(i,`nxl.${e}`),this}rangeLt(i,e){return this.url.searchParams.append(i,`sl.${e}`),this}rangeLte(i,e){return this.url.searchParams.append(i,`nxr.${e}`),this}rangeAdjacent(i,e){return this.url.searchParams.append(i,`adj.${e}`),this}overlaps(i,e){return typeof e=="string"?this.url.searchParams.append(i,`ov.${e}`):this.url.searchParams.append(i,`ov.{${e.join(",")}}`),this}textSearch(i,e,{config:t,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const a=t===void 0?"":`(${t})`;return this.url.searchParams.append(i,`${s}fts${a}.${e}`),this}match(i){return Object.entries(i).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(i,e,t){return this.url.searchParams.append(i,`not.${e}.${t}`),this}or(i,{foreignTable:e,referencedTable:t=e}={}){const n=t?`${t}.or`:"or";return this.url.searchParams.append(n,`(${i})`),this}filter(i,e,t){return this.url.searchParams.append(i,`${e}.${t}`),this}},S2=class{constructor(i,{headers:e={},schema:t,fetch:n}){this.url=i,this.headers=new Headers(e),this.schema=t,this.fetch=n}select(i,e){const{head:t=!1,count:n}=e??{},s=t?"HEAD":"GET";let a=!1;const o=(i??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new Wl({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:e,defaultToNull:t=!0}={}){var n;const s="POST";if(e&&this.headers.append("Prefer",`count=${e}`),t||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const a=i.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(a.length>0){const o=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Wl({method:s,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(i,{onConflict:e,ignoreDuplicates:t=!1,count:n,defaultToNull:s=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),n&&this.headers.append("Prefer",`count=${n}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const c=i.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new Wl({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(i,{count:e}={}){var t;const n="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new Wl({method:n,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:i}={}){var e;const t="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new Wl({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},T2=class $x{constructor(e,{headers:t={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new S2(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new $x(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:s=!1,count:a}={}){var o;let c;const h=new URL(`${this.url}/rpc/${e}`);let d;n||s?(c=n?"HEAD":"GET",Object.entries(t).filter(([m,v])=>v!==void 0).map(([m,v])=>[m,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([m,v])=>{h.searchParams.append(m,v)})):(c="POST",d=t);const p=new Headers(this.headers);return a&&p.set("Prefer",`count=${a}`),new Wl({method:c,url:h,headers:p,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class x2{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const n=t.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const C2="2.89.0",k2=`realtime-js/${C2}`,Gx="1.0.0",R2="2.0.0",lS=Gx,Kv=1e4,I2=1e3,D2=100;var _a;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(_a||(_a={}));var un;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(un||(un={}));var ls;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(ls||(ls={}));var Yv;(function(i){i.websocket="websocket"})(Yv||(Yv={}));var Co;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Co||(Co={}));class O2{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const s=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,n;const s=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,n){var s,a;const o=e.topic,c=(s=e.ref)!==null&&s!==void 0?s:"",h=(a=e.join_ref)!==null&&a!==void 0?a:"",d=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(p).length===0?"":JSON.stringify(p);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+c.length+o.length+d.length+m.length,_=new ArrayBuffer(this.HEADER_LENGTH+v);let S=new DataView(_),A=0;S.setUint8(A++,this.KINDS.userBroadcastPush),S.setUint8(A++,h.length),S.setUint8(A++,c.length),S.setUint8(A++,o.length),S.setUint8(A++,d.length),S.setUint8(A++,m.length),S.setUint8(A++,t),Array.from(h,x=>S.setUint8(A++,x.charCodeAt(0))),Array.from(c,x=>S.setUint8(A++,x.charCodeAt(0))),Array.from(o,x=>S.setUint8(A++,x.charCodeAt(0))),Array.from(d,x=>S.setUint8(A++,x.charCodeAt(0))),Array.from(m,x=>S.setUint8(A++,x.charCodeAt(0)));var T=new Uint8Array(_.byteLength+n.byteLength);return T.set(new Uint8Array(_),0),T.set(new Uint8Array(n),_.byteLength),T.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,a,o,c,h]=n;return t({join_ref:s,ref:a,topic:o,event:c,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),s=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,n){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),c=t.getUint8(4);let h=this.HEADER_LENGTH+4;const d=n.decode(e.slice(h,h+s));h=h+s;const p=n.decode(e.slice(h,h+a));h=h+a;const m=n.decode(e.slice(h,h+o));h=h+o;const v=e.slice(h,e.byteLength),_=c===this.JSON_ENCODING?JSON.parse(n.decode(v)):v,S={type:this.BROADCAST_EVENT,event:p,payload:_};return o>0&&(S.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:S}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class Wx{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var bt;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(bt||(bt={}));const cS=(i,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=P2(o,i,e,s),a),{}):{}},P2=(i,e,t,n)=>{const s=e.find(c=>c.name===i),a=s?.type,o=t[i];return a&&!n.includes(a)?Kx(a,o):Xv(o)},Kx=(i,e)=>{if(i.charAt(0)==="_"){const t=i.slice(1,i.length);return j2(e,t)}switch(i){case bt.bool:return N2(e);case bt.float4:case bt.float8:case bt.int2:case bt.int4:case bt.int8:case bt.numeric:case bt.oid:return M2(e);case bt.json:case bt.jsonb:return L2(e);case bt.timestamp:return B2(e);case bt.abstime:case bt.date:case bt.daterange:case bt.int4range:case bt.int8range:case bt.money:case bt.reltime:case bt.text:case bt.time:case bt.timestamptz:case bt.timetz:case bt.tsrange:case bt.tstzrange:return Xv(e);default:return Xv(e)}},Xv=i=>i,N2=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},M2=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},L2=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch{return i}return i},j2=(i,e)=>{if(typeof i!="string")return i;const t=i.length-1,n=i[t];if(i[0]==="{"&&n==="}"){let a;const o=i.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(c=>Kx(e,c))}return i},B2=i=>typeof i=="string"?i.replace(" ","T"):i,Yx=i=>{const e=new URL(i);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class zy{constructor(e,t,n={},s=Kv){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var uS;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(uS||(uS={}));class hh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hh.syncState(this.state,s,a,o),this.pendingDiffs.forEach(h=>{this.state=hh.syncDiff(this.state,h,a,o)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=hh.syncDiff(this.state,s,a,o),c())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const a=this.cloneDeep(e),o=this.transformState(t),c={},h={};return this.map(a,(d,p)=>{o[d]||(h[d]=p)}),this.map(o,(d,p)=>{const m=a[d];if(m){const v=p.map(T=>T.presence_ref),_=m.map(T=>T.presence_ref),S=p.filter(T=>_.indexOf(T.presence_ref)<0),A=m.filter(T=>v.indexOf(T.presence_ref)<0);S.length>0&&(c[d]=S),A.length>0&&(h[d]=A)}else c[d]=p}),this.syncDiff(a,{joins:c,leaves:h},n,s)}static syncDiff(e,t,n,s){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(c,h)=>{var d;const p=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(h),p.length>0){const m=e[c].map(_=>_.presence_ref),v=p.filter(_=>m.indexOf(_.presence_ref)<0);e[c].unshift(...v)}n(c,p,h)}),this.map(o,(c,h)=>{let d=e[c];if(!d)return;const p=h.map(m=>m.presence_ref);d=d.filter(m=>p.indexOf(m.presence_ref)<0),e[c]=d,s(c,d,h),d.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hS;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(hS||(hS={}));var dh;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(dh||(dh={}));var xr;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(xr||(xr={}));class ic{constructor(e,t={config:{}},n){var s,a;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=un.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new zy(this,ls.join,this.params,this.timeout),this.rejoinTimer=new Wx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=un.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=un.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=un.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=un.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=un.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ls.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new hh(this),this.broadcastEndpointURL=Yx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==un.closed){const{config:{broadcast:o,presence:c,private:h}}=this.params,d=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[dh.PRESENCE]&&this.bindings[dh.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},v={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(_=>e?.(xr.CHANNEL_ERROR,_)),this._onClose(()=>e?.(xr.CLOSED)),this.updateJoinPayload(Object.assign({config:v},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:_})=>{var S;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){e?.(xr.SUBSCRIBED);return}else{const A=this.bindings.postgres_changes,T=(S=A?.length)!==null&&S!==void 0?S:0,x=[];for(let D=0;D<T;D++){const I=A[D],{filter:{event:U,schema:z,table:F,filter:R}}=I,O=_&&_[D];if(O&&O.event===U&&ic.isFilterValueEqual(O.schema,z)&&ic.isFilterValueEqual(O.table,F)&&ic.isFilterValueEqual(O.filter,R))x.push(Object.assign(Object.assign({},I),{id:O.id}));else{this.unsubscribe(),this.state=un.errored,e?.(xr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(xr.SUBSCRIBED);return}}).receive("error",_=>{this.state=un.errored,e?.(xr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e?.(xr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===un.joined&&e===dh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let h=c.statusText;try{const d=await c.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,c,h;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=un.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ls.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new zy(this,ls.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=un.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new zy(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>D2){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,a;const o=e.toLocaleLowerCase(),{close:c,error:h,leave:d,join:p}=ls;if(n&&[c,h,d,p].indexOf(o)>=0&&n!==this._joinRef())return;let v=this._onMessage(o,t,n);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var S,A,T;return((S=_.filter)===null||S===void 0?void 0:S.event)==="*"||((T=(A=_.filter)===null||A===void 0?void 0:A.event)===null||T===void 0?void 0:T.toLocaleLowerCase())===o}).map(_=>_.callback(v,n)):(a=this.bindings[o])===null||a===void 0||a.filter(_=>{var S,A,T,x,D,I;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in _){const U=_.id,z=(S=_.filter)===null||S===void 0?void 0:S.event;return U&&((A=t.ids)===null||A===void 0?void 0:A.includes(U))&&(z==="*"||z?.toLocaleLowerCase()===((T=t.data)===null||T===void 0?void 0:T.type.toLocaleLowerCase()))}else{const U=(D=(x=_?.filter)===null||x===void 0?void 0:x.event)===null||D===void 0?void 0:D.toLocaleLowerCase();return U==="*"||U===((I=t?.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===o}).map(_=>{if(typeof v=="object"&&"ids"in v){const S=v.data,{schema:A,table:T,commit_timestamp:x,type:D,errors:I}=S;v=Object.assign(Object.assign({},{schema:A,table:T,commit_timestamp:x,eventType:D,new:{},old:{},errors:I}),this._getPayloadRecords(S))}_.callback(v,n)})}_isClosed(){return this.state===un.closed}_isJoined(){return this.state===un.joined}_isJoining(){return this.state===un.joining}_isLeaving(){return this.state===un.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&ic.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ls.close,{},e)}_onError(e){this._on(ls.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=un.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=cS(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=cS(e.columns,e.old_record)),t}}const Vy=()=>{},Lf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},U2=[1e3,2e3,5e3,1e4],F2=1e4,z2=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class V2{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Kv,this.transport=null,this.heartbeatIntervalMs=Lf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Vy,this.ref=0,this.reconnectTimer=null,this.vsn=lS,this.logger=Vy,this.conn=null,this.sendBuffer=[],this.serializer=new O2,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Yv.websocket}`,this.httpEndpoint=Yx(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=x2.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case _a.connecting:return Co.Connecting;case _a.open:return Co.Open;case _a.closing:return Co.Closing;default:return Co.Closed}}isConnected(){return this.connectionState()===Co.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new ic(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:n,payload:s,ref:a}=e,o=()=>{this.encode(e,c=>{var h;(h=this.conn)===null||h===void 0||h.send(c)})};this.log("push",`${t} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(I2,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Lf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=t,c=o?`(${o})`:"",h=a.status||"";this.log("receive",`${h} ${n} ${s} ${c}`.trim(),a),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===_a.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===_a.open||this.conn.readyState===_a.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ls.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([z2],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const a={access_token:t,version:k2};t&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(ls.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Wx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Lf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,a,o,c,h,d,p,m,v,_;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:Kv,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Lf.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Vy,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:lS,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(S=>U2[S-1]||F2),this.vsn){case Gx:this.encode=(p=e?.encode)!==null&&p!==void 0?p:((S,A)=>A(JSON.stringify(S))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:((S,A)=>A(JSON.parse(S)));break;case R2:this.encode=(v=e?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(_=e?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var wh=class extends Error{constructor(i,e){super(i),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function q2(i,e,t){const n=new URL(e,i);if(t)for(const[s,a]of Object.entries(t))a!==void 0&&n.searchParams.set(s,a);return n.toString()}async function H2(i){return!i||i.type==="none"?{}:i.type==="bearer"?{Authorization:`Bearer ${i.token}`}:i.type==="header"?{[i.name]:i.value}:i.type==="custom"?await i.getHeaders():{}}function $2(i){const e=i.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:s,body:a,headers:o}){const c=q2(i.baseUrl,n,s),h=await H2(i.auth),d=await e(c,{method:t,headers:{...a?{"Content-Type":"application/json"}:{},...h,...o},body:a?JSON.stringify(a):void 0}),p=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),v=m&&p?JSON.parse(p):p;if(!d.ok){const _=m?v:void 0,S=_?.error;throw new wh(S?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:S?.type,icebergCode:S?.code,details:_})}return{status:d.status,headers:d.headers,data:v}}}}function jf(i){return i.join("")}var G2=class{constructor(i,e=""){this.client=i,this.prefix=e}async listNamespaces(i){const e=i?{parent:jf(i.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(i,e){const t={namespace:i.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(i){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${jf(i.namespace)}`})}async loadNamespaceMetadata(i){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${jf(i.namespace)}`})).data.properties}}async namespaceExists(i){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${jf(i.namespace)}`}),!0}catch(e){if(e instanceof wh&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(i,e){try{return await this.createNamespace(i,e)}catch(t){if(t instanceof wh&&t.status===409)return;throw t}}};function Fl(i){return i.join("")}var W2=class{constructor(i,e="",t){this.client=i,this.prefix=e,this.accessDelegation=t}async listTables(i){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fl(i.namespace)}/tables`})).data.identifiers}async createTable(i,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fl(i.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(i,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fl(i.namespace)}/tables/${i.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(i,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Fl(i.namespace)}/tables/${i.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(i){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fl(i.namespace)}/tables/${i.name}`,headers:e})).data.metadata}async tableExists(i){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Fl(i.namespace)}/tables/${i.name}`,headers:e}),!0}catch(t){if(t instanceof wh&&t.status===404)return!1;throw t}}async createTableIfNotExists(i,e){try{return await this.createTable(i,e)}catch(t){if(t instanceof wh&&t.status===409)return await this.loadTable({namespace:i.namespace,name:e.name});throw t}}},K2=class{constructor(i){let e="v1";i.catalogName&&(e+=`/${i.catalogName}`);const t=i.baseUrl.endsWith("/")?i.baseUrl:`${i.baseUrl}/`;this.client=$2({baseUrl:t,auth:i.auth,fetchImpl:i.fetch}),this.accessDelegation=i.accessDelegation?.join(","),this.namespaceOps=new G2(this.client,e),this.tableOps=new W2(this.client,e,this.accessDelegation)}async listNamespaces(i){return this.namespaceOps.listNamespaces(i)}async createNamespace(i,e){return this.namespaceOps.createNamespace(i,e)}async dropNamespace(i){await this.namespaceOps.dropNamespace(i)}async loadNamespaceMetadata(i){return this.namespaceOps.loadNamespaceMetadata(i)}async listTables(i){return this.tableOps.listTables(i)}async createTable(i,e){return this.tableOps.createTable(i,e)}async updateTable(i,e){return this.tableOps.updateTable(i,e)}async dropTable(i,e){await this.tableOps.dropTable(i,e)}async loadTable(i){return this.tableOps.loadTable(i)}async namespaceExists(i){return this.namespaceOps.namespaceExists(i)}async tableExists(i){return this.tableOps.tableExists(i)}async createNamespaceIfNotExists(i,e){return this.namespaceOps.createNamespaceIfNotExists(i,e)}async createTableIfNotExists(i,e){return this.tableOps.createTableIfNotExists(i,e)}},Jp=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function It(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var Y2=class extends Jp{constructor(i,e,t){super(i),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Qv=class extends Jp{constructor(i,e){super(i),this.name="StorageUnknownError",this.originalError=e}};const o_=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),X2=()=>Response,Jv=i=>{if(Array.isArray(i))return i.map(t=>Jv(t));if(typeof i=="function"||i!==Object(i))return i;const e={};return Object.entries(i).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=Jv(n)}),e},Q2=i=>{if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},J2=i=>!i||typeof i!="string"||i.length===0||i.length>100||i.trim()!==i||i.includes("/")||i.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(i);function Ah(i){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ah(i)}function Z2(i,e){if(Ah(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Ah(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function eN(i){var e=Z2(i,"string");return Ah(e)=="symbol"?e:e+""}function tN(i,e,t){return(e=eN(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function dS(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function Ie(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dS(Object(t),!0).forEach(function(n){tN(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):dS(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}const qy=i=>{var e;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(e=i.error)===null||e===void 0?void 0:e.message)||JSON.stringify(i)},nN=async(i,e,t)=>{i instanceof await X2()&&!t?.noResolveJson?i.json().then(n=>{const s=i.status||500,a=n?.statusCode||s+"";e(new Y2(qy(n),s,a))}).catch(n=>{e(new Qv(qy(n),n))}):e(new Qv(qy(i),i))},iN=(i,e,t,n)=>{const s={method:i,headers:e?.headers||{}};return i==="GET"||!n?s:(Q2(n)?(s.headers=Ie({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n)):s.body=n,e?.duplex&&(s.duplex=e.duplex),Ie(Ie({},s),t))};async function qh(i,e,t,n,s,a){return new Promise((o,c)=>{i(t,iN(e,n,s,a)).then(h=>{if(!h.ok)throw h;return n?.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>nN(h,c,n))})}async function Eh(i,e,t,n){return qh(i,"GET",e,t,n)}async function as(i,e,t,n,s){return qh(i,"POST",e,n,s,t)}async function Zv(i,e,t,n,s){return qh(i,"PUT",e,n,s,t)}async function sN(i,e,t,n){return qh(i,"HEAD",e,Ie(Ie({},t),{},{noResolveJson:!0}),n)}async function l_(i,e,t,n,s){return qh(i,"DELETE",e,n,s,t)}var rN=class{constructor(i,e){this.downloadFn=i,this.shouldThrowOnError=e}then(i,e){return this.execute().then(i,e)}async execute(){var i=this;try{return{data:(await i.downloadFn()).body,error:null}}catch(e){if(i.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}}};let Xx;Xx=Symbol.toStringTag;var aN=class{constructor(i,e){this.downloadFn=i,this.shouldThrowOnError=e,this[Xx]="BlobDownloadBuilder",this.promise=null}asStream(){return new rN(this.downloadFn,this.shouldThrowOnError)}then(i,e){return this.getPromise().then(i,e)}catch(i){return this.getPromise().catch(i)}finally(i){return this.getPromise().finally(i)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var i=this;try{return{data:await(await i.downloadFn()).blob(),error:null}}catch(e){if(i.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}}};const oN={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var lN=class{constructor(i,e={},t,n){this.shouldThrowOnError=!1,this.url=i,this.headers=e,this.bucketId=t,this.fetch=o_(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(i,e,t,n){var s=this;try{let a;const o=Ie(Ie({},fS),n);let c=Ie(Ie({},s.headers),i==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),h&&a.append("metadata",s.encodeMetadata(h)),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),h&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(h))):(a=t,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,h&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(c=Ie(Ie({},c),n.headers));const d=s._removeEmptyFolders(e),p=s._getFinalPath(d),m=await(i=="PUT"?Zv:as)(s.fetch,`${s.url}/object/${p}`,a,Ie({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}}async upload(i,e,t){return this.uploadOrUpdate("POST",i,e,t)}async uploadToSignedUrl(i,e,t,n){var s=this;const a=s._removeEmptyFolders(i),o=s._getFinalPath(a),c=new URL(s.url+`/object/upload/sign/${o}`);c.searchParams.set("token",e);try{let h;const d=Ie({upsert:fS.upsert},n),p=Ie(Ie({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&t instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",t)):typeof FormData<"u"&&t instanceof FormData?(h=t,h.append("cacheControl",d.cacheControl)):(h=t,p["cache-control"]=`max-age=${d.cacheControl}`,p["content-type"]=d.contentType),{data:{path:a,fullPath:(await Zv(s.fetch,c.toString(),h,{headers:p})).Key},error:null}}catch(h){if(s.shouldThrowOnError)throw h;if(It(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(i,e){var t=this;try{let n=t._getFinalPath(i);const s=Ie({},t.headers);e?.upsert&&(s["x-upsert"]="true");const a=await as(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(t.url+a.url),c=o.searchParams.get("token");if(!c)throw new Jp("No token returned by API");return{data:{signedUrl:o.toString(),path:i,token:c},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async update(i,e,t){return this.uploadOrUpdate("PUT",i,e,t)}async move(i,e,t){var n=this;try{return{data:await as(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}}async copy(i,e,t){var n=this;try{return{data:{path:(await as(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:n.headers})).Key},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}}async createSignedUrl(i,e,t){var n=this;try{let s=n._getFinalPath(i),a=await as(n.fetch,`${n.url}/object/sign/${s}`,Ie({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:n.headers});const o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}}async createSignedUrls(i,e,t){var n=this;try{const s=await as(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:i},{headers:n.headers}),a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:s.map(o=>Ie(Ie({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}}download(i,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(e?.transform||{}),s=n?`?${n}`:"",a=this._getFinalPath(i),o=()=>Eh(this.fetch,`${this.url}/${t}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new aN(o,this.shouldThrowOnError)}async info(i){var e=this;const t=e._getFinalPath(i);try{return{data:Jv(await Eh(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async exists(i){var e=this;const t=e._getFinalPath(i);try{return await sN(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(It(n)&&n instanceof Qv){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}}getPublicUrl(i,e){const t=this._getFinalPath(i),n=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&n.push(s);const a=typeof e?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(e?.transform||{});o!==""&&n.push(o);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${c}`)}}}async remove(i){var e=this;try{return{data:await l_(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:i},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async list(i,e,t){var n=this;try{const s=Ie(Ie(Ie({},oN),e),{},{prefix:i||""});return{data:await as(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},t),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}}async listV2(i,e){var t=this;try{const n=Ie({},i);return{data:await as(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},e),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const e=[];return i.width&&e.push(`width=${i.width}`),i.height&&e.push(`height=${i.height}`),i.resize&&e.push(`resize=${i.resize}`),i.format&&e.push(`format=${i.format}`),i.quality&&e.push(`quality=${i.quality}`),e.join("&")}};const Qx="2.89.0",Jx={"X-Client-Info":`storage-js/${Qx}`};var cN=class{constructor(i,e={},t,n){this.shouldThrowOnError=!1;const s=new URL(i);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Ie(Ie({},Jx),e),this.fetch=o_(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(i){var e=this;try{const t=e.listBucketOptionsToQueryString(i);return{data:await Eh(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async getBucket(i){var e=this;try{return{data:await Eh(e.fetch,`${e.url}/bucket/${i}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async createBucket(i,e={public:!1}){var t=this;try{return{data:await as(t.fetch,`${t.url}/bucket`,{id:i,name:i,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async updateBucket(i,e){var t=this;try{return{data:await Zv(t.fetch,`${t.url}/bucket/${i}`,{id:i,name:i,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async emptyBucket(i){var e=this;try{return{data:await as(e.fetch,`${e.url}/bucket/${i}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async deleteBucket(i){var e=this;try{return{data:await l_(e.fetch,`${e.url}/bucket/${i}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(i){const e={};return i&&("limit"in i&&(e.limit=String(i.limit)),"offset"in i&&(e.offset=String(i.offset)),i.search&&(e.search=i.search),i.sortColumn&&(e.sortColumn=i.sortColumn),i.sortOrder&&(e.sortOrder=i.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},uN=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=Ie(Ie({},Jx),e),this.fetch=o_(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(i){var e=this;try{return{data:await as(e.fetch,`${e.url}/bucket`,{name:i},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async listBuckets(i){var e=this;try{const t=new URLSearchParams;i?.limit!==void 0&&t.set("limit",i.limit.toString()),i?.offset!==void 0&&t.set("offset",i.offset.toString()),i?.sortColumn&&t.set("sortColumn",i.sortColumn),i?.sortOrder&&t.set("sortOrder",i.sortOrder),i?.search&&t.set("search",i.search);const n=t.toString(),s=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await Eh(e.fetch,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async deleteBucket(i){var e=this;try{return{data:await l_(e.fetch,`${e.url}/bucket/${i}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}from(i){var e=this;if(!J2(i))throw new Jp("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new K2({baseUrl:this.url,catalogName:i,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(s,a){const o=s[a];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(s,c),error:null}}catch(h){if(n)throw h;return{data:null,error:h}}}}})}};const c_={"X-Client-Info":`storage-js/${Qx}`,"Content-Type":"application/json"};var Zx=class extends Error{constructor(i){super(i),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function _i(i){return typeof i=="object"&&i!==null&&"__isStorageVectorsError"in i}var Hy=class extends Zx{constructor(i,e,t){super(i),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},hN=class extends Zx{constructor(i,e){super(i),this.name="StorageVectorsUnknownError",this.originalError=e}};const u_=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),dN=i=>{if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},pS=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),fN=async(i,e,t)=>{if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!t?.noResolveJson){const n=i.status||500,s=i;if(typeof s.json=="function")s.json().then(a=>{const o=a?.statusCode||a?.code||n+"";e(new Hy(pS(a),n,o))}).catch(()=>{const a=n+"";e(new Hy(s.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";e(new Hy(s.statusText||`HTTP ${n} error`,n,a))}}else e(new hN(pS(i),i))},pN=(i,e,t,n)=>{const s={method:i,headers:e?.headers||{}};return n?(dN(n)?(s.headers=Ie({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n)):s.body=n,Ie(Ie({},s),t)):s};async function mN(i,e,t,n,s,a){return new Promise((o,c)=>{i(t,pN(e,n,s,a)).then(h=>{if(!h.ok)throw h;if(n?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>o(h)).catch(h=>fN(h,c,n))})}async function wi(i,e,t,n,s){return mN(i,"POST",e,n,s,t)}var gN=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=Ie(Ie({},c_),e),this.fetch=u_(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/CreateIndex`,i,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async getIndex(i,e){var t=this;try{return{data:await wi(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:i,indexName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(_i(n))return{data:null,error:n};throw n}}async listIndexes(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/ListIndexes`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async deleteIndex(i,e){var t=this;try{return{data:await wi(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:i,indexName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(_i(n))return{data:null,error:n};throw n}}},yN=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=Ie(Ie({},c_),e),this.fetch=u_(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(i){var e=this;try{if(i.vectors.length<1||i.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await wi(e.fetch,`${e.url}/PutVectors`,i,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async getVectors(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/GetVectors`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async listVectors(i){var e=this;try{if(i.segmentCount!==void 0){if(i.segmentCount<1||i.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(i.segmentIndex!==void 0&&(i.segmentIndex<0||i.segmentIndex>=i.segmentCount))throw new Error(`segmentIndex must be between 0 and ${i.segmentCount-1}`)}return{data:await wi(e.fetch,`${e.url}/ListVectors`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async queryVectors(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/QueryVectors`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async deleteVectors(i){var e=this;try{if(i.keys.length<1||i.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await wi(e.fetch,`${e.url}/DeleteVectors`,i,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}},vN=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=Ie(Ie({},c_),e),this.fetch=u_(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:i},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async getBucket(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:i},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async listBuckets(i={}){var e=this;try{return{data:await wi(e.fetch,`${e.url}/ListVectorBuckets`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}async deleteBucket(i){var e=this;try{return{data:await wi(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:i},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(_i(t))return{data:null,error:t};throw t}}},bN=class extends vN{constructor(i,e={}){super(i,e.headers||{},e.fetch)}from(i){return new _N(this.url,this.headers,i,this.fetch)}async createBucket(i){var e=()=>super.createBucket,t=this;return e().call(t,i)}async getBucket(i){var e=()=>super.getBucket,t=this;return e().call(t,i)}async listBuckets(i={}){var e=()=>super.listBuckets,t=this;return e().call(t,i)}async deleteBucket(i){var e=()=>super.deleteBucket,t=this;return e().call(t,i)}},_N=class extends gN{constructor(i,e,t,n){super(i,e,n),this.vectorBucketName=t}async createIndex(i){var e=()=>super.createIndex,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(i={}){var e=()=>super.listIndexes,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(i){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,i)}async deleteIndex(i){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,i)}index(i){return new wN(this.url,this.headers,this.vectorBucketName,i,this.fetch)}},wN=class extends yN{constructor(i,e,t,n,s){super(i,e,s),this.vectorBucketName=t,this.indexName=n}async putVectors(i){var e=()=>super.putVectors,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(i){var e=()=>super.getVectors,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(i={}){var e=()=>super.listVectors,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(i){var e=()=>super.queryVectors,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(i){var e=()=>super.deleteVectors,t=this;return e().call(t,Ie(Ie({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},AN=class extends cN{constructor(i,e={},t,n){super(i,e,t,n)}from(i){return new lN(this.url,this.headers,i,this.fetch)}get vectors(){return new bN(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new uN(this.url+"/iceberg",this.headers,this.fetch)}};const eC="2.89.0",Kl=30*1e3,eb=3,$y=eb*Kl,EN="http://localhost:9999",SN="supabase.auth.token",TN={"X-Client-Info":`gotrue-js/${eC}`},tb="X-Supabase-Api-Version",tC={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},xN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,CN=600*1e3;class Sh extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function _e(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class kN extends Sh{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function RN(i){return _e(i)&&i.name==="AuthApiError"}class ko extends Sh{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Br extends Sh{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class mi extends Br{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function IN(i){return _e(i)&&i.name==="AuthSessionMissingError"}class zl extends Br{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bf extends Br{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Uf extends Br{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function DN(i){return _e(i)&&i.name==="AuthImplicitGrantRedirectError"}class mS extends Br{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ON extends Br{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class nb extends Br{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Gy(i){return _e(i)&&i.name==="AuthRetryableFetchError"}class gS extends Br{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class ib extends Br{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const _p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yS=` 	
\r=`.split(""),PN=(()=>{const i=new Array(128);for(let e=0;e<i.length;e+=1)i[e]=-1;for(let e=0;e<yS.length;e+=1)i[yS[e].charCodeAt(0)]=-2;for(let e=0;e<_p.length;e+=1)i[_p[e].charCodeAt(0)]=e;return i})();function vS(i,e,t){if(i!==null)for(e.queue=e.queue<<8|i,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(_p[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(_p[n]),e.queuedBits-=6}}function nC(i,e,t){const n=PN[i];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function bS(i){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{LN(o,n,t)};for(let o=0;o<i.length;o+=1)nC(i.charCodeAt(o),s,a);return e.join("")}function NN(i,e){if(i<=127){e(i);return}else if(i<=2047){e(192|i>>6),e(128|i&63);return}else if(i<=65535){e(224|i>>12),e(128|i>>6&63),e(128|i&63);return}else if(i<=1114111){e(240|i>>18),e(128|i>>12&63),e(128|i>>6&63),e(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function MN(i,e){for(let t=0;t<i.length;t+=1){let n=i.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(i.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}NN(n,e)}}function LN(i,e,t){if(e.utf8seq===0){if(i<=127){t(i);return}for(let n=1;n<6;n+=1)if((i>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=i&31;else if(e.utf8seq===3)e.codepoint=i&15;else if(e.utf8seq===4)e.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|i&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function lc(i){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<i.length;s+=1)nC(i.charCodeAt(s),t,n);return new Uint8Array(e)}function jN(i){const e=[];return MN(i,t=>e.push(t)),new Uint8Array(e)}function Io(i){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return i.forEach(s=>vS(s,t,n)),vS(null,t,n),e.join("")}function BN(i){return Math.round(Date.now()/1e3)+i}function UN(){return Symbol("auth-callback")}const kn=()=>typeof window<"u"&&typeof document<"u",Eo={tested:!1,writable:!1},iC=()=>{if(!kn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eo.tested)return Eo.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Eo.tested=!0,Eo.writable=!0}catch{Eo.tested=!0,Eo.writable=!1}return Eo.writable};function FN(i){const e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const sC=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),zN=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Yl=async(i,e,t)=>{await i.setItem(e,JSON.stringify(t))},So=async(i,e)=>{const t=await i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Cn=async(i,e)=>{await i.removeItem(e)};let rC=class aC{constructor(){this.promise=new aC.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}};rC.promiseConstructor=Promise;function Wy(i){const e=i.split(".");if(e.length!==3)throw new ib("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!xN.test(e[n]))throw new ib("JWT not in base64url format");return{header:JSON.parse(bS(e[0])),payload:JSON.parse(bS(e[1])),signature:lc(e[2]),raw:{header:e[0],payload:e[1]}}}async function VN(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function qN(i,e){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await i(a);if(!e(a,null,o)){n(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function HN(i){return("0"+i.toString(16)).substr(-2)}function $N(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,HN).join("")}async function GN(i){const t=new TextEncoder().encode(i),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function WN(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const t=await GN(i);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vl(i,e,t=!1){const n=$N();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await Yl(i,`${e}-code-verifier`,s);const a=await WN(n);return[a,n===a?"plain":"s256"]}const KN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function YN(i){const e=i.headers.get(tb);if(!e||!e.match(KN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function XN(i){if(!i)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(i<=e)throw new Error("JWT has expired")}function QN(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const JN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ql(i){if(!JN.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ky(){const i={};return new Proxy(i,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ZN(i,e){return new Proxy(i,{get:(t,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,s)}})}function _S(i){return JSON.parse(JSON.stringify(i))}const To=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),eM=[502,503,504];async function wS(i){var e;if(!zN(i))throw new nb(To(i),0);if(eM.includes(i.status))throw new nb(To(i),i.status);let t;try{t=await i.json()}catch(a){throw new ko(To(a),a)}let n;const s=YN(i);if(s&&s.getTime()>=tC["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new gS(To(t),i.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new mi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new gS(To(t),i.status,t.weak_password.reasons);throw new kN(To(t),i.status||500,n)}const tM=(i,e,t,n)=>{const s={method:i,headers:e?.headers||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function Re(i,e,t,n){var s;const a=Object.assign({},n?.headers);a[tb]||(a[tb]=tC["2024-01-01"].name),n?.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await nM(i,e,t+c,{headers:a,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(h):{data:Object.assign({},h),error:null}}async function nM(i,e,t,n,s,a){const o=tM(e,n,s,a);let c;try{c=await i(t,Object.assign({},o))}catch(h){throw console.error(h),new nb(To(h),0)}if(c.ok||await wS(c),n?.noResolveJson)return c;try{return await c.json()}catch(h){await wS(h)}}function rs(i){var e;let t=null;rM(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=BN(i.expires_in)));const n=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:n},error:null}}function AS(i){const e=rs(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=i.weak_password),e}function wa(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function iM(i){return{data:i,error:null}}function sM(i){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:a}=i,o=Qp(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:a},h=Object.assign({},o);return{data:{properties:c,user:h},error:null}}function ES(i){return i}function rM(i){return i.access_token&&i.refresh_token&&i.expires_in}const Yy=["global","local","others"];class aM{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=sC(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Yy[0]){if(Yy.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yy.join(", ")}`);try{return await Re(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Re(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:wa})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Qp(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await Re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:sM,redirectTo:t?.redirectTo})}catch(t){if(_e(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:wa})}catch(t){if(_e(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,a,o,c,h;try{const d={nextPage:null,lastPage:0,total:0},p=await Re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:ES});if(p.error)throw p.error;const m=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(S=>{const A=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(S.split(";")[1].split("=")[1]);d[`${T}Page`]=A}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(_e(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){ql(e);try{return await Re(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:wa})}catch(t){if(_e(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ql(e);try{return await Re(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:wa})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){ql(e);try{return await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:wa})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){ql(e.userId);try{const{data:t,error:n}=await Re(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ql(e.userId),ql(e.id);try{return{data:await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,s,a,o,c,h;try{const d={nextPage:null,lastPage:0,total:0},p=await Re(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:ES});if(p.error)throw p.error;const m=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(S=>{const A=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(S.split(";")[1].split("=")[1]);d[`${T}Page`]=A}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(_e(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Re(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Re(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(_e(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await Re(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_e(t))return{data:null,error:t};throw t}}}function SS(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}const Hl={debug:!!(globalThis&&iC()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class oC extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class oM extends oC{}async function lM(i,e,t){Hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Hl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,s.name);try{return await t()}finally{Hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,s.name)}}else{if(e===0)throw Hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new oM(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Hl.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function cM(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function lC(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function uM(i){return parseInt(i,16)}function hM(i){const e=new TextEncoder().encode(i);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function dM(i){var e;const{chainId:t,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:c,requestId:h,resources:d,scheme:p,uri:m,version:v}=i;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((e=i.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const _=lC(i.address),S=p?`${p}://${n}`:n,A=i.statement?`${i.statement}
`:"",T=`${S} wants you to sign in with your Ethereum account:
${_}

${A}`;let x=`URI: ${m}
Version: ${v}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(x+=`
Expiration Time: ${s.toISOString()}`),c&&(x+=`
Not Before: ${c.toISOString()}`),h&&(x+=`
Request ID: ${h}`),d){let D=`
Resources:`;for(const I of d){if(!I||typeof I!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${I}`);D+=`
- ${I}`}x+=D}return`${T}
${x}`}class sn extends Error{constructor({message:e,code:t,cause:n,name:s}){var a;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class wp extends sn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function fM({error:i,options:e}){var t,n,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(e.signal instanceof AbortSignal)return new sn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new sn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(e.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new sn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new sn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new sn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new sn({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new sn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new sn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const o=window.location.hostname;if(cC(o)){if(a.rp.id!==o)return new sn({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new sn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new sn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new sn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new sn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function pM({error:i,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(e.signal instanceof AbortSignal)return new sn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new sn({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const n=window.location.hostname;if(cC(n)){if(t.rpId!==n)return new sn({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new sn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new sn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new sn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class mM{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const gM=new mM;function yM(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:e,user:t,excludeCredentials:n}=i,s=Qp(i,["challenge","user","excludeCredentials"]),a=lc(e).buffer,o=Object.assign(Object.assign({},t),{id:lc(t.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:a,user:o});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let h=0;h<n.length;h++){const d=n[h];c.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:lc(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function vM(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:e,allowCredentials:t}=i,n=Qp(i,["challenge","allowCredentials"]),s=lc(e).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const c=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},c),{id:lc(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function bM(i){var e;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const t=i;return{id:i.id,rawId:i.id,response:{attestationObject:Io(new Uint8Array(i.response.attestationObject)),clientDataJSON:Io(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function _M(i){var e;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const t=i,n=i.getClientExtensionResults(),s=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:Io(new Uint8Array(s.authenticatorData)),clientDataJSON:Io(new Uint8Array(s.clientDataJSON)),signature:Io(new Uint8Array(s.signature)),userHandle:s.userHandle?Io(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function cC(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function TS(){var i,e;return!!(kn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function wM(i){try{const e=await navigator.credentials.create(i);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new wp("Browser returned unexpected credential type",e)}:{data:null,error:new wp("Empty credential response",e)}}catch(e){return{data:null,error:fM({error:e,options:i})}}}async function AM(i){try{const e=await navigator.credentials.get(i);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new wp("Browser returned unexpected credential type",e)}:{data:null,error:new wp("Empty credential response",e)}}catch(e){return{data:null,error:pM({error:e,options:i})}}}const EM={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},SM={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ap(...i){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of i)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(t(o))n[a]=o;else if(e(o)){const c=n[a];e(c)?n[a]=Ap(c,o):n[a]=Ap(o)}else n[a]=o}return n}function TM(i,e){return Ap(EM,i,e||{})}function xM(i,e){return Ap(SM,i,e||{})}class CM{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:s},a){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:c};const h=s??gM.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=TM(o.webauthn.credential_options.publicKey,a?.create),{data:p,error:m}=await wM({publicKey:d,signal:h});return p?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}case"request":{const d=xM(o.webauthn.credential_options.publicKey,a?.request),{data:p,error:m}=await AM(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:h}));return p?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}}}catch(o){return _e(o)?{data:null,error:o}:{data:null,error:new ko("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new Sh("rpId is required for WebAuthn authentication")};try{if(!TS())return{data:null,error:new ko("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:s},{request:a});if(!o)return{data:null,error:c};const{webauthn:h}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:n,credential_response:h.credential_response}})}catch(o){return _e(o)?{data:null,error:o}:{data:null,error:new ko("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new Sh("rpId is required for WebAuthn registration")};try{if(!TS())return{data:null,error:new ko("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(p=>{var m;return(m=p.data)===null||m===void 0?void 0:m.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===e&&v.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:c};const{data:h,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:s},{create:a});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:n,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(o){return _e(o)?{data:null,error:o}:{data:null,error:new ko("Unexpected error in register",o)}}}}cM();const kM={url:EN,storageKey:SN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:TN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function xS(i,e,t){return await t()}const $l={};class Th{get jwks(){var e,t;return(t=(e=$l[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){$l[this.storageKey]=Object.assign(Object.assign({},$l[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=$l[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$l[this.storageKey]=Object.assign(Object.assign({},$l[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},kM),e);if(this.storageKey=a.storageKey,this.instanceID=(t=Th.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Th.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&kn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new aM({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=sC(a.fetch),this.lock=a.lock||xS,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&kn()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=lM:this.lock=xS,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new CM(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:iC()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=SS(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=SS(this.memoryStorage)),kn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${eC}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(kn()&&(t=FN(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),kn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),DN(a)){const h=(e=a.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return _e(t)?this._returnResult({error:t}):this._returnResult({error:new ko("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const a=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:rs}),{data:o,error:c}=a;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(a){if(_e(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,n,s;try{let a;if("email"in e){const{email:p,password:m,options:v}=e;let _=null,S=null;this.flowType==="pkce"&&([_,S]=await Vl(this.storage,this.storageKey)),a=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:p,password:m,data:(t=v?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:_,code_challenge_method:S},xform:rs})}else if("phone"in e){const{phone:p,password:m,options:v}=e;a=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(n=v?.data)!==null&&n!==void 0?n:{},channel:(s=v?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:rs})}else throw new Bf("You must provide either an email or phone number and a password");const{data:o,error:c}=a;if(c||!o)return await Cn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(a){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:c}=e;t=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:AS})}else if("phone"in e){const{phone:a,password:o,options:c}=e;t=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:AS})}else throw new Bf("You must provide either an email or phone number and a password");const{data:n,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const a=new zl;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,s,a,o,c,h,d,p,m,v;let _,S;if("message"in e)_=e.message,S=e.signature;else{const{chain:A,wallet:T,statement:x,options:D}=e;let I;if(kn())if(typeof T=="object")I=T;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")I=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!D?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=T}const U=new URL((t=D?.url)!==null&&t!==void 0?t:window.location.href),z=await I.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!z||z.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const F=lC(z[0]);let R=(n=D?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!R){const P=await I.request({method:"eth_chainId"});R=uM(P)}const O={domain:U.host,address:F,statement:x,uri:U.href,version:"1",chainId:R,nonce:(s=D?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=D?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=D?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(h=D?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=D?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(p=D?.signInWithEthereum)===null||p===void 0?void 0:p.resources};_=dM(O),S=await I.request({method:"personal_sign",params:[hM(_),F]})}try{const{data:A,error:T}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:S},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:rs});if(T)throw T;if(!A||!A.session||!A.user){const x=new zl;return this._returnResult({data:{user:null,session:null},error:x})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:T})}catch(A){if(_e(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async signInWithSolana(e){var t,n,s,a,o,c,h,d,p,m,v,_;let S,A;if("message"in e)S=e.message,A=e.signature;else{const{chain:T,wallet:x,statement:D,options:I}=e;let U;if(kn())if(typeof x=="object")U=x;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))U=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=x}const z=new URL((t=I?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in U&&U.signIn){const F=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},I?.signInWithSolana),{version:"1",domain:z.host,uri:z.href}),D?{statement:D}:null));let R;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")R=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)R=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)S=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),A=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${z.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${z.href}`,`Issued At: ${(s=(n=I?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=I?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${I.signInWithSolana.notBefore}`]:[],...!((o=I?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${I.signInWithSolana.expirationTime}`]:[],...!((c=I?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${I.signInWithSolana.chainId}`]:[],...!((h=I?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${I.signInWithSolana.nonce}`]:[],...!((d=I?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${I.signInWithSolana.requestId}`]:[],...!((m=(p=I?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...I.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const F=await U.signMessage(new TextEncoder().encode(S),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=F}}try{const{data:T,error:x}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Io(A)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:rs});if(x)throw x;if(!T||!T.session||!T.user){const D=new zl;return this._returnResult({data:{user:null,session:null},error:D})}return T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",T.session)),this._returnResult({data:Object.assign({},T),error:x})}catch(T){if(_e(T))return this._returnResult({data:{user:null,session:null},error:T});throw T}}async _exchangeCodeForSession(e){const t=await So(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new ON;const{data:a,error:o}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:rs});if(await Cn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const c=new zl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:a,nonce:o}=e,c=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:rs}),{data:h,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const p=new zl;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,s,a,o;try{if("email"in e){const{email:c,options:h}=e;let d=null,p=null;this.flowType==="pkce"&&([d,p]=await Vl(this.storage,this.storageKey));const{error:m}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(n=h?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:c,options:h}=e,{data:d,error:p}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(a=h?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:p})}throw new Bf("You must provide either an email or phone number.")}catch(c){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,n;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:c}=await Re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:rs});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,d=o.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(_e(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,n,s,a,o;try{let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Vl(this.storage,this.storageKey));const d=await Re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:h}),headers:this.headers,xform:iM});return!((a=d.data)===null||a===void 0)&&a.url&&kn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new mi;const{error:s}=await Re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(_e(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:a}=e,{error:o}=await Re(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:s,options:a}=e,{data:o,error:c}=await Re(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new Bf("You must provide either an email or phone number and a type")}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await So(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<$y:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await So(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Ky()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=ZN(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(-1,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:wa}):await this._useSession(async t=>{var n,s,a;const{data:o,error:c}=t;if(c)throw c;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new mi}:await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:wa})})}catch(t){if(_e(t))return IN(t)&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new mi;const o=s.session;let c=null,h=null;this.flowType==="pkce"&&e.email!=null&&([c,h]=await Vl(this.storage,this.storageKey));const{data:d,error:p}=await Re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:h}),jwt:o.access_token,xform:wa});if(p)throw p;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new mi;const t=Date.now()/1e3;let n=t,s=!0,a=null;const{payload:o}=Wy(e.access_token);if(o.exp&&(n=o.exp,s=n<=t),s){const{data:c,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:h}=await this._getUser(e.access_token);if(h)throw h;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(_e(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:c}=t;if(c)throw c;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new mi;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!kn())throw new Uf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Uf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new mS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Uf("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new mS("No code detected.");const{data:D,error:I}=await this._exchangeCodeForSession(e.code);if(I)throw I;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:c,expires_at:h,token_type:d}=e;if(!a||!c||!o||!d)throw new Uf("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(c);let v=p+m;h&&(v=parseInt(h));const _=v-p;_*1e3<=Kl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${m}s`);const S=v-m;p-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,v,p):p-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,v,p);const{data:A,error:T}=await this._getUser(a);if(T)throw T;const x={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:v,refresh_token:o,token_type:d,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:e.type},error:null})}catch(n){if(_e(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await So(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(RN(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=UN(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:a},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Vl(this.storage,this.storageKey,!0));try{return await Re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:s}=await this._useSession(async a=>{var o,c,h,d,p;const{data:m,error:v}=a;if(v)throw v;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Re(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return kn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:e.provider,url:n?.url},error:null})}catch(n){if(_e(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:o,provider:c,token:h,access_token:d,nonce:p}=e,m=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:h,access_token:d,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:rs}),{data:v,error:_}=m;return _?this._returnResult({data:{user:null,session:null},error:_}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new zl}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:_}))}catch(s){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),_e(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:a,error:o}=t;if(o)throw o;return await Re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await qN(async s=>(s>0&&await VN(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:rs})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Gy(a)&&Date.now()+o-n<Kl})}catch(n){if(this._debug(t,"error",n),_e(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),kn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await So(this.storage,this.storageKey);if(s&&this.userStorage){let o=await So(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Yl(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Ky()}else if(s&&!s.user&&!s.user){const o=await So(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await Cn(this.storage,this.storageKey+"-user"),await Yl(this.storage,this.storageKey,s)):s.user=Ky()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<$y;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${$y}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Gy(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(s.access_token);!c&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new mi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new rC;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new mi;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(s,"error",a),_e(a)){const o={data:null,error:a};return Gy(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(h){a.push(h)}});if(await Promise.all(o),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Cn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await Yl(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=_S(s);await Yl(this.storage,this.storageKey,a)}else{const s=_S(t);await Yl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Cn(this.storage,this.storageKey),await Cn(this.storage,this.storageKey+"-code-verifier"),await Cn(this.storage,this.storageKey+"-user"),this.userStorage&&await Cn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&kn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Kl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Kl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Kl}ms, refresh threshold is ${eb} ticks`),s<=eb&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof oC)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await Vl(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(c.toString())}if(n?.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await Re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:d}=await Re(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?bM(e.webauthn.credential_response):_M(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:h}=await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:h}))})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:yM(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:vM(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Wy(n.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?await Re(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new mi})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new mi});const o=await Re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&kn()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(_e(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new mi});const o=await Re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&kn()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(_e(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await Re(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new mi})})}catch(e){if(_e(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?(await Re(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new mi})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(c=>c.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+CN>s)return n;const{data:a,error:o}=await Re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:_,error:S}=await this.getSession();if(S||!_.session)return this._returnResult({data:null,error:S});n=_.session.access_token}const{header:s,payload:a,signature:o,raw:{header:c,payload:h}}=Wy(n);t?.allowExpired||XN(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:a,header:s,signature:o},error:null}}const p=QN(s.alg),m=await crypto.subtle.importKey("jwk",d,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,o,jN(`${c}.${h}`)))throw new ib("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(_e(n))return this._returnResult({data:null,error:n});throw n}}}Th.nextInstanceID={};const RM=Th,IM="2.89.0";let th="";typeof Deno<"u"?th="deno":typeof document<"u"?th="web":typeof navigator<"u"&&navigator.product==="ReactNative"?th="react-native":th="node";const DM={"X-Client-Info":`supabase-js-${th}/${IM}`},OM={headers:DM},PM={schema:"public"},NM={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},MM={};function xh(i){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xh(i)}function LM(i,e){if(xh(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(xh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function jM(i){var e=LM(i,"string");return xh(e)=="symbol"?e:e+""}function BM(i,e,t){return(e=jM(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function CS(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function Lt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?CS(Object(t),!0).forEach(function(n){BM(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):CS(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}const UM=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),FM=()=>Headers,zM=(i,e,t)=>{const n=UM(t),s=FM();return async(a,o)=>{var c;const h=(c=await e())!==null&&c!==void 0?c:i;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",i),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),n(a,Lt(Lt({},o),{},{headers:d}))}};function VM(i){return i.endsWith("/")?i:i+"/"}function qM(i,e){var t,n;const{db:s,auth:a,realtime:o,global:c}=i,{db:h,auth:d,realtime:p,global:m}=e,v={db:Lt(Lt({},h),s),auth:Lt(Lt({},d),a),realtime:Lt(Lt({},p),o),storage:{},global:Lt(Lt(Lt({},m),c),{},{headers:Lt(Lt({},(t=m?.headers)!==null&&t!==void 0?t:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return i.accessToken?v.accessToken=i.accessToken:delete v.accessToken,v}function HM(i){const e=i?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(VM(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var $M=class extends RM{constructor(i){super(i)}},GM=class{constructor(i,e,t){var n,s;this.supabaseUrl=i,this.supabaseKey=e;const a=HM(i);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:PM,realtime:MM,auth:Lt(Lt({},NM),{},{storageKey:o}),global:OM},h=qM(t??{},c);if(this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=zM(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Lt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new T2(new URL("rest/v1",a).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new AN(this.storageUrl.href,this.headers,this.fetch,t?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new _2(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(i,e,t)}channel(i,e={config:{}}){return this.realtime.channel(i,e)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var i=this,e,t;if(i.accessToken)return await i.accessToken();const{data:n}=await i.auth.getSession();return(e=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:i.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:s,storageKey:a,flowType:o,lock:c,debug:h,throwOnError:d},p,m){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $M({url:this.authUrl.href,headers:Lt(Lt({},v),p),storageKey:a,autoRefreshToken:i,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:s,flowType:o,lock:c,debug:h,throwOnError:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(i){return new V2(this.realtimeUrl.href,Lt(Lt({},i),{},{params:Lt(Lt({},{apikey:this.supabaseKey}),i?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((i,e)=>{this._handleTokenChanged(i,"CLIENT",e?.access_token)})}_handleTokenChanged(i,e,t){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):i==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const WM=(i,e,t)=>new GM(i,e,t);function KM(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const e=i.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}KM()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const YM="https://vorfyivralnjigaxmwcm.supabase.co",XM="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvcmZ5aXZyYWxuamlnYXhtd2NtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1OTE4MTUsImV4cCI6MjA4MzE2NzgxNX0.PgKiseOU4EDwDwVp7QIgEgoU6XDUrzj6kQdKsXKD8fo",Fi=WM(YM,XM),QM={async getSections(){const{data:i,error:e}=await Fi.from("sections").select("*").order("order",{ascending:!0});if(e)throw e;return i},async addSection(i){const{data:e,error:t}=await Fi.from("sections").insert([i]).select().single();if(t)throw t;return e},async deleteSection(i){const{error:e}=await Fi.from("sections").delete().eq("id",i);if(e)throw e}};function JM(){const[i,e]=Y.useState([]);return Y.useEffect(()=>{(async()=>{try{const n=await QM.getSections();e(n)}catch(n){console.error("Error loading sections:",n)}})()},[]),w.jsx(w.Fragment,{children:i.map(t=>w.jsx("section",{className:"section",id:`section-${t.id}`,children:w.jsxs("div",{className:"content-wrapper",children:[t.title&&w.jsx("h2",{children:t.title}),t.imageUrl&&w.jsx("img",{src:t.imageUrl,alt:t.title||"Section Image",style:{maxWidth:"100%",height:"auto",marginBottom:"1rem",borderRadius:"8px"}}),t.content&&w.jsx("div",{dangerouslySetInnerHTML:{__html:t.content}}),t.pdfUrl&&w.jsx("div",{style:{marginTop:"1rem"},children:w.jsxs("a",{href:t.pdfUrl,target:"_blank",style:{display:"inline-flex",alignItems:"center",padding:"0.5rem 1rem",backgroundColor:"#8E24AA",color:"white",textDecoration:"none",borderRadius:"5px",fontWeight:500},children:[w.jsx("span",{style:{marginRight:"8px"},children:""})," View PDF Document"]})})]})},t.id))})}const uC="/assets/hero1-BMJoYzFS.jpg",ZM="/assets/hero2-Bl7GMnov.jpg",eL="/assets/hero3-BGDoePaz.jpg",tL="/assets/hero4-DtlyC3bx.jpg",kS=[uC,ZM,eL,tL];function nL(){const[i,e]=Y.useState(0);return Y.useEffect(()=>{const t=setInterval(()=>{e(n=>(n+1)%kS.length)},5e3);return()=>clearInterval(t)},[]),w.jsxs("div",{className:"hero-slideshow-container",children:[kS.map((t,n)=>w.jsx("div",{className:`hero-slide ${n===i?"active":""}`,style:{backgroundImage:`url(${t})`}},n)),w.jsx("div",{className:"hero-overlay-gradient"})]})}function iL(){return Nc(),w.jsxs("div",{className:"page active",style:{display:"block"},children:[w.jsxs("section",{className:"hero",children:[w.jsx(nL,{}),w.jsxs("div",{className:"hero-content",children:[w.jsx("h1",{className:"fade-in",style:{textTransform:"uppercase",letterSpacing:"2px"},children:"IT Museum - India"}),w.jsx("p",{className:"fade-in",style:{animationDelay:"0.2s"},children:"Tracing the remarkable evolution of technology in India, from the first indigenous computers to becoming a global digital powerhouse."}),w.jsxs("div",{className:"btn-group fade-in",style:{animationDelay:"0.4s"},children:[w.jsx(bn,{className:"cta-button",to:"/collection",children:"Explore the Archive"}),w.jsx(bn,{className:"cta-button secondary",style:{background:"white",border:"none",boxShadow:"var(--shadow-soft)"},to:"/team",children:"Meet the Curators"})]})]})]}),w.jsx("section",{className:"section fade-in",style:{background:"rgba(13, 71, 161, 0.03)",borderRadius:"24px",margin:"4rem auto",padding:"4rem 2.5rem",maxWidth:"1200px",border:"1px solid rgba(13, 71, 161, 0.1)"},children:w.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto"},children:[w.jsxs("h2",{style:{textAlign:"center",marginBottom:"2.5rem",color:"var(--primary)",position:"relative",display:"inline-block",left:"50%",transform:"translateX(-50%)"},children:["IT Museum - India",w.jsx("span",{style:{content:'""',position:"absolute",bottom:"-10px",left:"25%",width:"50%",height:"3px",background:"var(--accent)",borderRadius:"2px"}})]}),w.jsxs("p",{style:{fontSize:"1.15rem",lineHeight:"1.9",color:"#444",marginBottom:"1.5rem",textAlign:"justify"},children:[w.jsx("a",{href:"https://museum.dataart.com/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary)",fontWeight:"700",textDecoration:"none",borderBottom:"2px solid rgba(13, 71, 161, 0.2)"},children:"DataArt"}),", a multinational IT firm, has established a collaborative partnership with the Department of Computer Science at ",w.jsx("a",{href:"https://christuniversity.in/bangalore-yeshwanthpur-campus",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary)",fontWeight:"700",textDecoration:"none",borderBottom:"2px solid rgba(13, 71, 161, 0.2)"},children:"Christ University"}),', Bangalore Yeshwantpur Campus. Through their "',w.jsx("a",{href:"https://museum.dataart.com/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary)",fontWeight:"700",textDecoration:"none",borderBottom:"2px solid rgba(13, 71, 161, 0.2)"},children:"IT Museum"}),`" project, DataArt documents the IT innovation contributions of countries across Eastern and Central Europe, Latin America, and Asia. As part of this Memorandum of Understanding (MoU), the DataArt IT Museum team seeks to collaborate with our University to document and showcase India's contributions to IT innovations.`]}),w.jsx("p",{style:{fontSize:"1.15rem",lineHeight:"1.9",color:"#444",textAlign:"justify"},children:"This strategic partnership will facilitate the curation of case studies, research articles, and historical narratives that illuminate the intersection of Indian traditions and IT advancements. The Departments of Computer Science, Media Studies, and the Centre for Digital Learning (CDL) at Bangalore Yeshwantpur Campus are actively engaged in this collaborative initiative."})]})}),w.jsx("section",{className:"spotlight-section fade-in",children:w.jsxs("div",{className:"spotlight-grid",children:[w.jsx("div",{className:"spotlight-image-container",children:w.jsx("img",{src:uC,alt:"Indian IT History - Early Mainframes"})}),w.jsxs("div",{className:"spotlight-content",children:[w.jsx("h2",{children:"The Dawn of Indian Computing"}),w.jsxs("p",{style:{color:"rgba(255,255,255,0.8)",fontSize:"1.2rem",lineHeight:"1.8",marginBottom:"2rem"},children:["In 1955, the ",w.jsx("strong",{children:"HEC-2M"})," arrived at the Indian Statistical Institute, marking India's entry into the digital age. This was soon followed by the ",w.jsx("strong",{children:"TIFRAC"})," in Mumbaithe first computer designed and built indigenously in India. These machines, housed in massive cooling halls, were the architectural blueprints for India's future as a global technology powerhouse."]}),w.jsx(bn,{to:"/collection",className:"cta-button",children:"Explore the IT Origins"})]})]})}),w.jsx("div",{style:{textAlign:"center",marginTop:"6rem",marginBottom:"-2rem"},children:w.jsx("h3",{style:{textTransform:"uppercase",letterSpacing:"4px",color:"var(--text-muted)",fontSize:"1rem",opacity:.8},children:"Discovery of Global Timeline with DataArt IT Museum"})}),w.jsx("div",{className:"milestone-ribbon",children:w.jsxs("div",{className:"ribbon-track",children:[w.jsx("a",{href:"https://museum.dataart.com/history/chapter-1-from-military-to-civil-computing",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter I. From Military to Civil Computing"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-2-computers-for-business-and-industry",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter II. Computers for Business and Industry"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-3-computer-globalization",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter III. Computer Globalization"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-4-early-networks-and-proto-internet",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter IV. Early Networks and Proto-Internet"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-5-mass-computerization",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter V. Mass Computerization"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-6-computer-footprint-on-culture",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter VI. Computer Footprint on Culture"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-1-from-military-to-civil-computing",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter I. From Military to Civil Computing"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-2-computers-for-business-and-industry",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter II. Computers for Business and Industry"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-3-computer-globalization",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter III. Computer Globalization"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-4-early-networks-and-proto-internet",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter IV. Early Networks and Proto-Internet"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-5-mass-computerization",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter V. Mass Computerization"}),w.jsx("a",{href:"https://museum.dataart.com/history/chapter-6-computer-footprint-on-culture",target:"_blank",rel:"noopener noreferrer",className:"ribbon-item",children:"Chapter VI. Computer Footprint on Culture"})]})}),w.jsxs("section",{className:"section",children:[w.jsx("h2",{style:{textAlign:"center"},children:"Our Core Mission"}),w.jsxs("div",{className:"team-grid",children:[w.jsxs("div",{className:"profile-card",style:{borderTop:"4px solid var(--primary)",position:"relative"},children:[w.jsx("div",{style:{color:"var(--primary)",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:w.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[w.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),w.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),w.jsx("h3",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Vision"}),w.jsxs("p",{style:{color:"var(--text-muted)",lineHeight:"1.8"},children:["To serve as a global beacon for the digital preservation of ",w.jsx("strong",{children:"intangible cultural heritage"}),". We aim to bridge the gap between ancient artistic traditions and modern computational science."]})]}),w.jsxs("div",{className:"profile-card",style:{borderTop:"4px solid var(--accent)",position:"relative"},children:[w.jsx("div",{style:{color:"var(--accent)",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:w.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[w.jsx("circle",{cx:"12",cy:"12",r:"10"}),w.jsx("path",{d:"m9 12 2 2 4-4"})]})}),w.jsx("h3",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Mission"}),w.jsxs("p",{style:{color:"var(--text-muted)",lineHeight:"1.8"},children:["We are dedicated to meticulously archiving and modeling the intricate logic of ",w.jsx("strong",{children:"traditional geometric art"}),". Our goal is to foster a vibrant interdisciplinary dialogue."]})]}),w.jsxs("div",{className:"profile-card",style:{borderTop:"4px solid var(--primary)",position:"relative"},children:[w.jsx("div",{style:{color:"var(--primary)",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:w.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[w.jsx("path",{d:"M6 3h12l4 6-10 13L2 9Z"}),w.jsx("path",{d:"M11 3 8 9l4 13 4-13-3-6"})]})}),w.jsx("h3",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Values"}),w.jsxs("p",{style:{color:"var(--text-muted)",lineHeight:"1.8"},children:["Grounded in an unwavering commitment to ",w.jsx("strong",{children:"integrity"})," in preservation and ",w.jsx("strong",{children:"inclusivity"})," in access. We believe technology democratizes culture."]})]})]})]}),w.jsxs("section",{className:"quote-section fade-in",children:[w.jsx("blockquote",{className:"quote-text",children:'"History is not a record of the past, but the blueprints for the future."'}),w.jsx("div",{className:"quote-author",children:" The Christ University IT Museum Board"})]}),w.jsx(JM,{})]})}const sL=()=>{};var RS={};const hC=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},rL=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=i[t++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=i[t++],o=i[t++],c=i[t++],h=((s&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const a=i[t++],o=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},dC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const a=i[s],o=s+1<i.length,c=o?i[s+1]:0,h=s+2<i.length,d=h?i[s+2]:0,p=a>>2,m=(a&3)<<4|c>>4;let v=(c&15)<<2|d>>6,_=d&63;h||(_=64,o||(v=64)),n.push(t[p],t[m],t[v],t[_])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(hC(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):rL(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const a=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const d=s<i.length?t[i.charAt(s)]:64;++s;const m=s<i.length?t[i.charAt(s)]:64;if(++s,a==null||c==null||d==null||m==null)throw new aL;const v=a<<2|c>>4;if(n.push(v),d!==64){const _=c<<4&240|d>>2;if(n.push(_),m!==64){const S=d<<6&192|m;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class aL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oL=function(i){const e=hC(i);return dC.encodeByteArray(e,!0)},Ep=function(i){return oL(i).replace(/\./g,"")},fC=function(i){try{return dC.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function lL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const cL=()=>lL().__FIREBASE_DEFAULTS__,uL=()=>{if(typeof process>"u"||typeof RS>"u")return;const i=RS.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},hL=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&fC(i[1]);return e&&JSON.parse(e)},Zp=()=>{try{return sL()||cL()||uL()||hL()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},pC=i=>Zp()?.emulatorHosts?.[i],mC=i=>{const e=pC(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},gC=()=>Zp()?.config,yC=i=>Zp()?.[`_${i}`];class dL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function $o(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function h_(i){return(await fetch(i,{credentials:"include"})).ok}function vC(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=i.iat||0,a=i.sub||i.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Ep(JSON.stringify(t)),Ep(JSON.stringify(o)),""].join(".")}const fh={};function fL(){const i={prod:[],emulator:[]};for(const e of Object.keys(fh))fh[e]?i.emulator.push(e):i.prod.push(e);return i}function pL(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let IS=!1;function d_(i,e){if(typeof window>"u"||typeof document>"u"||!$o(window.location.host)||fh[i]===e||fh[i]||IS)return;fh[i]=e;function t(v){return`__firebase__banner__${v}`}const n="__firebase__banner",a=fL().prod.length>0;function o(){const v=document.getElementById(n);v&&v.remove()}function c(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,_){v.setAttribute("width","24"),v.setAttribute("id",_),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{IS=!0,o()},v}function p(v,_){v.setAttribute("id",_),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function m(){const v=pL(n),_=t("text"),S=document.getElementById(_)||document.createElement("span"),A=t("learnmore"),T=document.getElementById(A)||document.createElement("a"),x=t("preprendIcon"),D=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const I=v.element;c(I),p(T,A);const U=d();h(D,x),I.append(D,S,T,U),document.body.appendChild(I)}a?(S.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function mL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function gL(){const i=Zp()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bC(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function vL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bL(){const i=zn();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function _L(){return!gL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _C(){try{return typeof indexedDB=="object"}catch{return!1}}function wC(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}function wL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const AL="FirebaseError";class Gi extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=AL,Object.setPrototypeOf(this,Gi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Go.prototype.create)}}class Go{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?EL(a,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Gi(s,c,n)}}function EL(i,e){return i.replace(SL,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const SL=/\{\$([^}]+)}/g;function TL(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function Na(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const a=i[s],o=e[s];if(DS(a)&&DS(o)){if(!Na(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function DS(i){return i!==null&&typeof i=="object"}function Hh(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function nh(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function ih(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function xL(i,e){const t=new CL(i,e);return t.subscribe.bind(t)}class CL{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");kL(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=Xy),s.error===void 0&&(s.error=Xy),s.complete===void 0&&(s.complete=Xy);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kL(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function Xy(){}const RL=1e3,IL=2,DL=14400*1e3,OL=.5;function OS(i,e=RL,t=IL){const n=e*Math.pow(t,i),s=Math.round(OL*n*(Math.random()-.5)*2);return Math.min(DL,n+s)}function _n(i){return i&&i._delegate?i._delegate:i}class qi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const xo="[DEFAULT]";class PL{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new dL;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ML(e))try{this.getOrInitializeService({instanceIdentifier:xo})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=xo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xo){return this.instances.has(e)}getOptions(e=xo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&o.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&e(a,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:NL(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=xo){return this.component?this.component.multipleInstances?e:xo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NL(i){return i===xo?void 0:i}function ML(i){return i.instantiationMode==="EAGER"}class LL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PL(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var We;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(We||(We={}));const jL={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},BL=We.INFO,UL={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},FL=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=UL[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class em{constructor(e){this.name=e,this._logLevel=BL,this._logHandler=FL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const zL=(i,e)=>e.some(t=>i instanceof t);let PS,NS;function VL(){return PS||(PS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qL(){return NS||(NS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const AC=new WeakMap,sb=new WeakMap,EC=new WeakMap,Qy=new WeakMap,f_=new WeakMap;function HL(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",a),i.removeEventListener("error",o)},a=()=>{t(Ia(i.result)),s()},o=()=>{n(i.error),s()};i.addEventListener("success",a),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&AC.set(t,i)}).catch(()=>{}),f_.set(e,i),e}function $L(i){if(sb.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",a),i.removeEventListener("error",o),i.removeEventListener("abort",o)},a=()=>{t(),s()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",a),i.addEventListener("error",o),i.addEventListener("abort",o)});sb.set(i,e)}let rb={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return sb.get(i);if(e==="objectStoreNames")return i.objectStoreNames||EC.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ia(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function GL(i){rb=i(rb)}function WL(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(Jy(this),e,...t);return EC.set(n,e.sort?e.sort():[e]),Ia(n)}:qL().includes(i)?function(...e){return i.apply(Jy(this),e),Ia(AC.get(this))}:function(...e){return Ia(i.apply(Jy(this),e))}}function KL(i){return typeof i=="function"?WL(i):(i instanceof IDBTransaction&&$L(i),zL(i,VL())?new Proxy(i,rb):i)}function Ia(i){if(i instanceof IDBRequest)return HL(i);if(Qy.has(i))return Qy.get(i);const e=KL(i);return e!==i&&(Qy.set(i,e),f_.set(e,i)),e}const Jy=i=>f_.get(i);function SC(i,e,{blocked:t,upgrade:n,blocking:s,terminated:a}={}){const o=indexedDB.open(i,e),c=Ia(o);return n&&o.addEventListener("upgradeneeded",h=>{n(Ia(o.result),h.oldVersion,h.newVersion,Ia(o.transaction),h)}),t&&o.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{a&&h.addEventListener("close",()=>a()),s&&h.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const YL=["get","getKey","getAll","getAllKeys","count"],XL=["put","add","delete","clear"],Zy=new Map;function MS(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Zy.get(e))return Zy.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=XL.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||YL.includes(t)))return;const a=async function(o,...c){const h=this.transaction(o,s?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),s&&h.done]))[0]};return Zy.set(e,a),a}GL(i=>({...i,get:(e,t,n)=>MS(e,t)||i.get(e,t,n),has:(e,t)=>!!MS(e,t)||i.has(e,t)}));class QL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(JL(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function JL(i){return i.getComponent()?.type==="VERSION"}const ab="@firebase/app",LS="0.14.6";const Pr=new em("@firebase/app"),ZL="@firebase/app-compat",ej="@firebase/analytics-compat",tj="@firebase/analytics",nj="@firebase/app-check-compat",ij="@firebase/app-check",sj="@firebase/auth",rj="@firebase/auth-compat",aj="@firebase/database",oj="@firebase/data-connect",lj="@firebase/database-compat",cj="@firebase/functions",uj="@firebase/functions-compat",hj="@firebase/installations",dj="@firebase/installations-compat",fj="@firebase/messaging",pj="@firebase/messaging-compat",mj="@firebase/performance",gj="@firebase/performance-compat",yj="@firebase/remote-config",vj="@firebase/remote-config-compat",bj="@firebase/storage",_j="@firebase/storage-compat",wj="@firebase/firestore",Aj="@firebase/ai",Ej="@firebase/firestore-compat",Sj="firebase",Tj="12.6.0";const ob="[DEFAULT]",xj={[ab]:"fire-core",[ZL]:"fire-core-compat",[tj]:"fire-analytics",[ej]:"fire-analytics-compat",[ij]:"fire-app-check",[nj]:"fire-app-check-compat",[sj]:"fire-auth",[rj]:"fire-auth-compat",[aj]:"fire-rtdb",[oj]:"fire-data-connect",[lj]:"fire-rtdb-compat",[cj]:"fire-fn",[uj]:"fire-fn-compat",[hj]:"fire-iid",[dj]:"fire-iid-compat",[fj]:"fire-fcm",[pj]:"fire-fcm-compat",[mj]:"fire-perf",[gj]:"fire-perf-compat",[yj]:"fire-rc",[vj]:"fire-rc-compat",[bj]:"fire-gcs",[_j]:"fire-gcs-compat",[wj]:"fire-fst",[Ej]:"fire-fst-compat",[Aj]:"fire-vertex","fire-js":"fire-js",[Sj]:"fire-js-all"};const Sp=new Map,Cj=new Map,lb=new Map;function jS(i,e){try{i.container.addComponent(e)}catch(t){Pr.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function ds(i){const e=i.name;if(lb.has(e))return Pr.debug(`There were multiple attempts to register component ${e}.`),!1;lb.set(e,i);for(const t of Sp.values())jS(t,i);for(const t of Cj.values())jS(t,i);return!0}function qa(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function zi(i){return i==null?!1:i.settings!==void 0}const kj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Da=new Go("app","Firebase",kj);class Rj{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new qi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Da.create("app-deleted",{appName:this._name})}}const Wo=Tj;function TC(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:ob,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Da.create("bad-app-name",{appName:String(s)});if(t||(t=gC()),!t)throw Da.create("no-options");const a=Sp.get(s);if(a){if(Na(t,a.options)&&Na(n,a.config))return a;throw Da.create("duplicate-app",{appName:s})}const o=new LL(s);for(const h of lb.values())o.addComponent(h);const c=new Rj(t,n,o);return Sp.set(s,c),c}function tm(i=ob){const e=Sp.get(i);if(!e&&i===ob&&gC())return TC();if(!e)throw Da.create("no-app",{appName:i});return e}function ri(i,e,t){let n=xj[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pr.warn(o.join(" "));return}ds(new qi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const Ij="firebase-heartbeat-database",Dj=1,Ch="firebase-heartbeat-store";let ev=null;function xC(){return ev||(ev=SC(Ij,Dj,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Ch)}catch(t){console.warn(t)}}}}).catch(i=>{throw Da.create("idb-open",{originalErrorMessage:i.message})})),ev}async function Oj(i){try{const t=(await xC()).transaction(Ch),n=await t.objectStore(Ch).get(CC(i));return await t.done,n}catch(e){if(e instanceof Gi)Pr.warn(e.message);else{const t=Da.create("idb-get",{originalErrorMessage:e?.message});Pr.warn(t.message)}}}async function BS(i,e){try{const n=(await xC()).transaction(Ch,"readwrite");await n.objectStore(Ch).put(e,CC(i)),await n.done}catch(t){if(t instanceof Gi)Pr.warn(t.message);else{const n=Da.create("idb-set",{originalErrorMessage:t?.message});Pr.warn(n.message)}}}function CC(i){return`${i.name}!${i.options.appId}`}const Pj=1024,Nj=30;class Mj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new jj(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=US();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>Nj){const s=Bj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=US(),{heartbeatsToSend:t,unsentEntries:n}=Lj(this._heartbeatsCache.heartbeats),s=Ep(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Pr.warn(e),""}}}function US(){return new Date().toISOString().substring(0,10)}function Lj(i,e=Pj){const t=[];let n=i.slice();for(const s of i){const a=t.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),FS(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),FS(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class jj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _C()?wC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Oj(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return BS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return BS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function FS(i){return Ep(JSON.stringify({version:2,heartbeats:i})).length}function Bj(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}function Uj(i){ds(new qi("platform-logger",e=>new QL(e),"PRIVATE")),ds(new qi("heartbeat",e=>new Mj(e),"PRIVATE")),ri(ab,LS,i),ri(ab,LS,"esm2020"),ri("fire-js","")}Uj("");var zS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Oa,kC;(function(){var i;function e(R,O){function P(){}P.prototype=O.prototype,R.F=O.prototype,R.prototype=new P,R.prototype.constructor=R,R.D=function(j,L,V){for(var B=Array(arguments.length-2),de=2;de<arguments.length;de++)B[de-2]=arguments[de];return O.prototype[L].apply(j,B)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,O,P){P||(P=0);const j=Array(16);if(typeof O=="string")for(var L=0;L<16;++L)j[L]=O.charCodeAt(P++)|O.charCodeAt(P++)<<8|O.charCodeAt(P++)<<16|O.charCodeAt(P++)<<24;else for(L=0;L<16;++L)j[L]=O[P++]|O[P++]<<8|O[P++]<<16|O[P++]<<24;O=R.g[0],P=R.g[1],L=R.g[2];let V=R.g[3],B;B=O+(V^P&(L^V))+j[0]+3614090360&4294967295,O=P+(B<<7&4294967295|B>>>25),B=V+(L^O&(P^L))+j[1]+3905402710&4294967295,V=O+(B<<12&4294967295|B>>>20),B=L+(P^V&(O^P))+j[2]+606105819&4294967295,L=V+(B<<17&4294967295|B>>>15),B=P+(O^L&(V^O))+j[3]+3250441966&4294967295,P=L+(B<<22&4294967295|B>>>10),B=O+(V^P&(L^V))+j[4]+4118548399&4294967295,O=P+(B<<7&4294967295|B>>>25),B=V+(L^O&(P^L))+j[5]+1200080426&4294967295,V=O+(B<<12&4294967295|B>>>20),B=L+(P^V&(O^P))+j[6]+2821735955&4294967295,L=V+(B<<17&4294967295|B>>>15),B=P+(O^L&(V^O))+j[7]+4249261313&4294967295,P=L+(B<<22&4294967295|B>>>10),B=O+(V^P&(L^V))+j[8]+1770035416&4294967295,O=P+(B<<7&4294967295|B>>>25),B=V+(L^O&(P^L))+j[9]+2336552879&4294967295,V=O+(B<<12&4294967295|B>>>20),B=L+(P^V&(O^P))+j[10]+4294925233&4294967295,L=V+(B<<17&4294967295|B>>>15),B=P+(O^L&(V^O))+j[11]+2304563134&4294967295,P=L+(B<<22&4294967295|B>>>10),B=O+(V^P&(L^V))+j[12]+1804603682&4294967295,O=P+(B<<7&4294967295|B>>>25),B=V+(L^O&(P^L))+j[13]+4254626195&4294967295,V=O+(B<<12&4294967295|B>>>20),B=L+(P^V&(O^P))+j[14]+2792965006&4294967295,L=V+(B<<17&4294967295|B>>>15),B=P+(O^L&(V^O))+j[15]+1236535329&4294967295,P=L+(B<<22&4294967295|B>>>10),B=O+(L^V&(P^L))+j[1]+4129170786&4294967295,O=P+(B<<5&4294967295|B>>>27),B=V+(P^L&(O^P))+j[6]+3225465664&4294967295,V=O+(B<<9&4294967295|B>>>23),B=L+(O^P&(V^O))+j[11]+643717713&4294967295,L=V+(B<<14&4294967295|B>>>18),B=P+(V^O&(L^V))+j[0]+3921069994&4294967295,P=L+(B<<20&4294967295|B>>>12),B=O+(L^V&(P^L))+j[5]+3593408605&4294967295,O=P+(B<<5&4294967295|B>>>27),B=V+(P^L&(O^P))+j[10]+38016083&4294967295,V=O+(B<<9&4294967295|B>>>23),B=L+(O^P&(V^O))+j[15]+3634488961&4294967295,L=V+(B<<14&4294967295|B>>>18),B=P+(V^O&(L^V))+j[4]+3889429448&4294967295,P=L+(B<<20&4294967295|B>>>12),B=O+(L^V&(P^L))+j[9]+568446438&4294967295,O=P+(B<<5&4294967295|B>>>27),B=V+(P^L&(O^P))+j[14]+3275163606&4294967295,V=O+(B<<9&4294967295|B>>>23),B=L+(O^P&(V^O))+j[3]+4107603335&4294967295,L=V+(B<<14&4294967295|B>>>18),B=P+(V^O&(L^V))+j[8]+1163531501&4294967295,P=L+(B<<20&4294967295|B>>>12),B=O+(L^V&(P^L))+j[13]+2850285829&4294967295,O=P+(B<<5&4294967295|B>>>27),B=V+(P^L&(O^P))+j[2]+4243563512&4294967295,V=O+(B<<9&4294967295|B>>>23),B=L+(O^P&(V^O))+j[7]+1735328473&4294967295,L=V+(B<<14&4294967295|B>>>18),B=P+(V^O&(L^V))+j[12]+2368359562&4294967295,P=L+(B<<20&4294967295|B>>>12),B=O+(P^L^V)+j[5]+4294588738&4294967295,O=P+(B<<4&4294967295|B>>>28),B=V+(O^P^L)+j[8]+2272392833&4294967295,V=O+(B<<11&4294967295|B>>>21),B=L+(V^O^P)+j[11]+1839030562&4294967295,L=V+(B<<16&4294967295|B>>>16),B=P+(L^V^O)+j[14]+4259657740&4294967295,P=L+(B<<23&4294967295|B>>>9),B=O+(P^L^V)+j[1]+2763975236&4294967295,O=P+(B<<4&4294967295|B>>>28),B=V+(O^P^L)+j[4]+1272893353&4294967295,V=O+(B<<11&4294967295|B>>>21),B=L+(V^O^P)+j[7]+4139469664&4294967295,L=V+(B<<16&4294967295|B>>>16),B=P+(L^V^O)+j[10]+3200236656&4294967295,P=L+(B<<23&4294967295|B>>>9),B=O+(P^L^V)+j[13]+681279174&4294967295,O=P+(B<<4&4294967295|B>>>28),B=V+(O^P^L)+j[0]+3936430074&4294967295,V=O+(B<<11&4294967295|B>>>21),B=L+(V^O^P)+j[3]+3572445317&4294967295,L=V+(B<<16&4294967295|B>>>16),B=P+(L^V^O)+j[6]+76029189&4294967295,P=L+(B<<23&4294967295|B>>>9),B=O+(P^L^V)+j[9]+3654602809&4294967295,O=P+(B<<4&4294967295|B>>>28),B=V+(O^P^L)+j[12]+3873151461&4294967295,V=O+(B<<11&4294967295|B>>>21),B=L+(V^O^P)+j[15]+530742520&4294967295,L=V+(B<<16&4294967295|B>>>16),B=P+(L^V^O)+j[2]+3299628645&4294967295,P=L+(B<<23&4294967295|B>>>9),B=O+(L^(P|~V))+j[0]+4096336452&4294967295,O=P+(B<<6&4294967295|B>>>26),B=V+(P^(O|~L))+j[7]+1126891415&4294967295,V=O+(B<<10&4294967295|B>>>22),B=L+(O^(V|~P))+j[14]+2878612391&4294967295,L=V+(B<<15&4294967295|B>>>17),B=P+(V^(L|~O))+j[5]+4237533241&4294967295,P=L+(B<<21&4294967295|B>>>11),B=O+(L^(P|~V))+j[12]+1700485571&4294967295,O=P+(B<<6&4294967295|B>>>26),B=V+(P^(O|~L))+j[3]+2399980690&4294967295,V=O+(B<<10&4294967295|B>>>22),B=L+(O^(V|~P))+j[10]+4293915773&4294967295,L=V+(B<<15&4294967295|B>>>17),B=P+(V^(L|~O))+j[1]+2240044497&4294967295,P=L+(B<<21&4294967295|B>>>11),B=O+(L^(P|~V))+j[8]+1873313359&4294967295,O=P+(B<<6&4294967295|B>>>26),B=V+(P^(O|~L))+j[15]+4264355552&4294967295,V=O+(B<<10&4294967295|B>>>22),B=L+(O^(V|~P))+j[6]+2734768916&4294967295,L=V+(B<<15&4294967295|B>>>17),B=P+(V^(L|~O))+j[13]+1309151649&4294967295,P=L+(B<<21&4294967295|B>>>11),B=O+(L^(P|~V))+j[4]+4149444226&4294967295,O=P+(B<<6&4294967295|B>>>26),B=V+(P^(O|~L))+j[11]+3174756917&4294967295,V=O+(B<<10&4294967295|B>>>22),B=L+(O^(V|~P))+j[2]+718787259&4294967295,L=V+(B<<15&4294967295|B>>>17),B=P+(V^(L|~O))+j[9]+3951481745&4294967295,R.g[0]=R.g[0]+O&4294967295,R.g[1]=R.g[1]+(L+(B<<21&4294967295|B>>>11))&4294967295,R.g[2]=R.g[2]+L&4294967295,R.g[3]=R.g[3]+V&4294967295}n.prototype.v=function(R,O){O===void 0&&(O=R.length);const P=O-this.blockSize,j=this.C;let L=this.h,V=0;for(;V<O;){if(L==0)for(;V<=P;)s(this,R,V),V+=this.blockSize;if(typeof R=="string"){for(;V<O;)if(j[L++]=R.charCodeAt(V++),L==this.blockSize){s(this,j),L=0;break}}else for(;V<O;)if(j[L++]=R[V++],L==this.blockSize){s(this,j),L=0;break}}this.h=L,this.o+=O},n.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var O=1;O<R.length-8;++O)R[O]=0;O=this.o*8;for(var P=R.length-8;P<R.length;++P)R[P]=O&255,O/=256;for(this.v(R),R=Array(16),O=0,P=0;P<4;++P)for(let j=0;j<32;j+=8)R[O++]=this.g[P]>>>j&255;return R};function a(R,O){var P=c;return Object.prototype.hasOwnProperty.call(P,R)?P[R]:P[R]=O(R)}function o(R,O){this.h=O;const P=[];let j=!0;for(let L=R.length-1;L>=0;L--){const V=R[L]|0;j&&V==O||(P[L]=V,j=!1)}this.g=P}var c={};function h(R){return-128<=R&&R<128?a(R,function(O){return new o([O|0],O<0?-1:0)}):new o([R|0],R<0?-1:0)}function d(R){if(isNaN(R)||!isFinite(R))return m;if(R<0)return T(d(-R));const O=[];let P=1;for(let j=0;R>=P;j++)O[j]=R/P|0,P*=4294967296;return new o(O,0)}function p(R,O){if(R.length==0)throw Error("number format error: empty string");if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(R.charAt(0)=="-")return T(p(R.substring(1),O));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=d(Math.pow(O,8));let j=m;for(let V=0;V<R.length;V+=8){var L=Math.min(8,R.length-V);const B=parseInt(R.substring(V,V+L),O);L<8?(L=d(Math.pow(O,L)),j=j.j(L).add(d(B))):(j=j.j(P),j=j.add(d(B)))}return j}var m=h(0),v=h(1),_=h(16777216);i=o.prototype,i.m=function(){if(A(this))return-T(this).m();let R=0,O=1;for(let P=0;P<this.g.length;P++){const j=this.i(P);R+=(j>=0?j:4294967296+j)*O,O*=4294967296}return R},i.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(S(this))return"0";if(A(this))return"-"+T(this).toString(R);const O=d(Math.pow(R,6));var P=this;let j="";for(;;){const L=U(P,O).g;P=x(P,L.j(O));let V=((P.g.length>0?P.g[0]:P.h)>>>0).toString(R);if(P=L,S(P))return V+j;for(;V.length<6;)V="0"+V;j=V+j}},i.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function S(R){if(R.h!=0)return!1;for(let O=0;O<R.g.length;O++)if(R.g[O]!=0)return!1;return!0}function A(R){return R.h==-1}i.l=function(R){return R=x(this,R),A(R)?-1:S(R)?0:1};function T(R){const O=R.g.length,P=[];for(let j=0;j<O;j++)P[j]=~R.g[j];return new o(P,~R.h).add(v)}i.abs=function(){return A(this)?T(this):this},i.add=function(R){const O=Math.max(this.g.length,R.g.length),P=[];let j=0;for(let L=0;L<=O;L++){let V=j+(this.i(L)&65535)+(R.i(L)&65535),B=(V>>>16)+(this.i(L)>>>16)+(R.i(L)>>>16);j=B>>>16,V&=65535,B&=65535,P[L]=B<<16|V}return new o(P,P[P.length-1]&-2147483648?-1:0)};function x(R,O){return R.add(T(O))}i.j=function(R){if(S(this)||S(R))return m;if(A(this))return A(R)?T(this).j(T(R)):T(T(this).j(R));if(A(R))return T(this.j(T(R)));if(this.l(_)<0&&R.l(_)<0)return d(this.m()*R.m());const O=this.g.length+R.g.length,P=[];for(var j=0;j<2*O;j++)P[j]=0;for(j=0;j<this.g.length;j++)for(let L=0;L<R.g.length;L++){const V=this.i(j)>>>16,B=this.i(j)&65535,de=R.i(L)>>>16,Ce=R.i(L)&65535;P[2*j+2*L]+=B*Ce,D(P,2*j+2*L),P[2*j+2*L+1]+=V*Ce,D(P,2*j+2*L+1),P[2*j+2*L+1]+=B*de,D(P,2*j+2*L+1),P[2*j+2*L+2]+=V*de,D(P,2*j+2*L+2)}for(R=0;R<O;R++)P[R]=P[2*R+1]<<16|P[2*R];for(R=O;R<2*O;R++)P[R]=0;return new o(P,0)};function D(R,O){for(;(R[O]&65535)!=R[O];)R[O+1]+=R[O]>>>16,R[O]&=65535,O++}function I(R,O){this.g=R,this.h=O}function U(R,O){if(S(O))throw Error("division by zero");if(S(R))return new I(m,m);if(A(R))return O=U(T(R),O),new I(T(O.g),T(O.h));if(A(O))return O=U(R,T(O)),new I(T(O.g),O.h);if(R.g.length>30){if(A(R)||A(O))throw Error("slowDivide_ only works with positive integers.");for(var P=v,j=O;j.l(R)<=0;)P=z(P),j=z(j);var L=F(P,1),V=F(j,1);for(j=F(j,2),P=F(P,2);!S(j);){var B=V.add(j);B.l(R)<=0&&(L=L.add(P),V=B),j=F(j,1),P=F(P,1)}return O=x(R,L.j(O)),new I(L,O)}for(L=m;R.l(O)>=0;){for(P=Math.max(1,Math.floor(R.m()/O.m())),j=Math.ceil(Math.log(P)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),V=d(P),B=V.j(O);A(B)||B.l(R)>0;)P-=j,V=d(P),B=V.j(O);S(V)&&(V=v),L=L.add(V),R=x(R,B)}return new I(L,R)}i.B=function(R){return U(this,R).h},i.and=function(R){const O=Math.max(this.g.length,R.g.length),P=[];for(let j=0;j<O;j++)P[j]=this.i(j)&R.i(j);return new o(P,this.h&R.h)},i.or=function(R){const O=Math.max(this.g.length,R.g.length),P=[];for(let j=0;j<O;j++)P[j]=this.i(j)|R.i(j);return new o(P,this.h|R.h)},i.xor=function(R){const O=Math.max(this.g.length,R.g.length),P=[];for(let j=0;j<O;j++)P[j]=this.i(j)^R.i(j);return new o(P,this.h^R.h)};function z(R){const O=R.g.length+1,P=[];for(let j=0;j<O;j++)P[j]=R.i(j)<<1|R.i(j-1)>>>31;return new o(P,R.h)}function F(R,O){const P=O>>5;O%=32;const j=R.g.length-P,L=[];for(let V=0;V<j;V++)L[V]=O>0?R.i(V+P)>>>O|R.i(V+P+1)<<32-O:R.i(V+P);return new o(L,R.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,kC=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Oa=o}).apply(typeof zS<"u"?zS:typeof self<"u"?self:typeof window<"u"?window:{});var Ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var RC,sh,IC,ap,cb,DC,OC,PC;(function(){var i,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ff=="object"&&Ff];for(var E=0;E<g.length;++E){var k=g[E];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=t(this);function s(g,E){if(E)e:{var k=n;g=g.split(".");for(var M=0;M<g.length-1;M++){var X=g[M];if(!(X in k))break e;k=k[X]}g=g[g.length-1],M=k[g],E=E(M),E!=M&&E!=null&&e(k,g,{configurable:!0,writable:!0,value:E})}}s("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(g){return g||function(E){var k=[],M;for(M in E)Object.prototype.hasOwnProperty.call(E,M)&&k.push([M,E[M]]);return k}});var a=a||{},o=this||self;function c(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function h(g,E,k){return g.call.apply(g.bind,arguments)}function d(g,E,k){return d=h,d.apply(null,arguments)}function p(g,E){var k=Array.prototype.slice.call(arguments,1);return function(){var M=k.slice();return M.push.apply(M,arguments),g.apply(this,M)}}function m(g,E){function k(){}k.prototype=E.prototype,g.Z=E.prototype,g.prototype=new k,g.prototype.constructor=g,g.Ob=function(M,X,te){for(var ue=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)ue[Fe-2]=arguments[Fe];return E.prototype[X].apply(M,ue)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function _(g){const E=g.length;if(E>0){const k=Array(E);for(let M=0;M<E;M++)k[M]=g[M];return k}return[]}function S(g,E){for(let M=1;M<arguments.length;M++){const X=arguments[M];var k=typeof X;if(k=k!="object"?k:X?Array.isArray(X)?"array":k:"null",k=="array"||k=="object"&&typeof X.length=="number"){k=g.length||0;const te=X.length||0;g.length=k+te;for(let ue=0;ue<te;ue++)g[k+ue]=X[ue]}else g.push(X)}}class A{constructor(E,k){this.i=E,this.j=k,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(g){o.setTimeout(()=>{throw g},0)}function x(){var g=R;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class D{constructor(){this.h=this.g=null}add(E,k){const M=I.get();M.set(E,k),this.h?this.h.next=M:this.g=M,this.h=M}}var I=new A(()=>new U,g=>g.reset());class U{constructor(){this.next=this.g=this.h=null}set(E,k){this.h=E,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let z,F=!1,R=new D,O=()=>{const g=Promise.resolve(void 0);z=()=>{g.then(P)}};function P(){for(var g;g=x();){try{g.h.call(g.g)}catch(k){T(k)}var E=I;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}F=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var V=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const k=()=>{};o.addEventListener("test",k,E),o.removeEventListener("test",k,E)}catch{}return g})();function B(g){return/^[\s\xa0]*$/.test(g)}function de(g,E){L.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}m(de,L),de.prototype.init=function(g,E){const k=this.type=g.type,M=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(k=="mouseover"?E=g.fromElement:k=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Ce="closure_listenable_"+(Math.random()*1e6|0),G=0;function W(g,E,k,M,X){this.listener=g,this.proxy=null,this.src=E,this.type=k,this.capture=!!M,this.ha=X,this.key=++G,this.da=this.fa=!1}function ae(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function we(g,E,k){for(const M in g)E.call(k,g[M],M,g)}function Oe(g,E){for(const k in g)E.call(void 0,g[k],k,g)}function H(g){const E={};for(const k in g)E[k]=g[k];return E}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(g,E){let k,M;for(let X=1;X<arguments.length;X++){M=arguments[X];for(k in M)g[k]=M[k];for(let te=0;te<ee.length;te++)k=ee[te],Object.prototype.hasOwnProperty.call(M,k)&&(g[k]=M[k])}}function he(g){this.src=g,this.g={},this.h=0}he.prototype.add=function(g,E,k,M,X){const te=g.toString();g=this.g[te],g||(g=this.g[te]=[],this.h++);const ue=ke(g,E,M,X);return ue>-1?(E=g[ue],k||(E.fa=!1)):(E=new W(E,this.src,te,!!M,X),E.fa=k,g.push(E)),E};function fe(g,E){const k=E.type;if(k in g.g){var M=g.g[k],X=Array.prototype.indexOf.call(M,E,void 0),te;(te=X>=0)&&Array.prototype.splice.call(M,X,1),te&&(ae(E),g.g[k].length==0&&(delete g.g[k],g.h--))}}function ke(g,E,k,M){for(let X=0;X<g.length;++X){const te=g[X];if(!te.da&&te.listener==E&&te.capture==!!k&&te.ha==M)return X}return-1}var Ae="closure_lm_"+(Math.random()*1e6|0),_t={};function ct(g,E,k,M,X){if(Array.isArray(E)){for(let te=0;te<E.length;te++)ct(g,E[te],k,M,X);return null}return k=$c(k),g&&g[Ce]?g.J(E,k,c(M)?!!M.capture:!1,X):sr(g,E,k,!1,M,X)}function sr(g,E,k,M,X,te){if(!E)throw Error("Invalid event type");const ue=c(X)?!!X.capture:!!X;let Fe=Ga(g);if(Fe||(g[Ae]=Fe=new he(g)),k=Fe.add(E,k,M,ue,te),k.proxy)return k;if(M=ms(),k.proxy=M,M.src=g,M.listener=k,g.addEventListener)V||(X=ue),X===void 0&&(X=!1),g.addEventListener(E.toString(),M,X);else if(g.attachEvent)g.attachEvent(Ei(E.toString()),M);else if(g.addListener&&g.removeListener)g.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return k}function ms(){function g(k){return E.call(g.src,g.listener,k)}const E=qc;return g}function gs(g,E,k,M,X){if(Array.isArray(E))for(var te=0;te<E.length;te++)gs(g,E[te],k,M,X);else M=c(M)?!!M.capture:!!M,k=$c(k),g&&g[Ce]?(g=g.i,te=String(E).toString(),te in g.g&&(E=g.g[te],k=ke(E,k,M,X),k>-1&&(ae(E[k]),Array.prototype.splice.call(E,k,1),E.length==0&&(delete g.g[te],g.h--)))):g&&(g=Ga(g))&&(E=g.g[E.toString()],g=-1,E&&(g=ke(E,k,M,X)),(k=g>-1?E[g]:null)&&rr(k))}function rr(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[Ce])fe(E.i,g);else{var k=g.type,M=g.proxy;E.removeEventListener?E.removeEventListener(k,M,g.capture):E.detachEvent?E.detachEvent(Ei(k),M):E.addListener&&E.removeListener&&E.removeListener(M),(k=Ga(E))?(fe(k,g),k.h==0&&(k.src=null,E[Ae]=null)):ae(g)}}}function Ei(g){return g in _t?_t[g]:_t[g]="on"+g}function qc(g,E){if(g.da)g=!0;else{E=new de(E,this);const k=g.listener,M=g.ha||g.src;g.fa&&rr(g),g=k.call(M,E)}return g}function Ga(g){return g=g[Ae],g instanceof he?g:null}var Hc="__closure_events_fn_"+(Math.random()*1e9>>>0);function $c(g){return typeof g=="function"?g:(g[Hc]||(g[Hc]=function(E){return g.handleEvent(E)}),g[Hc])}function $t(){j.call(this),this.i=new he(this),this.M=this,this.G=null}m($t,j),$t.prototype[Ce]=!0,$t.prototype.removeEventListener=function(g,E,k,M){gs(this,g,E,k,M)};function on(g,E){var k,M=g.G;if(M)for(k=[];M;M=M.G)k.push(M);if(g=g.M,M=E.type||E,typeof E=="string")E=new L(E,g);else if(E instanceof L)E.target=E.target||g;else{var X=E;E=new L(M,g),le(E,X)}X=!0;let te,ue;if(k)for(ue=k.length-1;ue>=0;ue--)te=E.g=k[ue],X=Ur(te,M,!0,E)&&X;if(te=E.g=g,X=Ur(te,M,!0,E)&&X,X=Ur(te,M,!1,E)&&X,k)for(ue=0;ue<k.length;ue++)te=E.g=k[ue],X=Ur(te,M,!1,E)&&X}$t.prototype.N=function(){if($t.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const k=g.g[E];for(let M=0;M<k.length;M++)ae(k[M]);delete g.g[E],g.h--}}this.G=null},$t.prototype.J=function(g,E,k,M){return this.i.add(String(g),E,!1,k,M)},$t.prototype.K=function(g,E,k,M){return this.i.add(String(g),E,!0,k,M)};function Ur(g,E,k,M){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let X=!0;for(let te=0;te<E.length;++te){const ue=E[te];if(ue&&!ue.da&&ue.capture==k){const Fe=ue.listener,Ut=ue.ha||ue.src;ue.fa&&fe(g.i,ue),X=Fe.call(Ut,M)!==!1&&X}}return X&&!M.defaultPrevented}function Pm(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function rd(g){g.g=Pm(()=>{g.g=null,g.i&&(g.i=!1,rd(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class Vn extends j{constructor(E,k){super(),this.m=E,this.l=k,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:rd(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wa(g){j.call(this),this.h=g,this.g={}}m(Wa,j);var Gc=[];function Wc(g){we(g.g,function(E,k){this.g.hasOwnProperty(k)&&rr(E)},g),g.g={}}Wa.prototype.N=function(){Wa.Z.N.call(this),Wc(this)},Wa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fr=o.JSON.stringify,Nm=o.JSON.parse,ad=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function od(){}function ld(){}var Wi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wn(){L.call(this,"d")}m(wn,L);function Si(){L.call(this,"c")}m(Si,L);var Bt={},cd=null;function Zo(){return cd=cd||new $t}Bt.Ia="serverreachability";function ud(g){L.call(this,Bt.Ia,g)}m(ud,L);function ys(g){const E=Zo();on(E,new ud(E))}Bt.STAT_EVENT="statevent";function Ka(g,E){L.call(this,Bt.STAT_EVENT,g),this.stat=E}m(Ka,L);function Gt(g){const E=Zo();on(E,new Ka(E,g))}Bt.Ja="timingevent";function vs(g,E){L.call(this,Bt.Ja,g),this.size=E}m(vs,L);function bs(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function Ki(){this.g=!0}Ki.prototype.ua=function(){this.g=!1};function Mm(g,E,k,M,X,te){g.info(function(){if(g.g)if(te){var ue="",Fe=te.split("&");for(let nt=0;nt<Fe.length;nt++){var Ut=Fe[nt].split("=");if(Ut.length>1){const Et=Ut[0];Ut=Ut[1];const ki=Et.split("_");ue=ki.length>=2&&ki[1]=="type"?ue+(Et+"="+Ut+"&"):ue+(Et+"=redacted&")}}}else ue=null;else ue=te;return"XMLHTTP REQ ("+M+") [attempt "+X+"]: "+E+`
`+k+`
`+ue})}function hd(g,E,k,M,X,te,ue){g.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+X+"]: "+E+`
`+k+`
`+te+" "+ue})}function _s(g,E,k,M){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+Lm(g,k)+(M?" "+M:"")})}function Ya(g,E){g.info(function(){return"TIMEOUT: "+E})}Ki.prototype.info=function(){};function Lm(g,E){if(!g.g)return E;if(!E)return null;try{const te=JSON.parse(E);if(te){for(g=0;g<te.length;g++)if(Array.isArray(te[g])){var k=te[g];if(!(k.length<2)){var M=k[1];if(Array.isArray(M)&&!(M.length<1)){var X=M[0];if(X!="noop"&&X!="stop"&&X!="close")for(let ue=1;ue<M.length;ue++)M[ue]=""}}}}return Fr(te)}catch{return E}}var Xa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Kc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Yc;function Qa(){}m(Qa,od),Qa.prototype.g=function(){return new XMLHttpRequest},Yc=new Qa;function ar(g){return encodeURIComponent(String(g))}function dd(g){var E=1;g=g.split(":");const k=[];for(;E>0&&g.length;)k.push(g.shift()),E--;return g.length&&k.push(g.join(":")),k}function Yi(g,E,k,M){this.j=g,this.i=E,this.l=k,this.S=M||1,this.V=new Wa(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Xi}function Xi(){this.i=null,this.g="",this.h=!1}var Wt={},fn={};function ws(g,E,k){g.M=1,g.A=Ja(Yt(E)),g.u=k,g.R=!0,el(g,null)}function el(g,E){g.F=Date.now(),As(g),g.B=Yt(g.A);var k=g.B,M=g.S;Array.isArray(M)||(M=[String(M)]),sl(k.i,"t",M),g.C=0,k=g.j.L,g.h=new Xi,g.g=Cd(g.j,k?E:null,!g.u),g.P>0&&(g.O=new Vn(d(g.Y,g,g.g),g.P)),E=g.V,k=g.g,M=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Gc[0]=X.toString()),X=Gc);for(let te=0;te<X.length;te++){const ue=ct(k,X[te],M||E.handleEvent,!1,E.h||E);if(!ue)break;E.g[ue.key]=ue}E=g.J?H(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),ys(),Mm(g.i,g.v,g.B,g.l,g.S,g.u)}Yi.prototype.ba=function(g){g=g.target;const E=this.O;E&&Zi(g)==3?E.j():this.Y(g)},Yi.prototype.Y=function(g){try{if(g==this.g)e:{const Fe=Zi(this.g),Ut=this.g.ya(),nt=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||An(this.g)))){this.K||Fe!=4||Ut==7||(Ut==8||nt<=0?ys(3):ys(2)),Es(this);var E=this.g.ca();this.X=E;var k=jm(this);if(this.o=E==200,hd(this.i,this.v,this.B,this.l,this.S,Fe,E),this.o){if(this.U&&!this.L){t:{if(this.g){var M,X=this.g;if((M=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(M)){var te=M;break t}}te=null}if(g=te)_s(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ss(this,g);else{this.o=!1,this.m=3,Gt(12),ai(this),Ti(this);break e}}if(this.R){g=!0;let Et;for(;!this.K&&this.C<k.length;)if(Et=pd(this,k),Et==fn){Fe==4&&(this.m=4,Gt(14),g=!1),_s(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Wt){this.m=4,Gt(15),_s(this.i,this.l,k,"[Invalid Chunk]"),g=!1;break}else _s(this.i,this.l,Et,null),Ss(this,Et);if(fd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||k.length!=0||this.h.h||(this.m=1,Gt(16),g=!1),this.o=this.o&&g,!g)_s(this.i,this.l,k,"[Invalid Chunked Response]"),ai(this),Ti(this);else if(k.length>0&&!this.W){this.W=!0;var ue=this.j;ue.g==this&&ue.aa&&!ue.P&&(ue.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),uu(ue),ue.P=!0,Gt(11))}}else _s(this.i,this.l,k,null),Ss(this,k);Fe==4&&ai(this),this.o&&!this.K&&(Fe==4?Ed(this.j,this):(this.o=!1,As(this)))}else lr(this.g),E==400&&k.indexOf("Unknown SID")>0?(this.m=3,Gt(12)):(this.m=0,Gt(13)),ai(this),Ti(this)}}}catch{}};function jm(g){if(!fd(g))return g.g.la();const E=An(g.g);if(E==="")return"";let k="";const M=E.length,X=Zi(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ai(g),Ti(g),"";g.h.i=new o.TextDecoder}for(let te=0;te<M;te++)g.h.h=!0,k+=g.h.i.decode(E[te],{stream:!(X&&te==M-1)});return E.length=0,g.h.g+=k,g.C=0,g.h.g}function fd(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function pd(g,E){var k=g.C,M=E.indexOf(`
`,k);return M==-1?fn:(k=Number(E.substring(k,M)),isNaN(k)?Wt:(M+=1,M+k>E.length?fn:(E=E.slice(M,M+k),g.C=M+k,E)))}Yi.prototype.cancel=function(){this.K=!0,ai(this)};function As(g){g.T=Date.now()+g.H,tl(g,g.H)}function tl(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=bs(d(g.aa,g),E)}function Es(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Yi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Ya(this.i,this.B),this.M!=2&&(ys(),Gt(17)),ai(this),this.m=2,Ti(this)):tl(this,this.T-g)};function Ti(g){g.j.I==0||g.K||Ed(g.j,g)}function ai(g){Es(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,Wc(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function Ss(g,E){try{var k=g.j;if(k.I!=0&&(k.g==g||xs(k.h,g))){if(!g.L&&xs(k.h,g)&&k.I==3){try{var M=k.Ba.g.parse(E)}catch{M=null}if(Array.isArray(M)&&M.length==3){var X=M;if(X[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<g.F)cl(k),Kr(k);else break e;ro(k),Gt(18)}}else k.xa=X[1],0<k.xa-k.K&&X[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=bs(d(k.Va,k),6e3));Ts(k.h)<=1&&k.ta&&(k.ta=void 0)}else Os(k,11)}else if((g.L||k.g==g)&&cl(k),!B(E))for(X=k.Ba.g.parse(E),E=0;E<X.length;E++){let nt=X[E];const Et=nt[0];if(!(Et<=k.K))if(k.K=Et,nt=nt[1],k.I==2)if(nt[0]=="c"){k.M=nt[1],k.ba=nt[2];const ki=nt[3];ki!=null&&(k.ka=ki,k.j.info("VER="+k.ka));const Ps=nt[4];Ps!=null&&(k.za=Ps,k.j.info("SVER="+k.za));const es=nt[5];es!=null&&typeof es=="number"&&es>0&&(M=1.5*es,k.O=M,k.j.info("backChannelRequestTimeoutMs_="+M)),M=k;const ts=g.g;if(ts){const ao=ts.g?ts.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ao){var te=M.h;te.g||ao.indexOf("spdy")==-1&&ao.indexOf("quic")==-1&&ao.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Jc(te,te.h),te.h=null))}if(M.G){const ul=ts.g?ts.g.getResponseHeader("X-HTTP-Session-Id"):null;ul&&(M.wa=ul,ut(M.J,M.G,ul))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-g.F,k.j.info("Handshake RTT: "+k.T+"ms")),M=k;var ue=g;if(M.na=xd(M,M.L?M.ba:null,M.W),ue.L){Zc(M.h,ue);var Fe=ue,Ut=M.O;Ut&&(Fe.H=Ut),Fe.D&&(Es(Fe),As(Fe)),M.g=ue}else wd(M);k.i.length>0&&Ds(k)}else nt[0]!="stop"&&nt[0]!="close"||Os(k,7);else k.I==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?Os(k,7):lu(k):nt[0]!="noop"&&k.l&&k.l.qa(nt),k.A=0)}}ys(4)}catch{}}var Kt=class{constructor(g,E){this.g=g,this.map=E}};function Xc(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qc(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Ts(g){return g.h?1:g.g?g.g.size:0}function xs(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function Jc(g,E){g.g?g.g.add(E):g.h=E}function Zc(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}Xc.prototype.cancel=function(){if(this.i=eu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function eu(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const k of g.g.values())E=E.concat(k.G);return E}return _(g.i)}var md=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nl(g,E){if(g){g=g.split("&");for(let k=0;k<g.length;k++){const M=g[k].indexOf("=");let X,te=null;M>=0?(X=g[k].substring(0,M),te=g[k].substring(M+1)):X=g[k],E(X,te?decodeURIComponent(te.replace(/\+/g," ")):"")}}}function oi(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof oi?(this.l=g.l,pn(this,g.j),this.o=g.o,this.g=g.g,zr(this,g.u),this.h=g.h,tu(this,bd(g.i)),this.m=g.m):g&&(E=String(g).match(md))?(this.l=!1,pn(this,E[1]||"",!0),this.o=Cs(E[2]||""),this.g=Cs(E[3]||"",!0),zr(this,E[4]),this.h=Cs(E[5]||"",!0),tu(this,E[6]||"",!0),this.m=Cs(E[7]||"")):(this.l=!1,this.i=new qr(null,this.l))}oi.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(Za(E,il,!0),":");var k=this.g;return(k||E=="file")&&(g.push("//"),(E=this.o)&&g.push(Za(E,il,!0),"@"),g.push(ar(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&g.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&g.push("/"),g.push(Za(k,k.charAt(0)=="/"?nu:gd,!0))),(k=this.i.toString())&&g.push("?",k),(k=this.m)&&g.push("#",Za(k,yd)),g.join("")},oi.prototype.resolve=function(g){const E=Yt(this);let k=!!g.j;k?pn(E,g.j):k=!!g.o,k?E.o=g.o:k=!!g.g,k?E.g=g.g:k=g.u!=null;var M=g.h;if(k)zr(E,g.u);else if(k=!!g.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var X=E.h.lastIndexOf("/");X!=-1&&(M=E.h.slice(0,X+1)+M)}if(X=M,X==".."||X==".")M="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){M=X.lastIndexOf("/",0)==0,X=X.split("/");const te=[];for(let ue=0;ue<X.length;){const Fe=X[ue++];Fe=="."?M&&ue==X.length&&te.push(""):Fe==".."?((te.length>1||te.length==1&&te[0]!="")&&te.pop(),M&&ue==X.length&&te.push("")):(te.push(Fe),M=!0)}M=te.join("/")}else M=X}return k?E.h=M:k=g.i.toString()!=="",k?tu(E,bd(g.i)):k=!!g.m,k&&(E.m=g.m),E};function Yt(g){return new oi(g)}function pn(g,E,k){g.j=k?Cs(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function zr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function tu(g,E,k){E instanceof qr?(g.i=E,rl(g.i,g.l)):(k||(E=Za(E,Vr)),g.i=new qr(E,g.l))}function ut(g,E,k){g.i.set(E,k)}function Ja(g){return ut(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Cs(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Za(g,E,k){return typeof g=="string"?(g=encodeURI(g).replace(E,Kn),k&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Kn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var il=/[#\/\?@]/g,gd=/[#\?:]/g,nu=/[#\?]/g,Vr=/[#\?@]/g,yd=/#/g;function qr(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Yn(g){g.g||(g.g=new Map,g.h=0,g.i&&nl(g.i,function(E,k){g.add(decodeURIComponent(E.replace(/\+/g," ")),k)}))}i=qr.prototype,i.add=function(g,E){Yn(this),this.i=null,g=Hr(this,g);let k=this.g.get(g);return k||this.g.set(g,k=[]),k.push(E),this.h+=1,this};function vd(g,E){Yn(g),E=Hr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function iu(g,E){return Yn(g),E=Hr(g,E),g.g.has(E)}i.forEach=function(g,E){Yn(this),this.g.forEach(function(k,M){k.forEach(function(X){g.call(E,X,M,this)},this)},this)};function su(g,E){Yn(g);let k=[];if(typeof E=="string")iu(g,E)&&(k=k.concat(g.g.get(Hr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)k=k.concat(g[E]);return k}i.set=function(g,E){return Yn(this),this.i=null,g=Hr(this,g),iu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},i.get=function(g,E){return g?(g=su(this,g),g.length>0?String(g[0]):E):E};function sl(g,E,k){vd(g,E),k.length>0&&(g.i=null,g.g.set(Hr(g,E),_(k)),g.h+=k.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let M=0;M<E.length;M++){var k=E[M];const X=ar(k);k=su(this,k);for(let te=0;te<k.length;te++){let ue=X;k[te]!==""&&(ue+="="+ar(k[te])),g.push(ue)}}return this.i=g.join("&")};function bd(g){const E=new qr;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Hr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function rl(g,E){E&&!g.j&&(Yn(g),g.i=null,g.g.forEach(function(k,M){const X=M.toLowerCase();M!=X&&(vd(this,M),sl(this,X,k))},g)),g.j=E}function Qi(g,E){const k=new Ki;if(o.Image){const M=new Image;M.onload=p(xi,k,"TestLoadImage: loaded",!0,E,M),M.onerror=p(xi,k,"TestLoadImage: error",!1,E,M),M.onabort=p(xi,k,"TestLoadImage: abort",!1,E,M),M.ontimeout=p(xi,k,"TestLoadImage: timeout",!1,E,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=g}else E(!1)}function ru(g,E){const k=new Ki,M=new AbortController,X=setTimeout(()=>{M.abort(),xi(k,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:M.signal}).then(te=>{clearTimeout(X),te.ok?xi(k,"TestPingServer: ok",!0,E):xi(k,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(X),xi(k,"TestPingServer: error",!1,E)})}function xi(g,E,k,M,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),M(k)}catch{}}function $r(){this.g=new ad}function ks(g){this.i=g.Sb||null,this.h=g.ab||!1}m(ks,od),ks.prototype.g=function(){return new eo(this.i,this.h)};function eo(g,E){$t.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(eo,$t),i=eo.prototype,i.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,Ji(this)},i.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Gr(this)),this.readyState=0},i.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Ji(this)),this.g&&(this.readyState=3,Ji(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;al(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function al(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}i.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?Gr(this):Ji(this),this.readyState==3&&al(this)}},i.Oa=function(g){this.g&&(this.response=this.responseText=g,Gr(this))},i.Na=function(g){this.g&&(this.response=g,Gr(this))},i.ga=function(){this.g&&Gr(this)};function Gr(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Ji(g)}i.setRequestHeader=function(g,E){this.A.append(g,E)},i.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var k=E.next();!k.done;)k=k.value,g.push(k[0]+": "+k[1]),k=E.next();return g.join(`\r
`)};function Ji(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(eo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ci(g){let E="";return we(g,function(k,M){E+=M,E+=":",E+=k,E+=`\r
`}),E}function to(g,E,k){e:{for(M in k){var M=!1;break e}M=!0}M||(k=Ci(k),typeof g=="string"?k!=null&&ar(k):ut(g,E,k))}function ft(g){$t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ft,$t);var Rs=/^https?$/i,au=["POST","PUT"];i=ft.prototype,i.Fa=function(g){this.H=g},i.ea=function(g,E,k,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Yc.g(),this.g.onreadystatechange=v(d(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(te){no(this,te);return}if(g=k||"",k=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var X in M)k.set(X,M[X]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const te of M.keys())k.set(te,M.get(te));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(k.keys()).find(te=>te.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(au,E,void 0)>=0)||M||X||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,ue]of k)this.g.setRequestHeader(te,ue);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(te){no(this,te)}};function no(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,ou(g),or(g)}function ou(g){g.A||(g.A=!0,on(g,"complete"),on(g,"error"))}i.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,on(this,"complete"),on(this,"abort"),or(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),or(this,!0)),ft.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?io(this):this.Xa())},i.Xa=function(){io(this)};function io(g){if(g.h&&typeof a<"u"){if(g.v&&Zi(g)==4)setTimeout(g.Ca.bind(g),0);else if(on(g,"readystatechange"),Zi(g)==4){g.h=!1;try{const te=g.ca();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var k;if(!(k=E)){var M;if(M=te===0){let ue=String(g.D).match(md)[1]||null;!ue&&o.self&&o.self.location&&(ue=o.self.location.protocol.slice(0,-1)),M=!Rs.test(ue?ue.toLowerCase():"")}k=M}if(k)on(g,"complete"),on(g,"success");else{g.o=6;try{var X=Zi(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",ou(g)}}finally{or(g)}}}}function or(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const k=g.g;g.g=null,E||on(g,"ready");try{k.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Zi(g){return g.g?g.g.readyState:0}i.ca=function(){try{return Zi(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),Nm(E)}};function An(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function lr(g){const E={};g=(g.g&&Zi(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<g.length;M++){if(B(g[M]))continue;var k=dd(g[M]);const X=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const te=E[X]||[];E[X]=te,te.push(k)}Oe(E,function(M){return M.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Is(g,E,k){return k&&k.internalChannelParams&&k.internalChannelParams[g]||E}function Wr(g){this.za=0,this.i=[],this.j=new Ki,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Is("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Is("baseRetryDelayMs",5e3,g),this.Za=Is("retryDelaySeedMs",1e4,g),this.Ta=Is("forwardChannelMaxRetries",2,g),this.va=Is("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Xc(g&&g.concurrentRequestLimit),this.Ba=new $r,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Wr.prototype,i.ka=8,i.I=1,i.connect=function(g,E,k,M){Gt(0),this.W=g,this.H=E||{},k&&M!==void 0&&(this.H.OSID=k,this.H.OAID=M),this.F=this.X,this.J=xd(this,null,this.W),Ds(this)};function lu(g){if(ol(g),g.I==3){var E=g.V++,k=Yt(g.J);if(ut(k,"SID",g.M),ut(k,"RID",E),ut(k,"TYPE","terminate"),so(g,k),E=new Yi(g,g.j,E),E.M=2,E.A=Ja(Yt(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!k&&o.Image&&(new Image().src=E.A,k=!0),k||(E.g=Cd(E.j,null),E.g.ea(E.A)),E.F=Date.now(),As(E)}Td(g)}function Kr(g){g.g&&(uu(g),g.g.cancel(),g.g=null)}function ol(g){Kr(g),g.v&&(o.clearTimeout(g.v),g.v=null),cl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Ds(g){if(!Qc(g.h)&&!g.m){g.m=!0;var E=g.Ea;z||O(),F||(z(),F=!0),R.add(E,g),g.D=0}}function ll(g,E){return Ts(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=bs(d(g.Ea,g,E),Sd(g,g.D)),g.D++,!0)}i.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Yi(this,this.j,g);let te=this.o;if(this.U&&(te?(te=H(te),le(te,this.U)):te=this.U),this.u!==null||this.R||(X.J=te,te=null),this.S)e:{for(var E=0,k=0;k<this.i.length;k++){t:{var M=this.i[k];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(E+=M,E>4096){E=k;break e}if(E===4096||k===this.i.length-1){E=k+1;break e}}E=1e3}else E=1e3;E=_d(this,X,E),k=Yt(this.J),ut(k,"RID",g),ut(k,"CVER",22),this.G&&ut(k,"X-HTTP-Session-Id",this.G),so(this,k),te&&(this.R?E="headers="+ar(Ci(te))+"&"+E:this.u&&to(k,this.u,te)),Jc(this.h,X),this.Ra&&ut(k,"TYPE","init"),this.S?(ut(k,"$req",E),ut(k,"SID","null"),X.U=!0,ws(X,k,null)):ws(X,k,E),this.I=2}}else this.I==3&&(g?cu(this,g):this.i.length==0||Qc(this.h)||cu(this))};function cu(g,E){var k;E?k=E.l:k=g.V++;const M=Yt(g.J);ut(M,"SID",g.M),ut(M,"RID",k),ut(M,"AID",g.K),so(g,M),g.u&&g.o&&to(M,g.u,g.o),k=new Yi(g,g.j,k,g.D+1),g.u===null&&(k.J=g.o),E&&(g.i=E.G.concat(g.i)),E=_d(g,k,1e3),k.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Jc(g.h,k),ws(k,M,E)}function so(g,E){g.H&&we(g.H,function(k,M){ut(E,M,k)}),g.l&&we({},function(k,M){ut(E,M,k)})}function _d(g,E,k){k=Math.min(g.i.length,k);const M=g.l?d(g.l.Ka,g.l,g):null;e:{var X=g.i;let Fe=-1;for(;;){const Ut=["count="+k];Fe==-1?k>0?(Fe=X[0].g,Ut.push("ofs="+Fe)):Fe=0:Ut.push("ofs="+Fe);let nt=!0;for(let Et=0;Et<k;Et++){var te=X[Et].g;const ki=X[Et].map;if(te-=Fe,te<0)Fe=Math.max(0,X[Et].g-100),nt=!1;else try{te="req"+te+"_"||"";try{var ue=ki instanceof Map?ki:Object.entries(ki);for(const[Ps,es]of ue){let ts=es;c(es)&&(ts=Fr(es)),Ut.push(te+Ps+"="+encodeURIComponent(ts))}}catch(Ps){throw Ut.push(te+"type="+encodeURIComponent("_badmap")),Ps}}catch{M&&M(ki)}}if(nt){ue=Ut.join("&");break e}}ue=void 0}return g=g.i.splice(0,k),E.G=g,ue}function wd(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;z||O(),F||(z(),F=!0),R.add(E,g),g.A=0}}function ro(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=bs(d(g.Da,g),Sd(g,g.A)),g.A++,!0)}i.Da=function(){if(this.v=null,Ad(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=bs(d(this.Wa,this),g)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Gt(10),Kr(this),Ad(this))};function uu(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function Ad(g){g.g=new Yi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Yt(g.na);ut(E,"RID","rpc"),ut(E,"SID",g.M),ut(E,"AID",g.K),ut(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&ut(E,"TO",g.ia),ut(E,"TYPE","xmlhttp"),so(g,E),g.u&&g.o&&to(E,g.u,g.o),g.O&&(g.g.H=g.O);var k=g.g;g=g.ba,k.M=1,k.A=Ja(Yt(E)),k.u=null,k.R=!0,el(k,g)}i.Va=function(){this.C!=null&&(this.C=null,Kr(this),ro(this),Gt(19))};function cl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Ed(g,E){var k=null;if(g.g==E){cl(g),uu(g),g.g=null;var M=2}else if(xs(g.h,E))k=E.G,Zc(g.h,E),M=1;else return;if(g.I!=0){if(E.o)if(M==1){k=E.u?E.u.length:0,E=Date.now()-E.F;var X=g.D;M=Zo(),on(M,new vs(M,k)),Ds(g)}else wd(g);else if(X=E.m,X==3||X==0&&E.X>0||!(M==1&&ll(g,E)||M==2&&ro(g)))switch(k&&k.length>0&&(E=g.h,E.i=E.i.concat(k)),X){case 1:Os(g,5);break;case 4:Os(g,10);break;case 3:Os(g,6);break;default:Os(g,2)}}}function Sd(g,E){let k=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(k*=2),k*E}function Os(g,E){if(g.j.info("Error code "+E),E==2){var k=d(g.bb,g),M=g.Ua;const X=!M;M=new oi(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pn(M,"https"),Ja(M),X?Qi(M.toString(),k):ru(M.toString(),k)}else Gt(2);g.I=0,g.l&&g.l.pa(E),Td(g),ol(g)}i.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function Td(g){if(g.I=0,g.ja=[],g.l){const E=eu(g.h);(E.length!=0||g.i.length!=0)&&(S(g.ja,E),S(g.ja,g.i),g.h.i.length=0,_(g.i),g.i.length=0),g.l.oa()}}function xd(g,E,k){var M=k instanceof oi?Yt(k):new oi(k);if(M.g!="")E&&(M.g=E+"."+M.g),zr(M,M.u);else{var X=o.location;M=X.protocol,E=E?E+"."+X.hostname:X.hostname,X=+X.port;const te=new oi(null);M&&pn(te,M),E&&(te.g=E),X&&zr(te,X),k&&(te.h=k),M=te}return k=g.G,E=g.wa,k&&E&&ut(M,k,E),ut(M,"VER",g.ka),so(g,M),M}function Cd(g,E,k){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new ft(new ks({ab:k})):new ft(g.ma),E.Fa(g.L),E}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function kd(){}i=kd.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Yr(){}Yr.prototype.g=function(g,E){return new qn(g,E)};function qn(g,E){$t.call(this),this.g=new Wr(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!B(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!B(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new cr(this)}m(qn,$t),qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},qn.prototype.close=function(){lu(this.g)},qn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var k={};k.__data__=g,g=k}else this.v&&(k={},k.__data__=Fr(g),g=k);E.i.push(new Kt(E.Ya++,g)),E.I==3&&Ds(E)},qn.prototype.N=function(){this.g.l=null,delete this.j,lu(this.g),delete this.g,qn.Z.N.call(this)};function Rd(g){wn.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const k in E){g=k;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}m(Rd,wn);function Id(){Si.call(this),this.status=1}m(Id,Si);function cr(g){this.g=g}m(cr,kd),cr.prototype.ra=function(){on(this.g,"a")},cr.prototype.qa=function(g){on(this.g,new Rd(g))},cr.prototype.pa=function(g){on(this.g,new Id)},cr.prototype.oa=function(){on(this.g,"b")},Yr.prototype.createWebChannel=Yr.prototype.g,qn.prototype.send=qn.prototype.o,qn.prototype.open=qn.prototype.m,qn.prototype.close=qn.prototype.close,PC=function(){return new Yr},OC=function(){return Zo()},DC=Bt,cb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Xa.NO_ERROR=0,Xa.TIMEOUT=8,Xa.HTTP_ERROR=6,ap=Xa,Kc.COMPLETE="complete",IC=Kc,ld.EventType=Wi,Wi.OPEN="a",Wi.CLOSE="b",Wi.ERROR="c",Wi.MESSAGE="d",$t.prototype.listen=$t.prototype.J,sh=ld,ft.prototype.listenOnce=ft.prototype.K,ft.prototype.getLastError=ft.prototype.Ha,ft.prototype.getLastErrorCode=ft.prototype.ya,ft.prototype.getStatus=ft.prototype.ca,ft.prototype.getResponseJson=ft.prototype.La,ft.prototype.getResponseText=ft.prototype.la,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Fa,RC=ft}).apply(typeof Ff<"u"?Ff:typeof self<"u"?self:typeof window<"u"?window:{});const VS="@firebase/firestore",qS="4.9.3";class jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jn.UNAUTHENTICATED=new jn(null),jn.GOOGLE_CREDENTIALS=new jn("google-credentials-uid"),jn.FIRST_PARTY=new jn("first-party-uid"),jn.MOCK_USER=new jn("mock-user");let Mc="12.7.0";const Uo=new em("@firebase/firestore");function Xl(){return Uo.logLevel}function me(i,...e){if(Uo.logLevel<=We.DEBUG){const t=e.map(p_);Uo.debug(`Firestore (${Mc}): ${i}`,...t)}}function Nr(i,...e){if(Uo.logLevel<=We.ERROR){const t=e.map(p_);Uo.error(`Firestore (${Mc}): ${i}`,...t)}}function Ec(i,...e){if(Uo.logLevel<=We.WARN){const t=e.map(p_);Uo.warn(`Firestore (${Mc}): ${i}`,...t)}}function p_(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}function Be(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,NC(i,n,t)}function NC(i,e,t){let n=`FIRESTORE (${Mc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Nr(n),new Error(n)}function Ot(i,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,i||NC(e,s,n)}function Je(i,e){return i}const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ve extends Gi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cc{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class MC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Fj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(jn.UNAUTHENTICATED)))}shutdown(){}}class zj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Vj{constructor(e){this.t=e,this.currentUser=jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ot(this.o===void 0,42304);let n=this.i;const s=h=>this.i!==n?(n=this.i,t(h)):Promise.resolve();let a=new cc;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new cc,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const h=a;e.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},c=h=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((h=>c(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new cc)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ot(typeof n.accessToken=="string",31837,{l:n}),new MC(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ot(e===null||typeof e=="string",2055,{h:e}),new jn(e)}}class qj{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=jn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Hj{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new qj(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(jn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class HS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $j{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ot(this.o===void 0,3512);const n=a=>{a.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,me("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>n(a)))};const s=a=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new HS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ot(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new HS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Gj(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}class LC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=Gj(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<t&&(n+=e.charAt(s[a]%62))}return n}}function Xe(i,e){return i<e?-1:i>e?1:0}function ub(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const s=i.charAt(n),a=e.charAt(n);if(s!==a)return tv(s)===tv(a)?Xe(s,a):tv(s)?1:-1}return Xe(i.length,e.length)}const Wj=55296,Kj=57343;function tv(i){const e=i.charCodeAt(0);return e>=Wj&&e<=Kj}function Sc(i,e,t){return i.length===e.length&&i.every(((n,s)=>t(n,e[s])))}const $S="__name__";class qs{constructor(e,t,n){t===void 0?t=0:t>e.length&&Be(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Be(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return qs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qs?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const a=qs.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Xe(e.length,t.length)}static compareSegments(e,t){const n=qs.isNumericId(e),s=qs.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?qs.extractNumericId(e).compare(qs.extractNumericId(t)):ub(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Oa.fromString(e.substring(4,e.length-2))}}class Ct extends qs{construct(e,t,n){return new Ct(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ve(ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((s=>s.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const Yj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Un extends qs{construct(e,t,n){return new Un(e,t,n)}static isValidIdentifier(e){return Yj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Un.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$S}static keyField(){return new Un([$S])}static fromServerFormat(e){const t=[];let n="",s=0;const a=()=>{if(n.length===0)throw new ve(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new ve(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ve(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(a(),s++)}if(a(),o)throw new ve(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Un(t)}static emptyPath(){return new Un([])}}class xe{constructor(e){this.path=e}static fromPath(e){return new xe(Ct.fromString(e))}static fromName(e){return new xe(Ct.fromString(e).popFirst(5))}static empty(){return new xe(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xe(new Ct(e.slice()))}}function Xj(i,e,t,n){if(e===!0&&n===!0)throw new ve(ce.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function GS(i){if(xe.isDocumentKey(i))throw new ve(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function jC(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function nm(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Be(12329,{type:typeof i})}function op(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new ve(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=nm(i);throw new ve(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function an(i,e){const t={typeString:i};return e&&(t.value=e),t}function $h(i,e){if(!jC(i))throw new ve(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const o=i[n];if(s&&typeof o!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${n}' field to equal '${a.value}'`;break}}if(t)throw new ve(ce.INVALID_ARGUMENT,t);return!0}const WS=-62135596800,KS=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*KS);return new kt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ve(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ve(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<WS)throw new ve(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ve(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/KS}_compareTo(e){return this.seconds===e.seconds?Xe(this.nanoseconds,e.nanoseconds):Xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($h(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-WS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:an("string",kt._jsonSchemaVersion),seconds:an("number"),nanoseconds:an("number")};class je{static fromTimestamp(e){return new je(e)}static min(){return new je(new kt(0,0))}static max(){return new je(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const kh=-1;function Qj(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=je.fromTimestamp(n===1e9?new kt(t+1,0):new kt(t,n));return new Ma(s,xe.empty(),e)}function Jj(i){return new Ma(i.readTime,i.key,kh)}class Ma{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ma(je.min(),xe.empty(),kh)}static max(){return new Ma(je.max(),xe.empty(),kh)}}function Zj(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=xe.comparator(i.documentKey,e.documentKey),t!==0?t:Xe(i.largestBatchId,e.largestBatchId))}const eB="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tB{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function im(i){if(i.code!==ce.FAILED_PRECONDITION||i.message!==eB)throw i;me("LocalStore","Unexpectedly lost primary lease")}class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,n)=>{t(e)}))}static reject(e){return new oe(((t,n)=>{n(e)}))}static waitFor(e){return new oe(((t,n)=>{let s=0,a=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++a,o&&a===s&&t()}),(h=>n(h)))})),o=!0,a===s&&t()}))}static or(e){let t=oe.resolve(!1);for(const n of e)t=t.next((s=>s?oe.resolve(s):n()));return t}static forEach(e,t){const n=[];return e.forEach(((s,a)=>{n.push(t.call(this,s,a))})),this.waitFor(n)}static mapArray(e,t){return new oe(((n,s)=>{const a=e.length,o=new Array(a);let c=0;for(let h=0;h<a;h++){const d=h;t(e[d]).next((p=>{o[d]=p,++c,c===a&&n(o)}),(p=>s(p)))}}))}static doWhile(e,t){return new oe(((n,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):n()};a()}))}}function nB(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Lc(i){return i.name==="IndexedDbTransactionError"}class sm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sm.ce=-1;const iB=-1;function rm(i){return i==null}function Tp(i){return i===0&&1/i==-1/0}function sB(i){return typeof i=="number"&&Number.isInteger(i)&&!Tp(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const BC="";function rB(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=YS(e)),e=aB(i.get(t),e);return YS(e)}function aB(i,e){let t=e;const n=i.length;for(let s=0;s<n;s++){const a=i.charAt(s);switch(a){case"\0":t+="";break;case BC:t+="";break;default:t+=a}}return t}function YS(i){return i+BC+""}function XS(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function jc(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function UC(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}class Ht{constructor(e,t){this.comparator=e,this.root=t||Dn.EMPTY}insert(e,t){return new Ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dn.BLACK,null,null))}remove(e){return new Ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zf(this.root,e,this.comparator,!1)}getReverseIterator(){return new zf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zf(this.root,e,this.comparator,!0)}}class zf{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dn{constructor(e,t,n,s,a){this.key=e,this.value=t,this.color=n??Dn.RED,this.left=s??Dn.EMPTY,this.right=a??Dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,a){return new Dn(e??this.key,t??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,n),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Dn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Be(27949);return e+(this.isRed()?0:1)}}Dn.EMPTY=null,Dn.RED=!0,Dn.BLACK=!1;Dn.EMPTY=new class{constructor(){this.size=0}get key(){throw Be(57766)}get value(){throw Be(16141)}get color(){throw Be(16727)}get left(){throw Be(29726)}get right(){throw Be(36894)}copy(e,t,n,s,a){return this}insert(e,t,n){return new Dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hn{constructor(e){this.comparator=e,this.data=new Ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new QS(this.data.getIterator())}getIteratorFrom(e){return new QS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof hn)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new hn(this.comparator);return t.data=e,t}}class QS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ka{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new ka([])}unionWith(e){let t=new hn(Un.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ka(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sc(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}class FC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Nn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new FC("Invalid base64 string: "+a):a}})(e);return new Nn(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a})(e);return new Nn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nn.EMPTY_BYTE_STRING=new Nn("");const oB=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function La(i){if(Ot(!!i,39018),typeof i=="string"){let e=0;const t=oB.exec(i);if(Ot(!!t,46558,{timestamp:i}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:qt(i.seconds),nanos:qt(i.nanos)}}function qt(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function ja(i){return typeof i=="string"?Nn.fromBase64String(i):Nn.fromUint8Array(i)}const zC="server_timestamp",VC="__type__",qC="__previous_value__",HC="__local_write_time__";function m_(i){return(i?.mapValue?.fields||{})[VC]?.stringValue===zC}function am(i){const e=i.mapValue.fields[qC];return m_(e)?am(e):e}function Rh(i){const e=La(i.mapValue.fields[HC].timestampValue);return new kt(e.seconds,e.nanos)}class lB{constructor(e,t,n,s,a,o,c,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const xp="(default)";class Ih{constructor(e,t){this.projectId=e,this.database=t||xp}static empty(){return new Ih("","")}get isDefaultDatabase(){return this.database===xp}isEqual(e){return e instanceof Ih&&e.projectId===this.projectId&&e.database===this.database}}const $C="__type__",cB="__max__",Vf={mapValue:{}},GC="__vector__",Cp="value";function Ba(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?m_(i)?4:hB(i)?9007199254740991:uB(i)?10:11:Be(28295,{value:i})}function Zs(i,e){if(i===e)return!0;const t=Ba(i);if(t!==Ba(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Rh(i).isEqual(Rh(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=La(s.timestampValue),c=La(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(s,a){return ja(s.bytesValue).isEqual(ja(a.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(s,a){return qt(s.geoPointValue.latitude)===qt(a.geoPointValue.latitude)&&qt(s.geoPointValue.longitude)===qt(a.geoPointValue.longitude)})(i,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return qt(s.integerValue)===qt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=qt(s.doubleValue),c=qt(a.doubleValue);return o===c?Tp(o)===Tp(c):isNaN(o)&&isNaN(c)}return!1})(i,e);case 9:return Sc(i.arrayValue.values||[],e.arrayValue.values||[],Zs);case 10:case 11:return(function(s,a){const o=s.mapValue.fields||{},c=a.mapValue.fields||{};if(XS(o)!==XS(c))return!1;for(const h in o)if(o.hasOwnProperty(h)&&(c[h]===void 0||!Zs(o[h],c[h])))return!1;return!0})(i,e);default:return Be(52216,{left:i})}}function Dh(i,e){return(i.values||[]).find((t=>Zs(t,e)))!==void 0}function Tc(i,e){if(i===e)return 0;const t=Ba(i),n=Ba(e);if(t!==n)return Xe(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xe(i.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=qt(a.integerValue||a.doubleValue),h=qt(o.integerValue||o.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1})(i,e);case 3:return JS(i.timestampValue,e.timestampValue);case 4:return JS(Rh(i),Rh(e));case 5:return ub(i.stringValue,e.stringValue);case 6:return(function(a,o){const c=ja(a),h=ja(o);return c.compareTo(h)})(i.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),h=o.split("/");for(let d=0;d<c.length&&d<h.length;d++){const p=Xe(c[d],h[d]);if(p!==0)return p}return Xe(c.length,h.length)})(i.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=Xe(qt(a.latitude),qt(o.latitude));return c!==0?c:Xe(qt(a.longitude),qt(o.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return ZS(i.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},h=o.fields||{},d=c[Cp]?.arrayValue,p=h[Cp]?.arrayValue,m=Xe(d?.values?.length||0,p?.values?.length||0);return m!==0?m:ZS(d,p)})(i.mapValue,e.mapValue);case 11:return(function(a,o){if(a===Vf.mapValue&&o===Vf.mapValue)return 0;if(a===Vf.mapValue)return 1;if(o===Vf.mapValue)return-1;const c=a.fields||{},h=Object.keys(c),d=o.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const v=ub(h[m],p[m]);if(v!==0)return v;const _=Tc(c[h[m]],d[p[m]]);if(_!==0)return _}return Xe(h.length,p.length)})(i.mapValue,e.mapValue);default:throw Be(23264,{he:t})}}function JS(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Xe(i,e);const t=La(i),n=La(e),s=Xe(t.seconds,n.seconds);return s!==0?s:Xe(t.nanos,n.nanos)}function ZS(i,e){const t=i.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const a=Tc(t[s],n[s]);if(a)return a}return Xe(t.length,n.length)}function xc(i){return hb(i)}function hb(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const n=La(t);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return ja(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return xe.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let n="[",s=!0;for(const a of t.values||[])s?s=!1:n+=",",n+=hb(a);return n+"]"})(i.arrayValue):"mapValue"in i?(function(t){const n=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const o of n)a?a=!1:s+=",",s+=`${o}:${hb(t.fields[o])}`;return s+"}"})(i.mapValue):Be(61005,{value:i})}function lp(i){switch(Ba(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=am(i);return e?16+lp(e):16;case 5:return 2*i.stringValue.length;case 6:return ja(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,a)=>s+lp(a)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return jc(n.fields,((a,o)=>{s+=a.length+lp(o)})),s})(i.mapValue);default:throw Be(13486,{value:i})}}function eT(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function db(i){return!!i&&"integerValue"in i}function g_(i){return!!i&&"arrayValue"in i}function tT(i){return!!i&&"nullValue"in i}function nT(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function nv(i){return!!i&&"mapValue"in i}function uB(i){return(i?.mapValue?.fields||{})[$C]?.stringValue===GC}function ph(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return jc(i.mapValue.fields,((t,n)=>e.mapValue.fields[t]=ph(n))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ph(i.arrayValue.values[t]);return e}return{...i}}function hB(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===cB}class $s{constructor(e){this.value=e}static empty(){return new $s({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!nv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ph(t)}setAll(e){let t=Un.emptyPath(),n={},s=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const h=this.getFieldsMap(t);this.applyChanges(h,n,s),n={},s=[],t=c.popLast()}o?n[c.lastSegment()]=ph(o):s.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,n,s)}delete(e){const t=this.field(e.popLast());nv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];nv(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){jc(t,((s,a)=>e[s]=a));for(const s of n)delete e[s]}clone(){return new $s(ph(this.value))}}class Bn{constructor(e,t,n,s,a,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Bn(e,0,je.min(),je.min(),je.min(),$s.empty(),0)}static newFoundDocument(e,t,n,s){return new Bn(e,1,t,je.min(),n,s,0)}static newNoDocument(e,t){return new Bn(e,2,t,je.min(),je.min(),$s.empty(),0)}static newUnknownDocument(e,t){return new Bn(e,3,t,je.min(),je.min(),$s.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$s.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$s.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class kp{constructor(e,t){this.position=e,this.inclusive=t}}function iT(i,e,t){let n=0;for(let s=0;s<i.position.length;s++){const a=e[s],o=i.position[s];if(a.field.isKeyField()?n=xe.comparator(xe.fromName(o.referenceValue),t.key):n=Tc(o,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function sT(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Zs(i.position[t],e.position[t]))return!1;return!0}class Oh{constructor(e,t="asc"){this.field=e,this.dir=t}}function dB(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}class WC{}class rn extends WC{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new pB(e,t,n):t==="array-contains"?new yB(e,n):t==="in"?new vB(e,n):t==="not-in"?new bB(e,n):t==="array-contains-any"?new _B(e,n):new rn(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new mB(e,n):new gB(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Tc(t,this.value)):t!==null&&Ba(this.value)===Ba(t)&&this.matchesComparison(Tc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fs extends WC{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new fs(e,t)}matches(e){return KC(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function KC(i){return i.op==="and"}function YC(i){return fB(i)&&KC(i)}function fB(i){for(const e of i.filters)if(e instanceof fs)return!1;return!0}function fb(i){if(i instanceof rn)return i.field.canonicalString()+i.op.toString()+xc(i.value);if(YC(i))return i.filters.map((e=>fb(e))).join(",");{const e=i.filters.map((t=>fb(t))).join(",");return`${i.op}(${e})`}}function XC(i,e){return i instanceof rn?(function(n,s){return s instanceof rn&&n.op===s.op&&n.field.isEqual(s.field)&&Zs(n.value,s.value)})(i,e):i instanceof fs?(function(n,s){return s instanceof fs&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((a,o,c)=>a&&XC(o,s.filters[c])),!0):!1})(i,e):void Be(19439)}function QC(i){return i instanceof rn?(function(t){return`${t.field.canonicalString()} ${t.op} ${xc(t.value)}`})(i):i instanceof fs?(function(t){return t.op.toString()+" {"+t.getFilters().map(QC).join(" ,")+"}"})(i):"Filter"}class pB extends rn{constructor(e,t,n){super(e,t,n),this.key=xe.fromName(n.referenceValue)}matches(e){const t=xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class mB extends rn{constructor(e,t){super(e,"in",t),this.keys=JC("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class gB extends rn{constructor(e,t){super(e,"not-in",t),this.keys=JC("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function JC(i,e){return(e.arrayValue?.values||[]).map((t=>xe.fromName(t.referenceValue)))}class yB extends rn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return g_(t)&&Dh(t.arrayValue,this.value)}}class vB extends rn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Dh(this.value.arrayValue,t)}}class bB extends rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Dh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Dh(this.value.arrayValue,t)}}class _B extends rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!g_(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>Dh(this.value.arrayValue,n)))}}class wB{constructor(e,t=null,n=[],s=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function rT(i,e=null,t=[],n=[],s=null,a=null,o=null){return new wB(i,e,t,n,s,a,o)}function y_(i){const e=Je(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>fb(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),rm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>xc(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>xc(n))).join(",")),e.Te=t}return e.Te}function v_(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!dB(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!XC(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!sT(i.startAt,e.startAt)&&sT(i.endAt,e.endAt)}function pb(i){return xe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}class Bc{constructor(e,t=null,n=[],s=[],a=null,o="F",c=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function AB(i,e,t,n,s,a,o,c){return new Bc(i,e,t,n,s,a,o,c)}function b_(i){return new Bc(i)}function aT(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function ZC(i){return i.collectionGroup!==null}function mh(i){const e=Je(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new hn(Un.comparator);return o.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Oh(a,n))})),t.has(Un.keyField().canonicalString())||e.Ie.push(new Oh(Un.keyField(),n))}return e.Ie}function Ws(i){const e=Je(i);return e.Ee||(e.Ee=EB(e,mh(i))),e.Ee}function EB(i,e){if(i.limitType==="F")return rT(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Oh(s.field,a)}));const t=i.endAt?new kp(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new kp(i.startAt.position,i.startAt.inclusive):null;return rT(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function mb(i,e){const t=i.filters.concat([e]);return new Bc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function gb(i,e,t){return new Bc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function om(i,e){return v_(Ws(i),Ws(e))&&i.limitType===e.limitType}function ek(i){return`${y_(Ws(i))}|lt:${i.limitType}`}function Ql(i){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((s=>QC(s))).join(", ")}]`),rm(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((s=>xc(s))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((s=>xc(s))).join(",")),`Target(${n})`})(Ws(i))}; limitType=${i.limitType})`}function lm(i,e){return e.isFoundDocument()&&(function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):xe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(i,e)&&(function(n,s){for(const a of mh(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(i,e)&&(function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0})(i,e)&&(function(n,s){return!(n.startAt&&!(function(o,c,h){const d=iT(o,c,h);return o.inclusive?d<=0:d<0})(n.startAt,mh(n),s)||n.endAt&&!(function(o,c,h){const d=iT(o,c,h);return o.inclusive?d>=0:d>0})(n.endAt,mh(n),s))})(i,e)}function SB(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function tk(i){return(e,t)=>{let n=!1;for(const s of mh(i)){const a=TB(s,e,t);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function TB(i,e,t){const n=i.field.isKeyField()?xe.comparator(e.key,t.key):(function(a,o,c){const h=o.data.field(a),d=c.data.field(a);return h!==null&&d!==null?Tc(h,d):Be(42886)})(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Be(19790,{direction:i.dir})}}class Ko{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){jc(this.inner,((t,n)=>{for(const[s,a]of n)e(s,a)}))}isEmpty(){return UC(this.inner)}size(){return this.innerSize}}const xB=new Ht(xe.comparator);function Ua(){return xB}const nk=new Ht(xe.comparator);function rh(...i){let e=nk;for(const t of i)e=e.insert(t.key,t);return e}function CB(i){let e=nk;return i.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Do(){return gh()}function ik(){return gh()}function gh(){return new Ko((i=>i.toString()),((i,e)=>i.isEqual(e)))}const kB=new hn(xe.comparator);function Ze(...i){let e=kB;for(const t of i)e=e.add(t);return e}const RB=new hn(Xe);function IB(){return RB}function __(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tp(e)?"-0":e}}function sk(i){return{integerValue:""+i}}function DB(i,e){return sB(e)?sk(e):__(i,e)}class cm{constructor(){this._=void 0}}function OB(i,e,t){return i instanceof yb?(function(s,a){const o={fields:{[VC]:{stringValue:zC},[HC]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&m_(a)&&(a=am(a)),a&&(o.fields[qC]=a),{mapValue:o}})(t,e):i instanceof Rp?rk(i,e):i instanceof Ip?ak(i,e):(function(s,a){const o=NB(s,a),c=oT(o)+oT(s.Ae);return db(o)&&db(s.Ae)?sk(c):__(s.serializer,c)})(i,e)}function PB(i,e,t){return i instanceof Rp?rk(i,e):i instanceof Ip?ak(i,e):t}function NB(i,e){return i instanceof vb?(function(n){return db(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(e)?e:{integerValue:0}:null}class yb extends cm{}class Rp extends cm{constructor(e){super(),this.elements=e}}function rk(i,e){const t=ok(e);for(const n of i.elements)t.some((s=>Zs(s,n)))||t.push(n);return{arrayValue:{values:t}}}class Ip extends cm{constructor(e){super(),this.elements=e}}function ak(i,e){let t=ok(e);for(const n of i.elements)t=t.filter((s=>!Zs(s,n)));return{arrayValue:{values:t}}}class vb extends cm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function oT(i){return qt(i.integerValue||i.doubleValue)}function ok(i){return g_(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function MB(i,e){return i.field.isEqual(e.field)&&(function(n,s){return n instanceof Rp&&s instanceof Rp||n instanceof Ip&&s instanceof Ip?Sc(n.elements,s.elements,Zs):n instanceof vb&&s instanceof vb?Zs(n.Ae,s.Ae):n instanceof yb&&s instanceof yb})(i.transform,e.transform)}class jo{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new jo}static exists(e){return new jo(void 0,e)}static updateTime(e){return new jo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cp(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class w_{}function lk(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new jB(i.key,jo.none()):new A_(i.key,i.data,jo.none());{const t=i.data,n=$s.empty();let s=new hn(Un.comparator);for(let a of e.fields)if(!s.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?n.delete(a):n.set(a,o),s=s.add(a)}return new um(i.key,n,new ka(s.toArray()),jo.none())}}function LB(i,e,t){i instanceof A_?(function(s,a,o){const c=s.value.clone(),h=cT(s.fieldTransforms,a,o.transformResults);c.setAll(h),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(i,e,t):i instanceof um?(function(s,a,o){if(!cp(s.precondition,a))return void a.convertToUnknownDocument(o.version);const c=cT(s.fieldTransforms,a,o.transformResults),h=a.data;h.setAll(ck(s)),h.setAll(c),a.convertToFoundDocument(o.version,h).setHasCommittedMutations()})(i,e,t):(function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function yh(i,e,t,n){return i instanceof A_?(function(a,o,c,h){if(!cp(a.precondition,o))return c;const d=a.value.clone(),p=uT(a.fieldTransforms,h,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(i,e,t,n):i instanceof um?(function(a,o,c,h){if(!cp(a.precondition,o))return c;const d=uT(a.fieldTransforms,h,o),p=o.data;return p.setAll(ck(a)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((m=>m.field)))})(i,e,t,n):(function(a,o,c){return cp(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(i,e,t)}function lT(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Sc(n,s,((a,o)=>MB(a,o)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class A_ extends w_{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class um extends w_{constructor(e,t,n,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function ck(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}})),e}function cT(i,e,t){const n=new Map;Ot(i.length===t.length,32656,{Re:t.length,Ve:i.length});for(let s=0;s<t.length;s++){const a=i[s],o=a.transform,c=e.data.field(a.field);n.set(a.field,PB(o,c,t[s]))}return n}function uT(i,e,t){const n=new Map;for(const s of i){const a=s.transform,o=t.data.field(s.field);n.set(s.field,OB(a,o,e))}return n}class jB extends w_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BB{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&LB(a,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=yh(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=yh(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=ik();return this.mutations.forEach((s=>{const a=e.get(s.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(s.key)?null:c;const h=lk(o,c);h!==null&&n.set(s.key,h),o.isValidDocument()||o.convertToNoDocument(je.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ze())}isEqual(e){return this.batchId===e.batchId&&Sc(this.mutations,e.mutations,((t,n)=>lT(t,n)))&&Sc(this.baseMutations,e.baseMutations,((t,n)=>lT(t,n)))}}class UB{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class FB{constructor(e,t){this.count=e,this.unchangedNames=t}}var nn,Qe;function uk(i){if(i===void 0)return Nr("GRPC error has no .code"),ce.UNKNOWN;switch(i){case nn.OK:return ce.OK;case nn.CANCELLED:return ce.CANCELLED;case nn.UNKNOWN:return ce.UNKNOWN;case nn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case nn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case nn.INTERNAL:return ce.INTERNAL;case nn.UNAVAILABLE:return ce.UNAVAILABLE;case nn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case nn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case nn.NOT_FOUND:return ce.NOT_FOUND;case nn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case nn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case nn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case nn.ABORTED:return ce.ABORTED;case nn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case nn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case nn.DATA_LOSS:return ce.DATA_LOSS;default:return Be(39323,{code:i})}}(Qe=nn||(nn={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";function zB(){return new TextEncoder}const VB=new Oa([4294967295,4294967295],0);function hT(i){const e=zB().encode(i),t=new kC;return t.update(e),new Uint8Array(t.digest())}function dT(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Oa([t,n],0),new Oa([s,a],0)]}class E_{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ah(`Invalid padding: ${t}`);if(n<0)throw new ah(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ah(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new ah(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Oa.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(Oa.fromNumber(n)));return s.compare(VB)===1&&(s=new Oa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=hT(e),[n,s]=dT(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(n,s,a);if(!this.we(o))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new E_(a,s,t);return n.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=hT(e),[n,s]=dT(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(n,s,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ah extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hm{constructor(e,t,n,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,Gh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new hm(je.min(),s,new Ht(Xe),Ua(),Ze())}}class Gh{constructor(e,t,n,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Gh(n,t,Ze(),Ze(),Ze())}}class up{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class hk{constructor(e,t){this.targetId=e,this.Ce=t}}class dk{constructor(e,t,n=Nn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class fT{constructor(){this.ve=0,this.Fe=pT(),this.Me=Nn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ze(),t=Ze(),n=Ze();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:Be(38017,{changeType:a})}})),new Gh(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=pT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class qB{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ua(),this.Je=qf(),this.He=qf(),this.Ye=new Ht(Xe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Be(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(pb(a))if(n===0){const o=new xe(a.path);this.et(t,o,Bn.newNoDocument(o,je.min()))}else Ot(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const c=this.ut(e),h=c?this.ct(c,e,o):1;if(h!==0){this.it(t);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=t;let o,c;try{o=ja(n).toUint8Array()}catch(h){if(h instanceof FC)return Ec("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new E_(o,s,a)}catch(h){return Ec(h instanceof ah?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&pb(c.target)){const h=new xe(c.target.path);this.It(h).has(o)||this.Et(o,h)||this.et(o,h,Bn.newNoDocument(h,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let n=Ze();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const s=new hm(e,t,this.Ye,this.je,n);return this.je=Ua(),this.Je=qf(),this.He=qf(),this.Ye=new Ht(Xe),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new fT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new hn(Xe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new hn(Xe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||me("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function qf(){return new Ht(xe.comparator)}function pT(){return new Ht(xe.comparator)}const HB={asc:"ASCENDING",desc:"DESCENDING"},$B={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GB={and:"AND",or:"OR"};class WB{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bb(i,e){return i.useProto3Json||rm(e)?e:{value:e}}function _b(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fk(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function uc(i){return Ot(!!i,49232),je.fromTimestamp((function(t){const n=La(t);return new kt(n.seconds,n.nanos)})(i))}function pk(i,e){return wb(i,e).canonicalString()}function wb(i,e){const t=(function(s){return new Ct(["projects",s.projectId,"databases",s.database])})(i).child("documents");return e===void 0?t:t.child(e)}function mk(i){const e=Ct.fromString(i);return Ot(_k(e),10190,{key:e.toString()}),e}function iv(i,e){const t=mk(e);if(t.get(1)!==i.databaseId.projectId)throw new ve(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new ve(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new xe(yk(t))}function gk(i,e){return pk(i.databaseId,e)}function KB(i){const e=mk(i);return e.length===4?Ct.emptyPath():yk(e)}function mT(i){return new Ct(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function yk(i){return Ot(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function YB(i,e){let t;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Be(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(d,p){return d.useProto3Json?(Ot(p===void 0||typeof p=="string",58123),Nn.fromBase64String(p||"")):(Ot(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Nn.fromUint8Array(p||new Uint8Array))})(i,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const p=d.code===void 0?ce.UNKNOWN:uk(d.code);return new ve(p,d.message||"")})(o);t=new dk(n,s,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=iv(i,n.document.name),a=uc(n.document.updateTime),o=n.document.createTime?uc(n.document.createTime):je.min(),c=new $s({mapValue:{fields:n.document.fields}}),h=Bn.newFoundDocument(s,a,o,c),d=n.targetIds||[],p=n.removedTargetIds||[];t=new up(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=iv(i,n.document),a=n.readTime?uc(n.readTime):je.min(),o=Bn.newNoDocument(s,a),c=n.removedTargetIds||[];t=new up([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=iv(i,n.document),a=n.removedTargetIds||[];t=new up([],a,s,null)}else{if(!("filter"in e))return Be(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,o=new FB(s,a),c=n.targetId;t=new hk(c,o)}}return t}function XB(i,e){return{documents:[gk(i,e.path)]}}function QB(i,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=gk(i,s);const a=(function(d){if(d.length!==0)return bk(fs.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((p=>(function(v){return{field:Jl(v.field),direction:eU(v.dir)}})(p)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=bb(i,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:s}}function JB(i){let e=KB(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){Ot(n===1,65062);const p=t.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let a=[];t.where&&(a=(function(m){const v=vk(m);return v instanceof fs&&YC(v)?v.getFilters():[v]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((v=>(function(S){return new Oh(Zl(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(v)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let v;return v=typeof m=="object"?m.value:m,rm(v)?null:v})(t.limit));let h=null;t.startAt&&(h=(function(m){const v=!!m.before,_=m.values||[];return new kp(_,v)})(t.startAt));let d=null;return t.endAt&&(d=(function(m){const v=!m.before,_=m.values||[];return new kp(_,v)})(t.endAt)),AB(e,s,o,a,c,"F",h,d)}function ZB(i,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function vk(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Zl(t.unaryFilter.field);return rn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Zl(t.unaryFilter.field);return rn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Zl(t.unaryFilter.field);return rn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Zl(t.unaryFilter.field);return rn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Be(61313);default:return Be(60726)}})(i):i.fieldFilter!==void 0?(function(t){return rn.create(Zl(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Be(58110);default:return Be(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return fs.create(t.compositeFilter.filters.map((n=>vk(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Be(1026)}})(t.compositeFilter.op))})(i):Be(30097,{filter:i})}function eU(i){return HB[i]}function tU(i){return $B[i]}function nU(i){return GB[i]}function Jl(i){return{fieldPath:i.canonicalString()}}function Zl(i){return Un.fromServerFormat(i.fieldPath)}function bk(i){return i instanceof rn?(function(t){if(t.op==="=="){if(nT(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NAN"}};if(tT(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nT(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NOT_NAN"}};if(tT(t.value))return{unaryFilter:{field:Jl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jl(t.field),op:tU(t.op),value:t.value}}})(i):i instanceof fs?(function(t){const n=t.getFilters().map((s=>bk(s)));return n.length===1?n[0]:{compositeFilter:{op:nU(t.op),filters:n}}})(i):Be(54877,{filter:i})}function _k(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}class Ra{constructor(e,t,n,s,a=je.min(),o=je.min(),c=Nn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new Ra(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ra(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ra(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ra(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class iU{constructor(e){this.yt=e}}function sU(i){const e=JB({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?gb(e,e.limit,"L"):e}class rU{constructor(){this.Cn=new aU}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(Ma.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(Ma.min())}updateCollectionGroup(e,t,n){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class aU{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new hn(Ct.comparator),a=!s.has(n);return this.index[t]=s.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new hn(Ct.comparator)).toArray()}}const gT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wk=41943040;class si{static withCacheSize(e){return new si(e,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}si.DEFAULT_COLLECTION_PERCENTILE=10,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,si.DEFAULT=new si(wk,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),si.DISABLED=new si(-1,0,0);class Cc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cc(0)}static cr(){return new Cc(-1)}}const yT="LruGarbageCollector",oU=1048576;function vT([i,e],[t,n]){const s=Xe(i,t);return s===0?Xe(e,n):s}class lU{constructor(e){this.Ir=e,this.buffer=new hn(vT),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();vT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cU{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){me(yT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Lc(t)?me(yT,"Ignoring IndexedDB error during garbage collection: ",t):await im(t)}await this.Vr(3e5)}))}}class uU{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(sm.ce);const n=new lU(t);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(me("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(gT)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,a,o,c,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(n=m,c=Date.now(),this.removeTargets(e,n,t)))).next((m=>(a=m,h=Date.now(),this.removeOrphanedDocuments(e,n)))).next((m=>(d=Date.now(),Xl()<=We.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${a} targets in `+(h-c)+`ms
	Removed ${m} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:m}))))}}function hU(i,e){return new uU(i,e)}class dU{constructor(){this.changes=new Ko((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?oe.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class fU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class pU{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(n!==null&&yh(n.mutation,s,ka.empty(),kt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Ze()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Ze()){const s=Do();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((a=>{let o=rh();return a.forEach(((c,h)=>{o=o.insert(c,h.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const n=Do();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Ze())))}populateOverlays(e,t,n){const s=[];return n.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,n,s){let a=Ua();const o=gh(),c=(function(){return gh()})();return t.forEach(((h,d)=>{const p=n.get(d.key);s.has(d.key)&&(p===void 0||p.mutation instanceof um)?a=a.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),yh(p.mutation,d,p.mutation.getFieldMask(),kt.now())):o.set(d.key,ka.empty())})),this.recalculateAndSaveOverlays(e,a).next((h=>(h.forEach(((d,p)=>o.set(d,p))),t.forEach(((d,p)=>c.set(d,new fU(p,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const n=gh();let s=new Ht(((o,c)=>o-c)),a=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((h=>{const d=t.get(h);if(d===null)return;let p=n.get(h)||ka.empty();p=c.applyToLocalView(d,p),n.set(h,p);const m=(s.get(c.batchId)||Ze()).add(h);s=s.insert(c.batchId,m)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),d=h.key,p=h.value,m=ik();p.forEach((v=>{if(!a.has(v)){const _=lk(t.get(v),n.get(v));_!==null&&m.set(v,_),a=a.add(v)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return oe.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,s){return(function(o){return xe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ZC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-a.size):oe.resolve(Do());let c=kh,h=a;return o.next((d=>oe.forEach(d,((p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),a.get(p)?oe.resolve():this.remoteDocumentCache.getEntry(e,p).next((v=>{h=h.insert(p,v)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,h,d,Ze()))).next((p=>({batchId:c,changes:CB(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xe(t)).next((n=>{let s=rh();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const a=t.collectionGroup;let o=rh();return this.indexManager.getCollectionParents(e,a).next((c=>oe.forEach(c,(h=>{const d=(function(m,v){return new Bc(v,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,h.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,n,s).next((p=>{p.forEach(((m,v)=>{o=o.insert(m,v)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,s)))).next((o=>{a.forEach(((h,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,Bn.newInvalidDocument(p)))}));let c=rh();return o.forEach(((h,d)=>{const p=a.get(h);p!==void 0&&yh(p.mutation,d,ka.empty(),kt.now()),lm(t,d)&&(c=c.insert(h,d))})),c}))}}class mU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return oe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:uc(s.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:sU(s.bundledQuery),readTime:uc(s.readTime)}})(t)),oe.resolve()}}class gU{constructor(){this.overlays=new Ht(xe.comparator),this.qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Do();return oe.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&n.set(s,a)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((s,a)=>{this.St(e,t,a)})),oe.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(n)),oe.resolve()}getOverlaysForCollection(e,t,n){const s=Do(),a=t.length+1,o=new xe(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const h=c.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&h.largestBatchId>n&&s.set(h.getKey(),h)}return oe.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let a=new Ht(((d,p)=>d-p));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let p=a.get(d.largestBatchId);p===null&&(p=Do(),a=a.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const c=Do(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>c.set(d,p))),!(c.size()>=s)););return oe.resolve(c)}St(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new UB(t,n));let a=this.qr.get(t);a===void 0&&(a=Ze(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}class yU{constructor(){this.sessionToken=Nn.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}class S_{constructor(){this.Qr=new hn(vn.$r),this.Ur=new hn(vn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new vn(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new vn(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new xe(new Ct([])),n=new vn(t,e),s=new vn(t,e+1),a=[];return this.Ur.forEachInRange([n,s],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new xe(new Ct([])),n=new vn(t,e),s=new vn(t,e+1);let a=Ze();return this.Ur.forEachInRange([n,s],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new vn(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class vn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return xe.comparator(e.key,t.key)||Xe(e.Yr,t.Yr)}static Kr(e,t){return Xe(e.Yr,t.Yr)||xe.comparator(e.key,t.key)}}class vU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new hn(vn.$r)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new BB(a,t,n,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new vn(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return oe.resolve(o)}lookupMutationBatch(e,t){return oe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),a=s<0?0:s;return oe.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?iB:this.tr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new vn(t,0),s=new vn(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,s],(o=>{const c=this.Xr(o.Yr);a.push(c)})),oe.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hn(Xe);return t.forEach((s=>{const a=new vn(s,0),o=new vn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{n=n.add(c.Yr)}))})),oe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let a=n;xe.isDocumentKey(a)||(a=a.child(""));const o=new vn(new xe(a),0);let c=new hn(Xe);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(c=c.add(h.Yr)),!0)}),o),oe.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Ot(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return oe.forEach(t.mutations,(s=>{const a=new vn(s.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new vn(t,0),s=this.Zr.firstAfterOrEqual(n);return oe.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class bU{constructor(e){this.ri=e,this.docs=(function(){return new Ht(xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),a=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return oe.resolve(n?n.document.mutableCopy():Bn.newInvalidDocument(t))}getEntries(e,t){let n=Ua();return t.forEach((s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Bn.newInvalidDocument(s))})),oe.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let a=Ua();const o=t.path,c=new xe(o.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Zj(Jj(p),n)<=0||(s.has(p.key)||lm(t,p))&&(a=a.insert(p.key,p.mutableCopy()))}return oe.resolve(a)}getAllFromCollectionGroup(e,t,n,s){Be(9500)}ii(e,t){return oe.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new _U(this)}getSize(e){return oe.resolve(this.size)}}class _U extends dU{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),oe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class wU{constructor(e){this.persistence=e,this.si=new Ko((t=>y_(t)),v_),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this.oi=0,this._i=new S_,this.targetCount=0,this.ai=Cc.ur()}forEachTarget(e,t){return this.si.forEach(((n,s)=>t(s))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),oe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Cc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Pr(t),oe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,n){let s=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),oe.waitFor(a).next((()=>s))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return oe.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),oe.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((o=>{a.push(s.markPotentiallyOrphaned(e,o))})),oe.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return oe.resolve(n)}containsKey(e,t){return oe.resolve(this._i.containsKey(t))}}class Ak{constructor(e,t){this.ui={},this.overlays={},this.ci=new sm(0),this.li=!1,this.li=!0,this.hi=new yU,this.referenceDelegate=e(this),this.Pi=new wU(this),this.indexManager=new rU,this.remoteDocumentCache=(function(s){return new bU(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new iU(t),this.Ii=new mU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new vU(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){me("MemoryPersistence","Starting transaction:",e);const s=new AU(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return oe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class AU extends tB{constructor(e){super(),this.currentSequenceNumber=e}}class T_{constructor(e){this.persistence=e,this.Ri=new S_,this.Vi=null}static mi(e){return new T_(e)}get fi(){if(this.Vi)return this.Vi;throw Be(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),oe.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.fi,(n=>{const s=xe.fromPath(n);return this.gi(e,s).next((a=>{a||t.removeEntry(s,je.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Dp{constructor(e,t){this.persistence=e,this.pi=new Ko((n=>rB(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=hU(this,t)}static mi(e,t){return new Dp(e,t)}Ei(){}di(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return oe.forEach(this.pi,((n,s)=>this.br(e,n,s).next((a=>a?oe.resolve():t(s)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(o=>this.br(e,o,t).next((c=>{c||(n++,a.removeEntry(o,je.min()))})))).next((()=>a.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=lp(e.data.value)),t}br(e,t,n){return oe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return oe.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class x_{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=Ze(),s=Ze();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new x_(e,t.fromCache,n,s)}}class EU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class SU{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return _L()?8:nB(zn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,s,n).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new EU;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,n,s){return n.documentReadCount<this.fs?(Xl()<=We.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",Ql(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),oe.resolve()):(Xl()<=We.DEBUG&&me("QueryEngine","Query:",Ql(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Xl()<=We.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",Ql(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ws(t))):oe.resolve())}ys(e,t){if(aT(t))return oe.resolve(null);let n=Ws(t);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=gb(t,null,"F"),n=Ws(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((a=>{const o=Ze(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,n).next((h=>{const d=this.Ds(t,c);return this.Cs(t,d,o,h.readTime)?this.ys(e,gb(t,null,"F")):this.vs(e,d,t,h)}))))})))))}ws(e,t,n,s){return aT(t)||s.isEqual(je.min())?oe.resolve(null):this.ps.getDocuments(e,n).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,n,s)?oe.resolve(null):(Xl()<=We.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ql(t)),this.vs(e,o,t,Qj(s,kh)).next((c=>c)))}))}Ds(e,t){let n=new hn(tk(e));return t.forEach(((s,a)=>{lm(e,a)&&(n=n.add(a))})),n}Cs(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,n){return Xl()<=We.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",Ql(t)),this.ps.getDocumentsMatchingQuery(e,t,Ma.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const C_="LocalStore",TU=3e8;class xU{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new Ht(Xe),this.xs=new Ko((a=>y_(a)),v_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pU(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function CU(i,e,t,n){return new xU(i,e,t,n)}async function Ek(i,e){const t=Je(i);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((a=>{const o=[],c=[];let h=Ze();for(const d of s){o.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of a){c.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(n,h).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function Sk(i){const e=Je(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function kU(i,e){const t=Je(i),n=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((p,m)=>{const v=s.get(m);if(!v)return;c.push(t.Pi.removeMatchingKeys(a,p.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(a,p.addedDocuments,m))));let _=v.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(Nn.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):p.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(p.resumeToken,n)),s=s.insert(m,_),(function(A,T,x){return A.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=TU?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(v,_,p)&&c.push(t.Pi.updateTargetData(a,_))}));let h=Ua(),d=Ze();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,p))})),c.push(RU(a,o,e.documentUpdates).next((p=>{h=p.ks,d=p.qs}))),!n.isEqual(je.min())){const p=t.Pi.getLastRemoteSnapshotVersion(a).next((m=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n)));c.push(p)}return oe.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,h,d))).next((()=>h))})).then((a=>(t.Ms=s,a)))}function RU(i,e,t){let n=Ze(),s=Ze();return t.forEach((a=>n=n.add(a))),e.getEntries(i,n).next((a=>{let o=Ua();return t.forEach(((c,h)=>{const d=a.get(c);h.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),h.isNoDocument()&&h.version.isEqual(je.min())?(e.removeEntry(c,h.readTime),o=o.insert(c,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),o=o.insert(c,h)):me(C_,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",h.version)})),{ks:o,qs:s}}))}function IU(i,e){const t=Je(i);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return t.Pi.getTargetData(n,e).next((a=>a?(s=a,oe.resolve(s)):t.Pi.allocateTargetId(n).next((o=>(s=new Ra(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=t.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function Ab(i,e,t){const n=Je(i),s=n.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,(o=>n.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Lc(o))throw o;me(C_,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function bT(i,e,t){const n=Je(i);let s=je.min(),a=Ze();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(h,d,p){const m=Je(h),v=m.xs.get(p);return v!==void 0?oe.resolve(m.Ms.get(v)):m.Pi.getTargetData(d,p)})(n,o,Ws(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,c.targetId).next((h=>{a=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,t?s:je.min(),t?a:Ze()))).next((c=>(DU(n,SB(e),c),{documents:c,Qs:a})))))}function DU(i,e,t){let n=i.Os.get(e)||je.min();t.forEach(((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)})),i.Os.set(e,n)}class _T{constructor(){this.activeTargetIds=IB()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class OU{constructor(){this.Mo=new _T,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _T,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class PU{Oo(e){}shutdown(){}}const wT="ConnectivityMonitor";class AT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){me(wT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){me(wT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Hf=null;function Eb(){return Hf===null?Hf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Hf++,"0x"+Hf.toString(16)}const sv="RestConnection",NU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class MU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===xp?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,a){const o=Eb(),c=this.zo(e,t.toUriEncodedString());me(sv,`Sending RPC '${e}' ${o}:`,c,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,a);const{host:d}=new URL(c),p=$o(d);return this.Jo(e,c,h,n,p).then((m=>(me(sv,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw Ec(sv,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",n),m}))}Ho(e,t,n,s,a,o){return this.Go(e,t,n,s,a)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),n&&n.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const n=NU[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class LU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ln="WebChannelConnection";class jU extends MU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,a){const o=Eb();return new Promise(((c,h)=>{const d=new RC;d.setWithCredentials(!0),d.listenOnce(IC.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case ap.NO_ERROR:const m=d.getResponseJson();me(Ln,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case ap.TIMEOUT:me(Ln,`RPC '${e}' ${o} timed out`),h(new ve(ce.DEADLINE_EXCEEDED,"Request time out"));break;case ap.HTTP_ERROR:const v=d.getStatus();if(me(Ln,`RPC '${e}' ${o} failed with status:`,v,"response text:",d.getResponseText()),v>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const S=_?.error;if(S&&S.status&&S.message){const A=(function(x){const D=x.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(D)>=0?D:ce.UNKNOWN})(S.status);h(new ve(A,S.message))}else h(new ve(ce.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new ve(ce.UNAVAILABLE,"Connection failed."));break;default:Be(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{me(Ln,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(s);me(Ln,`RPC '${e}' ${o} sending request:`,s),d.send(t,"POST",p,n,15)}))}T_(e,t,n){const s=Eb(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=PC(),c=OC(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,n),h.encodeInitMessageHeaders=!0;const p=a.join("");me(Ln,`Creating RPC '${e}' stream ${s}: ${p}`,h);const m=o.createWebChannel(p,h);this.I_(m);let v=!1,_=!1;const S=new LU({Yo:T=>{_?me(Ln,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(v||(me(Ln,`Opening RPC '${e}' stream ${s} transport.`),m.open(),v=!0),me(Ln,`RPC '${e}' stream ${s} sending:`,T),m.send(T))},Zo:()=>m.close()}),A=(T,x,D)=>{T.listen(x,(I=>{try{D(I)}catch(U){setTimeout((()=>{throw U}),0)}}))};return A(m,sh.EventType.OPEN,(()=>{_||(me(Ln,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),A(m,sh.EventType.CLOSE,(()=>{_||(_=!0,me(Ln,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))})),A(m,sh.EventType.ERROR,(T=>{_||(_=!0,Ec(Ln,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new ve(ce.UNAVAILABLE,"The operation could not be completed")))})),A(m,sh.EventType.MESSAGE,(T=>{if(!_){const x=T.data[0];Ot(!!x,16349);const D=x,I=D?.error||D[0]?.error;if(I){me(Ln,`RPC '${e}' stream ${s} received error:`,I);const U=I.status;let z=(function(O){const P=nn[O];if(P!==void 0)return uk(P)})(U),F=I.message;z===void 0&&(z=ce.INTERNAL,F="Unknown error status: "+U+" with message "+I.message),_=!0,S.a_(new ve(z,F)),m.close()}else me(Ln,`RPC '${e}' stream ${s} received:`,x),S.u_(x)}})),A(c,DC.STAT_EVENT,(T=>{T.stat===cb.PROXY?me(Ln,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===cb.NOPROXY&&me(Ln,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function rv(){return typeof document<"u"?document:null}function dm(i){return new WB(i,!0)}class Tk{constructor(e,t,n=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&me("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ET="PersistentStream";class BU{constructor(e,t,n,s,a,o,c,h){this.Mi=e,this.S_=n,this.b_=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Tk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Nr(t.toString()),Nr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===t&&this.G_(n,s)}),(n=>{e((()=>{const s=new ve(ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return me(ET,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(me(ET,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class UU extends BU{constructor(e,t,n,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=YB(this.serializer,e),n=(function(a){if(!("targetChange"in a))return je.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?je.min():o.readTime?uc(o.readTime):je.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=mT(this.serializer),t.addTarget=(function(a,o){let c;const h=o.target;if(c=pb(h)?{documents:XB(a,h)}:{query:QB(a,h).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=fk(a,o.resumeToken);const d=bb(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(je.min())>0){c.readTime=_b(a,o.snapshotVersion.toTimestamp());const d=bb(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const n=ZB(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=mT(this.serializer),t.removeTarget=e,this.q_(t)}}class FU{}class zU extends FU{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ve(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,wb(t,n),s,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ve(ce.UNKNOWN,a.toString())}))}Ho(e,t,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,wb(t,n),s,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ve(ce.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class VU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Nr(t),this.aa=!1):me("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const kc="RemoteStore";class qU{constructor(e,t,n,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{Kh(this)&&(me(kc,"Restarting streams for network reachability change."),await(async function(h){const d=Je(h);d.Ea.add(4),await Wh(d),d.Ra.set("Unknown"),d.Ea.delete(4),await fm(d)})(this))}))})),this.Ra=new VU(n,s)}}async function fm(i){if(Kh(i))for(const e of i.da)await e(!0)}async function Wh(i){for(const e of i.da)await e(!1)}function xk(i,e){const t=Je(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),D_(t)?I_(t):Uc(t).O_()&&R_(t,e))}function k_(i,e){const t=Je(i),n=Uc(t);t.Ia.delete(e),n.O_()&&Ck(t,e),t.Ia.size===0&&(n.O_()?n.L_():Kh(t)&&t.Ra.set("Unknown"))}function R_(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Uc(i).Y_(e)}function Ck(i,e){i.Va.Ue(e),Uc(i).Z_(e)}function I_(i){i.Va=new qB({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Uc(i).start(),i.Ra.ua()}function D_(i){return Kh(i)&&!Uc(i).x_()&&i.Ia.size>0}function Kh(i){return Je(i).Ea.size===0}function kk(i){i.Va=void 0}async function HU(i){i.Ra.set("Online")}async function $U(i){i.Ia.forEach(((e,t)=>{R_(i,e)}))}async function GU(i,e){kk(i),D_(i)?(i.Ra.ha(e),I_(i)):i.Ra.set("Unknown")}async function WU(i,e,t){if(i.Ra.set("Online"),e instanceof dk&&e.state===2&&e.cause)try{await(async function(s,a){const o=a.cause;for(const c of a.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))})(i,e)}catch(n){me(kc,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ST(i,n)}else if(e instanceof up?i.Va.Ze(e):e instanceof hk?i.Va.st(e):i.Va.tt(e),!t.isEqual(je.min()))try{const n=await Sk(i.localStore);t.compareTo(n)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=a.Ia.get(d);p&&a.Ia.set(d,p.withResumeToken(h.resumeToken,o))}})),c.targetMismatches.forEach(((h,d)=>{const p=a.Ia.get(h);if(!p)return;a.Ia.set(h,p.withResumeToken(Nn.EMPTY_BYTE_STRING,p.snapshotVersion)),Ck(a,h);const m=new Ra(p.target,h,d,p.sequenceNumber);R_(a,m)})),a.remoteSyncer.applyRemoteEvent(c)})(i,t)}catch(n){me(kc,"Failed to raise snapshot:",n),await ST(i,n)}}async function ST(i,e,t){if(!Lc(e))throw e;i.Ea.add(1),await Wh(i),i.Ra.set("Offline"),t||(t=()=>Sk(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{me(kc,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await fm(i)}))}async function TT(i,e){const t=Je(i);t.asyncQueue.verifyOperationInProgress(),me(kc,"RemoteStore received new credentials");const n=Kh(t);t.Ea.add(3),await Wh(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await fm(t)}async function KU(i,e){const t=Je(i);e?(t.Ea.delete(2),await fm(t)):e||(t.Ea.add(2),await Wh(t),t.Ra.set("Unknown"))}function Uc(i){return i.ma||(i.ma=(function(t,n,s){const a=Je(t);return a.sa(),new UU(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(i.datastore,i.asyncQueue,{Xo:HU.bind(null,i),t_:$U.bind(null,i),r_:GU.bind(null,i),H_:WU.bind(null,i)}),i.da.push((async e=>{e?(i.ma.B_(),D_(i)?I_(i):i.Ra.set("Unknown")):(await i.ma.stop(),kk(i))}))),i.ma}class O_{constructor(e,t,n,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new cc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,a){const o=Date.now()+n,c=new O_(e,t,o,s,a);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ve(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Rk(i,e){if(Nr("AsyncQueue",`${e}: ${i}`),Lc(i))return new ve(ce.UNAVAILABLE,`${e}: ${i}`);throw i}class hc{static emptySet(e){return new hc(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||xe.comparator(t.key,n.key):(t,n)=>xe.comparator(t.key,n.key),this.keyedMap=rh(),this.sortedSet=new Ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new hc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class xT{constructor(){this.ga=new Ht(xe.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Be(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Rc{constructor(e,t,n,s,a,o,c,h,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,s,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new Rc(e,t,hc.emptySet(t),o,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&om(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}class YU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class XU{constructor(){this.queries=CT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=Je(t),a=s.queries;s.queries=CT(),a.forEach(((o,c)=>{for(const h of c.Sa)h.onError(n)}))})(this,new ve(ce.ABORTED,"Firestore shutting down"))}}function CT(){return new Ko((i=>ek(i)),om)}async function QU(i,e){const t=Je(i);let n=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(n=2):(a=new YU,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const c=Rk(o,`Initialization of query '${Ql(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&P_(t)}async function JU(i,e){const t=Je(i),n=e.query;let s=3;const a=t.queries.get(n);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function ZU(i,e){const t=Je(i);let n=!1;for(const s of e){const a=s.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(s)&&(n=!0);o.wa=s}}n&&P_(t)}function eF(i,e,t){const n=Je(i),s=n.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);n.queries.delete(e)}function P_(i){i.Ca.forEach((e=>{e.next()}))}var Sb,kT;(kT=Sb||(Sb={})).Ma="default",kT.Cache="cache";class tF{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Rc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Rc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sb.Cache}}class Ik{constructor(e){this.key=e}}class Dk{constructor(e){this.key=e}}class nF{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ze(),this.mutatedKeys=Ze(),this.eu=tk(e),this.tu=new hc(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new xT,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=s,c=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((p,m)=>{const v=s.get(p),_=lm(this.query,m)?m:null,S=!!v&&this.mutatedKeys.has(v.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let T=!1;v&&_?v.data.isEqual(_.data)?S!==A&&(n.track({type:3,doc:_}),T=!0):this.su(v,_)||(n.track({type:2,doc:_}),T=!0,(h&&this.eu(_,h)>0||d&&this.eu(_,d)<0)&&(c=!0)):!v&&_?(n.track({type:0,doc:_}),T=!0):v&&!_&&(n.track({type:1,doc:v}),T=!0,(h||d)&&(c=!0)),T&&(_?(o=o.add(_),a=A?a.add(p):a.delete(p)):(o=o.delete(p),a=a.delete(p)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),a=a.delete(p.key),n.track({type:1,doc:p})}return{tu:o,iu:n,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((p,m)=>(function(_,S){const A=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be(20277,{Rt:T})}};return A(_)-A(S)})(p.type,m.type)||this.eu(p.doc,m.doc))),this.ou(n),s=s??!1;const c=t&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,d=h!==this.Za;return this.Za=h,o.length!==0||d?{snapshot:new Rc(this.query,e.tu,a,o,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ze(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new Dk(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new Ik(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ze();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Rc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const N_="SyncEngine";class iF{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class sF{constructor(e){this.key=e,this.hu=!1}}class rF{constructor(e,t,n,s,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ko((c=>ek(c)),om),this.Iu=new Map,this.Eu=new Set,this.du=new Ht(xe.comparator),this.Au=new Map,this.Ru=new S_,this.Vu={},this.mu=new Map,this.fu=Cc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function aF(i,e,t=!0){const n=Lk(i);let s;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await Ok(n,e,t,!0),s}async function oF(i,e){const t=Lk(i);await Ok(t,e,!0,!1)}async function Ok(i,e,t,n){const s=await IU(i.localStore,Ws(e)),a=s.targetId,o=i.sharedClientState.addLocalQueryTarget(a,t);let c;return n&&(c=await lF(i,e,a,o==="current",s.resumeToken)),i.isPrimaryClient&&t&&xk(i.remoteStore,s),c}async function lF(i,e,t,n,s){i.pu=(m,v,_)=>(async function(A,T,x,D){let I=T.view.ru(x);I.Cs&&(I=await bT(A.localStore,T.query,!1).then((({documents:R})=>T.view.ru(R,I))));const U=D&&D.targetChanges.get(T.targetId),z=D&&D.targetMismatches.get(T.targetId)!=null,F=T.view.applyChanges(I,A.isPrimaryClient,U,z);return IT(A,T.targetId,F.au),F.snapshot})(i,m,v,_);const a=await bT(i.localStore,e,!0),o=new nF(e,a.Qs),c=o.ru(a.documents),h=Gh.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",s),d=o.applyChanges(c,i.isPrimaryClient,h);IT(i,t,d.au);const p=new iF(e,t,o);return i.Tu.set(e,p),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),d.snapshot}async function cF(i,e,t){const n=Je(i),s=n.Tu.get(e),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter((o=>!om(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ab(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),t&&k_(n.remoteStore,s.targetId),Tb(n,s.targetId)})).catch(im)):(Tb(n,s.targetId),await Ab(n.localStore,s.targetId,!0))}async function uF(i,e){const t=Je(i),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),k_(t.remoteStore,n.targetId))}async function Pk(i,e){const t=Je(i);try{const n=await kU(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const o=t.Au.get(a);o&&(Ot(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Ot(o.hu,14607):s.removedDocuments.size>0&&(Ot(o.hu,42227),o.hu=!1))})),await Mk(t,n,e)}catch(n){await im(n)}}function RT(i,e,t){const n=Je(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const h=Je(o);h.onlineState=c;let d=!1;h.queries.forEach(((p,m)=>{for(const v of m.Sa)v.va(c)&&(d=!0)})),d&&P_(h)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function hF(i,e,t){const n=Je(i);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),a=s&&s.key;if(a){let o=new Ht(xe.comparator);o=o.insert(a,Bn.newNoDocument(a,je.min()));const c=Ze().add(a),h=new hm(je.min(),new Map,new Ht(Xe),o,c);await Pk(n,h),n.du=n.du.remove(a),n.Au.delete(e),M_(n)}else await Ab(n.localStore,e,!1).then((()=>Tb(n,e,t))).catch(im)}function Tb(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach((n=>{i.Ru.containsKey(n)||Nk(i,n)}))}function Nk(i,e){i.Eu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(k_(i.remoteStore,t),i.du=i.du.remove(e),i.Au.delete(t),M_(i))}function IT(i,e,t){for(const n of t)n instanceof Ik?(i.Ru.addReference(n.key,e),dF(i,n)):n instanceof Dk?(me(N_,"Document no longer in limbo: "+n.key),i.Ru.removeReference(n.key,e),i.Ru.containsKey(n.key)||Nk(i,n.key)):Be(19791,{wu:n})}function dF(i,e){const t=e.key,n=t.path.canonicalString();i.du.get(t)||i.Eu.has(n)||(me(N_,"New document in limbo: "+t),i.Eu.add(n),M_(i))}function M_(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new xe(Ct.fromString(e)),n=i.fu.next();i.Au.set(n,new sF(t)),i.du=i.du.insert(t,n),xk(i.remoteStore,new Ra(Ws(b_(t.path)),n,"TargetPurposeLimboResolution",sm.ce))}}async function Mk(i,e,t){const n=Je(i),s=[],a=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,h)=>{o.push(n.pu(h,e,t).then((d=>{if((d||t)&&n.isPrimaryClient){const p=d?!d.fromCache:t?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){s.push(d);const p=x_.As(h.targetId,d);a.push(p)}})))})),await Promise.all(o),n.Pu.H_(s),await(async function(h,d){const p=Je(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>oe.forEach(d,(v=>oe.forEach(v.Es,(_=>p.persistence.referenceDelegate.addReference(m,v.targetId,_))).next((()=>oe.forEach(v.ds,(_=>p.persistence.referenceDelegate.removeReference(m,v.targetId,_)))))))))}catch(m){if(!Lc(m))throw m;me(C_,"Failed to update sequence numbers: "+m)}for(const m of d){const v=m.targetId;if(!m.fromCache){const _=p.Ms.get(v),S=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(S);p.Ms=p.Ms.insert(v,A)}}})(n.localStore,a))}async function fF(i,e){const t=Je(i);if(!t.currentUser.isEqual(e)){me(N_,"User change. New user:",e.toKey());const n=await Ek(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((h=>{h.reject(new ve(ce.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Mk(t,n.Ls)}}function pF(i,e){const t=Je(i),n=t.Au.get(e);if(n&&n.hu)return Ze().add(n.key);{let s=Ze();const a=t.Iu.get(e);if(!a)return s;for(const o of a){const c=t.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function Lk(i){const e=Je(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hF.bind(null,e),e.Pu.H_=ZU.bind(null,e.eventManager),e.Pu.yu=eF.bind(null,e.eventManager),e}class Op{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return CU(this.persistence,new SU,e.initialUser,this.serializer)}Cu(e){return new Ak(T_.mi,this.serializer)}Du(e){return new OU}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Op.provider={build:()=>new Op};class mF extends Op{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ot(this.persistence.referenceDelegate instanceof Dp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new cU(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new Ak((n=>Dp.mi(n,t)),this.serializer)}}class xb{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>RT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=fF.bind(null,this.syncEngine),await KU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new XU})()}createDatastore(e){const t=dm(e.databaseInfo.databaseId),n=(function(a){return new jU(a)})(e.databaseInfo);return(function(a,o,c,h){return new zU(a,o,c,h)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,s,a,o,c){return new qU(n,s,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>RT(this.syncEngine,t,0)),(function(){return AT.v()?new AT:new PU})())}createSyncEngine(e,t){return(function(s,a,o,c,h,d,p){const m=new rF(s,a,o,c,h,d);return p&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=Je(t);me(kc,"RemoteStore shutting down."),n.Ea.add(5),await Wh(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}xb.provider={build:()=>new xb};class gF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Nr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Fa="FirestoreClient";class yF{constructor(e,t,n,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=jn.UNAUTHENTICATED,this.clientId=LC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async o=>{me(Fa,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(me(Fa,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Rk(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function av(i,e){i.asyncQueue.verifyOperationInProgress(),me(Fa,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await Ek(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function DT(i,e){i.asyncQueue.verifyOperationInProgress();const t=await vF(i);me(Fa,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((n=>TT(e.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>TT(e.remoteStore,s))),i._onlineComponents=e}async function vF(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){me(Fa,"Using user provided OfflineComponentProvider");try{await av(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ce.FAILED_PRECONDITION||s.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Ec("Error using user provided cache. Falling back to memory cache: "+t),await av(i,new Op)}}else me(Fa,"Using default OfflineComponentProvider"),await av(i,new mF(void 0));return i._offlineComponents}async function bF(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(me(Fa,"Using user provided OnlineComponentProvider"),await DT(i,i._uninitializedComponentsProvider._online)):(me(Fa,"Using default OnlineComponentProvider"),await DT(i,new xb))),i._onlineComponents}async function OT(i){const e=await bF(i),t=e.eventManager;return t.onListen=aF.bind(null,e.syncEngine),t.onUnlisten=cF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=oF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=uF.bind(null,e.syncEngine),t}function jk(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}const PT=new Map;const Bk="firestore.googleapis.com",NT=!0;class MT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ve(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Bk,this.ssl=NT}else this.host=e.host,this.ssl=e.ssl??NT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=wk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oU)throw new ve(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Xj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jk(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ve(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ve(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ve(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class L_{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new MT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ve(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ve(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new MT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new Fj;switch(n.type){case"firstParty":return new Hj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ve(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=PT.get(t);n&&(me("ComponentProvider","Removing Datastore"),PT.delete(t),n.terminate())})(this),Promise.resolve()}}function _F(i,e,t,n={}){i=op(i,L_);const s=$o(e),a=i._getSettings(),o={...a,emulatorOptions:i._getEmulatorOptions()},c=`${e}:${t}`;s&&(h_(`https://${c}`),d_("Firestore",!0)),a.host!==Bk&&a.host!==c&&Ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...a,host:c,ssl:s,emulatorOptions:n};if(!Na(h,o)&&(i._setSettings(h),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=jn.MOCK_USER;else{d=vC(n.mockUserToken,i._app?.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new ve(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new jn(m)}i._authCredentials=new zj(new MC(d,p))}}class Yo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yo(this.firestore,e,this._query)}}class Fn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fn(this.firestore,e,this._key)}toJSON(){return{type:Fn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if($h(t,Fn._jsonSchema))return new Fn(e,n||null,new xe(Ct.fromString(t.referencePath)))}}Fn._jsonSchemaVersion="firestore/documentReference/1.0",Fn._jsonSchema={type:an("string",Fn._jsonSchemaVersion),referencePath:an("string")};class dc extends Yo{constructor(e,t,n){super(e,t,b_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fn(this.firestore,null,new xe(e))}withConverter(e){return new dc(this.firestore,e,this._path)}}function wF(i,e,...t){if(i=_n(i),i instanceof L_){const n=Ct.fromString(e,...t);return GS(n),new dc(i,null,n)}{if(!(i instanceof Fn||i instanceof dc))throw new ve(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Ct.fromString(e,...t));return GS(n),new dc(i.firestore,null,n)}}const LT="AsyncQueue";class jT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Tk(this,"async_queue_retry"),this._c=()=>{const n=rv();n&&me(LT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=rv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=rv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cc;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Lc(e))throw e;me(LT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Nr("INTERNAL UNHANDLED ERROR: ",BT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=O_.createAndSchedule(this,e,t,n,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&Be(47125,{Pc:BT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function BT(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}function UT(i){return(function(t,n){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1})(i,["next","error","complete"])}class Cb extends L_{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new jT,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new jT(e),this._firestoreClient=void 0,await e}}}function AF(i,e){const t=typeof i=="object"?i:tm(),n=typeof i=="string"?i:xp,s=qa(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=mC("firestore");a&&_F(s,...a)}return s}function EF(i){if(i._terminated)throw new ve(ce.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||SF(i),i._firestoreClient}function SF(i){const e=i._freezeSettings(),t=(function(s,a,o,c){return new lB(s,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,jk(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new yF(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(i._componentsProvider))}class Vi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vi(Nn.fromBase64String(e))}catch(t){throw new ve(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vi(Nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($h(e,Vi._jsonSchema))return Vi.fromBase64String(e.bytes)}}Vi._jsonSchemaVersion="firestore/bytes/1.0",Vi._jsonSchema={type:an("string",Vi._jsonSchemaVersion),bytes:an("string")};class Uk{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ve(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fk{constructor(e){this._methodName=e}}class Ks{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ve(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ve(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xe(this._lat,e._lat)||Xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ks._jsonSchemaVersion}}static fromJSON(e){if($h(e,Ks._jsonSchema))return new Ks(e.latitude,e.longitude)}}Ks._jsonSchemaVersion="firestore/geoPoint/1.0",Ks._jsonSchema={type:an("string",Ks._jsonSchemaVersion),latitude:an("number"),longitude:an("number")};class Ys{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ys._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($h(e,Ys._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ys(e.vectorValues);throw new ve(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ys._jsonSchemaVersion="firestore/vectorValue/1.0",Ys._jsonSchema={type:an("string",Ys._jsonSchemaVersion),vectorValues:an("object")};const TF=/^__.*__$/;function zk(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be(40011,{Ac:i})}}class j_{constructor(e,t,n,s,a,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new j_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return kb(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(zk(this.Ac)&&TF.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class xF{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||dm(e)}Cc(e,t,n,s=!1){return new j_({Ac:e,methodName:t,Dc:n,path:Un.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function CF(i){const e=i._freezeSettings(),t=dm(i._databaseId);return new xF(i._databaseId,!!e.ignoreUndefinedProperties,t)}function kF(i,e,t,n=!1){return B_(t,i.Cc(n?4:3,e))}function B_(i,e){if(Vk(i=_n(i)))return IF("Unsupported field value:",e,i),RF(i,e);if(i instanceof Fk)return(function(n,s){if(!zk(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const a=[];let o=0;for(const c of n){let h=B_(c,s.wc(o));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),o++}return{arrayValue:{values:a}}})(i,e)}return(function(n,s){if((n=_n(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return DB(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=kt.fromDate(n);return{timestampValue:_b(s.serializer,a)}}if(n instanceof kt){const a=new kt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:_b(s.serializer,a)}}if(n instanceof Ks)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Vi)return{bytesValue:fk(s.serializer,n._byteString)};if(n instanceof Fn){const a=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:pk(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Ys)return(function(o,c){return{mapValue:{fields:{[$C]:{stringValue:GC},[Cp]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return __(c.serializer,d)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${nm(n)}`)})(i,e)}function RF(i,e){const t={};return UC(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jc(i,((n,s)=>{const a=B_(s,e.mc(n));a!=null&&(t[n]=a)})),{mapValue:{fields:t}}}function Vk(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof kt||i instanceof Ks||i instanceof Vi||i instanceof Fn||i instanceof Fk||i instanceof Ys)}function IF(i,e,t){if(!Vk(t)||!jC(t)){const n=nm(t);throw n==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+n)}}const DF=new RegExp("[~\\*/\\[\\]]");function OF(i,e,t){if(e.search(DF)>=0)throw kb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new Uk(...e.split("."))._internalPath}catch{throw kb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function kb(i,e,t,n,s){const a=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(a||o)&&(h+=" (found",a&&(h+=` in field ${n}`),o&&(h+=` in document ${s}`),h+=")"),new ve(ce.INVALID_ARGUMENT,c+i+h)}class qk{constructor(e,t,n,s,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Fn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(U_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class PF extends qk{data(){return super.data()}}function U_(i,e){return typeof e=="string"?OF(i,e):e instanceof Uk?e._internalPath:e._delegate._internalPath}function NF(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new ve(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class F_{}class Hk extends F_{}function MF(i,e,...t){let n=[];e instanceof F_&&n.push(e),n=n.concat(t),(function(a){const o=a.filter((h=>h instanceof V_)).length,c=a.filter((h=>h instanceof z_)).length;if(o>1||o>0&&c>0)throw new ve(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)i=s._apply(i);return i}class z_ extends Hk{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new z_(e,t,n)}_apply(e){const t=this._parse(e);return $k(e._query,t),new Yo(e.firestore,e.converter,mb(e._query,t))}_parse(e){const t=CF(e.firestore);return(function(a,o,c,h,d,p,m){let v;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ve(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){zT(m,p);const S=[];for(const A of m)S.push(FT(h,a,A));v={arrayValue:{values:S}}}else v=FT(h,a,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||zT(m,p),v=kF(c,o,m,p==="in"||p==="not-in");return rn.create(d,p,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class V_ extends F_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new V_(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:fs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let o=s;const c=a.getFlattenedFilters();for(const h of c)$k(o,h),o=mb(o,h)})(e._query,t),new Yo(e.firestore,e.converter,mb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class q_ extends Hk{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new q_(e,t)}_apply(e){const t=(function(s,a,o){if(s.startAt!==null)throw new ve(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ve(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oh(a,o)})(e._query,this._field,this._direction);return new Yo(e.firestore,e.converter,(function(s,a){const o=s.explicitOrderBy.concat([a]);return new Bc(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function LF(i,e="asc"){const t=e,n=U_("orderBy",i);return q_._create(n,t)}function FT(i,e,t){if(typeof(t=_n(t))=="string"){if(t==="")throw new ve(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ZC(e)&&t.indexOf("/")!==-1)throw new ve(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Ct.fromString(t));if(!xe.isDocumentKey(n))throw new ve(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return eT(i,new xe(n))}if(t instanceof Fn)return eT(i,t._key);throw new ve(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nm(t)}.`)}function zT(i,e){if(!Array.isArray(i)||i.length===0)throw new ve(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $k(i,e){const t=(function(s,a){for(const o of s)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(i.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ve(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ve(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class jF{convertValue(e,t="none"){switch(Ba(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ja(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Be(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return jc(e,((s,a)=>{n[s]=this.convertValue(a,t)})),n}convertVectorValue(e){const t=e.fields?.[Cp].arrayValue?.values?.map((n=>qt(n.doubleValue)));return new Ys(t)}convertGeoPoint(e){return new Ks(qt(e.latitude),qt(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=am(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Rh(e));default:return null}}convertTimestamp(e){const t=La(e);return new kt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ct.fromString(e);Ot(_k(n),9688,{name:e});const s=new Ih(n.get(1),n.get(3)),a=new xe(n.popFirst(5));return s.isEqual(t)||Nr(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}class oh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bo extends qk{constructor(e,t,n,s,a,o){super(e,t,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new hp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(U_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ve(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Bo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Bo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bo._jsonSchema={type:an("string",Bo._jsonSchemaVersion),bundleSource:an("string","DocumentSnapshot"),bundleName:an("string"),bundle:an("string")};class hp extends Bo{data(e={}){return super.data(e)}}class fc{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new oh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new hp(this._firestore,this._userDataWriter,n.key,n,new oh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ve(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const h=new hp(s._firestore,s._userDataWriter,c.doc.key,c.doc,new oh(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const h=new hp(s._firestore,s._userDataWriter,c.doc.key,c.doc,new oh(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,p=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),p=o.indexOf(c.doc.key)),{type:BF(c.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ve(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=LC.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BF(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be(61501,{type:i})}}fc._jsonSchemaVersion="firestore/querySnapshot/1.0",fc._jsonSchema={type:an("string",fc._jsonSchemaVersion),bundleSource:an("string","QuerySnapshot"),bundleName:an("string"),bundle:an("string")};class Gk extends jF{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fn(this.firestore,null,t)}}function UF(i,...e){i=_n(i);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||UT(e[n])||(t=e[n++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(UT(e[n])){const h=e[n];e[n]=h.next?.bind(h),e[n+1]=h.error?.bind(h),e[n+2]=h.complete?.bind(h)}let a,o,c;if(i instanceof Fn)o=op(i.firestore,Cb),c=b_(i._key.path),a={next:h=>{e[n]&&e[n](FF(o,i,h))},error:e[n+1],complete:e[n+2]};else{const h=op(i,Yo);o=op(h.firestore,Cb),c=h._query;const d=new Gk(o);a={next:p=>{e[n]&&e[n](new fc(o,d,h,p))},error:e[n+1],complete:e[n+2]},NF(i._query)}return(function(d,p,m,v){const _=new gF(v),S=new tF(p,_,m);return d.asyncQueue.enqueueAndForget((async()=>QU(await OT(d),S))),()=>{_.Nu(),d.asyncQueue.enqueueAndForget((async()=>JU(await OT(d),S)))}})(EF(o),c,s,a)}function FF(i,e,t){const n=t.docs.get(e._key),s=new Gk(i);return new Bo(i,s,e._key,n,new oh(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Mc=s})(Wo),ds(new qi("firestore",((n,{instanceIdentifier:s,options:a})=>{const o=n.getProvider("app").getImmediate(),c=new Cb(new Vj(n.getProvider("auth-internal")),new $j(o,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ve(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ih(d.options.projectId,p)})(o,s),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),ri(VS,qS,e),ri(VS,qS,"esm2020")})();var zF="firebase",VF="12.7.0";ri(zF,VF,"app");const Wk="@firebase/installations",H_="0.6.19";const Kk=1e4,Yk=`w:${H_}`,Xk="FIS_v2",qF="https://firebaseinstallations.googleapis.com/v1",HF=3600*1e3,$F="installations",GF="Installations";const WF={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Fo=new Go($F,GF,WF);function Qk(i){return i instanceof Gi&&i.code.includes("request-failed")}function Jk({projectId:i}){return`${qF}/projects/${i}/installations`}function Zk(i){return{token:i.token,requestStatus:2,expiresIn:YF(i.expiresIn),creationTime:Date.now()}}async function eR(i,e){const n=(await e.json()).error;return Fo.create("request-failed",{requestName:i,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function tR({apiKey:i}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":i})}function KF(i,{refreshToken:e}){const t=tR(i);return t.append("Authorization",XF(e)),t}async function nR(i){const e=await i();return e.status>=500&&e.status<600?i():e}function YF(i){return Number(i.replace("s","000"))}function XF(i){return`${Xk} ${i}`}async function QF({appConfig:i,heartbeatServiceProvider:e},{fid:t}){const n=Jk(i),s=tR(i),a=e.getImmediate({optional:!0});if(a){const d=await a.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:t,authVersion:Xk,appId:i.appId,sdkVersion:Yk},c={method:"POST",headers:s,body:JSON.stringify(o)},h=await nR(()=>fetch(n,c));if(h.ok){const d=await h.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:Zk(d.authToken)}}else throw await eR("Create Installation",h)}function iR(i){return new Promise(e=>{setTimeout(e,i)})}function JF(i){return btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_")}const ZF=/^[cdef][\w-]{21}$/,Rb="";function e4(){try{const i=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(i),i[0]=112+i[0]%16;const t=t4(i);return ZF.test(t)?t:Rb}catch{return Rb}}function t4(i){return JF(i).substr(0,22)}function pm(i){return`${i.appName}!${i.appId}`}const sR=new Map;function rR(i,e){const t=pm(i);aR(t,e),n4(t,e)}function aR(i,e){const t=sR.get(i);if(t)for(const n of t)n(e)}function n4(i,e){const t=i4();t&&t.postMessage({key:i,fid:e}),s4()}let Oo=null;function i4(){return!Oo&&"BroadcastChannel"in self&&(Oo=new BroadcastChannel("[Firebase] FID Change"),Oo.onmessage=i=>{aR(i.data.key,i.data.fid)}),Oo}function s4(){sR.size===0&&Oo&&(Oo.close(),Oo=null)}const r4="firebase-installations-database",a4=1,zo="firebase-installations-store";let ov=null;function $_(){return ov||(ov=SC(r4,a4,{upgrade:(i,e)=>{e===0&&i.createObjectStore(zo)}})),ov}async function Pp(i,e){const t=pm(i),s=(await $_()).transaction(zo,"readwrite"),a=s.objectStore(zo),o=await a.get(t);return await a.put(e,t),await s.done,(!o||o.fid!==e.fid)&&rR(i,e.fid),e}async function oR(i){const e=pm(i),n=(await $_()).transaction(zo,"readwrite");await n.objectStore(zo).delete(e),await n.done}async function mm(i,e){const t=pm(i),s=(await $_()).transaction(zo,"readwrite"),a=s.objectStore(zo),o=await a.get(t),c=e(o);return c===void 0?await a.delete(t):await a.put(c,t),await s.done,c&&(!o||o.fid!==c.fid)&&rR(i,c.fid),c}async function G_(i){let e;const t=await mm(i.appConfig,n=>{const s=o4(n),a=l4(i,s);return e=a.registrationPromise,a.installationEntry});return t.fid===Rb?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function o4(i){const e=i||{fid:e4(),registrationStatus:0};return lR(e)}function l4(i,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Fo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=c4(i,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:u4(i)}:{installationEntry:e}}async function c4(i,e){try{const t=await QF(i,e);return Pp(i.appConfig,t)}catch(t){throw Qk(t)&&t.customData.serverCode===409?await oR(i.appConfig):await Pp(i.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function u4(i){let e=await VT(i.appConfig);for(;e.registrationStatus===1;)await iR(100),e=await VT(i.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await G_(i);return n||t}return e}function VT(i){return mm(i,e=>{if(!e)throw Fo.create("installation-not-found");return lR(e)})}function lR(i){return h4(i)?{fid:i.fid,registrationStatus:0}:i}function h4(i){return i.registrationStatus===1&&i.registrationTime+Kk<Date.now()}async function d4({appConfig:i,heartbeatServiceProvider:e},t){const n=f4(i,t),s=KF(i,t),a=e.getImmediate({optional:!0});if(a){const d=await a.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:Yk,appId:i.appId}},c={method:"POST",headers:s,body:JSON.stringify(o)},h=await nR(()=>fetch(n,c));if(h.ok){const d=await h.json();return Zk(d)}else throw await eR("Generate Auth Token",h)}function f4(i,{fid:e}){return`${Jk(i)}/${e}/authTokens:generate`}async function W_(i,e=!1){let t;const n=await mm(i.appConfig,a=>{if(!cR(a))throw Fo.create("not-registered");const o=a.authToken;if(!e&&g4(o))return a;if(o.requestStatus===1)return t=p4(i,e),a;{if(!navigator.onLine)throw Fo.create("app-offline");const c=v4(a);return t=m4(i,c),c}});return t?await t:n.authToken}async function p4(i,e){let t=await qT(i.appConfig);for(;t.authToken.requestStatus===1;)await iR(100),t=await qT(i.appConfig);const n=t.authToken;return n.requestStatus===0?W_(i,e):n}function qT(i){return mm(i,e=>{if(!cR(e))throw Fo.create("not-registered");const t=e.authToken;return b4(t)?{...e,authToken:{requestStatus:0}}:e})}async function m4(i,e){try{const t=await d4(i,e),n={...e,authToken:t};return await Pp(i.appConfig,n),t}catch(t){if(Qk(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await oR(i.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Pp(i.appConfig,n)}throw t}}function cR(i){return i!==void 0&&i.registrationStatus===2}function g4(i){return i.requestStatus===2&&!y4(i)}function y4(i){const e=Date.now();return e<i.creationTime||i.creationTime+i.expiresIn<e+HF}function v4(i){const e={requestStatus:1,requestTime:Date.now()};return{...i,authToken:e}}function b4(i){return i.requestStatus===1&&i.requestTime+Kk<Date.now()}async function _4(i){const e=i,{installationEntry:t,registrationPromise:n}=await G_(e);return n?n.catch(console.error):W_(e).catch(console.error),t.fid}async function w4(i,e=!1){const t=i;return await A4(t),(await W_(t,e)).token}async function A4(i){const{registrationPromise:e}=await G_(i);e&&await e}function E4(i){if(!i||!i.options)throw lv("App Configuration");if(!i.name)throw lv("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!i.options[t])throw lv(t);return{appName:i.name,projectId:i.options.projectId,apiKey:i.options.apiKey,appId:i.options.appId}}function lv(i){return Fo.create("missing-app-config-values",{valueName:i})}const uR="installations",S4="installations-internal",T4=i=>{const e=i.getProvider("app").getImmediate(),t=E4(e),n=qa(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},x4=i=>{const e=i.getProvider("app").getImmediate(),t=qa(e,uR).getImmediate();return{getId:()=>_4(t),getToken:s=>w4(t,s)}};function C4(){ds(new qi(uR,T4,"PUBLIC")),ds(new qi(S4,x4,"PRIVATE"))}C4();ri(Wk,H_);ri(Wk,H_,"esm2020");const Np="analytics",k4="firebase_id",R4="origin",I4=60*1e3,D4="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",K_="https://www.googletagmanager.com/gtag/js";const Wn=new em("@firebase/analytics");const O4={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Ai=new Go("analytics","Analytics",O4);function P4(i){if(!i.startsWith(K_)){const e=Ai.create("invalid-gtag-resource",{gtagURL:i});return Wn.warn(e.message),""}return i}function hR(i){return Promise.all(i.map(e=>e.catch(t=>t)))}function N4(i,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(i,e)),t}function M4(i,e){const t=N4("firebase-js-sdk-policy",{createScriptURL:P4}),n=document.createElement("script"),s=`${K_}?l=${i}&id=${e}`;n.src=t?t?.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function L4(i){let e=[];return Array.isArray(window[i])?e=window[i]:window[i]=e,e}async function j4(i,e,t,n,s,a){const o=n[s];try{if(o)await e[o];else{const h=(await hR(t)).find(d=>d.measurementId===s);h&&await e[h.appId]}}catch(c){Wn.error(c)}i("config",s,a)}async function B4(i,e,t,n,s){try{let a=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=await hR(t);for(const h of o){const d=c.find(m=>m.measurementId===h),p=d&&e[d.appId];if(p)a.push(p);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),i("event",n,s||{})}catch(a){Wn.error(a)}}function U4(i,e,t,n){async function s(a,...o){try{if(a==="event"){const[c,h]=o;await B4(i,e,t,c,h)}else if(a==="config"){const[c,h]=o;await j4(i,e,t,n,c,h)}else if(a==="consent"){const[c,h]=o;i("consent",c,h)}else if(a==="get"){const[c,h,d]=o;i("get",c,h,d)}else if(a==="set"){const[c]=o;i("set",c)}else i(a,...o)}catch(c){Wn.error(c)}}return s}function F4(i,e,t,n,s){let a=function(...o){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=U4(a,i,e,t),{gtagCore:a,wrappedGtag:window[s]}}function z4(i){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(K_)&&t.src.includes(i))return t;return null}const V4=30,q4=1e3;class H4{constructor(e={},t=q4){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const dR=new H4;function $4(i){return new Headers({Accept:"application/json","x-goog-api-key":i})}async function G4(i){const{appId:e,apiKey:t}=i,n={method:"GET",headers:$4(t)},s=D4.replace("{app-id}",e),a=await fetch(s,n);if(a.status!==200&&a.status!==304){let o="";try{const c=await a.json();c.error?.message&&(o=c.error.message)}catch{}throw Ai.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function W4(i,e=dR,t){const{appId:n,apiKey:s,measurementId:a}=i.options;if(!n)throw Ai.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:n};throw Ai.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new X4;return setTimeout(async()=>{c.abort()},I4),fR({appId:n,apiKey:s,measurementId:a},o,c,e)}async function fR(i,{throttleEndTimeMillis:e,backoffCount:t},n,s=dR){const{appId:a,measurementId:o}=i;try{await K4(n,e)}catch(c){if(o)return Wn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:a,measurementId:o};throw c}try{const c=await G4(i);return s.deleteThrottleMetadata(a),c}catch(c){const h=c;if(!Y4(h)){if(s.deleteThrottleMetadata(a),o)return Wn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:a,measurementId:o};throw c}const d=Number(h?.customData?.httpStatus)===503?OS(t,s.intervalMillis,V4):OS(t,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:t+1};return s.setThrottleMetadata(a,p),Wn.debug(`Calling attemptFetch again in ${d} millis`),fR(i,p,n,s)}}function K4(i,e){return new Promise((t,n)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(t,s);i.addEventListener(()=>{clearTimeout(a),n(Ai.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Y4(i){if(!(i instanceof Gi)||!i.customData)return!1;const e=Number(i.customData.httpStatus);return e===429||e===500||e===503||e===504}class X4{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Q4(i,e,t,n,s){if(s&&s.global){i("event",t,n);return}else{const a=await e,o={...n,send_to:a};i("event",t,o)}}async function J4(i,e,t,n){if(n&&n.global){const s={};for(const a of Object.keys(t))s[`user_properties.${a}`]=t[a];return i("set",s),Promise.resolve()}else{const s=await e;i("config",s,{update:!0,user_properties:t})}}async function Z4(){if(_C())try{await wC()}catch(i){return Wn.warn(Ai.create("indexeddb-unavailable",{errorInfo:i?.toString()}).message),!1}else return Wn.warn(Ai.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function e3(i,e,t,n,s,a,o){const c=W4(i);c.then(v=>{t[v.measurementId]=v.appId,i.options.measurementId&&v.measurementId!==i.options.measurementId&&Wn.warn(`The measurement ID in the local Firebase config (${i.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>Wn.error(v)),e.push(c);const h=Z4().then(v=>{if(v)return n.getId()}),[d,p]=await Promise.all([c,h]);z4(a)||M4(a,d.measurementId),s("js",new Date);const m=o?.config??{};return m[R4]="firebase",m.update=!0,p!=null&&(m[k4]=p),s("config",d.measurementId,m),d.measurementId}class t3{constructor(e){this.app=e}_delete(){return delete pc[this.app.options.appId],Promise.resolve()}}let pc={},HT=[];const $T={};let cv="dataLayer",n3="gtag",GT,Y_,WT=!1;function i3(){const i=[];if(bC()&&i.push("This is a browser extension environment."),wL()||i.push("Cookies are not available."),i.length>0){const e=i.map((n,s)=>`(${s+1}) ${n}`).join(" "),t=Ai.create("invalid-analytics-context",{errorInfo:e});Wn.warn(t.message)}}function s3(i,e,t){i3();const n=i.options.appId;if(!n)throw Ai.create("no-app-id");if(!i.options.apiKey)if(i.options.measurementId)Wn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${i.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Ai.create("no-api-key");if(pc[n]!=null)throw Ai.create("already-exists",{id:n});if(!WT){L4(cv);const{wrappedGtag:a,gtagCore:o}=F4(pc,HT,$T,cv,n3);Y_=a,GT=o,WT=!0}return pc[n]=e3(i,HT,$T,e,GT,cv,t),new t3(i)}function r3(i=tm()){i=_n(i);const e=qa(i,Np);return e.isInitialized()?e.getImmediate():a3(i)}function a3(i,e={}){const t=qa(i,Np);if(t.isInitialized()){const s=t.getImmediate();if(Na(e,t.getOptions()))return s;throw Ai.create("already-initialized")}return t.initialize({options:e})}function o3(i,e,t){i=_n(i),J4(Y_,pc[i.app.options.appId],e,t).catch(n=>Wn.error(n))}function l3(i,e,t,n){i=_n(i),Q4(Y_,pc[i.app.options.appId],e,t,n).catch(s=>Wn.error(s))}const KT="@firebase/analytics",YT="0.10.19";function c3(){ds(new qi(Np,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return s3(n,s,t)},"PUBLIC")),ds(new qi("analytics-internal",i,"PRIVATE")),ri(KT,YT),ri(KT,YT,"esm2020");function i(e){try{const t=e.getProvider(Np).getImmediate();return{logEvent:(n,s,a)=>l3(t,n,s,a),setUserProperties:(n,s)=>o3(t,n,s)}}catch(t){throw Ai.create("interop-component-reg-failed",{reason:t})}}}c3();function pR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const u3=pR,mR=new Go("auth","Firebase",pR());const Mp=new em("@firebase/auth");function h3(i,...e){Mp.logLevel<=We.WARN&&Mp.warn(`Auth (${Wo}): ${i}`,...e)}function dp(i,...e){Mp.logLevel<=We.ERROR&&Mp.error(`Auth (${Wo}): ${i}`,...e)}function ps(i,...e){throw X_(i,...e)}function Xs(i,...e){return X_(i,...e)}function gR(i,e,t){const n={...u3(),[e]:t};return new Go("auth","Firebase",n).create(e,{appName:i.name})}function Pa(i){return gR(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function X_(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return mR.create(i,...e)}function De(i,e,...t){if(!i)throw X_(e,...t)}function Rr(i){const e="INTERNAL ASSERTION FAILED: "+i;throw dp(e),new Error(e)}function Mr(i,e){i||Rr(e)}function Ib(){return typeof self<"u"&&self.location?.href||""}function d3(){return XT()==="http:"||XT()==="https:"}function XT(){return typeof self<"u"&&self.location?.protocol||null}function f3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(d3()||bC()||"connection"in navigator)?navigator.onLine:!0}function p3(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}class Yh{constructor(e,t){this.shortDelay=e,this.longDelay=t,Mr(t>e,"Short delay should be less than long delay!"),this.isMobile=mL()||vL()}get(){return f3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Q_(i,e){Mr(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class yR{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const m3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const g3=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],y3=new Yh(3e4,6e4);function Xo(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function Ha(i,e,t,n,s={}){return vR(i,s,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const c=Hh({key:i.config.apiKey,...o}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const d={method:e,headers:h,...a};return yL()||(d.referrerPolicy="no-referrer"),i.emulatorConfig&&$o(i.emulatorConfig.host)&&(d.credentials="include"),yR.fetch()(await bR(i,i.config.apiHost,t,c),d)})}async function vR(i,e,t){i._canInitEmulator=!1;const n={...m3,...e};try{const s=new b3(i),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw $f(i,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[h,d]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw $f(i,"credential-already-in-use",o);if(h==="EMAIL_EXISTS")throw $f(i,"email-already-in-use",o);if(h==="USER_DISABLED")throw $f(i,"user-disabled",o);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gR(i,p,d);ps(i,p)}}catch(s){if(s instanceof Gi)throw s;ps(i,"network-request-failed",{message:String(s)})}}async function gm(i,e,t,n,s={}){const a=await Ha(i,e,t,n,s);return"mfaPendingCredential"in a&&ps(i,"multi-factor-auth-required",{_serverResponse:a}),a}async function bR(i,e,t,n){const s=`${e}${t}?${n}`,a=i,o=a.config.emulator?Q_(i.config,s):`${i.config.apiScheme}://${s}`;return g3.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function v3(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class b3{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Xs(this.auth,"network-request-failed")),y3.get())})}}function $f(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=Xs(i,e,n);return s.customData._tokenResponse=t,s}function QT(i){return i!==void 0&&i.enterprise!==void 0}class _3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return v3(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function w3(i,e){return Ha(i,"GET","/v2/recaptchaConfig",Xo(i,e))}async function A3(i,e){return Ha(i,"POST","/v1/accounts:delete",e)}async function Lp(i,e){return Ha(i,"POST","/v1/accounts:lookup",e)}function vh(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function E3(i,e=!1){const t=_n(i),n=await t.getIdToken(e),s=J_(n);De(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,o=a?.sign_in_provider;return{claims:s,token:n,authTime:vh(uv(s.auth_time)),issuedAtTime:vh(uv(s.iat)),expirationTime:vh(uv(s.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function uv(i){return Number(i)*1e3}function J_(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return dp("JWT malformed, contained fewer than 3 sections"),null;try{const s=fC(t);return s?JSON.parse(s):(dp("Failed to decode base64 JWT payload"),null)}catch(s){return dp("Caught error parsing JWT payload as JSON",s?.toString()),null}}function JT(i){const e=J_(i);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ph(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Gi&&S3(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function S3({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}class T3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Db{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vh(this.lastLoginAt),this.creationTime=vh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function jp(i){const e=i.auth,t=await i.getIdToken(),n=await Ph(i,Lp(e,{idToken:t}));De(n?.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const a=s.providerUserInfo?.length?_R(s.providerUserInfo):[],o=C3(i.providerData,a),c=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!o?.length,d=c?h:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Db(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(i,p)}async function x3(i){const e=_n(i);await jp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function C3(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function _R(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function k3(i,e){const t=await vR(i,{},async()=>{const n=Hh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=i.config,o=await bR(i,s,"/v1/token",`key=${a}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return i.emulatorConfig&&$o(i.emulatorConfig.host)&&(h.credentials="include"),yR.fetch()(o,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function R3(i,e){return Ha(i,"POST","/v2/accounts:revokeToken",Xo(i,e))}class mc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):JT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=JT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:a}=await k3(e,t);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:a}=t,o=new mc;return n&&(De(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(De(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),a&&(De(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new mc,this.toJSON())}_performRefresh(){return Rr("not implemented")}}function va(i,e){De(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class cs{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new T3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Db(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ph(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return E3(this,e)}reload(){return x3(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new cs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await jp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zi(this.auth.app))return Promise.reject(Pa(this.auth));const e=await this.getIdToken();return await Ph(this,A3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,d=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:m,emailVerified:v,isAnonymous:_,providerData:S,stsTokenManager:A}=t;De(m&&A,e,"internal-error");const T=mc.fromJSON(this.name,A);De(typeof m=="string",e,"internal-error"),va(n,e.name),va(s,e.name),De(typeof v=="boolean",e,"internal-error"),De(typeof _=="boolean",e,"internal-error"),va(a,e.name),va(o,e.name),va(c,e.name),va(h,e.name),va(d,e.name),va(p,e.name);const x=new cs({uid:m,auth:e,email:s,emailVerified:v,displayName:n,isAnonymous:_,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:T,createdAt:d,lastLoginAt:p});return S&&Array.isArray(S)&&(x.providerData=S.map(D=>({...D}))),h&&(x._redirectEventId=h),x}static async _fromIdTokenResponse(e,t,n=!1){const s=new mc;s.updateFromServerResponse(t);const a=new cs({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await jp(a),a}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];De(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?_R(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!a?.length,c=new mc;c.updateFromIdToken(n);const h=new cs({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Db(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(h,d),h}}const ZT=new Map;function Ir(i){Mr(i instanceof Function,"Expected a class definition");let e=ZT.get(i);return e?(Mr(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,ZT.set(i,e),e)}class wR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wR.type="NONE";const e1=wR;function fp(i,e,t){return`firebase:${i}:${e}:${t}`}class gc{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=fp(this.userKey,s.apiKey,a),this.fullPersistenceKey=fp("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Lp(this.auth,{idToken:e}).catch(()=>{});return t?cs._fromGetAccountInfoResponse(this.auth,t,e):null}return cs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new gc(Ir(e1),e,n);const s=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=s[0]||Ir(e1);const o=fp(n,e.config.apiKey,e.name);let c=null;for(const d of t)try{const p=await d._get(o);if(p){let m;if(typeof p=="string"){const v=await Lp(e,{idToken:p}).catch(()=>{});if(!v)break;m=await cs._fromGetAccountInfoResponse(e,v,p)}else m=cs._fromJSON(e,p);d!==a&&(c=m),a=d;break}}catch{}const h=s.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new gc(a,e,n):(a=h[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new gc(a,e,n))}}function t1(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(TR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(AR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CR(e))return"Blackberry";if(kR(e))return"Webos";if(ER(e))return"Safari";if((e.includes("chrome/")||SR(e))&&!e.includes("edge/"))return"Chrome";if(xR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if(n?.length===2)return n[1]}return"Other"}function AR(i=zn()){return/firefox\//i.test(i)}function ER(i=zn()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function SR(i=zn()){return/crios\//i.test(i)}function TR(i=zn()){return/iemobile/i.test(i)}function xR(i=zn()){return/android/i.test(i)}function CR(i=zn()){return/blackberry/i.test(i)}function kR(i=zn()){return/webos/i.test(i)}function Z_(i=zn()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function I3(i=zn()){return Z_(i)&&!!window.navigator?.standalone}function D3(){return bL()&&document.documentMode===10}function RR(i=zn()){return Z_(i)||xR(i)||kR(i)||CR(i)||/windows phone/i.test(i)||TR(i)}function IR(i,e=[]){let t;switch(i){case"Browser":t=t1(zn());break;case"Worker":t=`${t1(zn())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wo}/${n}`}class O3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=a=>new Promise((o,c)=>{try{const h=e(a);o(h)}catch(h){c(h)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function P3(i,e={}){return Ha(i,"GET","/v2/passwordPolicy",Xo(i,e))}const N3=6;class M3{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??N3,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class L3{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new n1(this),this.idTokenSubscription=new n1(this),this.beforeStateQueue=new O3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ir(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await gc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Lp(this,{idToken:e}),n=await cs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await jp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=p3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zi(this.app))return Promise.reject(Pa(this));const t=e?_n(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zi(this.app)?Promise.reject(Pa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zi(this.app)?Promise.reject(Pa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ir(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await P3(this),t=new M3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Go("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await R3(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ir(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await gc.create(this,[Ir(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,n,s);return()=>{o=!0,h()}}else{const h=e.addObserver(t);return()=>{o=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=IR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(zi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&h3(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Fc(i){return _n(i)}class n1{constructor(e){this.auth=e,this.observer=null,this.addObserver=xL(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ym={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function j3(i){ym=i}function DR(i){return ym.loadJS(i)}function B3(){return ym.recaptchaEnterpriseScript}function U3(){return ym.gapiScript}function F3(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class z3{constructor(){this.enterprise=new V3}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class V3{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const q3="recaptcha-enterprise",OR="NO_RECAPTCHA";class H3{constructor(e){this.type=q3,this.auth=Fc(e)}async verify(e="verify",t=!1){async function n(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{w3(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new _3(h);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(h=>{c(h)})})}function s(a,o,c){const h=window.grecaptcha;QT(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(OR)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new z3().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(c=>{if(!t&&QT(window.grecaptcha))s(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let h=B3();h.length!==0&&(h+=c),DR(h).then(()=>{s(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function i1(i,e,t,n=!1,s=!1){const a=new H3(i);let o;if(s)o=OR;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function s1(i,e,t,n,s){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await i1(i,e,t,t==="getOobCode");return n(i,a)}else return n(i,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await i1(i,e,t,t==="getOobCode");return n(i,o)}else return Promise.reject(a)})}function $3(i,e){const t=qa(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(Na(a,e??{}))return s;ps(s,"already-initialized")}return t.initialize({options:e})}function G3(i,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Ir);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e?.popupRedirectResolver)}function W3(i,e,t){const n=Fc(i);De(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=PR(e),{host:o,port:c}=K3(e),h=c===null?"":`:${c}`,d={url:`${a}//${o}${h}/`},p=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){De(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),De(Na(d,n.config.emulator)&&Na(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,$o(o)?(h_(`${a}//${o}${h}`),d_("Auth",!0)):Y3()}function PR(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function K3(i){const e=PR(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:r1(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:r1(o)}}}function r1(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function Y3(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}class e0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Rr("not implemented")}_getIdTokenResponse(e){return Rr("not implemented")}_linkToIdToken(e,t){return Rr("not implemented")}_getReauthenticationResolver(e){return Rr("not implemented")}}async function X3(i,e){return Ha(i,"POST","/v1/accounts:signUp",e)}async function Q3(i,e){return gm(i,"POST","/v1/accounts:signInWithPassword",Xo(i,e))}async function J3(i,e){return gm(i,"POST","/v1/accounts:signInWithEmailLink",Xo(i,e))}async function Z3(i,e){return gm(i,"POST","/v1/accounts:signInWithEmailLink",Xo(i,e))}class Nh extends e0{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Nh(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Nh(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return s1(e,t,"signInWithPassword",Q3);case"emailLink":return J3(e,{email:this._email,oobCode:this._password});default:ps(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return s1(e,n,"signUpPassword",X3);case"emailLink":return Z3(e,{idToken:t,email:this._email,oobCode:this._password});default:ps(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function yc(i,e){return gm(i,"POST","/v1/accounts:signInWithIdp",Xo(i,e))}const ez="http://localhost";class Vo extends e0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ps("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...a}=t;if(!n||!s)return null;const o=new Vo(n,s);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return yc(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,yc(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,yc(e,t)}buildRequest(){const e={requestUri:ez,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hh(t)}return e}}function tz(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nz(i){const e=nh(ih(i)).link,t=e?nh(ih(e)).deep_link_id:null,n=nh(ih(i)).deep_link_id;return(n?nh(ih(n)).link:null)||n||t||e||i}class t0{constructor(e){const t=nh(ih(e)),n=t.apiKey??null,s=t.oobCode??null,a=tz(t.mode??null);De(n&&s&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=nz(e);try{return new t0(t)}catch{return null}}}class zc{constructor(){this.providerId=zc.PROVIDER_ID}static credential(e,t){return Nh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=t0.parseLink(t);return De(n,"argument-error"),Nh._fromEmailAndCode(e,n.code,n.tenantId)}}zc.PROVIDER_ID="password";zc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class NR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Xh extends NR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Aa extends Xh{constructor(){super("facebook.com")}static credential(e){return Vo._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Aa.credential(e.oauthAccessToken)}catch{return null}}}Aa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Aa.PROVIDER_ID="facebook.com";class Ea extends Xh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vo._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ea.credential(t,n)}catch{return null}}}Ea.GOOGLE_SIGN_IN_METHOD="google.com";Ea.PROVIDER_ID="google.com";class Sa extends Xh{constructor(){super("github.com")}static credential(e){return Vo._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sa.credential(e.oauthAccessToken)}catch{return null}}}Sa.GITHUB_SIGN_IN_METHOD="github.com";Sa.PROVIDER_ID="github.com";class Ta extends Xh{constructor(){super("twitter.com")}static credential(e,t){return Vo._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ta.credential(t,n)}catch{return null}}}Ta.TWITTER_SIGN_IN_METHOD="twitter.com";Ta.PROVIDER_ID="twitter.com";class Ic{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const a=await cs._fromIdTokenResponse(e,n,s),o=a1(n);return new Ic({user:a,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=a1(n);return new Ic({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function a1(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}class Bp extends Gi{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Bp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Bp(e,t,n,s)}}function MR(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Bp._fromErrorAndOperation(i,a,e,n):a})}async function iz(i,e,t=!1){const n=await Ph(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Ic._forOperation(i,"link",n)}async function sz(i,e,t=!1){const{auth:n}=i;if(zi(n.app))return Promise.reject(Pa(n));const s="reauthenticate";try{const a=await Ph(i,MR(n,s,e,i),t);De(a.idToken,n,"internal-error");const o=J_(a.idToken);De(o,n,"internal-error");const{sub:c}=o;return De(i.uid===c,n,"user-mismatch"),Ic._forOperation(i,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&ps(n,"user-mismatch"),a}}async function LR(i,e,t=!1){if(zi(i.app))return Promise.reject(Pa(i));const n="signIn",s=await MR(i,n,e),a=await Ic._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(a.user),a}async function rz(i,e){return LR(Fc(i),e)}async function az(i){const e=Fc(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function oz(i,e,t){return zi(i.app)?Promise.reject(Pa(i)):rz(_n(i),zc.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&az(i),n})}function lz(i,e,t,n){return _n(i).onIdTokenChanged(e,t,n)}function cz(i,e,t){return _n(i).beforeAuthStateChanged(e,t)}function uz(i,e,t,n){return _n(i).onAuthStateChanged(e,t,n)}function hz(i){return _n(i).signOut()}const Up="__sak";class jR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Up,"1"),this.storage.removeItem(Up),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const dz=1e3,fz=10;class BR extends jR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=RR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,h)=>{this.notifyListeners(o,h)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);D3()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fz):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},dz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}BR.type="LOCAL";const pz=BR;class UR extends jR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}UR.type="SESSION";const FR=UR;function mz(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class vm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new vm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:a}=t.data,o=this.handlersMap[s];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async d=>d(t.origin,a)),h=await mz(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vm.receivers=[];function n0(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}class gz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,o;return new Promise((c,h)=>{const d=n0("",20);s.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(m){const v=m;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(v.data.response);break;default:clearTimeout(p),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Qs(){return window}function yz(i){Qs().location.href=i}function zR(){return typeof Qs().WorkerGlobalScope<"u"&&typeof Qs().importScripts=="function"}async function vz(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bz(){return navigator?.serviceWorker?.controller||null}function _z(){return zR()?self:null}const VR="firebaseLocalStorageDb",wz=1,Fp="firebaseLocalStorage",qR="fbase_key";class Qh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function bm(i,e){return i.transaction([Fp],e?"readwrite":"readonly").objectStore(Fp)}function Az(){const i=indexedDB.deleteDatabase(VR);return new Qh(i).toPromise()}function Ob(){const i=indexedDB.open(VR,wz);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Fp,{keyPath:qR})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Fp)?e(n):(n.close(),await Az(),e(await Ob()))})})}async function o1(i,e,t){const n=bm(i,!0).put({[qR]:e,value:t});return new Qh(n).toPromise()}async function Ez(i,e){const t=bm(i,!1).get(e),n=await new Qh(t).toPromise();return n===void 0?null:n.value}function l1(i,e){const t=bm(i,!0).delete(e);return new Qh(t).toPromise()}const Sz=800,Tz=3;class HR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ob(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>Tz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vm._getInstance(_z()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await vz(),!this.activeServiceWorker)return;this.sender=new gz(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ob();return await o1(e,Up,"1"),await l1(e,Up),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>o1(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>Ez(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>l1(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=bm(s,!1).getAll();return new Qh(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Sz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HR.type="LOCAL";const xz=HR;new Yh(3e4,6e4);function Cz(i,e){return e?Ir(e):(De(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}class i0 extends e0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return yc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return yc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function kz(i){return LR(i.auth,new i0(i),i.bypassAuthState)}function Rz(i){const{auth:e,user:t}=i;return De(t,e,"internal-error"),sz(t,new i0(i),i.bypassAuthState)}async function Iz(i){const{auth:e,user:t}=i;return De(t,e,"internal-error"),iz(t,new i0(i),i.bypassAuthState)}class $R{constructor(e,t,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const h={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kz;case"linkViaPopup":case"linkViaRedirect":return Iz;case"reauthViaPopup":case"reauthViaRedirect":return Rz;default:ps(this.auth,"internal-error")}}resolve(e){Mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Dz=new Yh(2e3,1e4);class sc extends $R{constructor(e,t,n,s,a){super(e,t,s,a),this.provider=n,this.authWindow=null,this.pollId=null,sc.currentPopupAction&&sc.currentPopupAction.cancel(),sc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Mr(this.filter.length===1,"Popup operations only handle one event");const e=n0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,sc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Dz.get())};e()}}sc.currentPopupAction=null;const Oz="pendingRedirect",pp=new Map;class Pz extends $R{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=pp.get(this.auth._key());if(!e){try{const n=await Nz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}pp.set(this.auth._key(),e)}return this.bypassAuthState||pp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Nz(i,e){const t=jz(e),n=Lz(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function Mz(i,e){pp.set(i._key(),e)}function Lz(i){return Ir(i._redirectPersistence)}function jz(i){return fp(Oz,i.config.apiKey,i.name)}async function Bz(i,e,t=!1){if(zi(i.app))return Promise.reject(Pa(i));const n=Fc(i),s=Cz(n,e),o=await new Pz(n,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const Uz=600*1e3;class Fz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zz(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!GR(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Xs(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Uz&&this.cachedEventUids.clear(),this.cachedEventUids.has(c1(e))}saveEventToCache(e){this.cachedEventUids.add(c1(e)),this.lastProcessedEventTime=Date.now()}}function c1(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function GR({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function zz(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return GR(i);default:return!1}}async function Vz(i,e={}){return Ha(i,"GET","/v1/projects",e)}const qz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hz=/^https?/;async function $z(i){if(i.config.emulator)return;const{authorizedDomains:e}=await Vz(i);for(const t of e)try{if(Gz(t))return}catch{}ps(i,"unauthorized-domain")}function Gz(i){const e=Ib(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const o=new URL(i);return o.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!Hz.test(t))return!1;if(qz.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}const Wz=new Yh(3e4,6e4);function u1(){const i=Qs().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function Kz(i){return new Promise((e,t)=>{function n(){u1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{u1(),t(Xs(i,"network-request-failed"))},timeout:Wz.get()})}if(Qs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Qs().gapi?.load)n();else{const s=F3("iframefcb");return Qs()[s]=()=>{gapi.load?n():t(Xs(i,"network-request-failed"))},DR(`${U3()}?onload=${s}`).catch(a=>t(a))}}).catch(e=>{throw mp=null,e})}let mp=null;function Yz(i){return mp=mp||Kz(i),mp}const Xz=new Yh(5e3,15e3),Qz="__/auth/iframe",Jz="emulator/auth/iframe",Zz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tV(i){const e=i.config;De(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Q_(e,Jz):`https://${i.config.authDomain}/${Qz}`,n={apiKey:e.apiKey,appName:i.name,v:Wo},s=eV.get(i.config.apiHost);s&&(n.eid=s);const a=i._getFrameworks();return a.length&&(n.fw=a.join(",")),`${t}?${Hh(n).slice(1)}`}async function nV(i){const e=await Yz(i),t=Qs().gapi;return De(t,i,"internal-error"),e.open({where:document.body,url:tV(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Zz,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const o=Xs(i,"network-request-failed"),c=Qs().setTimeout(()=>{a(o)},Xz.get());function h(){Qs().clearTimeout(c),s(n)}n.ping(h).then(h,()=>{a(o)})}))}const iV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sV=500,rV=600,aV="_blank",oV="http://localhost";class h1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lV(i,e,t,n=sV,s=rV){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...iV,width:n.toString(),height:s.toString(),top:a,left:o},d=zn().toLowerCase();t&&(c=SR(d)?aV:t),AR(d)&&(e=e||oV,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[_,S])=>`${v}${_}=${S},`,"");if(I3(d)&&c!=="_self")return cV(e||"",c),new h1(null);const m=window.open(e||"",c,p);De(m,i,"popup-blocked");try{m.focus()}catch{}return new h1(m)}function cV(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}const uV="__/auth/handler",hV="emulator/auth/handler",dV=encodeURIComponent("fac");async function d1(i,e,t,n,s,a){De(i.config.authDomain,i,"auth-domain-config-required"),De(i.config.apiKey,i,"invalid-api-key");const o={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:Wo,eventId:s};if(e instanceof NR){e.setDefaultLanguage(i.languageCode),o.providerId=e.providerId||"",TL(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof Xh){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}i.tenantId&&(o.tid=i.tenantId);const c=o;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const h=await i._getAppCheckToken(),d=h?`#${dV}=${encodeURIComponent(h)}`:"";return`${fV(i)}?${Hh(c).slice(1)}${d}`}function fV({config:i}){return i.emulator?Q_(i,hV):`https://${i.authDomain}/${uV}`}const hv="webStorageSupport";class pV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=FR,this._completeRedirectFn=Bz,this._overrideRedirectResult=Mz}async _openPopup(e,t,n,s){Mr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await d1(e,t,n,Ib(),s);return lV(e,a,n0())}async _openRedirect(e,t,n,s){await this._originValidation(e);const a=await d1(e,t,n,Ib(),s);return yz(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(Mr(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await nV(e),n=new Fz(e);return t.register("authEvent",s=>(De(s?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hv,{type:hv},s=>{const a=s?.[0]?.[hv];a!==void 0&&t(!!a),ps(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$z(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return RR()||ER()||Z_()}}const mV=pV;var f1="@firebase/auth",p1="1.12.0";class gV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function yV(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vV(i){ds(new qi("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;De(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:o,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:IR(i)},d=new L3(n,s,a,h);return G3(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ds(new qi("auth-internal",e=>{const t=Fc(e.getProvider("auth").getImmediate());return(n=>new gV(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ri(f1,p1,yV(i)),ri(f1,p1,"esm2020")}const bV=300,_V=yC("authIdTokenMaxAge")||bV;let m1=null;const wV=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>_V)return;const s=t?.token;m1!==s&&(m1=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function AV(i=tm()){const e=qa(i,"auth");if(e.isInitialized())return e.getImmediate();const t=$3(i,{popupRedirectResolver:mV,persistence:[xz,pz,FR]}),n=yC("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=wV(a.toString());cz(t,o,()=>o(t.currentUser)),lz(t,c=>o(c))}}const s=pC("auth");return s&&W3(t,`http://${s}`),t}function EV(){return document.getElementsByTagName("head")?.[0]??document}j3({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const a=Xs("internal-error");a.customData=s,t(a)},n.type="text/javascript",n.charset="UTF-8",EV().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vV("Browser");const WR="firebasestorage.googleapis.com",SV="storageBucket",TV=120*1e3,xV=600*1e3;class ir extends Gi{constructor(e,t,n=0){super(dv(e),`Firebase Storage: ${t} (${dv(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ir.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return dv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var er;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(er||(er={}));function dv(i){return"storage/"+i}function CV(){const i="An unknown error occurred, please check the error payload for server response.";return new ir(er.UNKNOWN,i)}function kV(){return new ir(er.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function RV(){return new ir(er.CANCELED,"User canceled the upload/download.")}function IV(i){return new ir(er.INVALID_URL,"Invalid URL '"+i+"'.")}function DV(i){return new ir(er.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function g1(i){return new ir(er.INVALID_ARGUMENT,i)}function KR(){return new ir(er.APP_DELETED,"The Firebase app was deleted.")}function OV(i){return new ir(er.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class us{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=us.makeFromUrl(e,t)}catch{return new us(e,"")}if(n.path==="")return n;throw DV(e)}static makeFromUrl(e,t){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}const o="(/(.*))?$",c=new RegExp("^gs://"+s+o,"i"),h={bucket:1,path:3};function d(U){U.path_=decodeURIComponent(U.path)}const p="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",_=new RegExp(`^https?://${m}/${p}/b/${s}/o${v}`,"i"),S={bucket:1,path:3},A=t===WR?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",x=new RegExp(`^https?://${A}/${s}/${T}`,"i"),I=[{regex:c,indices:h,postModify:a},{regex:_,indices:S,postModify:d},{regex:x,indices:{bucket:1,path:2},postModify:d}];for(let U=0;U<I.length;U++){const z=I[U],F=z.regex.exec(e);if(F){const R=F[z.indices.bucket];let O=F[z.indices.path];O||(O=""),n=new us(R,O),z.postModify(n);break}}if(n==null)throw IV(e);return n}}class PV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function NV(i,e,t){let n=1,s=null,a=null,o=!1,c=0;function h(){return c===2}let d=!1;function p(...T){d||(d=!0,e.apply(null,T))}function m(T){s=setTimeout(()=>{s=null,i(_,h())},T)}function v(){a&&clearTimeout(a)}function _(T,...x){if(d){v();return}if(T){v(),p.call(null,T,...x);return}if(h()||o){v(),p.call(null,T,...x);return}n<64&&(n*=2);let I;c===1?(c=2,I=0):I=(n+Math.random())*1e3,m(I)}let S=!1;function A(T){S||(S=!0,v(),!d&&(s!==null?(T||(c=2),clearTimeout(s),m(0)):T||(c=1)))}return m(0),a=setTimeout(()=>{o=!0,A(!0)},t),A}function MV(i){i(!1)}function LV(i){return i!==void 0}function y1(i,e,t,n){if(n<e)throw g1(`Invalid value for '${i}'. Expected ${e} or greater.`);if(n>t)throw g1(`Invalid value for '${i}'. Expected ${t} or less.`)}function jV(i){const e=encodeURIComponent;let t="?";for(const n in i)if(i.hasOwnProperty(n)){const s=e(n)+"="+e(i[n]);t=t+s+"&"}return t=t.slice(0,-1),t}var zp;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(zp||(zp={}));function BV(i,e){const t=i>=500&&i<600,s=[408,429].indexOf(i)!==-1,a=e.indexOf(i)!==-1;return t||s||a}class UV{constructor(e,t,n,s,a,o,c,h,d,p,m,v=!0,_=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=m,this.retry=v,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,A)=>{this.resolve_=S,this.reject_=A,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Gf(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const o=c=>{const h=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&a.addUploadProgressListener(o),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(o),this.pendingConnection_=null;const c=a.getErrorCode()===zp.NO_ERROR,h=a.getStatus();if(!c||BV(h,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===zp.ABORT;n(!1,new Gf(!1,null,p));return}const d=this.successCodes_.indexOf(h)!==-1;n(!0,new Gf(d,a))})},t=(n,s)=>{const a=this.resolve_,o=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const h=this.callback_(c,c.getResponse());LV(h)?a(h):a()}catch(h){o(h)}else if(c!==null){const h=CV();h.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,h)):o(h)}else if(s.canceled){const h=this.appDelete_?KR():RV();o(h)}else{const h=kV();o(h)}};this.canceled_?t(!1,new Gf(!1,null,!0)):this.backoffId_=NV(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&MV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gf{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function FV(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function zV(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function VV(i,e){e&&(i["X-Firebase-GMPID"]=e)}function qV(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function HV(i,e,t,n,s,a,o=!0,c=!1){const h=jV(i.urlParams),d=i.url+h,p=Object.assign({},i.headers);return VV(p,e),FV(p,t),zV(p,a),qV(p,n),new UV(d,i.method,p,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,s,o,c)}function $V(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function GV(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}class Vp{constructor(e,t){this._service=e,t instanceof us?this._location=t:this._location=us.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Vp(e,t)}get root(){const e=new us(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return GV(this._location.path)}get storage(){return this._service}get parent(){const e=$V(this._location.path);if(e===null)return null;const t=new us(this._location.bucket,e);return new Vp(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw OV(e)}}function v1(i,e){const t=e?.[SV];return t==null?null:us.makeFromBucketSpec(t,i)}function WV(i,e,t,n={}){i.host=`${e}:${t}`;const s=$o(e);s&&(h_(`https://${i.host}/b`),d_("Storage",!0)),i._isUsingEmulator=!0,i._protocol=s?"https":"http";const{mockUserToken:a}=n;a&&(i._overrideAuthToken=typeof a=="string"?a:vC(a,i.app.options.projectId))}class KV{constructor(e,t,n,s,a,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._isUsingEmulator=o,this._bucket=null,this._host=WR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=TV,this._maxUploadRetryTime=xV,this._requests=new Set,s!=null?this._bucket=us.makeFromBucketSpec(s,this._host):this._bucket=v1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=us.makeFromBucketSpec(this._url,e):this._bucket=v1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){y1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){y1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(zi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Vp(this,e)}_makeRequest(e,t,n,s,a=!0){if(this._deleted)return new PV(KR());{const o=HV(e,this._appId,n,s,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,s).getPromise()}}const b1="@firebase/storage",_1="0.14.0";const YR="storage";function YV(i=tm(),e){i=_n(i);const n=qa(i,YR).getImmediate({identifier:e}),s=mC("storage");return s&&XV(n,...s),n}function XV(i,e,t,n={}){WV(i,e,t,n)}function QV(i,{instanceIdentifier:e}){const t=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),s=i.getProvider("app-check-internal");return new KV(t,n,s,e,Wo)}function JV(){ds(new qi(YR,QV,"PUBLIC").setMultipleInstances(!0)),ri(b1,_1,""),ri(b1,_1,"esm2020")}JV();const ZV={apiKey:"AIzaSyCHGoYNndFtq00JOKpdfBI8645uxwzrxVw",authDomain:"it-museum.firebaseapp.com",projectId:"it-museum",storageBucket:"it-museum.firebasestorage.app",messagingSenderId:"49569676822",appId:"1:49569676822:web:c85d338f174ae336493f37",measurementId:"G-4XX95MCY6D"},_m=TC(ZV);r3(_m);const e6=AF(_m),fv=AV(_m);YV(_m);function t6(){const[i,e]=Y.useState([]),[t,n]=Y.useState(!0);return Y.useEffect(()=>{const s=MF(wF(e6,"collections"),LF("date","desc")),a=UF(s,o=>{const c=[];o.forEach(h=>{c.push({id:h.id,...h.data()})}),e(c),n(!1)});return()=>a()},[]),!t&&i.length===0?w.jsx("p",{style:{textAlign:"center",gridColumn:"1/-1",color:"#666",padding:"2rem"},children:"No collections added yet."}):w.jsx(w.Fragment,{children:i.map(s=>w.jsxs("div",{className:"researcher-card",onClick:()=>{},children:[s.imageUrl&&w.jsx("img",{src:s.imageUrl,alt:s.title||"Collection"}),w.jsxs("div",{className:"card-content",children:[w.jsx("h3",{children:s.title}),s.subtitle&&w.jsx("p",{className:"subtitle",children:s.subtitle}),s.pdfUrl&&w.jsx("div",{style:{marginTop:"0.5rem",marginBottom:"0.5rem"},children:w.jsxs("a",{href:s.pdfUrl,target:"_blank",style:{color:"#8E24AA",fontSize:"0.9em",textDecoration:"none",display:"flex",alignItems:"center",fontWeight:600},children:[w.jsx("span",{style:{marginRight:"5px"},children:""})," View PDF"]})}),w.jsx("p",{children:s.summary||(s.content?s.content.substring(0,150)+"...":"")})]})]},s.id))})}const hs={async uploadFile(i,e="articles"){const t=i.name.split(".").pop(),s=`${`${Math.random().toString(36).substring(2,15)}_${Date.now()}.${t}`}`,{error:a}=await Fi.storage.from(e).upload(s,i);if(a)throw a;const{data:{publicUrl:o}}=Fi.storage.from(e).getPublicUrl(s);return o},async submitArticle(i){const{data:e,error:t}=await Fi.from("articles").insert([{...i,status:"SUBMITTED"}]).select();if(t)throw t;return e?e[0]:null},async getAcceptedArticles(){const{data:i,error:e}=await Fi.from("articles").select("*").in("status",["PUBLISHED"]).order("created_at",{ascending:!1});if(e)throw e;return i},async getPendingArticles(i="SUBMITTED"){let e=Fi.from("articles").select("*");e=e.eq("status",i);const{data:t,error:n}=await e.order("created_at",{ascending:!1});if(n)throw n;return t},async updateStatus(i,e){const{data:t,error:n}=await Fi.from("articles").update({status:e}).eq("id",i).select();if(n)throw n;return t?t[0]:null},async updateArticleDetails(i,e){const{data:t,error:n}=await Fi.from("articles").update(e).eq("id",i).select();if(n)throw n;return t?t[0]:null},async getArticleById(i){const{data:e,error:t}=await Fi.from("articles").select("*").eq("id",i).single();if(t)throw t;return e}};function Lr(i){return Array.isArray?Array.isArray(i):JR(i)==="[object Array]"}function n6(i){if(typeof i=="string")return i;let e=i+"";return e=="0"&&1/i==-1/0?"-0":e}function i6(i){return i==null?"":n6(i)}function Gs(i){return typeof i=="string"}function XR(i){return typeof i=="number"}function s6(i){return i===!0||i===!1||r6(i)&&JR(i)=="[object Boolean]"}function QR(i){return typeof i=="object"}function r6(i){return QR(i)&&i!==null}function bi(i){return i!=null}function pv(i){return!i.trim().length}function JR(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}const a6="Incorrect 'index' type",o6=i=>`Invalid value for key ${i}`,l6=i=>`Pattern length exceeds max of ${i}.`,c6=i=>`Missing ${i} property in key`,u6=i=>`Property 'weight' in key '${i}' must be a positive integer`,w1=Object.prototype.hasOwnProperty;class h6{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(n=>{let s=ZR(n);this._keys.push(s),this._keyMap[s.id]=s,t+=s.weight}),this._keys.forEach(n=>{n.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function ZR(i){let e=null,t=null,n=null,s=1,a=null;if(Gs(i)||Lr(i))n=i,e=A1(i),t=Pb(i);else{if(!w1.call(i,"name"))throw new Error(c6("name"));const o=i.name;if(n=o,w1.call(i,"weight")&&(s=i.weight,s<=0))throw new Error(u6(o));e=A1(o),t=Pb(o),a=i.getFn}return{path:e,id:t,weight:s,src:n,getFn:a}}function A1(i){return Lr(i)?i:i.split(".")}function Pb(i){return Lr(i)?i.join("."):i}function d6(i,e){let t=[],n=!1;const s=(a,o,c)=>{if(bi(a))if(!o[c])t.push(a);else{let h=o[c];const d=a[h];if(!bi(d))return;if(c===o.length-1&&(Gs(d)||XR(d)||s6(d)))t.push(i6(d));else if(Lr(d)){n=!0;for(let p=0,m=d.length;p<m;p+=1)s(d[p],o,c+1)}else o.length&&s(d,o,c+1)}};return s(i,Gs(e)?e.split("."):e,0),n?t:t[0]}const f6={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},p6={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(i,e)=>i.score===e.score?i.idx<e.idx?-1:1:i.score<e.score?-1:1},m6={location:0,threshold:.6,distance:100},g6={useExtendedSearch:!1,getFn:d6,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Pe={...p6,...f6,...m6,...g6};const y6=/[^ ]+/g;function v6(i=1,e=3){const t=new Map,n=Math.pow(10,e);return{get(s){const a=s.match(y6).length;if(t.has(a))return t.get(a);const o=1/Math.pow(a,.5*i),c=parseFloat(Math.round(o*n)/n);return t.set(a,c),c},clear(){t.clear()}}}class s0{constructor({getFn:e=Pe.getFn,fieldNormWeight:t=Pe.fieldNormWeight}={}){this.norm=v6(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,n)=>{this._keysMap[t.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Gs(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();Gs(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!bi(e)||pv(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((s,a)=>{let o=s.getFn?s.getFn(e):this.getFn(e,s.path);if(bi(o)){if(Lr(o)){let c=[];const h=[{nestedArrIndex:-1,value:o}];for(;h.length;){const{nestedArrIndex:d,value:p}=h.pop();if(bi(p))if(Gs(p)&&!pv(p)){let m={v:p,i:d,n:this.norm.get(p)};c.push(m)}else Lr(p)&&p.forEach((m,v)=>{h.push({nestedArrIndex:v,value:m})})}n.$[a]=c}else if(Gs(o)&&!pv(o)){let c={v:o,n:this.norm.get(o)};n.$[a]=c}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function eI(i,e,{getFn:t=Pe.getFn,fieldNormWeight:n=Pe.fieldNormWeight}={}){const s=new s0({getFn:t,fieldNormWeight:n});return s.setKeys(i.map(ZR)),s.setSources(e),s.create(),s}function b6(i,{getFn:e=Pe.getFn,fieldNormWeight:t=Pe.fieldNormWeight}={}){const{keys:n,records:s}=i,a=new s0({getFn:e,fieldNormWeight:t});return a.setKeys(n),a.setIndexRecords(s),a}function Wf(i,{errors:e=0,currentLocation:t=0,expectedLocation:n=0,distance:s=Pe.distance,ignoreLocation:a=Pe.ignoreLocation}={}){const o=e/i.length;if(a)return o;const c=Math.abs(n-t);return s?o+c/s:c?1:o}function _6(i=[],e=Pe.minMatchCharLength){let t=[],n=-1,s=-1,a=0;for(let o=i.length;a<o;a+=1){let c=i[a];c&&n===-1?n=a:!c&&n!==-1&&(s=a-1,s-n+1>=e&&t.push([n,s]),n=-1)}return i[a-1]&&a-n>=e&&t.push([n,a-1]),t}const Ro=32;function w6(i,e,t,{location:n=Pe.location,distance:s=Pe.distance,threshold:a=Pe.threshold,findAllMatches:o=Pe.findAllMatches,minMatchCharLength:c=Pe.minMatchCharLength,includeMatches:h=Pe.includeMatches,ignoreLocation:d=Pe.ignoreLocation}={}){if(e.length>Ro)throw new Error(l6(Ro));const p=e.length,m=i.length,v=Math.max(0,Math.min(n,m));let _=a,S=v;const A=c>1||h,T=A?Array(m):[];let x;for(;(x=i.indexOf(e,S))>-1;){let R=Wf(e,{currentLocation:x,expectedLocation:v,distance:s,ignoreLocation:d});if(_=Math.min(R,_),S=x+p,A){let O=0;for(;O<p;)T[x+O]=1,O+=1}}S=-1;let D=[],I=1,U=p+m;const z=1<<p-1;for(let R=0;R<p;R+=1){let O=0,P=U;for(;O<P;)Wf(e,{errors:R,currentLocation:v+P,expectedLocation:v,distance:s,ignoreLocation:d})<=_?O=P:U=P,P=Math.floor((U-O)/2+O);U=P;let j=Math.max(1,v-P+1),L=o?m:Math.min(v+P,m)+p,V=Array(L+2);V[L+1]=(1<<R)-1;for(let de=L;de>=j;de-=1){let Ce=de-1,G=t[i.charAt(Ce)];if(A&&(T[Ce]=+!!G),V[de]=(V[de+1]<<1|1)&G,R&&(V[de]|=(D[de+1]|D[de])<<1|1|D[de+1]),V[de]&z&&(I=Wf(e,{errors:R,currentLocation:Ce,expectedLocation:v,distance:s,ignoreLocation:d}),I<=_)){if(_=I,S=Ce,S<=v)break;j=Math.max(1,2*v-S)}}if(Wf(e,{errors:R+1,currentLocation:v,expectedLocation:v,distance:s,ignoreLocation:d})>_)break;D=V}const F={isMatch:S>=0,score:Math.max(.001,I)};if(A){const R=_6(T,c);R.length?h&&(F.indices=R):F.isMatch=!1}return F}function A6(i){let e={};for(let t=0,n=i.length;t<n;t+=1){const s=i.charAt(t);e[s]=(e[s]||0)|1<<n-t-1}return e}const qp=String.prototype.normalize?(i=>i.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,"")):(i=>i);class tI{constructor(e,{location:t=Pe.location,threshold:n=Pe.threshold,distance:s=Pe.distance,includeMatches:a=Pe.includeMatches,findAllMatches:o=Pe.findAllMatches,minMatchCharLength:c=Pe.minMatchCharLength,isCaseSensitive:h=Pe.isCaseSensitive,ignoreDiacritics:d=Pe.ignoreDiacritics,ignoreLocation:p=Pe.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:s,includeMatches:a,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:h,ignoreDiacritics:d,ignoreLocation:p},e=h?e:e.toLowerCase(),e=d?qp(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const m=(_,S)=>{this.chunks.push({pattern:_,alphabet:A6(_),startIndex:S})},v=this.pattern.length;if(v>Ro){let _=0;const S=v%Ro,A=v-S;for(;_<A;)m(this.pattern.substr(_,Ro),_),_+=Ro;if(S){const T=v-Ro;m(this.pattern.substr(T),T)}}else m(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:s}=this.options;if(e=t?e:e.toLowerCase(),e=n?qp(e):e,this.pattern===e){let A={isMatch:!0,score:0};return s&&(A.indices=[[0,e.length-1]]),A}const{location:a,distance:o,threshold:c,findAllMatches:h,minMatchCharLength:d,ignoreLocation:p}=this.options;let m=[],v=0,_=!1;this.chunks.forEach(({pattern:A,alphabet:T,startIndex:x})=>{const{isMatch:D,score:I,indices:U}=w6(e,A,T,{location:a+x,distance:o,threshold:c,findAllMatches:h,minMatchCharLength:d,includeMatches:s,ignoreLocation:p});D&&(_=!0),v+=I,D&&U&&(m=[...m,...U])});let S={isMatch:_,score:_?v/this.chunks.length:1};return _&&s&&(S.indices=m),S}}class $a{constructor(e){this.pattern=e}static isMultiMatch(e){return E1(e,this.multiRegex)}static isSingleMatch(e){return E1(e,this.singleRegex)}search(){}}function E1(i,e){const t=i.match(e);return t?t[1]:null}class E6 extends $a{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class S6 extends $a{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class T6 extends $a{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class x6 extends $a{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class C6 extends $a{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class k6 extends $a{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class nI extends $a{constructor(e,{location:t=Pe.location,threshold:n=Pe.threshold,distance:s=Pe.distance,includeMatches:a=Pe.includeMatches,findAllMatches:o=Pe.findAllMatches,minMatchCharLength:c=Pe.minMatchCharLength,isCaseSensitive:h=Pe.isCaseSensitive,ignoreDiacritics:d=Pe.ignoreDiacritics,ignoreLocation:p=Pe.ignoreLocation}={}){super(e),this._bitapSearch=new tI(e,{location:t,threshold:n,distance:s,includeMatches:a,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:h,ignoreDiacritics:d,ignoreLocation:p})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class iI extends $a{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n;const s=[],a=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+a,s.push([n,t-1]);const o=!!s.length;return{isMatch:o,score:o?0:1,indices:s}}}const Nb=[E6,iI,T6,x6,k6,C6,S6,nI],S1=Nb.length,R6=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,I6="|";function D6(i,e={}){return i.split(I6).map(t=>{let n=t.trim().split(R6).filter(a=>a&&!!a.trim()),s=[];for(let a=0,o=n.length;a<o;a+=1){const c=n[a];let h=!1,d=-1;for(;!h&&++d<S1;){const p=Nb[d];let m=p.isMultiMatch(c);m&&(s.push(new p(m,e)),h=!0)}if(!h)for(d=-1;++d<S1;){const p=Nb[d];let m=p.isSingleMatch(c);if(m){s.push(new p(m,e));break}}}return s})}const O6=new Set([nI.type,iI.type]);class P6{constructor(e,{isCaseSensitive:t=Pe.isCaseSensitive,ignoreDiacritics:n=Pe.ignoreDiacritics,includeMatches:s=Pe.includeMatches,minMatchCharLength:a=Pe.minMatchCharLength,ignoreLocation:o=Pe.ignoreLocation,findAllMatches:c=Pe.findAllMatches,location:h=Pe.location,threshold:d=Pe.threshold,distance:p=Pe.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:s,minMatchCharLength:a,findAllMatches:c,ignoreLocation:o,location:h,threshold:d,distance:p},e=t?e:e.toLowerCase(),e=n?qp(e):e,this.pattern=e,this.query=D6(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:s,ignoreDiacritics:a}=this.options;e=s?e:e.toLowerCase(),e=a?qp(e):e;let o=0,c=[],h=0;for(let d=0,p=t.length;d<p;d+=1){const m=t[d];c.length=0,o=0;for(let v=0,_=m.length;v<_;v+=1){const S=m[v],{isMatch:A,indices:T,score:x}=S.search(e);if(A){if(o+=1,h+=x,n){const D=S.constructor.type;O6.has(D)?c=[...c,...T]:c.push(T)}}else{h=0,o=0,c.length=0;break}}if(o){let v={isMatch:!0,score:h/o};return n&&(v.indices=c),v}}return{isMatch:!1,score:1}}}const Mb=[];function N6(...i){Mb.push(...i)}function Lb(i,e){for(let t=0,n=Mb.length;t<n;t+=1){let s=Mb[t];if(s.condition(i,e))return new s(i,e)}return new tI(i,e)}const Hp={AND:"$and",OR:"$or"},jb={PATH:"$path",PATTERN:"$val"},Bb=i=>!!(i[Hp.AND]||i[Hp.OR]),M6=i=>!!i[jb.PATH],L6=i=>!Lr(i)&&QR(i)&&!Bb(i),T1=i=>({[Hp.AND]:Object.keys(i).map(e=>({[e]:i[e]}))});function sI(i,e,{auto:t=!0}={}){const n=s=>{let a=Object.keys(s);const o=M6(s);if(!o&&a.length>1&&!Bb(s))return n(T1(s));if(L6(s)){const h=o?s[jb.PATH]:a[0],d=o?s[jb.PATTERN]:s[h];if(!Gs(d))throw new Error(o6(h));const p={keyId:Pb(h),pattern:d};return t&&(p.searcher=Lb(d,e)),p}let c={children:[],operator:a[0]};return a.forEach(h=>{const d=s[h];Lr(d)&&d.forEach(p=>{c.children.push(n(p))})}),c};return Bb(i)||(i=T1(i)),n(i)}function j6(i,{ignoreFieldNorm:e=Pe.ignoreFieldNorm}){i.forEach(t=>{let n=1;t.matches.forEach(({key:s,norm:a,score:o})=>{const c=s?s.weight:null;n*=Math.pow(o===0&&c?Number.EPSILON:o,(c||1)*(e?1:a))}),t.score=n})}function B6(i,e){const t=i.matches;e.matches=[],bi(t)&&t.forEach(n=>{if(!bi(n.indices)||!n.indices.length)return;const{indices:s,value:a}=n;let o={indices:s,value:a};n.key&&(o.key=n.key.src),n.idx>-1&&(o.refIndex=n.idx),e.matches.push(o)})}function U6(i,e){e.score=i.score}function F6(i,e,{includeMatches:t=Pe.includeMatches,includeScore:n=Pe.includeScore}={}){const s=[];return t&&s.push(B6),n&&s.push(U6),i.map(a=>{const{idx:o}=a,c={item:e[o],refIndex:o};return s.length&&s.forEach(h=>{h(a,c)}),c})}class Vc{constructor(e,t={},n){this.options={...Pe,...t},this.options.useExtendedSearch,this._keyStore=new h6(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof s0))throw new Error(a6);this._myIndex=t||eI(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){bi(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,s=this._docs.length;n<s;n+=1){const a=this._docs[n];e(a,n)&&(this.removeAt(n),n-=1,s-=1,t.push(a))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:s,shouldSort:a,sortFn:o,ignoreFieldNorm:c}=this.options;let h=Gs(e)?Gs(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return j6(h,{ignoreFieldNorm:c}),a&&h.sort(o),XR(t)&&t>-1&&(h=h.slice(0,t)),F6(h,this._docs,{includeMatches:n,includeScore:s})}_searchStringList(e){const t=Lb(e,this.options),{records:n}=this._myIndex,s=[];return n.forEach(({v:a,i:o,n:c})=>{if(!bi(a))return;const{isMatch:h,score:d,indices:p}=t.searchIn(a);h&&s.push({item:a,idx:o,matches:[{score:d,value:a,norm:c,indices:p}]})}),s}_searchLogical(e){const t=sI(e,this.options),n=(c,h,d)=>{if(!c.children){const{keyId:m,searcher:v}=c,_=this._findMatches({key:this._keyStore.get(m),value:this._myIndex.getValueForItemAtKeyId(h,m),searcher:v});return _&&_.length?[{idx:d,item:h,matches:_}]:[]}const p=[];for(let m=0,v=c.children.length;m<v;m+=1){const _=c.children[m],S=n(_,h,d);if(S.length)p.push(...S);else if(c.operator===Hp.AND)return[]}return p},s=this._myIndex.records,a={},o=[];return s.forEach(({$:c,i:h})=>{if(bi(c)){let d=n(t,c,h);d.length&&(a[h]||(a[h]={idx:h,item:c,matches:[]},o.push(a[h])),d.forEach(({matches:p})=>{a[h].matches.push(...p)}))}}),o}_searchObjectList(e){const t=Lb(e,this.options),{keys:n,records:s}=this._myIndex,a=[];return s.forEach(({$:o,i:c})=>{if(!bi(o))return;let h=[];n.forEach((d,p)=>{h.push(...this._findMatches({key:d,value:o[p],searcher:t}))}),h.length&&a.push({idx:c,item:o,matches:h})}),a}_findMatches({key:e,value:t,searcher:n}){if(!bi(t))return[];let s=[];if(Lr(t))t.forEach(({v:a,i:o,n:c})=>{if(!bi(a))return;const{isMatch:h,score:d,indices:p}=n.searchIn(a);h&&s.push({score:d,key:e,value:a,idx:o,norm:c,indices:p})});else{const{v:a,n:o}=t,{isMatch:c,score:h,indices:d}=n.searchIn(a);c&&s.push({score:h,key:e,value:a,norm:o,indices:d})}return s}}Vc.version="7.1.0";Vc.createIndex=eI;Vc.parseIndex=b6;Vc.config=Pe;Vc.parseQuery=sI;N6(P6);const z6=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),V6=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),x1=i=>{const e=V6(i);return e.charAt(0).toUpperCase()+e.slice(1)},rI=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),q6=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var H6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const $6=Y.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...c},h)=>Y.createElement("svg",{ref:h,...H6,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:rI("lucide",s),...!a&&!q6(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,p])=>Y.createElement(d,p)),...Array.isArray(a)?a:[a]]));const Jh=(i,e)=>{const t=Y.forwardRef(({className:n,...s},a)=>Y.createElement($6,{ref:a,iconNode:e,className:rI(`lucide-${z6(x1(i))}`,`lucide-${i}`,n),...s}));return t.displayName=x1(i),t};const G6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],W6=Jh("circle-alert",G6);const K6=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Y6=Jh("circle-check-big",K6);const X6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Q6=Jh("info",X6);const J6=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Z6=Jh("search",J6);const e5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],t5=Jh("x",e5);function n5(){Nc();const i=Mx(),[e,t]=Y.useState([]),[n,s]=Y.useState(!0),[a,o]=Y.useState("");Y.useEffect(()=>{(async()=>{try{const p=await hs.getAcceptedArticles();t(p)}catch(p){console.error("Failed to load articles",p)}finally{s(!1)}})()},[]);const c=Y.useMemo(()=>new Vc(e,{keys:["title","tags","description","author_name"],threshold:.4,includeScore:!0}),[e]),h=Y.useMemo(()=>a.trim()?c.search(a).map(d=>d.item):e,[a,e,c]);return w.jsxs("div",{className:"page active",style:{display:"block"},children:[w.jsx("section",{className:"hero",style:{minHeight:"40vh"},children:w.jsxs("div",{className:"hero-content",children:[w.jsx("h1",{children:"Digital Archive"}),w.jsx("p",{children:"Select an exhibit to explore detailed research and artifacts."})]})}),w.jsxs("section",{className:"section",style:{marginTop:"2rem"},children:[w.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto 4rem",position:"relative"},children:[w.jsxs("div",{style:{position:"relative"},children:[w.jsx(Z6,{style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"#999"}}),w.jsx("input",{type:"text",placeholder:"Search archives (e.g., 'algorithm', 'history')...",value:a,onChange:d=>o(d.target.value),style:{width:"100%",padding:"1rem 1rem 1rem 3rem",fontSize:"1.1rem",borderRadius:"30px",border:"1px solid #ddd",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",outline:"none",transition:"all 0.3s ease"},onFocus:d=>d.target.style.boxShadow="0 6px 16px rgba(0,0,0,0.1)",onBlur:d=>d.target.style.boxShadow="0 4px 12px rgba(0,0,0,0.05)"})]}),a&&w.jsxs("p",{style:{textAlign:"center",marginTop:"1rem",color:"#666",fontSize:"0.9rem"},children:["Found ",h.length," result",h.length!==1?"s":"",' for "',a,'"']})]}),w.jsxs("div",{className:"gallery-grid",children:[!a&&w.jsxs("a",{onClick:()=>i("/article/kolam"),className:"gallery-item slide-in-up",style:{cursor:"pointer"},children:[w.jsx("div",{className:"gallery-thumb",children:w.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(45deg, #4A148C, #7B1FA2)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"3rem"},children:""})}),w.jsxs("div",{className:"gallery-content",children:[w.jsx("span",{className:"gallery-tag",children:"Ethnomathematics"}),w.jsx("h3",{children:"The Art of Kolam"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem"},children:"Exploring the recursive geometry and array grammars hidden within traditional threshold patterns."}),w.jsx("span",{style:{color:"var(--primary)",fontWeight:600,fontSize:"0.9rem",marginTop:"1rem",display:"block"},children:"Read Article "})]})]}),n?w.jsx("p",{children:"Loading archive..."}):h.length===0?w.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"3rem",color:"#666",background:"#f9f9f9",borderRadius:"8px"},children:[w.jsx("p",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"No matches found"}),w.jsx("p",{style:{fontSize:"0.9rem"},children:"Try checking your spelling or using different keywords."})]}):h.map((d,p)=>w.jsxs("a",{onClick:()=>i(`/article/${d.id}`),className:"gallery-item slide-in-up",style:{animationDelay:`${p*100}ms`,cursor:"pointer"},children:[w.jsx("div",{className:"gallery-thumb",children:w.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(45deg, #006064, #0097A7)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"3rem"},children:""})}),w.jsxs("div",{className:"gallery-content",children:[w.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1rem"},children:w.jsx("span",{className:"gallery-tag",style:{borderBottom:"2px solid var(--accent)",paddingBottom:"2px"},children:"Feature Article"})}),w.jsx("h3",{style:{fontSize:"1.2rem",marginBottom:"0.8rem",lineHeight:"1.3"},children:d.title}),w.jsxs("p",{style:{color:"var(--text-muted)",marginBottom:"0.8rem",fontWeight:600,fontSize:"0.9rem"},children:["By ",d.author_name]}),d.tags&&d.tags.length>0&&w.jsxs("div",{style:{display:"flex",gap:"0.4rem",flexWrap:"wrap",marginBottom:"1rem"},children:[d.tags.slice(0,5).map(m=>w.jsx("span",{style:{fontSize:"0.7rem",background:"#f0f4f8",color:"#1565c0",padding:"2px 8px",borderRadius:"4px",border:"1px solid #e1e8ed"},children:m},m)),d.tags.length>5&&w.jsxs("span",{style:{fontSize:"0.7rem",color:"var(--primary)",fontWeight:"bold",alignSelf:"center"},children:["+",d.tags.length-5," more"]})]}),w.jsx("p",{style:{fontSize:"0.85rem",color:"#555",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:"1.5"},children:d.description}),w.jsx("span",{style:{color:"var(--primary)",fontWeight:700,fontSize:"0.85rem",marginTop:"1.2rem",display:"block",borderTop:"1px solid #eee",paddingTop:"1rem"},children:"View Full Analysis "})]})]},d.id))]}),w.jsx("div",{style:{marginTop:"3rem"},className:"gallery-grid",children:w.jsx(t6,{})})]})]})}const i5="/assets/biju-kc-BH-9db2q.png",s5="/assets/vinay-m-CKLnQED_.png",r5="/assets/nirmala-mn-CSZIkzQg.png",a5="/assets/balakrishnan-c-DWyBB_Oz.png",o5="/assets/gayathry-sw-Cq3gTXaf.png",l5="/assets/rajasekhar-d-BID84HL1.png",c5="/assets/alexey-p-Cwhp41UP.png",u5="/assets/krishna-p-DrTgQGP5.png",h5="/assets/jehoson-jj-DkknYcYL.png",d5="/assets/1745844616185-CKfG24R2.jpeg",f5="/assets/profile-pic-B5QyCRyG.jpg";function p5(){return Nc(),w.jsxs("div",{className:"page active",style:{display:"block"},children:[w.jsx("section",{className:"hero",style:{minHeight:"40vh"},children:w.jsxs("div",{className:"hero-content",children:[w.jsx("h1",{children:"The Curators"}),w.jsx("p",{children:"Meet the researchers bridging the gap between art and algorithms."})]})}),w.jsxs("section",{className:"section",children:[w.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary)",fontFamily:"Playfair Display, serif"},children:"Mentors"}),w.jsxs("div",{className:"team-grid",style:{marginBottom:"4rem"},children:[w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${i5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Chief Curator"}),w.jsx("h3",{children:"Dr. Fr. Biju K C"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${s5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Co-Chief Curator"}),w.jsx("h3",{children:"Dr. Vinay M"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${r5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Co-Chief Curator"}),w.jsx("h3",{children:"Dr. Nirmala M N"})]})]}),w.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary)",fontFamily:"Playfair Display, serif"},children:"Core Coordination Team"}),w.jsxs("div",{className:"team-grid",style:{marginBottom:"4rem"},children:[w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${a5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Coordinator & Curator"}),w.jsx("h3",{children:"Dr. Balakrishnan C"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Computer Science-BYC"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${o5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Curator - Technical"}),w.jsx("h3",{children:"Dr. Gayathry S Warrier"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Computer Science-BYC"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${l5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Curator - Cultural"}),w.jsx("h3",{children:"Dr. Rajasekhar D"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Media Studies-BYC"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{background:"#00acc1",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2rem"},children:"JJ"}),w.jsx("span",{className:"profile-badge",children:"Curator - Logistics"}),w.jsx("h3",{children:"Mr. Jack Joy"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"CDL-BYC"})]})]}),w.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary)",fontFamily:"Playfair Display, serif"},children:"Collaborating Partner"}),w.jsx("div",{className:"team-grid",style:{marginBottom:"4rem",display:"flex",justifyContent:"center"},children:w.jsxs("div",{className:"profile-card",style:{maxWidth:"350px"},children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${c5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"DataArt IT Museum Curator"}),w.jsx("h3",{children:"Dr. Alexey Pomigalov"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"DataArt"})]})}),w.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary)",fontFamily:"Playfair Display, serif"},children:"Editorial Team"}),w.jsxs("div",{className:"team-grid",style:{marginBottom:"4rem",justifyContent:"center"},children:[w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${u5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Editor - Technical"}),w.jsx("h3",{children:"Dr. Krishna Presannakumar"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Computer Science-BYC"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${h5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"Editor - Linguistic"}),w.jsx("h3",{children:"Dr. Jehoson Jiresh J"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"English & Cultural Studies-BYC"})]})]}),w.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem",color:"var(--primary)",fontFamily:"Playfair Display, serif"},children:"Student Developers"}),w.jsxs("div",{className:"team-grid",style:{justifyContent:"center"},children:[w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{background:"#1b5e20",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2rem"},children:"SP"}),w.jsx("span",{className:"profile-badge",children:"BCA"}),w.jsx("h3",{children:"Shruthi S Patel"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Front End Developer"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${f5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"BCA"}),w.jsx("h3",{children:"Vishnu S"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Back End Developer"})]}),w.jsxs("div",{className:"profile-card",children:[w.jsx("div",{className:"profile-img",style:{backgroundImage:`url(${d5})`,backgroundSize:"cover",backgroundPosition:"top center",backgroundColor:"#e0e0e0"}}),w.jsx("span",{className:"profile-badge",children:"BCA"}),w.jsx("h3",{children:"Shashwat"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.5rem",fontSize:"0.9rem"},children:"Full Stack Developer"})]})]})]})]})}function m5(){return Nc(),w.jsxs("div",{className:"page active",style:{display:"block"},children:[w.jsx("section",{className:"hero",style:{minHeight:"40vh"},children:w.jsxs("div",{className:"hero-content",children:[w.jsx("h1",{children:"Get in Touch"}),w.jsx("p",{children:"Visit us at the Bangalore Yeshwanthpur Campus or reach out online."})]})}),w.jsx("section",{className:"section",children:w.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"4rem",alignItems:"center"},children:[w.jsxs("div",{className:"card-premium",children:[w.jsx("h3",{style:{marginBottom:"2rem"},children:"Contact Information"}),w.jsxs("div",{style:{marginBottom:"2rem"},children:[w.jsx("h4",{style:{fontSize:"1.1rem",color:"var(--primary)"},children:" Location"}),w.jsxs("p",{style:{color:"var(--text-muted)"},children:["Christ University, Bangalore Yeshwanthpur Campus",w.jsx("br",{}),"Bangalore, Karnataka 560022"]})]}),w.jsxs("div",{children:[w.jsx("h4",{style:{fontSize:"1.1rem",color:"var(--primary)"},children:" Contact"}),w.jsxs("p",{style:{color:"var(--text-muted)"},children:["080 6989 6666",w.jsx("br",{}),"itmuseum@christuniversity.in"]})]})]}),w.jsx("div",{style:{borderRadius:"24px",overflow:"hidden",height:"400px",boxShadow:"var(--shadow-soft)"},children:w.jsx("iframe",{src:"https://maps.google.com/maps?q=Christ+University+Yeshwanthpur+Campus+Bangalore&t=&z=15&ie=UTF8&iwloc=&output=embed",width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",title:"Christ University Yeshwantpur Campus Map"})})]})})]})}function g5(){Nc();const{id:i}=bP(),[e,t]=Y.useState(null),[n,s]=Y.useState(!0);return Y.useEffect(()=>{i&&i!=="kolam"?(async()=>{try{const o=await hs.getArticleById(i);t(o)}catch(o){console.error("Failed to load article",o)}finally{s(!1)}})():s(!1)},[i]),n?w.jsx("div",{className:"page active",style:{display:"block",padding:"4rem",textAlign:"center"},children:"Loading research document..."}):i==="kolam"?w.jsx("div",{className:"page active",style:{display:"block"},children:w.jsxs("div",{className:"article-container",children:[w.jsx(bn,{to:"/collection",className:"article-back-btn",children:" Back to Collection"}),w.jsxs("header",{className:"article-header",children:[w.jsx("span",{className:"profile-badge",children:"Exhibit #001"}),w.jsx("h1",{children:"The Art of Kolam: Symmetry & Computation"}),w.jsx("p",{style:{fontSize:"1.2rem",color:"var(--text-muted)"},children:"An in-depth analysis of South Indian threshold designs."})]}),w.jsxs("div",{className:"card-premium",style:{marginBottom:"3rem"},children:[w.jsx("h3",{children:"Introduction to Kolam"}),w.jsx("p",{style:{color:"var(--text-muted)",marginTop:"1rem"},children:'Kolam is an ancient Indian folk art extensively used to beautifully adorn the thresholds and open courtyards in front of houses. The word "Kolam" in the Tamil language means form and beauty.'})]}),w.jsxs("div",{className:"card-premium",style:{marginBottom:"3rem"},children:[w.jsx("h3",{children:"Mathematical Frameworks"}),w.jsxs("div",{style:{marginTop:"1.5rem",display:"grid",gap:"1.5rem"},children:[w.jsxs("div",{children:[w.jsx("h4",{style:{color:"var(--primary)"},children:"1. Angular Encoding Model"}),w.jsx("p",{style:{color:"var(--text-muted)"},children:"Maps angular movements in Kolam drawing to symbol sequences representing directions."})]}),w.jsxs("div",{children:[w.jsx("h4",{style:{color:"var(--primary)"},children:"2. Array Grammar"}),w.jsx("p",{style:{color:"var(--text-muted)"},children:"Uses array grammars and contextual Array P Systems to generate and analyze patterns."})]})]})]}),w.jsxs("div",{className:"card-premium",style:{background:"linear-gradient(135deg, #f3e5f5, white)"},children:[w.jsx("h3",{children:" Further Reading"}),w.jsxs("ul",{style:{marginTop:"1rem",marginLeft:"1.5rem",color:"var(--text-muted)"},children:[w.jsx("li",{children:w.jsx("a",{href:"https://arxiv.org/abs/2307.02144",target:"_blank",rel:"noreferrer",style:{color:"var(--primary)"},children:"Kolam Simulation (arXiv)"})}),w.jsx("li",{children:w.jsx("a",{href:"https://www.iitm.ac.in/",target:"_blank",rel:"noreferrer",style:{color:"var(--primary)"},children:"IIT Madras Research Archive"})})]})]})]})}):e?w.jsx("div",{className:"page active",style:{display:"block",backgroundColor:"#fdfdfd"},children:w.jsxs("div",{className:"article-container",style:{maxWidth:"1200px",padding:"8rem 4rem",backgroundColor:"white",boxShadow:"0 0 50px rgba(0,0,0,0.02)",margin:"4rem auto",borderRadius:"8px"},children:[w.jsx(bn,{to:"/collection",className:"article-back-btn",style:{marginBottom:"4rem",fontSize:"1rem"},children:" Return to Feature Collection"}),w.jsxs("header",{className:"article-header",style:{textAlign:"left",marginBottom:"6rem",position:"relative"},children:[w.jsx("div",{style:{position:"absolute",top:"-1rem",left:0,width:"60px",height:"6px",background:"var(--accent)"}}),w.jsxs("span",{className:"profile-badge",style:{marginBottom:"2rem",background:"#e3f2fd",color:"#0d47a1",letterSpacing:"1.5px",textTransform:"uppercase",padding:"6px 16px"},children:["Feature Article  ",new Date(e.created_at||"").getFullYear()]}),w.jsx("h1",{style:{fontSize:"4rem",lineHeight:"1.1",fontWeight:800,color:"#002147",marginBottom:"2rem"},children:e.title}),w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[w.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"50%",background:"linear-gradient(45deg, #0d47a1, #1565c0)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"1.2rem"},children:e.author_name.charAt(0)}),w.jsxs("div",{children:[w.jsx("p",{style:{margin:0,fontSize:"1.4rem",fontWeight:600,color:"#333"},children:e.author_name}),w.jsx("p",{style:{margin:0,fontSize:"0.9rem",color:"var(--text-muted)"},children:"Corresponding Author  IT Museum Faculty"})]})]})]}),w.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"3rem",marginBottom:"4rem"},children:[w.jsxs("div",{className:"card-premium",style:{margin:0,border:"none",boxShadow:"0 4px 30px rgba(0,0,0,0.05)",padding:"4rem"},children:[w.jsxs("h3",{style:{fontSize:"1.8rem",marginBottom:"2rem",display:"flex",alignItems:"center",gap:"10px"},children:[w.jsx("span",{style:{color:"var(--accent)"},children:""})," Abstract"]}),w.jsx("p",{style:{color:"#444",lineHeight:"1.8",fontSize:"1.1rem",textAlign:"justify"},children:e.description})]}),w.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[w.jsxs("div",{className:"card-premium",style:{margin:0,border:"none",background:"var(--primary-dark)",color:"white",padding:"2.5rem"},children:[w.jsx("h3",{style:{color:"var(--accent)",fontSize:"1.3rem",marginBottom:"1.5rem"},children:"Citation Details"}),w.jsxs("p",{style:{fontSize:"0.9rem",lineHeight:"1.6",color:"white",marginBottom:"0"},children:[w.jsx("strong",{style:{color:"var(--accent)"},children:"Preferred Citation:"}),w.jsx("br",{}),e.author_name," (",new Date(e.created_at||"").getFullYear(),"). ",w.jsx("em",{children:e.title}),". IT Museum Feature Archive."]})]}),w.jsxs("div",{className:"card-premium",style:{margin:0,border:"none",background:"linear-gradient(135deg, #fff, #f5f7fa)",padding:"2.5rem"},children:[w.jsx("h3",{style:{fontSize:"1.3rem",marginBottom:"1rem"},children:"Metadata"}),w.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",fontSize:"0.9rem"},children:[w.jsxs("div",{children:[w.jsx("span",{style:{color:"var(--text-muted)",display:"block"},children:"Published On"}),w.jsx("strong",{children:new Date(e.created_at||"").toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),w.jsxs("div",{children:[w.jsx("span",{style:{color:"var(--text-muted)",display:"block"},children:"Repository ID"}),w.jsxs("code",{style:{background:"#eee",padding:"2px 6px",borderRadius:"4px"},children:["ITM-",i?.substring(0,8).toUpperCase()]})]}),w.jsxs("div",{children:[w.jsx("span",{style:{color:"var(--text-muted)",display:"block"},children:"Format"}),w.jsx("strong",{children:"Digital PDF Archive"})]})]})]})]})]}),w.jsxs("div",{className:"card-premium",style:{marginBottom:"3rem",padding:"3rem",background:"#fff",border:"1px solid #eee",boxShadow:"0 10px 40px rgba(0,0,0,0.08)"},children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"3rem",padding:"1rem 0",borderBottom:"1px solid #f0f0f0"},children:[w.jsxs("div",{children:[w.jsx("h3",{style:{margin:0,fontSize:"1.8rem"},children:"Full Feature Article"}),w.jsx("p",{style:{margin:0,fontSize:"0.9rem",color:"var(--text-muted)"},children:"Interactive Digital Exhibit  Museum Archive"})]}),w.jsxs("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"cta-button",style:{padding:"14px 28px",fontSize:"1rem",display:"flex",alignItems:"center",gap:"8px"},children:[w.jsx("span",{children:""})," Download Feature PDF"]})]}),w.jsxs("div",{style:{width:"100%",height:"900px",borderRadius:"4px",overflow:"hidden",backgroundColor:"#525659",position:"relative",boxShadow:"inset 0 0 20px rgba(0,0,0,0.2)"},children:[w.jsx("iframe",{src:`${e.file_url}#toolbar=0&navpanes=0`,width:"100%",height:"100%",title:e.title,style:{border:"none"}}),w.jsx("div",{style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255, 215, 0, 0.9)",color:"#002147",padding:"6px 15px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"bold",boxShadow:"0 4px 10px rgba(0,0,0,0.2)",pointerEvents:"none"},children:"SECURE VIEW MODE"})]})]}),w.jsx("footer",{style:{textAlign:"center",marginTop:"6rem",padding:"4rem 0",borderTop:"1px solid #eee"},children:w.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.9rem"},children:[" ",new Date().getFullYear()," Christ University IT Museum Research. All Rights Reserved."]})})]})}):w.jsxs("div",{className:"page active",style:{display:"block",padding:"4rem",textAlign:"center"},children:["Article not found (ID: ",i,")"]})}function y5(){Nc();const[i,e]=Y.useState(!1),[t,n]=Y.useState(""),[s,a]=Y.useState(""),[o,c]=Y.useState(null),[h,d]=Y.useState(null),[p,m]=Y.useState({title:"",description:"",keywords:"",numAuthors:1,submitterEmail:"",authors:[{name:"",email:"",designation:""}],originalityConfirmed:!1}),v=T=>{const x=Array.from({length:T},(D,I)=>p.authors[I]||{name:"",email:"",designation:""});m({...p,numAuthors:T,authors:x})},_=(T,x,D)=>{const I=[...p.authors];I[T]={...I[T],[x]:D},m({...p,authors:I})},S=T=>T?!T.includes("docs.google.com/document")&&!T.includes("drive.google.com")?(a("Please provide a valid Google Docs or Google Drive URL."),!1):(a(""),!0):(a("Please provide the Google Docs URL."),!1),A=async T=>{T.preventDefault(),e(!0);try{if(!t){alert("Please provide the Google Docs URL."),e(!1);return}if(!o){alert("Please upload the Similarity Report PDF."),e(!1);return}if(!h){alert("Please upload the AI Detection Report PDF."),e(!1);return}if(!p.originalityConfirmed){alert("Please confirm that your article is original work."),e(!1);return}if(!/^([a-zA-Z0-9\s-]+,)*[a-zA-Z0-9\s-]+$/.test(p.keywords.trim())){alert('Please enter keywords in a comma-separated format (e.g. "AI, Machine Learning, Data Science").'),e(!1);return}if(!S(t)){alert("Please enter a valid Google Docs URL."),e(!1);return}const D=await hs.uploadFile(o,"reports"),I=await hs.uploadFile(h,"reports"),U=p.authors.map(R=>R.name).join(", "),z=p.authors.map(R=>R.email).join(", "),F=p.authors.map(R=>R.designation).join(", ");await hs.submitArticle({title:p.title,author_name:U,institution_email:z,description:p.description,keywords:p.keywords,num_authors:p.numAuthors,author_designations:F,submitted_email:p.submitterEmail,similarity_report_url:D,ai_report_url:I,originality_confirmed:p.originalityConfirmed,status:"SUBMITTED",file_url:t}),alert(" Submission successful! Our academic panel will review your article."),m({title:"",description:"",keywords:"",numAuthors:1,submitterEmail:"",authors:[{name:"",email:"",designation:""}],originalityConfirmed:!1}),n(""),c(null),d(null),a("")}catch(x){console.error("Error submitting document: ",x),alert(" Submission failed: "+x.message)}finally{e(!1)}};return w.jsxs("div",{className:"page active",style:{display:"block"},children:[w.jsx("section",{className:"hero",style:{padding:"6rem 2rem 4rem",minHeight:"50vh",background:"white"},children:w.jsxs("div",{className:"hero-content",children:[w.jsx("h1",{className:"fade-in",children:"Submission Portal"}),w.jsx("p",{className:"fade-in",style:{animationDelay:"0.2s"},children:"Contribute to document Indian IT Innovations"})]})}),w.jsxs("div",{className:"section",style:{marginTop:"-4rem",position:"relative",zIndex:10},children:[w.jsxs("div",{className:"fade-in",style:{display:"flex",justifyContent:"center",gap:"2rem",marginBottom:"4rem",flexWrap:"wrap",animationDelay:"0.3s"},children:[w.jsxs("div",{className:"card-premium",style:{flex:"1",minWidth:"250px",maxWidth:"300px",textAlign:"center",padding:"2rem"},children:[w.jsx("div",{style:{background:"rgba(13, 71, 161, 0.1)",color:"var(--primary)",width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,margin:"0 auto 1rem"},children:"1"}),w.jsx("h3",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"Download Template"}),w.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:"Please ensure that your contribution meets all the requirements given below."})]}),w.jsxs("div",{className:"card-premium",style:{flex:"1",minWidth:"250px",maxWidth:"300px",textAlign:"center",padding:"2rem"},children:[w.jsx("div",{style:{background:"rgba(13, 71, 161, 0.1)",color:"var(--primary)",width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,margin:"0 auto 1rem"},children:"2"}),w.jsx("h3",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"Prepare Manuscript"}),w.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:["Write your paper in Google Docs. Ensure you grant ",w.jsx("strong",{children:"commenter access"})," to our editorial team."]})]}),w.jsxs("div",{className:"card-premium",style:{flex:"1",minWidth:"250px",maxWidth:"300px",textAlign:"center",padding:"2rem"},children:[w.jsx("div",{style:{background:"rgba(13, 71, 161, 0.1)",color:"var(--primary)",width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,margin:"0 auto 1rem"},children:"3"}),w.jsx("h3",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"Submit URL"}),w.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:"Paste your Google Docs URL below. Our academic panel will review your submission directly in the document."})]})]}),w.jsx("div",{className:"fade-in",style:{animationDelay:"0.4s",maxWidth:"1000px",margin:"0 auto 4rem"},children:w.jsx("div",{style:{background:"linear-gradient(135deg, #0d1b2a 0%, var(--primary) 100%)",color:"white",padding:"3rem",borderRadius:"var(--radius-lg)",position:"relative",overflow:"hidden",boxShadow:"var(--shadow-soft)"},children:w.jsxs("div",{style:{position:"relative",zIndex:2,display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"2rem"},children:[w.jsxs("div",{style:{flex:"1",minWidth:"300px"},className:"text-white-force",children:[w.jsx("h2",{style:{marginBottom:"1rem",textAlign:"left",fontSize:"1.8rem",color:"white"},children:" Submission Guidelines"}),w.jsxs("ul",{style:{lineHeight:"1.8",paddingLeft:"1.5rem",color:"white"},children:[w.jsx("li",{style:{color:"white"},children:"All submissions must be original and not previously published elsewhere."}),w.jsx("li",{style:{color:"white"},children:"Include a clear abstract (max 250 words) and keywords."}),w.jsx("li",{style:{color:"white"},children:"AI-generated content must not exceed 5% of the total manuscript."}),w.jsx("li",{style:{color:"white"},children:"Paste the Google Docs link or Google Drive link in the submission field."}),w.jsx("li",{style:{color:"white"},children:"You can add relevant pictures and videos within your document if needed."}),w.jsx("li",{style:{background:"#FFD700",color:"#002147",padding:"12px 20px",borderRadius:"8px",listStyle:"none",marginLeft:"-1.5rem",marginTop:"1.5rem",boxShadow:"0 4px 15px rgba(0,0,0,0.2)",fontWeight:"bold",textAlign:"center"},children:"Give Commenter Access to the document before submitting"})]})]}),w.jsxs("div",{children:[w.jsx("a",{href:"https://docs.google.com/document/d/1ExampleTemplate_URL",target:"_blank",rel:"noopener noreferrer",className:"cta-button",style:{display:"flex",alignItems:"center",gap:"10px",textDecoration:"none"},children:w.jsx("span",{children:"View Document Template"})}),w.jsx("p",{style:{textAlign:"center",color:"rgba(255,255,255,0.7)",marginTop:"0.5rem",fontSize:"0.85rem"},children:"Opens in Google Docs"})]})]})})}),w.jsxs("div",{className:"card-premium fade-in",style:{animationDelay:"0.5s",maxWidth:"800px",margin:"0 auto"},children:[w.jsx("h2",{style:{borderBottom:"2px solid #f0f0f0",paddingBottom:"1rem",marginBottom:"2rem",fontSize:"1.5rem"},children:"New Submission"}),w.jsxs("form",{onSubmit:A,children:[w.jsxs("div",{style:{marginBottom:"1.5rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Article Title"}),w.jsx("input",{type:"text",required:!0,placeholder:"Enter the full title of your research paper",value:p.title,onChange:T=>m({...p,title:T.target.value}),className:"enhanced-input",style:{width:"100%",padding:"1rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem"}})]}),w.jsxs("div",{style:{marginBottom:"1.5rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Submitter Email"}),w.jsx("input",{type:"email",required:!0,placeholder:"Enter your email for notifications",value:p.submitterEmail,onChange:T=>m({...p,submitterEmail:T.target.value}),className:"enhanced-input",style:{width:"100%",padding:"1rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem"}}),w.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.3rem",color:"var(--text-muted)"},children:"Important: We will use this email to communicate the status of your submission (acceptance/rejection)."})]}),w.jsxs("div",{style:{marginBottom:"1.5rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Number of Authors"}),w.jsx("select",{required:!0,value:p.numAuthors,onChange:T=>v(parseInt(T.target.value)),className:"enhanced-input",style:{width:"100%",maxWidth:"200px",padding:"1rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",backgroundColor:"white"},children:[1,2,3,4,5,6,7,8,9,10].map(T=>w.jsx("option",{value:T,children:T},T))}),w.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.3rem",color:"var(--text-muted)"},children:"Select the total number of authors"})]}),w.jsxs("div",{style:{marginBottom:"2rem"},children:[w.jsx("h3",{style:{fontSize:"1.2rem",marginBottom:"1rem",color:"var(--primary)"},children:"Author Information"}),p.authors.map((T,x)=>w.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1.5rem",backgroundColor:x===0?"#f0f7ff":"#f8f9fa",borderRadius:"8px",border:`2px solid ${x===0?"#0d47a1":"#e0e0e0"}`},children:[w.jsx("h4",{style:{fontSize:"1rem",marginBottom:"1rem",fontWeight:600},children:x===0?" Primary Author":` Author ${x+1}`}),w.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[w.jsxs("div",{style:{gridColumn:"1 / -1"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600,fontSize:"0.9rem"},children:"Full Name *"}),w.jsx("input",{type:"text",required:!0,placeholder:"Enter full name",value:T.name,onChange:D=>_(x,"name",D.target.value),className:"enhanced-input",style:{width:"100%",padding:"0.875rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem"}})]}),w.jsxs("div",{children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600,fontSize:"0.9rem"},children:"Institutional Email *"}),w.jsx("input",{type:"email",required:!0,placeholder:"name@university.edu",value:T.email,onChange:D=>_(x,"email",D.target.value),className:"enhanced-input",style:{width:"100%",padding:"0.875rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem"}})]}),w.jsxs("div",{children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600,fontSize:"0.9rem"},children:"Designation *"}),w.jsx("input",{type:"text",required:!0,placeholder:"e.g., Associate Professor",value:T.designation,onChange:D=>_(x,"designation",D.target.value),className:"enhanced-input",style:{width:"100%",padding:"0.875rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem"}})]})]})]},x))]}),w.jsxs("div",{style:{marginBottom:"1.5rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Description"}),w.jsx("textarea",{rows:6,required:!0,placeholder:"Provide a comprehensive description of your research (approx. 200-250 words)...",value:p.description,onChange:T=>m({...p,description:T.target.value}),className:"enhanced-input",style:{width:"100%",padding:"1rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",resize:"vertical"}}),w.jsxs("p",{className:"char-counter",style:{fontSize:"0.85rem",marginTop:"0.5rem",color:"var(--text-muted)"},children:[p.description.split(" ").filter(T=>T).length," / 250 words"]})]}),w.jsxs("div",{style:{marginBottom:"1.5rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Keywords"}),w.jsx("input",{type:"text",required:!0,placeholder:"Enter keywords separated by commas (e.g., machine learning, neural networks, AI)",value:p.keywords,onChange:T=>m({...p,keywords:T.target.value}),className:"enhanced-input",style:{width:"100%",padding:"1rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem"}}),w.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.3rem",color:"var(--text-muted)"},children:"These keywords help categorize and index your research"})]}),w.jsxs("div",{style:{marginBottom:"2rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"1.5rem",fontWeight:600,fontSize:"1.1rem"},children:"Research Reports"}),w.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.8rem",fontWeight:700,fontSize:"0.9rem",color:"var(--primary)"},children:"1. SIMILARITY REPORT (PDF) *"}),w.jsx("input",{type:"file",required:!0,accept:".pdf",onChange:T=>{const x=T.target.files?.[0];x&&c(x)},style:{width:"100%",padding:"0.75rem",border:"2px solid #e0e0e0",borderRadius:"8px",backgroundColor:"white"}}),o&&w.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"#2e7d32"},children:[" ",o.name]}),w.jsx("p",{style:{fontSize:"0.8rem",color:"#64748b",marginTop:"0.5rem"},children:"Upload your plagiarism/similarity report in PDF format."})]}),w.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.8rem",fontWeight:700,fontSize:"0.9rem",color:"var(--primary)"},children:"2. AI DETECTION REPORT (PDF) *"}),w.jsx("input",{type:"file",required:!0,accept:".pdf",onChange:T=>{const x=T.target.files?.[0];x&&d(x)},style:{width:"100%",padding:"0.75rem",border:"2px solid #e0e0e0",borderRadius:"8px",backgroundColor:"white"}}),h&&w.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"#2e7d32"},children:[" ",h.name]}),w.jsx("p",{style:{fontSize:"0.8rem",color:"#64748b",marginTop:"0.5rem"},children:"Upload your AI content detection report in PDF format."}),w.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem",color:"#d32f2f",fontWeight:"bold"},children:" AI content policy: Only up to 5% AI-generated content is permitted."})]})]}),w.jsxs("div",{style:{marginBottom:"2rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Submit your work (Google Doc or Drive link with Commenter Access)"}),w.jsx("input",{type:"url",required:!0,placeholder:"Paste your Google Docs or Google Drive URL here",value:t,onChange:T=>{n(T.target.value),S(T.target.value)},className:`enhanced-input ${s?"error":t&&!s?"success":""}`,style:{width:"100%",padding:"1rem",border:`2px solid ${s?"#ef5350":"#e0e0e0"}`,borderRadius:"8px",fontSize:"1rem"}}),s&&w.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#ef5350"},children:[" ",s]}),w.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#666"},children:[" ",w.jsx("strong",{children:"Give Commenter Access"})," to the document before submitting."]})]}),w.jsx("div",{style:{marginBottom:"2rem",padding:"1.5rem",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"2px solid #0d47a1"},children:w.jsxs("label",{style:{display:"flex",alignItems:"flex-start",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:[w.jsx("input",{type:"checkbox",required:!0,checked:p.originalityConfirmed,onChange:T=>m({...p,originalityConfirmed:T.target.checked}),style:{marginRight:"0.75rem",marginTop:"0.25rem",width:"20px",height:"20px",cursor:"pointer"}}),w.jsx("span",{children:"I confirm that this article is original work and has not been published elsewhere. I understand that plagiarism or submission of non-original work will result in rejection."})]})}),w.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem"},children:w.jsx("button",{type:"submit",className:`cta-button ${i?"loading":""}`,disabled:i||!!s||!t||!o||!h||!p.originalityConfirmed,style:{fontSize:"1rem",padding:"14px 28px"},children:i?"Submitting...":" Submit Article"})})]})]})]})]})}class Zh{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const v5=()=>{if(!(typeof localStorage>"u"))return{get:i=>Promise.resolve(localStorage.getItem(i)),set:(i,e)=>Promise.resolve(localStorage.setItem(i,e)),remove:i=>Promise.resolve(localStorage.removeItem(i))}},Pn={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:v5()},r0=i=>i?typeof i=="string"?{publicKey:i}:i.toString()==="[object Object]"?i:{}:{},b5=(i,e="https://api.emailjs.com")=>{if(!i)return;const t=r0(i);Pn.publicKey=t.publicKey,Pn.blockHeadless=t.blockHeadless,Pn.storageProvider=t.storageProvider,Pn.blockList=t.blockList,Pn.limitRate=t.limitRate,Pn.origin=t.origin||e},aI=async(i,e,t={})=>{const n=await fetch(Pn.origin+i,{method:"POST",headers:t,body:e}),s=await n.text(),a=new Zh(n.status,s);if(n.ok)return a;throw a},oI=(i,e,t)=>{if(!i||typeof i!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},_5=i=>{if(i&&i.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},lI=i=>i.webdriver||!i.languages||i.languages.length===0,cI=()=>new Zh(451,"Unavailable For Headless Browser"),w5=(i,e)=>{if(!Array.isArray(i))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},A5=i=>!i.list?.length||!i.watchVariable,E5=(i,e)=>i instanceof FormData?i.get(e):i[e],uI=(i,e)=>{if(A5(i))return!1;w5(i.list,i.watchVariable);const t=E5(e,i.watchVariable);return typeof t!="string"?!1:i.list.includes(t)},hI=()=>new Zh(403,"Forbidden"),S5=(i,e)=>{if(typeof i!="number"||i<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},T5=async(i,e,t)=>{const n=Number(await t.get(i)||0);return e-Date.now()+n},dI=async(i,e,t)=>{if(!e.throttle||!t)return!1;S5(e.throttle,e.id);const n=e.id||i;return await T5(n,e.throttle,t)>0?!0:(await t.set(n,Date.now().toString()),!1)},fI=()=>new Zh(429,"Too Many Requests"),x5=async(i,e,t,n)=>{const s=r0(n),a=s.publicKey||Pn.publicKey,o=s.blockHeadless||Pn.blockHeadless,c=s.storageProvider||Pn.storageProvider,h={...Pn.blockList,...s.blockList},d={...Pn.limitRate,...s.limitRate};return o&&lI(navigator)?Promise.reject(cI()):(oI(a,i,e),_5(t),t&&uI(h,t)?Promise.reject(hI()):await dI(location.pathname,d,c)?Promise.reject(fI()):aI("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:a,service_id:i,template_id:e,template_params:t}),{"Content-type":"application/json"}))},C5=i=>{if(!i||i.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},k5=i=>typeof i=="string"?document.querySelector(i):i,R5=async(i,e,t,n)=>{const s=r0(n),a=s.publicKey||Pn.publicKey,o=s.blockHeadless||Pn.blockHeadless,c=Pn.storageProvider||s.storageProvider,h={...Pn.blockList,...s.blockList},d={...Pn.limitRate,...s.limitRate};if(o&&lI(navigator))return Promise.reject(cI());const p=k5(t);oI(a,i,e),C5(p);const m=new FormData(p);return uI(h,m)?Promise.reject(hI()):await dI(location.pathname,d,c)?Promise.reject(fI()):(m.append("lib_version","4.4.1"),m.append("service_id",i),m.append("template_id",e),m.append("user_id",a),aI("/api/v1.0/email/send-form",m))},I5={init:b5,send:x5,sendForm:R5,EmailJSResponseStatus:Zh};function Kf({title:i,currentStageStatus:e,nextStageStatus:t,rejectionStatus:n,reviewerName:s,onActionComplete:a}){const[o,c]=Y.useState([]),[h,d]=Y.useState(!0),[p,m]=Y.useState(null),[v,_]=Y.useState({title:"",description:""}),[S,A]=Y.useState([]),[T,x]=Y.useState(!1),[D,I]=Y.useState(""),[U,z]=Y.useState(null),[F,R]=Y.useState(null);Y.useEffect(()=>{if(F){const W=setTimeout(()=>R(null),5e3);return()=>clearTimeout(W)}},[F]);const O=(W,ae="info")=>{R({message:W,type:ae})};Y.useEffect(()=>{(async()=>{try{let ae=await hs.getPendingArticles(e);c(ae)}catch(ae){console.error("Error loading articles:",ae)}finally{d(!1)}})()},[e]),Y.useEffect(()=>{A([])},[o]);const P=W=>{m(W.id||null),_({title:W.title,description:W.description})},j=async W=>{try{W&&(await hs.updateArticleDetails(W,{title:v.title,description:v.description}),c(o.map(ae=>ae.id===W?{...ae,...v}:ae)),m(null),O("Changes saved successfully!","success"))}catch(ae){O("Error saving: "+ae.message,"error")}},[L,V]=Y.useState(null);Y.useEffect(()=>{o.length>0&&!L&&V(o[0].id||null)},[o,L]);const B=o.find(W=>W.id===L)||(o.length>0?o[0]:null),de=async W=>{if(window.confirm("Approve this article for the next stage?"))try{if(W){await hs.updateStatus(W,t);const ae=o.findIndex(Oe=>Oe.id===W),we=o[ae+1]||o[ae-1];c(o.filter(Oe=>Oe.id!==W)),V(we&&we.id||null),O("Article approved successfully!","success"),a&&a()}}catch(ae){O("Error approving: "+ae.message,"error")}},Ce=W=>{z(W),I(""),x(!0)},G=async()=>{if(!D.trim()){O("Please enter a rejection reason.","error");return}const W=U;if(W)try{const ae=o.find(ee=>ee.id===W),we=o.findIndex(ee=>ee.id===W),Oe=o[we+1]||o[we-1];await hs.updateStatus(W,n);let H=!1;if(ae?.submitted_email){const ee="service_xfk2dr6",le="template_8hp6kaj",he="7yIw1m9N4ce0CcUxw";if(ee&&le&&he)try{const fe={to_email:ae.submitted_email,article_title:ae.title,rejection_reason:D,recipient_name:ae.author_name.split(",")[0]};await I5.send(ee,le,fe,he),H=!0}catch(fe){console.error("EmailJS Error:",fe),O("Rejection saved but email failed: "+(fe.text||fe.message),"error")}}c(o.filter(ee=>ee.id!==W)),V(Oe&&Oe.id||null),x(!1),H?O(`Article rejected and email sent to ${ae?.submitted_email}`,"success"):ae?.submitted_email||O("Article rejected (no submitter email found).","info")}catch(ae){O("Error processing rejection: "+ae.message,"error")}};return h?w.jsx("div",{children:"Loading submissions..."}):w.jsxs("div",{className:"review-panel fade-in",children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",borderBottom:"2px solid var(--primary)",paddingBottom:"0.5rem"},children:[w.jsx("h2",{style:{margin:0},children:i}),w.jsxs("div",{style:{position:"relative",cursor:"pointer"},title:"Recent Activity",children:[w.jsx("span",{style:{fontSize:"1.5rem"},children:""}),S.length>0&&w.jsx("span",{style:{position:"absolute",top:-5,right:-5,background:"#d32f2f",color:"white",borderRadius:"50%",width:"20px",height:"20px",fontSize:"11px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white"},children:S.length})]})]}),S.length>0&&w.jsxs("div",{style:{background:"#fff8e1",padding:"1rem",borderRadius:"8px",marginBottom:"2rem",border:"1px solid #ffe082"},children:[w.jsxs("h4",{style:{margin:"0 0 0.5rem 0",color:"#f57f17",display:"flex",alignItems:"center",gap:"8px"},children:[w.jsx("span",{children:""})," Recent Updates"]}),w.jsx("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.9rem",color:"#5d4037"},children:S.map((W,ae)=>w.jsxs("li",{style:{marginBottom:"4px"},children:[w.jsx("strong",{children:W.action.toUpperCase()})," by ",W.reviewed_by," ",w.jsxs("span",{style:{opacity:.7},children:["(",new Date(W.timestamp).toLocaleTimeString(),")"]})]},ae))})]}),o.length===0?w.jsx("div",{style:{padding:"3rem",textAlign:"center",background:"#f5f5f5",borderRadius:"8px",color:"#757575"},children:w.jsx("p",{children:"No articles pending for review in this stage."})}):w.jsxs("div",{style:{display:"flex",gap:"2rem",flexWrap:"wrap"},children:[w.jsxs("div",{style:{flex:1,minWidth:"250px",borderRight:"1px solid #eee",paddingRight:"1.5rem",maxHeight:"700px",overflowY:"auto"},children:[w.jsxs("h4",{style:{marginTop:0,marginBottom:"1rem",color:"#666"},children:["Pending Articles (",o.length,")"]}),o.map(W=>w.jsxs("div",{onClick:()=>V(W.id||null),style:{padding:"1rem",borderRadius:"8px",marginBottom:"0.75rem",cursor:"pointer",border:L===W.id?"2px solid var(--primary)":"1px solid #eee",background:L===W.id?"#f0f4f8":"white",transition:"all 0.2s ease"},children:[w.jsx("strong",{style:{display:"block",fontSize:"0.9rem",color:L===W.id?"var(--primary)":"#333"},children:W.title}),w.jsx("small",{style:{color:"#666"},children:W.author_name})]},W.id))]}),w.jsx("div",{style:{flex:2.5,minWidth:"350px"},children:B?w.jsxs("div",{className:"card-premium",style:{position:"relative",margin:0,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[w.jsxs("div",{style:{width:"100%"},children:[p===B.id?w.jsx("input",{type:"text",value:v.title,onChange:W=>_({...v,title:W.target.value}),placeholder:"Article Title",style:{width:"100%",padding:"0.8rem",marginBottom:"0.5rem",fontSize:"1.2rem",fontWeight:"bold",border:"2px solid var(--primary)",borderRadius:"4px"}}):w.jsx("h3",{style:{margin:0,color:"var(--primary)",fontSize:"1.5rem"},children:B.title}),w.jsxs("p",{style:{margin:"0.5rem 0",color:"#666"},children:["By ",B.author_name," (",B.institution_email,")"]})]}),w.jsx("span",{style:{padding:"0.4rem 1rem",background:"#e3f2fd",color:"#1565c0",borderRadius:"20px",fontSize:"0.85rem",fontWeight:600,whiteSpace:"nowrap",marginLeft:"1rem"},children:B.status.replace(/_/g," ").toUpperCase()})]}),w.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",marginBottom:"2rem",border:"1px solid #edf2f7"},children:[w.jsx("strong",{style:{color:"#4a5568",display:"block",marginBottom:"0.75rem"},children:"Description / Abstract:"}),p===B.id?w.jsx("textarea",{value:v.description,onChange:W=>_({...v,description:W.target.value}),rows:8,style:{width:"100%",padding:"1rem",marginTop:"0.5rem",border:"2px solid var(--primary)",borderRadius:"4px",fontFamily:"inherit",fontSize:"1rem"}}):w.jsx("p",{style:{margin:0,lineHeight:"1.7",color:"#2d3748"},children:B.description})]}),w.jsxs("div",{style:{marginBottom:"2rem",display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",background:"#fff5f5",borderRadius:"8px",border:"1px solid #feb2b2"},children:[w.jsx("span",{style:{fontSize:"1.2rem"},children:""}),w.jsxs("div",{style:{flex:1},children:[w.jsx("strong",{style:{display:"block",color:"#c53030"},children:"Document Submission"}),w.jsx("a",{href:B.file_url,target:"_blank",rel:"noreferrer",style:{color:"#2b6cb0",fontWeight:600,textDecoration:"underline"},children:"Open Google Doc for Review "})]})]}),w.jsx("div",{style:{display:"flex",gap:"1rem",borderTop:"1px solid #eee",paddingTop:"1.5rem"},children:p===B.id?w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>B.id&&j(B.id),className:"cta-button",style:{flex:1,background:"#1976d2"},children:" Save Changes"}),w.jsx("button",{onClick:()=>m(null),className:"cta-button secondary",style:{flex:1},children:" Cancel"})]}):w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>B.id&&P(B),className:"cta-button secondary",style:{flex:.4},title:"Edit Article Details",children:" Edit"}),w.jsxs("button",{onClick:()=>B.id&&de(B.id),className:"cta-button",style:{flex:1,background:"#2e7d32"},children:[" ",t==="LIT_APPROVED"?"Move to Final Processing":"Approve & Pass"]}),w.jsx("button",{onClick:()=>B.id&&Ce(B.id),className:"cta-button",style:{flex:1,background:"#c62828"},children:" Reject"})]})})]}):w.jsx("div",{style:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center",color:"#999",border:"2px dashed #ddd",borderRadius:"8px"},children:w.jsx("p",{children:"Select an article from the list to review"})})})]}),T&&w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"fadeIn 0.2s ease-out"},onClick:()=>x(!1),children:w.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",width:"90%",maxWidth:"500px",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",transform:"translateY(0)",animation:"slideUp 0.3s ease-out"},onClick:W=>W.stopPropagation(),children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[w.jsx("h3",{style:{margin:0,fontSize:"1.5rem",color:"#c62828"},children:"Reject Article"}),w.jsx("button",{onClick:()=>x(!1),style:{background:"none",border:"none",cursor:"pointer"},children:w.jsx(t5,{size:24,color:"#666"})})]}),w.jsx("p",{style:{marginBottom:"1rem",color:"#555"},children:"Please provide a reason for rejection. This will be sent to the submitter."}),w.jsx("textarea",{value:D,onChange:W=>I(W.target.value),placeholder:"Enter rejection reason...",rows:5,autoFocus:!0,style:{width:"100%",padding:"1rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",fontFamily:"inherit",marginBottom:"1.5rem",resize:"vertical"}}),w.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[w.jsx("button",{onClick:()=>x(!1),style:{padding:"0.8rem 1.5rem",borderRadius:"8px",border:"1px solid #ddd",background:"white",cursor:"pointer",fontSize:"1rem",fontWeight:500,color:"#666"},children:"Cancel"}),w.jsx("button",{onClick:G,style:{padding:"0.8rem 1.5rem",borderRadius:"8px",border:"none",background:"#c62828",color:"white",cursor:"pointer",fontSize:"1rem",fontWeight:600,boxShadow:"0 2px 5px rgba(198, 40, 40, 0.4)"},children:"Confirm Rejection"})]})]})}),F&&w.jsxs("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",background:"white",padding:"1rem 1.5rem",borderRadius:"8px",boxShadow:"0 5px 20px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"12px",zIndex:2e3,borderLeft:`5px solid ${F.type==="success"?"#4caf50":F.type==="error"?"#f44336":"#2196f3"}`,animation:"slideInRight 0.3s ease-out",maxWidth:"400px"},children:[F.type==="success"&&w.jsx(Y6,{size:24,color:"#4caf50"}),F.type==="error"&&w.jsx(W6,{size:24,color:"#f44336"}),F.type==="info"&&w.jsx(Q6,{size:24,color:"#2196f3"}),w.jsx("div",{children:w.jsx("p",{style:{margin:0,fontWeight:500,color:"#333"},children:F.message})})]})]})}const $n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ub=[.001,0,0,.001,0,0],mv=1.35,gi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},xa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Mh="pdfjs_internal_editor_",Ue={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ye={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},D5={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Fb={TRIANGLES:1,LATTICE:2},cn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},gp={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},tn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ec={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},wm={ERRORS:0,WARNINGS:1,INFOS:5},Lh={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Xu={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},O5={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Am=wm.WARNINGS;function P5(i){Number.isInteger(i)&&(Am=i)}function N5(){return Am}function Em(i){Am>=wm.INFOS&&console.info(`Info: ${i}`)}function Ne(i){Am>=wm.WARNINGS&&console.warn(`Warning: ${i}`)}function lt(i){throw new Error(i)}function ot(i,e){i||lt(e)}function M5(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function pI(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"&&(t.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),t.tryConvertEncoding))try{i=z5(i)}catch{}const n=e?URL.parse(i,e):URL.parse(i);return M5(n)?n:null}function mI(i,e,t=!1){const n=URL.parse(i);return n?(n.hash=e,n.href):t&&pI(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Me(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const Qo=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class C1 extends Qo{constructor(e,t){super(e,"PasswordException"),this.code=t}}class gv extends Qo{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class zb extends Qo{constructor(e){super(e,"InvalidPDFException")}}class $p extends Qo{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class L5 extends Qo{constructor(e){super(e,"FormatError")}}class za extends Qo{constructor(e){super(e,"AbortException")}}function j5(i){(typeof i!="object"||i?.length===void 0)&&lt("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const a=Math.min(s+t,e),o=i.subarray(s,a);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function Sm(i){typeof i!="string"&&lt("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function B5(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function U5(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function F5(){try{return new Function(""),!0}catch{return!1}}class dn{static get isLittleEndian(){return Me(this,"isLittleEndian",U5())}static get isEvalSupported(){return Me(this,"isEvalSupported",F5())}static get isOffscreenCanvasSupported(){return Me(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Me(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Me(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Me(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Me(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Me(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const yv=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class pe{static makeHexColor(e,t,n){return`#${yv[e]}${yv[t]}${yv[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],a=e[n+1];e[n]=s*t[0]+a*t[2]+t[4],e[n+1]=s*t[1]+a*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],a=t[1],o=t[2],c=t[3],h=t[4],d=t[5];for(let p=0;p<6;p+=2){const m=e[n+p],v=e[n+p+1];e[n+p]=m*s+v*o+h,e[n+p+1]=m*a+v*c+d}}static applyInverseTransform(e,t){const n=e[0],s=e[1],a=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/a,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/a}static axialAlignedBoundingBox(e,t,n){const s=t[0],a=t[1],o=t[2],c=t[3],h=t[4],d=t[5],p=e[0],m=e[1],v=e[2],_=e[3];let S=s*p+h,A=S,T=s*v+h,x=T,D=c*m+d,I=D,U=c*_+d,z=U;if(a!==0||o!==0){const F=a*p,R=a*v,O=o*m,P=o*_;S+=O,x+=O,T+=P,A+=P,D+=F,z+=F,U+=R,I+=R}n[0]=Math.min(n[0],S,T,A,x),n[1]=Math.min(n[1],D,U,I,z),n[2]=Math.max(n[2],S,T,A,x),n[3]=Math.max(n[3],D,U,I,z)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],a=e[2],o=e[3],c=n**2+s**2,h=n*a+s*o,d=a**2+o**2,p=(c+d)/2,m=Math.sqrt(p**2-(c*d-h**2));t[0]=Math.sqrt(p+m||1),t[1]=Math.sqrt(p-m||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>o?null:[n,a,s,o]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,a){a[0]=Math.min(a[0],e,n),a[1]=Math.min(a[1],t,s),a[2]=Math.max(a[2],e,n),a[3]=Math.max(a[3],t,s)}static#e(e,t,n,s,a,o,c,h,d,p){if(d<=0||d>=1)return;const m=1-d,v=d*d,_=v*d,S=m*(m*(m*e+3*d*t)+3*v*n)+_*s,A=m*(m*(m*a+3*d*o)+3*v*c)+_*h;p[0]=Math.min(p[0],S),p[1]=Math.min(p[1],A),p[2]=Math.max(p[2],S),p[3]=Math.max(p[3],A)}static#t(e,t,n,s,a,o,c,h,d,p,m,v){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,n,s,a,o,c,h,-m/p,v);return}const _=p**2-4*m*d;if(_<0)return;const S=Math.sqrt(_),A=2*d;this.#e(e,t,n,s,a,o,c,h,(-p+S)/A,v),this.#e(e,t,n,s,a,o,c,h,(-p-S)/A,v)}static bezierBoundingBox(e,t,n,s,a,o,c,h,d){d[0]=Math.min(d[0],e,c),d[1]=Math.min(d[1],t,h),d[2]=Math.max(d[2],e,c),d[3]=Math.max(d[3],t,h),this.#t(e,n,a,c,t,s,o,h,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),d),this.#t(e,n,a,c,t,s,o,h,3*(-t+3*(s-o)+h),6*(t-2*s+o),3*(s-t),d)}}function z5(i){return decodeURIComponent(escape(i))}let vv=null,k1=null;function V5(i){return vv||(vv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,k1=new Map([["","t"]])),i.replaceAll(vv,(e,t,n)=>t?t.normalize("NFKC"):k1.get(n))}function gI(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),j5(i)}const rc="pdfjs_internal_id_";function q5(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...a]=t;if(!i(n)&&!Number.isInteger(n)||!e(s))return!1;const o=a.length;let c=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;c=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function In(i,e,t){return Math.min(Math.max(i,e),t)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});class jh{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(a){if(!a)return;let o=null;const c=a.name;if(c==="#text")o=a.value;else if(jh.shouldBuildText(c))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&t.push({str:o}),!!a.children)for(const h of a.children)s(h)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class yI{static setupStorage(e,t,n,s,a){const o=s.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),a==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),a==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const c of n.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:a}){const{attributes:o}=t,c=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[h,d]of Object.entries(o))if(d!=null)switch(h){case"class":d.length&&e.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,d)}c&&a.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,a=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:a,linkService:n});const c=a!=="richText",h=e.div;if(h.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=m}c&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);o.append(m),c&&jh.shouldBuildText(s.name)&&d.push(m)}return{textDivs:d}}const p=[[s,-1,o]];for(;p.length>0;){const[m,v,_]=p.at(-1);if(v+1===m.children.length){p.pop();continue}const S=m.children[++p.at(-1)[1]];if(S===null)continue;const{name:A}=S;if(A==="#text"){const x=document.createTextNode(S.value);d.push(x),_.append(x);continue}const T=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,A):document.createElement(A);if(_.append(T),S.attributes&&this.setAttributes({html:T,element:S,storage:t,intent:a,linkService:n}),S.children?.length>0)p.push([S,-1,T]);else if(S.value){const x=document.createTextNode(S.value);c&&jh.shouldBuildText(A)&&d.push(x),T.append(x)}}for(const m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Tr="http://www.w3.org/2000/svg";class Dc{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ed(i,e="text"){if(lh(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class td{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:a=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=a,this.offsetY=o,n*=t;const h=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let p,m,v,_;switch(s%=360,s<0&&(s+=360),s){case 180:p=-1,m=0,v=0,_=1;break;case 90:p=0,m=1,v=1,_=0;break;case 270:p=0,m=-1,v=-1,_=0;break;case 0:p=1,m=0,v=0,_=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,_=-_);let S,A,T,x;p===0?(S=Math.abs(d-e[1])*n+a,A=Math.abs(h-e[0])*n+o,T=(e[3]-e[1])*n,x=(e[2]-e[0])*n):(S=Math.abs(h-e[0])*n+a,A=Math.abs(d-e[1])*n+o,T=(e[2]-e[0])*n,x=(e[3]-e[1])*n),this.transform=[p*n,m*n,v*n,_*n,S-p*n*h-v*n*d,A-m*n*h-_*n*d],this.width=T,this.height=x}get rawDims(){const e=this.viewBox;return Me(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:a=!1}={}){return new td({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:a})}convertToViewportPoint(e,t){const n=[e,t];return pe.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];pe.applyTransform(t,this.transform);const n=[e[2],e[3]];return pe.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return pe.applyInverseTransform(n,this.transform),n}}class a0 extends Qo{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Tm(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function o0(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function H5(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function $5(i,e="document.pdf"){if(typeof i!="string")return e;if(Tm(i))return Ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},a=/\.pdf$/i,o=n.pathname.split("/").at(-1);if(a.test(o))return s(o);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const d of c)if(a.test(d))return s(d);const h=Array.from(n.searchParams.keys()).reverse();for(const d of h)if(a.test(d))return s(d)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class R1{started=Object.create(null);times=[];time(e){e in this.started&&Ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-s}ms
`);return e.join("")}}function lh(i,e){const t=e?URL.parse(i,e):URL.parse(i);return t?.protocol==="http:"||t?.protocol==="https:"}function Hi(i){i.preventDefault()}function jt(i){i.preventDefault(),i.stopPropagation()}function G5(i){console.log("Deprecated API usage: "+i)}class Vb{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const d=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(o+=p,c+=m):d==="+"&&(o-=p,c-=m),new Date(Date.UTC(n,s,a,o,c,h))}}function W5(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,a=[0,0,parseInt(n),parseInt(s)];return new td({viewBox:a,userUnit:1,scale:e,rotation:t})}function nd(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ne(`Not a valid color format: "${i}"`),[0,0,0])}function K5(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,nd(n))}e.remove()}function Rt(i){const{a:e,b:t,c:n,d:s,e:a,f:o}=i.getTransform();return[e,t,n,s,a,o]}function Fs(i){const{a:e,b:t,c:n,d:s,e:a,f:o}=i.getTransform().invertSelf();return[e,t,n,s,a,o]}function qo(i,e,t=!1,n=!0){if(e instanceof td){const{pageWidth:s,pageHeight:a}=e.rawDims,{style:o}=i,c=dn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,d=`var(--total-scale-factor) * ${a}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,m=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(o.width=p,o.height=m):(o.width=m,o.height=p)}n&&i.setAttribute("data-main-rotation",e.rotation)}class tr{constructor(){const{pixelRatio:e}=tr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,a=-1){let o=1/0,c=1/0,h=1/0;n=tr.capPixels(n,a),n>0&&(o=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const d=Math.min(o,c,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const qb=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Y5{static get isDarkMode(){return Me(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class X5{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Me(this,"commentForegroundColor",nd(n))}}function Q5(i,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return i=Math.round(i*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[i,e,t]}function I1(i,e){const t=i[0]/255,n=i[1]/255,s=i[2]/255,a=Math.max(t,n,s),o=Math.min(t,n,s),c=(a+o)/2;if(a===o)e[0]=e[1]=0;else{const h=a-o;switch(e[1]=c<.5?h/(a+o):h/(2-a-o),a){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function Hb(i,e){const t=i[0],n=i[1],s=i[2],a=(1-Math.abs(2*s-1))*n,o=a*(1-Math.abs(t/60%2-1)),c=s-a/2;switch(Math.floor(t/60)){case 0:e[0]=a+c,e[1]=o+c,e[2]=c;break;case 1:e[0]=o+c,e[1]=a+c,e[2]=c;break;case 2:e[0]=c,e[1]=a+c,e[2]=o+c;break;case 3:e[0]=c,e[1]=o+c,e[2]=a+c;break;case 4:e[0]=o+c,e[1]=c,e[2]=a+c;break;case 5:case 6:e[0]=a+c,e[1]=c,e[2]=o+c;break}}function D1(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function O1(i,e,t){Hb(i,t),t.map(D1);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];Hb(e,t),t.map(D1);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const P1=new Map;function J5(i,e){const t=i[0]+i[1]*256+i[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=P1.get(t);if(n)return n;const s=new Float32Array(9),a=s.subarray(0,3),o=s.subarray(3,6);I1(i,o);const c=s.subarray(6,9);I1(e,c);const h=c[2]<.5,d=h?12:4.5;if(o[2]=h?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),O1(o,c,a)<d){let p,m;h?(p=o[2],m=1):(p=0,m=o[2]);const v=.005;for(;m-p>v;){const _=o[2]=(p+m)/2;h===O1(o,c,a)<d?p=_:m=_}o[2]=h?m:p}return Hb(o,a),n=pe.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),P1.set(t,n),n}function vI({html:i,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof i=="string"){const a=document.createElement("p");a.dir=e||"auto";const o=i.split(/(?:\r\n?|\n)/);for(let c=0,h=o.length;c<h;++c){const d=o[c];a.append(document.createTextNode(d)),c<h-1&&a.append(document.createElement("br"))}s.append(a)}else yI.render({xfaHtml:i,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",t),n.append(s)}function bI(i){const e=new Path2D;if(!i)return e;for(let t=0,n=i.length;t<n;)switch(i[t++]){case Xu.moveTo:e.moveTo(i[t++],i[t++]);break;case Xu.lineTo:e.lineTo(i[t++],i[t++]);break;case Xu.curveTo:e.bezierCurveTo(i[t++],i[t++],i[t++],i[t++],i[t++],i[t++]);break;case Xu.quadraticCurveTo:e.quadraticCurveTo(i[t++],i[t++],i[t++],i[t++]);break;case Xu.closePath:e.closePath();break;default:Ne(`Unrecognized drawing path operator: ${i[t-1]}`);break}return e}class rt{static#e=null;static#t=null;static#i=null;static#n=0;static#r=[];get pagesNumber(){return rt.#n}set pagesNumber(e){rt.#n!==e&&(rt.#n=e,e===0&&(rt.#t=null,rt.#e=null))}addListener(e){rt.#r.push(e)}removeListener(e){const t=rt.#r.indexOf(e);t>=0&&rt.#r.splice(t,1)}#a(){for(const e of rt.#r)e()}#s(e){if(rt.#t)return;const t=rt.#n,n=new Uint32Array(3*t),s=rt.#t=n.subarray(0,t),a=rt.#e=n.subarray(t,2*t);if(e)for(let o=0;o<t;o++)s[o]=a[o]=o+1;rt.#i=n.subarray(2*t)}movePages(e,t,n){this.#s(!0);const s=rt.#t,a=rt.#e;rt.#i.set(a);const o=t.length,c=new Uint32Array(o);let h=0;for(let _=0;_<o;_++){const S=t[_]-1;c[_]=s[S],S<n&&(h+=1)}const d=rt.#n;let p=n-h;const m=d-o;p=In(p,0,m);for(let _=0,S=0;_<d;_++)e.has(_+1)||(s[S++]=s[_]);s.copyWithin(p+o,p,m),s.set(c,p);let v=!1;for(let _=0,S=d;_<S;_++){const A=s[_];v||=A!==_+1,a[A-1]=_+1}this.#a(),v||(this.pagesNumber=0)}hasBeenAltered(){return rt.#t!==null}getPageMappingForSaving(){return{pageIndices:rt.#e?rt.#e.map(e=>e-1):null}}getPrevPageNumber(e){return rt.#i[rt.#t[e-1]-1]}getPageNumber(e){return rt.#e?.[e-1]??e}getPageId(e){return rt.#t?.[e-1]??e}static get instance(){return Me(this,"instance",new rt)}getMapping(){return rt.#t.subarray(0,this.pagesNumber)}}class bh{#e=null;#t=null;#i;#n=null;#r=null;#a=null;#s=null;#o=null;static#c=null;constructor(e){this.#i=e,bh.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#i._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Hi,{signal:t}),e.addEventListener("pointerdown",bh.#l,{signal:t}));const n=this.#n=document.createElement("div");n.className="buttons",e.append(n);const s=this.#i.toolbarPosition;if(s){const{style:a}=e,o=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#d(e){this.#i._focusEventsAllowed=!1,jt(e)}#h(e){this.#i._focusEventsAllowed=!0,jt(e)}#f(e){const t=this.#i._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Hi,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",bh.#c[e]),this.#f(n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#n.append(n)}get#g(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#n.append(t,this.#g),this.#r=e}addComment(e,t=null){if(this.#a)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const s=this.#s=this.#g;t?(this.#n.insertBefore(n,t),this.#n.insertBefore(s,t)):this.#n.append(n,s),this.#a=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#n.append(t,this.#g)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#i);this.#f(t),this.#n.append(t,this.#g)}removeButton(e){e==="comment"&&(this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const s=this.#n.querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class Z5{#e=null;#t=null;#i;constructor(e){this.#i=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#i._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Hi,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#i.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),e}#r(e,t){let n=0,s=0;for(const a of e){const o=a.y+a.height;if(o<n)continue;const c=a.x+(t?a.width:0);if(o>n){s=c,n=o;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]}show(e,t,n){const[s,a]=this.#r(t,n),{style:o}=this.#t||=this.#n();e.append(this.#t),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#a(e,t,n,s){const a=document.createElement("button");a.classList.add("basic",e),a.tabIndex=0,a.setAttribute("data-l10n-id",t);const o=document.createElement("span");a.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",n);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(a.addEventListener("contextmenu",Hi,{signal:c}),a.addEventListener("click",s,{signal:c})),this.#e.append(a)}}function _I(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}class at{static#e=NaN;static#t=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(e){(at.#t||=new Set).add(e)}static setPointer(e,t){at.#e||=t,at.#n??=e}static setTimeStamp(e){at.#i=e}static isSamePointerId(e){return at.#e===e}static isSamePointerIdOrRemove(e){return at.#e===e?!0:(at.#t?.delete(e),!1)}static isSamePointerType(e){return at.#n===e}static isInitializedAndDifferentPointerType(e){return at.#n!==null&&!at.isSamePointerType(e)}static isSameTimeStamp(e){return at.#i===e}static isUsingMultiplePointers(){return at.#t?.size>=1}static clearPointerType(){at.#n=null}static clearPointerIds(){at.#e=NaN,at.#t=null}static clearTimeStamp(){at.#i=NaN}}class eq{#e=0;get id(){return`${Mh}${this.#e++}`}}class l0{#e=gI();#t=0;#i=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const a=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Me(this,"_isSVGFittingCanvas",a)}async#n(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await ed(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const a=l0._isSVGFittingCanvas,o=new FileReader,c=new Image,h=new Promise((d,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,d()},o.onload=async()=>{const m=n.svgUrl=o.result;c.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=o.onerror=p});o.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Ne(s),n=null}return this.#i.set(e,n),n&&this.#i.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:a}=e;return this.#n(`${t}_${n}_${s}_${a}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const n=await t;return this.#n(e,n)}async getFromId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#i.set(e,n),this.#i.set(n.id,n),n}getSvgUrl(e){const t=this.#i.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class tq{#e=[];#t=!1;#i;#n=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:t,post:n,mustExec:s,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:a};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(o&&this.#e[this.#n].type===a){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const d=this.#n+1;d===this.#i?this.#e.splice(0,1):(this.#n=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class id{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=dn.platform;for(const[n,s,a={}]of e)for(const o of n){const c=o.startsWith("mac+");t&&c?(this.callbacks.set(o.slice(4),{callback:s,options:a}),this.allKeys.add(o.split("+").at(-1))):!t&&!c&&(this.callbacks.set(o,{callback:s,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:a=!1,args:o=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...o,t)(),a||jt(t))}}class c0{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return K5(e),Me(this,"_colors",e)}convert(e){const t=nd(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((a,o)=>a===t[o]))return c0._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?pe.makeHexColor(...t):e}}class Va{#e=new AbortController;#t=null;#i=null;#n=new Map;#r=new Map;#a=null;#s=null;#o=null;#c=new tq;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#b=!1;#v=!1;#T=null;#E=null;#w=null;#C=null;#_=!1;#S=null;#I=new eq;#k=!1;#R=!1;#j=!1;#O=null;#N=null;#B=null;#M=null;#H=null;#x=Ue.NONE;#A=new Set;#P=null;#U=null;#z=null;#W=null;#G=null;#K={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#V=[0,0];#L=null;#$=null;#J=null;#Z=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Va.prototype,t=o=>o.#$.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Me(this,"_keyboardManager",new id([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#$.contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#$.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,n,s,a,o,c,h,d,p,m,v,_,S,A,T){const x=this._signal=this.#e.signal;this.#$=e,this.#J=t,this.#Z=n,this.#a=s,this.#l=a,this.#U=o,this.#G=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:x}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),c._on("setpreference",this.onSetPreference.bind(this),{signal:x}),c._on("switchannotationeditorparams",D=>this.updateParams(D.type,D.value),{signal:x}),c._on("pagesedited",this.onPagesEdited.bind(this),{signal:x}),window.addEventListener("pointerdown",()=>{this.#R=!0},{capture:!0,signal:x}),window.addEventListener("pointerup",()=>{this.#R=!1},{capture:!0,signal:x}),this.#ae(),this.#de(),this.#te(),this.#s=h.annotationStorage,this.#T=h.filterFactory,this.#z=d,this.#C=p||null,this.#y=m,this.#b=v,this.#v=_,this.#H=S||null,this.viewParameters={realScale:Dc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=A||null,this._supportsPinchToZoom=T!==!1,a?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#r.values())e.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#A.clear(),this.#c.destroy(),this.#a?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#S?.hide(),this.#S=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#E&&(clearTimeout(this.#E),this.#E=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy(),this.#G=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#H}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Me(this,"hcmFilter",this.#z?this.#T.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Me(this,"direction",getComputedStyle(this.#$).direction)}get _highlightColors(){return Me(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Me(this,"highlightColors",null);const t=new Map,n=!!this.#z;for(const[s,a]of e){const o=s.endsWith("_HCM");if(n&&o){t.set(s.replace("_HCM",""),a);continue}!n&&!o&&t.set(s,a)}return Me(this,"highlightColors",t)}get highlightColorNames(){return Me(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=e}setMainHighlightColorPicker(e){this.#B=e}editAltText(e,t=!1){this.#a?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,s){this.#l?.showDialog(this,e,t,n,s)}selectComment(e,t){this.#r.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}deleteComment(e,t){const n=()=>{e.comment=t},s=()=>{this._editorUndoBar?.show(n,"comment"),this.toggleComment(null),e.comment=null};this.addCommands({cmd:s,undo:n,mustExec:!0})}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#r.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=a=>{a.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){this.#U?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#U}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&(this.#v=t)}onPagesEdited({pagesMapper:e}){for(const s of this.#n.values())s.updatePageIndex(e.getPrevPageNumber(s.pageIndex+1)-1);const t=this.#r,n=this.#r=new Map;for(const[s,a]of t){const o=e.getPrevPageNumber(s+1)-1;if(o===-1){a.destroy();continue}n.set(o,a),a.updatePageIndex(o)}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#$.focus()}findParent(e,t){for(const n of this.#r.values()){const{x:s,y:a,width:o,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=a&&t<=a+c)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Dc.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#r.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:a,focusNode:o,focusOffset:c}=n,h=n.toString(),p=this.#Q(n).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;n.empty();const v=this.#ee(p),_=this.#x===Ue.NONE,S=()=>{const A=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:s,anchorOffset:a,focusNode:o,focusOffset:c,text:h});_&&this.showAllEditors("highlight",!0,!0),t&&A?.editComment()};if(_){this.switchToMode(Ue.HIGHLIGHT,S);return}S()}commentSelection(e=""){this.highlightSelection(e,!0)}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Q(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#S||=new Z5(this),this.#S.show(n,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#s)return null;const t=`${Mh}${e}`,n=this.#s.getRawValue(t);return n&&this.#s.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#P&&(this.#S?.hide(),this.#P=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#P)return;const s=this.#Q(e).closest(".textLayer");if(!s){this.#P&&(this.#S?.hide(),this.#P=null,this.#D({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#P=t,this.#D({hasSelectedText:!0}),!(this.#x!==Ue.HIGHLIGHT&&this.#x!==Ue.NONE)&&(this.#x===Ue.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#x===Ue.HIGHLIGHT?this.#ee(s):null;if(a?.toggleDrawing(),this.#R){const o=new AbortController,c=this.combinedSignal(o),h=d=>{d.type==="pointerup"&&d.button!==0||(o.abort(),a?.toggleDrawing(!0),d.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else a?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(e=""){this.#x===Ue.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#se()}#ae(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#oe(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#A)if(t.div.contains(e)){this.#N=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[e,t]=this.#N;this.#N=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#O)return;this.#O=new AbortController;const e=this.combinedSignal(this.#O);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#O?.abort(),this.#O=null}#ue(){if(this.#d)return;this.#d=new AbortController;const e=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#he(){this.#d?.abort(),this.#d=null}#de(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#A){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const o of this.#u)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Ne(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const a=[];for(const h of n){const d=await s.deserialize(h);if(!d)return;a.push(d)}const o=()=>{for(const h of a)this.#ne(h);this.#ie(a)},c=()=>{for(const h of a)h.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(a){Ne(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#x!==Ue.NONE&&!this.isEditorHandlingKeyboard&&Va._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(e){Object.entries(e).some(([n,s])=>this.#K[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#K,e)}),this.#x===Ue.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#q([[Ye.HIGHLIGHT_FREE,!0]]))}#q(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#ue(),this.#D({isEditing:this.#x!==Ue.NONE,isEmpty:this.#X(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#he(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#q(t.defaultPropertiesToUpdate)}}getId(){return this.#I.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(e){return this.#r.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#r.set(e.pageIndex,e),this.#k?e.enable():e.disable()}removeLayer(e){this.#r.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,a=!1,o=!1){if(this.#x!==e&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#x===Ue.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#x=e,e===Ue.NONE){this.setEditingState(!1),this.#pe();for(const c of this.#n.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const c of this.#n.values())c.addStandaloneCommentButton();e===Ue.SIGNATURE&&await this.#U?.loadSignatures(),n&&at.clearPointerType(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const c of this.#r.values())c.updateMode(e);if(e===Ue.POPUP){this.#i||=await this.#G.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const c=new Set,h=[];for(const d of this.#n.values()){const{annotationElementId:p,hasComment:m,deleted:v}=d;p&&c.add(p),m&&!v&&h.push(d.getData())}for(const d of this.#i){const{id:p,popupRef:m,contentsObj:v}=d;m&&v?.str&&!c.has(p)&&!this.#g.has(p)&&h.push(d)}this.#l?.showSidebar(h)}if(!t){s&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const c of this.#n.values())c.uid===t?(this.setSelected(c),o?c.editComment():a?c.enterInEditMode():c.focus()):c.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#x&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case Ye.CREATE:this.currentLayer.addNewEditor(t);return;case Ye.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#W||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#A)n.updateParams(e,t);else for(const n of this.#u)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const a of this.#n.values())a.editorType===e&&a.show(t);(this.#W?.get(Ye.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#q([[Ye.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#j!==e){this.#j=e;for(const t of this.#r.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#k){this.#k=!0;const e=[];for(const t of this.#r.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#pe(){if(this.unselectAll(),this.#k){this.#k=!1;for(const e of this.#r.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#E&&clearTimeout(this.#E),this.#E=setTimeout(()=>{this.focusMainContainer(),this.#E=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#g.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#g.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#g.has(e)}removeDeletedAnnotationElement(e){this.#g.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#r.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#q(e.propertiesToUpdate))}get#me(){let e=null;for(e of this.#A);return e}updateUI(e){this.#me===e&&this.#q(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#q(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#A.has(e)){this.#A.delete(e),e.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#A.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#h?.commitOrRemove();for(const t of this.#A)t!==e&&t.unselect();this.#A.clear(),this.#A.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(e){return this.#A.has(e)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(e){e.unselect(),this.#A.delete(e),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#D({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#X()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#X()})}addCommands(e){this.#c.add(e),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#X()})}cleanUndoStack(e){this.#c.cleanType(e)}#X(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#A],n=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},s=()=>{for(const a of t)this.#ne(a)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ie(e){for(const t of this.#A)t.unselect();this.#A.clear();for(const t of e)t.isEmpty()||(this.#A.add(t),t.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#A)e.commit();this.#ie(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#x!==Ue.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const e of this.#A)e.unselect();this.#A.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#V[0]+=e,this.#V[1]+=t;const[s,a]=this.#V,o=[...this.#A],c=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#V[0]=this.#V[1]=0,this.addCommands({cmd:()=>{for(const h of o)this.#n.has(h.id)&&(h.translateInPage(s,a),h.translationDone())},undo:()=>{for(const h of o)this.#n.has(h.id)&&(h.translateInPage(-s,-a),h.translationDone())},mustExec:!1})},c);for(const h of o)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const e of this.#A)this.#m.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const e=this.#m;this.#m=null;let t=!1;for(const[{x:s,y:a,pageIndex:o},c]of e)c.newX=s,c.newY=a,c.newPageIndex=o,t||=s!==c.savedX||a!==c.savedY||o!==c.savedPageIndex;if(!t)return!1;const n=(s,a,o,c)=>{if(this.#n.has(s.id)){const h=this.#r.get(c);h?s._setParentAndPosition(h,a,o):(s.pageIndex=c,s.x=a,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:a,newY:o,newPageIndex:c}]of e)n(s,a,o,c)},undo:()=>{for(const[s,{savedX:a,savedY:o,savedPageIndex:c}]of e)n(s,a,o,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#m)for(const n of this.#m.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#x}isEditingMode(){return this.#x!==Ue.NONE}get imageManager(){return Me(this,"imageManager",new l0)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,p=t.rangeCount;d<p;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:s,width:a,height:o}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(d,p,m,v)=>({x:(p-s)/o,y:1-(d+m-n)/a,width:v/o,height:m/a});break;case"180":c=(d,p,m,v)=>({x:1-(d+m-n)/a,y:1-(p+v-s)/o,width:m/a,height:v/o});break;case"270":c=(d,p,m,v)=>({x:1-(p+v-s)/o,y:(d-n)/a,width:v/o,height:m/a});break;default:c=(d,p,m,v)=>({x:(d-n)/a,y:(p-s)/o,width:m/a,height:v/o});break}const h=[];for(let d=0,p=t.rangeCount;d<p;d++){const m=t.getRangeAt(d);if(!m.collapsed)for(const{x:v,y:_,width:S,height:A}of m.getClientRects())S===0||A===0||h.push(c(v,_,S,A))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#s.getRawValue(t);n&&(this.#x===Ue.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const s=this.#M?.get(e);s&&(s.setCanvas(t,n),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class Hs{#e=null;#t=!1;#i=null;#n=null;#r=null;#a=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#h=e._uiManager.useNewAltTextFlow,Hs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Hs._l10n??=e}async render(){const e=this.#i=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#h?(e.classList.add("new"),e.setAttribute("data-l10n-id",Hs.#f.missing),t.setAttribute("data-l10n-id",Hs.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",Hi,{signal:n}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#s=!0,s(a))},{signal:n}),await this.#m(),e}get#g(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#h?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#d=await Hs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#m())}toggleAltTextBadge(e=!1){if(!this.#h||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#d),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:a=!1}){n&&(this.#l=n,this.#d=s),!(this.#e===e&&this.#t===t)&&(a||(this.#e=e,this.#t=t),this.#m())}toggle(e=!1){this.#i&&(!e&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#i.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#r=null,this.#o?.remove(),this.#o=null}async#m(){const e=this.#i;if(!e)return;if(this.#h){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Hs.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",Hs.#f[`${this.#g}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#r?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#r;if(!t){this.#r=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const s=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:a}),e.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:a})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Yf{#e=null;#t=null;#i=!1;#n=null;#r=null;#a=null;#s=null;#o=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#d(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(n.backgroundColor=s)}return this.#d(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:s,y:a,width:o,height:c}=this.#n.parent.boundingClientRect;return[(e-s)/o,(t+n-a)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#d(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",Hi,{signal:n}),t&&(e.addEventListener("focusin",a=>{this.#n._focusEventsAllowed=!1,jt(a)},{capture:!0,signal:n}),e.addEventListener("focusout",a=>{this.#n._focusEventsAllowed=!0,jt(a)},{capture:!0,signal:n})),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#i=!0,s(a))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=this.#n.commentButtonPosition;const{width:p,height:m,x:v,y:_}=this.#n;n=v+n*p,s=_+s*m}const a=this.#n.parent.boundingClientRect,{x:o,y:c,width:h,height:d}=a;this.#n._uiManager.editComment(this.#n,o+n*h,c+s*d,{...e,parentDimensions:a})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#s&&(this.#a=null),e===null){this.#s="",this.#c=!0;return}this.#s=e,this.#o=new Date,this.#c=!1}restoreData({text:e,richText:t,date:n}){this.#s=e,this.#a=t,this.#o=n,this.#c=!1}setInitialText(e,t=null){this.#r=e,this.data=e,this.#o=null,this.#a=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#s="",this.#a=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class xm{#e;#t=!1;#i=null;#n;#r;#a;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:o=null,signal:c}){this.#e=e,this.#i=n,this.#n=t,this.#r=s,this.#a=a,this.#s=o,this.#d=new AbortController,this.#c=AbortSignal.any([c,this.#d.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/tr.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,a=AbortSignal.any([this.#c,s.signal]),o=this.#e,c={capture:!0,signal:a,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(jt(d),h(d))},c),o.addEventListener("pointerup",h,c),o.addEventListener("pointercancel",h,c);return}if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#c,this.#h.signal]),a=this.#e,o={signal:s,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),o);const c=this.#m.bind(this);a.addEventListener("touchend",c,o),a.addEventListener("touchcancel",c,o),o.capture=!0,a.addEventListener("pointerdown",jt,o),a.addEventListener("pointermove",jt,o),a.addEventListener("pointercancel",jt,o),a.addEventListener("pointerup",jt,o),this.#r?.()}if(jt(e),e.touches.length!==2||this.#i?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(e){if(!this.#l||e.touches.length!==2)return;jt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:a}=t,{screenX:o,screenY:c}=n,h=this.#l,{touch0X:d,touch0Y:p,touch1X:m,touch1Y:v}=h,_=m-d,S=v-p,A=o-s,T=c-a,x=Math.hypot(A,T)||1,D=Math.hypot(_,S)||1;if(!this.#t&&Math.abs(D-x)<=xm.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=a,h.touch1X=o,h.touch1Y=c,!this.#t){this.#t=!0;return}const I=[(s+o)/2,(a+c)/2];this.#a?.(I,D,x)}#m(e){e.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(jt(e),this.#l=null,this.#t=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Se{#e=null;#t=null;#i=null;#n=null;#r=null;#a=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#b=!1;#v=null;#T=0;#E=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#_=!1;#S=Se._zIndex++;static _borderLineWidth=-1;static _colorManager=new c0;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Se.prototype._resizeWithKeyboard,t=Va.TRANSLATE_SMALL,n=Va.TRANSLATE_BIG;return Me(this,"_resizerKeyboardManager",new id([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Se.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[a,o];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Me(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new nq({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Se._l10n??=e,Se._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Se._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Se._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){lt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#_}set _isDraggable(e){this.#_=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#L(),this.#h?.remove(),this.#h=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[a,o]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/a,this.y=(t+s)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}#I([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#I(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#I(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,a]}=this;if(this.x+=e/s,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[h,d]=this.getBaseTranslation();o+=h,c+=d;const{style:p}=n;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Se,s=n/e,a=n/t;switch(this.rotation){case 90:return[-s,a];case 180:return[s,a];case 270:return[s,-a];default:return[-s,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:a,y:o,width:c,height:h}=this;if(c*=n,h*=s,a*=n,o*=s,this._mustFixPosition)switch(e){case 0:a=In(a,0,n-c),o=In(o,0,s-h);break;case 90:a=In(a,0,n-h),o=In(o,c,s);break;case 180:a=In(a,c,n),o=In(o,h,s);break;case 270:a=In(a,h,n),o=In(o,0,s-c);break}this.x=a/=n,this.y=o/=s;const[d,p]=this.getBaseTranslation();a+=d,o+=p,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#k(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Se.#k(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Se.#k(e,t,360-this.parentRotation)}#R(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#O.bind(this,n),{signal:t}),s.addEventListener("contextmenu",Hi,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#c)}#O(e,t){t.preventDefault();const{isMac:n}=dn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#M.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",jt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Hi,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#B()};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}#N(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#d;this.#d=null;const a=this.x,o=this.y,c=this.width,h=this.height;a===e&&o===t&&c===n&&h===s||this.addCommands({cmd:this.#N.bind(this,a,o,c,h),undo:this.#N.bind(this,e,t,n,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#M(e,t){const[n,s]=this.parentDimensions,a=this.x,o=this.y,c=this.width,h=this.height,d=Se.MIN_SIZE/n,p=Se.MIN_SIZE/s,m=this.#R(this.rotation),v=(G,W)=>[m[0]*G+m[2]*W,m[1]*G+m[3]*W],_=this.#R(360-this.rotation),S=(G,W)=>[_[0]*G+_[2]*W,_[1]*G+_[3]*W];let A,T,x=!1,D=!1;switch(e){case"topLeft":x=!0,A=(G,W)=>[0,0],T=(G,W)=>[G,W];break;case"topMiddle":A=(G,W)=>[G/2,0],T=(G,W)=>[G/2,W];break;case"topRight":x=!0,A=(G,W)=>[G,0],T=(G,W)=>[0,W];break;case"middleRight":D=!0,A=(G,W)=>[G,W/2],T=(G,W)=>[0,W/2];break;case"bottomRight":x=!0,A=(G,W)=>[G,W],T=(G,W)=>[0,0];break;case"bottomMiddle":A=(G,W)=>[G/2,W],T=(G,W)=>[G/2,0];break;case"bottomLeft":x=!0,A=(G,W)=>[0,W],T=(G,W)=>[G,0];break;case"middleLeft":D=!0,A=(G,W)=>[0,W/2],T=(G,W)=>[G,W/2];break}const I=A(c,h),U=T(c,h);let z=v(...U);const F=Se._round(a+z[0]),R=Se._round(o+z[1]);let O=1,P=1,j,L;if(t.fromKeyboard)({deltaX:j,deltaY:L}=t);else{const{screenX:G,screenY:W}=t,[ae,we]=this.#l;[j,L]=this.screenToPageTranslation(G-ae,W-we),this.#l[0]=G,this.#l[1]=W}if([j,L]=S(j/n,L/s),x){const G=Math.hypot(c,h);O=P=Math.max(Math.min(Math.hypot(U[0]-I[0]-j,U[1]-I[1]-L)/G,1/c,1/h),d/c,p/h)}else D?O=In(Math.abs(U[0]-I[0]-j),d,1)/c:P=In(Math.abs(U[1]-I[1]-L),p,1)/h;const V=Se._round(c*O),B=Se._round(h*P);z=v(...T(V,B));const de=F-z[0],Ce=R-z[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=V,this.height=B,this.x=de,this.y=Ce,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new bh(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Hs.initialize(Se._l10n),this.#i=new Hs(this),this.#e&&(this.#i.data=this.#e,this.#e=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(e){this.#i&&(this.#i.data=e)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(e){await this.#i?.setGuessedText(e)}serializeAltText(e){return this.#i?.serialize(e)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new Yf(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#n.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:e,text:t,date:n,deleted:s}}=this.#n;return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new Yf(this),typeof e=="object"&&e!==null?this.#n.restoreData(e):this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#n||=new Yf(this),this.#n.setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new Yf(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[a]=this.pageDimensions,[o]=this.pageTranslation,c=o+a+1,h=s-100,d=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,d,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#a?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#z();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,a]=this.getInitialTranslation();return this.translate(s,a),_I(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new xm({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#H.bind(this),onPinching:this.#x.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#H(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#x(e,t,n){let a=.7*(n/t)+1-.7;if(a===1)return;const o=this.#R(this.rotation),c=(F,R)=>[o[0]*F+o[2]*R,o[1]*F+o[3]*R],[h,d]=this.parentDimensions,p=this.x,m=this.y,v=this.width,_=this.height,S=Se.MIN_SIZE/h,A=Se.MIN_SIZE/d;a=Math.max(Math.min(a,1/v,1/_),S/v,A/_);const T=Se._round(v*a),x=Se._round(_*a);if(T===v&&x===_)return;this.#u||=[p,m,v,_];const D=c(v/2,_/2),I=Se._round(p+D[0]),U=Se._round(m+D[1]),z=c(T/2,x/2);this.x=I-z[0],this.y=U-z[1],this.width=T,this.height=x,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(e){const{isMac:t}=dn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#U(e);return}this.#P(e)}#P(e){const{isMac:t}=dn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:a},c=d=>{s.abort(),this.#s=null,this.#m=!1,this._uiManager.endDragSession()||this.#P(d),n&&this._onStopDragging()};t&&(this.#T=e.clientX,this.#E=e.clientY,this.#s=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:m,pointerId:v}=d;if(v!==this.#s){jt(d);return}const[_,S]=this.screenToPageTranslation(p-this.#T,m-this.#E);this.#T=p,this.#E=m,this._uiManager.dragSelectedEditors(_,S)},o),window.addEventListener("touchmove",jt,o),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#C||d.isPrimary)&&c(d),jt(d)},o));const h=d=>{if(!this.#s||this.#s===d.pointerId){c(d);return}jt(d)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[a,o]=this.pageDimensions,[c,h]=this.pageTranslation,d=e/s,p=t/s,m=this.x*a,v=this.y*o,_=this.width*a,S=this.height*o;switch(n){case 0:return[m+d+c,o-v-p-S+h,m+d+_+c,o-v-p+h];case 90:return[m+p+c,o-v+d+h,m+p+S+c,o-v+d+_+h];case 180:return[m-d-_+c,o-v+p+h,m-d+c,o-v+p+S+h];case 270:return[m-p-S+c,o-v-d-_+h,m-p+c,o-v-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,a,o]=e,c=a-n,h=o-s;switch(this.rotation){case 0:return[n,t-o,c,h];case 90:return[n,t-s,h,c];case 180:return[a,t-s,c,h];case 270:return[a,t-o,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Se._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:a,richText:o},uid:c,pageIndex:h,creationDate:d,modificationDate:p}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:d,modificationDate:n||p,popupRef:!a,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return t<o&&s>0&&e<a&&n>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#z()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[a,o]=s.pageDimensions,[c,h,d,p]=s.getRectInCurrentCoords(e.rect,o);return s.x=c/a,s.y=h/o,s.width=d/a,s.height=p/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,a,o]=this.getPDFRect();return[Se._round(n+(a-n)*e),Se._round(s+(o-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const o=this.#W.bind(this),c=this.#G.bind(this),h=this._uiManager._signal;for(const d of this.#t){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:h}),d.addEventListener("blur",c,{signal:h}),d.addEventListener("focus",this.#K.bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",Se._l10nResizer[p])}}const n=this.#t[0];let s=0;for(const o of t){if(o===n)break;s++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(a!==s){if(a<s)for(let c=0;c<s-a;c++)this.#c.append(this.#c.firstElementChild);else if(a>s)for(let c=0;c<a-s;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let o=0;for(const c of t){const d=this.#t[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Se._l10nResizer[d])}}this.#V(0),this.#b=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#W(e){Se._resizerKeyboardManager.exec(this,e)}#G(e){this.#b&&e.relatedTarget?.parentNode!==this.#c&&this.#L()}#K(e){this.#g=this.#b?e:""}#V(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#b&&this.#M(this.#g,{deltaX:e,deltaY:t,fromKeyboard:!0})}#L(){this.#b=!1,this.#V(-1),this.#B()}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:n}=e;let s=this.#w.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(n),this.#w.size===0&&(this.#w=null)},Se._telemetryTimeout),this.#w.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(e){if(!this.#h&&!this.deleted){this.#h=e.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class nq extends Se{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const N1=3285377520,ji=4294901760,zs=65535;class wI{constructor(e){this.h1=e?e&4294967295:N1,this.h2=e?e&4294967295:N1}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let A=0,T=e.length;A<T;A++){const x=e.charCodeAt(A);x<=255?t[n++]=x:(t[n++]=x>>>8,t[n++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,a=n-s*4,o=new Uint32Array(t.buffer,0,s);let c=0,h=0,d=this.h1,p=this.h2;const m=3432918353,v=461845907,_=m&zs,S=v&zs;for(let A=0;A<s;A++)A&1?(c=o[A],c=c*m&ji|c*_&zs,c=c<<15|c>>>17,c=c*v&ji|c*S&zs,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(h=o[A],h=h*m&ji|h*_&zs,h=h<<15|h>>>17,h=h*v&ji|h*S&zs,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*m&ji|c*_&zs,c=c<<15|c>>>17,c=c*v&ji|c*S&zs,s&1?d^=c:p^=c}this.h1=d,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ji|e*36045&zs,t=t*4283543511&ji|((t<<16|e>>>16)*2950163797&ji)>>>16,e^=t>>>1,e=e*444984403&ji|e*60499&zs,t=t*3301882366&ji|((t<<16|e>>>16)*3120437893&ji)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const $b=Object.freeze({map:null,hash:"",transfer:void 0});class u0{#e=!1;#t=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof Se&&this.#i.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof Se)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[a,o]of Object.entries(t))n[a]!==o&&(s=!0,n[a]=o);else s=!0,this.#n.set(e,t);s&&this.#r(),t instanceof Se&&((this.#i||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new AI(this)}get serializable(){if(this.#n.size===0)return $b;const e=new Map,t=new wI,n=[],s=Object.create(null);let a=!1;for(const[o,c]of this.#n){const h=c instanceof Se?c.serialize(!1,s):c;c.page&&(c.pageIndex=c.page._pageIndex,delete c.page),h&&(e.set(o,h),t.update(`${o}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:$b}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const a of this.#n.values()){if(!(a instanceof Se)){a.popup&&(a.popup.deleted?s+=1:n+=1);continue}a.isCommentDeleted?s+=1:a.hasEditedComment&&(n+=1);const o=a.telemetryFinalData;if(!o)continue;const{type:c}=o;t.has(c)||t.set(c,Object.getPrototypeOf(a).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[d,p]of Object.entries(o)){if(d==="type")continue;let m=h.get(d);m||(m=new Map,h.set(d,m));const v=m.get(p)??0;m.set(p,v+1)}}if((s>0||n>0)&&(e||=Object.create(null),e.comments={deleted:s,edited:n}),!e)return null;for(const[a,o]of t)e[a]=o.computeTelemetryFinalData(e[a]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#i?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#i?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#i)for(const t of this.#i.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class AI extends u0{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,a=structuredClone(t,s?{transfer:s}:null);this.#e={map:a,hash:n,transfer:s}}get print(){lt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Me(this,"modifiedIds",{ids:new Set,hash:""})}}class iq{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(ot(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:a,style:o}=e,c=new FontFace(s,a,o);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),n?.(e)}catch{Ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}lt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Ne(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Me(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Me(this,"isSyncFontLoadingSupported",$n||dn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ot(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Me(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(U,z){return U.charCodeAt(z)<<24|U.charCodeAt(z+1)<<16|U.charCodeAt(z+2)<<8|U.charCodeAt(z+3)&255}function s(U,z,F,R){const O=U.substring(0,z),P=U.substring(z+F);return O+R+P}let a,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let d=0;function p(U,z){if(++d>30){Ne("Load test font never loaded."),z();return}if(h.font="30px "+U,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(p.bind(null,U,z))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,m.length,m);const S=16,A=1482184792;let T=n(v,S);for(a=0,o=m.length-3;a<o;a+=4)T=T-A+n(m,a)|0;a<m.length&&(T=T-A+n(m+"XXX",a)|0),v=s(v,S,4,B5(T));const x=`url(data:font/opentype;base64,${btoa(v)});`,D=`@font-face {font-family:"${m}";src:${x}}`;this.insertRule(D);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const U of[e.loadedName,m]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=U,I.append(z)}this._document.body.append(I),p(m,()=>{I.remove(),t.complete()})}}class sq{#e;constructor(e,t=null,n,s){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(o){Ne(`getPathGenerator - ignoring character: "${o}".`)}const a=bI(s?.path);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=a}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){Me(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){Me(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class vc{#e;#t;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let s=0;for(const d of vc.strings){const p=t.encode(e[d]);n[d]=p,s+=4+p.length}const a=new ArrayBuffer(s),o=new Uint8Array(a),c=new DataView(a);let h=0;for(const d of vc.strings){const p=n[d],m=p.length;c.setUint32(h,m),o.set(p,h+4),h+=4+m}return ot(h===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}#n(e){ot(e<vc.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class bc{#e;#t;#i;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let s=0;for(const v of bc.strings){const _=t.encode(e[v]);n[v]=_,s+=4+_.length}s+=4;let a,o,c=1+s;e.style&&(a=t.encode(e.style.style),o=t.encode(e.style.weight),c+=4+a.length+4+o.length);const h=new ArrayBuffer(c),d=new Uint8Array(h),p=new DataView(h);let m=0;p.setUint8(m++,e.guessFallback?1:0),p.setUint32(m,0),m+=4,s=0;for(const v of bc.strings){const _=n[v],S=_.length;s+=4+S,p.setUint32(m,S),d.set(_,m+4),m+=4+S}return p.setUint32(m-s-4,s),e.style&&(p.setUint32(m,a.length),d.set(a,m+4),m+=4+a.length,p.setUint32(m,o.length),d.set(o,m+4),m+=4+o.length),ot(m<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(m)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){ot(e<bc.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#i.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const s=this.#t.getUint32(e),a=this.#i.decode(new Uint8Array(this.#e,e+4,s));return{style:n,weight:a}}}class yt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#i=this.#t+1+8;static#n=this.#i+1+48;static#r=this.#n+1+6;#a;#s;#o;constructor({data:e,extra:t}){this.#a=e,this.#s=new TextDecoder,this.#o=new DataView(this.#a),t&&Object.assign(this,t)}#c(e){ot(e<yt.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=this.#o.getUint8(t)>>n&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return ot(e<yt.numbers.length,"Invalid number index"),this.#o.getFloat64(yt.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=yt.#t;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=yt.#i;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(this.#o.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=yt.#n;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}#d(e){ot(e<yt.strings.length,"Invalid string index");let t=yt.#r+4;for(let a=0;a<e;a++)t+=this.#o.getUint32(t)+4;const n=this.#o.getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(this.#a,t+4,n)),this.#s.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let e=yt.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);e+=4+s;const a=this.#o.getUint32(e);if(a!==0)return new Uint8Array(this.#a,e+4,a)}clearData(){let e=yt.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);e+=4+s;const a=this.#o.getUint32(e);new Uint8Array(this.#a,e+4,a).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=yt.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#a,e+4,s)),new vc(a.buffer)}get systemFontInfo(){let e=yt.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(this.#a,e+4,n)),new bc(s.buffer)}static write(e){const t=e.systemFontInfo?bc.write(e.systemFontInfo):null,n=e.cssFontInfo?vc.write(e.cssFontInfo):null,s=new TextEncoder,a={};let o=0;for(const A of yt.strings)a[A]=s.encode(e[A]),o+=4+a[A].length;const c=yt.#r+4+o+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),d=new Uint8Array(h),p=new DataView(h);let m=0;const v=yt.bools.length;let _=0,S=0;for(let A=0;A<v;A++){const T=e[yt.bools[A]];_|=(T===void 0?0:T?2:1)<<S,S+=2,(S===8||A===v-1)&&(p.setUint8(m++,_),_=0,S=0)}ot(m===yt.#e,"FontInfo.write: Boolean properties offset mismatch");for(const A of yt.numbers)p.setFloat64(m,e[A]),m+=8;if(ot(m===yt.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){p.setUint8(m++,4);for(const A of e.bbox)p.setInt16(m,A,!0),m+=2}else p.setUint8(m++,0),m+=8;if(ot(m===yt.#i,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){p.setUint8(m++,6);for(const A of e.fontMatrix)p.setFloat64(m,A,!0),m+=8}else p.setUint8(m++,0),m+=48;if(ot(m===yt.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){p.setUint8(m++,1);for(const A of e.defaultVMetrics)p.setInt16(m,A,!0),m+=2}else p.setUint8(m++,0),m+=6;ot(m===yt.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(yt.#r,0),m+=4;for(const A of yt.strings){const T=a[A],x=T.length;p.setUint32(m,x),d.set(T,m+4),m+=4+x}if(p.setUint32(yt.#r,m-yt.#r-4),!t)p.setUint32(m,0),m+=4;else{const A=t.byteLength;p.setUint32(m,A),ot(m+4+A<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(t),m+4),m+=4+A}if(!n)p.setUint32(m,0),m+=4;else{const A=n.byteLength;p.setUint32(m,A),ot(m+4+A<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(n),m+4),m+=4+A}return e.data===void 0?(p.setUint32(m,0),m+=4):(p.setUint32(m,e.data.length),d.set(e.data,m+4),m+=4+e.data.length),ot(m<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(m)}}class gn{static#e=0;static#t=1;static#i=2;static#n=3;static#r=4;static#a=8;static#s=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,s=[],a=[],o=[],c=[],h=null,d=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],o=e[3],t===1?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],s=e[2],a=e[3],c=e[4]||[],n=e[6],d=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const p=Math.floor(s.length/2),m=Math.floor(a.length/3),v=o.length,_=c.length;let S=0;for(const z of c)S+=1,S=Math.ceil(S/4)*4,S+=4+z.coords.length*4,S+=4+z.colors.length*4,z.verticesPerRow!==void 0&&(S+=4);const A=20+p*8+m*3+v*8+(n?16:0)+(d?3:0)+S,T=new ArrayBuffer(A),x=new DataView(T),D=new Uint8Array(T);x.setUint8(gn.#e,t),x.setUint8(gn.#t,n?1:0),x.setUint8(gn.#i,d?1:0),x.setUint8(gn.#n,h),x.setUint32(gn.#r,p,!0),x.setUint32(gn.#a,m,!0),x.setUint32(gn.#s,v,!0),x.setUint32(gn.#o,_,!0);let I=20;new Float32Array(T,I,p*2).set(s),I+=p*8,D.set(a,I),I+=m*3;for(const[z,F]of o)x.setFloat32(I,z,!0),I+=4,x.setUint32(I,parseInt(F.slice(1),16),!0),I+=4;if(n)for(const z of n)x.setFloat32(I,z,!0),I+=4;d&&(D.set(d,I),I+=3);for(let z=0;z<c.length;z++){const F=c[z];x.setUint8(I,F.type),I+=1,I=Math.ceil(I/4)*4,x.setUint32(I,F.coords.length,!0),I+=4,new Int32Array(T,I,F.coords.length).set(F.coords),I+=F.coords.length*4,x.setUint32(I,F.colors.length,!0),I+=4,new Int32Array(T,I,F.colors.length).set(F.colors),I+=F.colors.length*4,F.verticesPerRow!==void 0&&(x.setUint32(I,F.verticesPerRow,!0),I+=4)}return T}getIR(){const e=this.view,t=this.data[gn.#e],n=!!this.data[gn.#t],s=!!this.data[gn.#i],a=e.getUint32(gn.#r,!0),o=e.getUint32(gn.#a,!0),c=e.getUint32(gn.#s,!0),h=e.getUint32(gn.#o,!0);let d=20;const p=new Float32Array(this.buffer,d,a*2);d+=a*8;const m=new Uint8Array(this.buffer,d,o*3);d+=o*3;const v=[];for(let T=0;T<c;++T){const x=e.getFloat32(d,!0);d+=4;const D=e.getUint32(d,!0);d+=4,v.push([x,`#${D.toString(16).padStart(6,"0")}`])}let _=null;if(n){_=[];for(let T=0;T<4;++T)_.push(e.getFloat32(d,!0)),d+=4}let S=null;s&&(S=new Uint8Array(this.buffer,d,3),d+=3);const A=[];for(let T=0;T<h;++T){const x=e.getUint8(d);d+=1,d=Math.ceil(d/4)*4;const D=e.getUint32(d,!0);d+=4;const I=new Int32Array(this.buffer,d,D);d+=D*4;const U=e.getUint32(d,!0);d+=4;const z=new Int32Array(this.buffer,d,U);d+=U*4;const F={type:x,coords:I,colors:z};x===Fb.LATTICE&&(F.verticesPerRow=e.getUint32(d,!0),d+=4),A.push(F)}if(t===1)return["RadialAxial","axial",_,v,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",_,v,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(t===3){const T=this.data[gn.#n];let x=null;if(p.length>0){let D=p[0],I=p[0],U=p[1],z=p[1];for(let F=0;F<p.length;F+=2){const R=p[F],O=p[F+1];D=D>R?R:D,U=U>O?O:U,I=I<R?R:I,z=z<O?O:z}x=[D,U,I,z]}return["Mesh",T,p,m,A,x,_,S]}throw new Error(`Unsupported pattern kind: ${t}`)}}class rq{static write(e){let t,n;return dn.isFloat16ArraySupported?(n=new ArrayBuffer(e.length*2),t=new Float16Array(n)):(n=new ArrayBuffer(e.length*4),t=new Float32Array(n)),t.set(e),n}#e;constructor(e){this.#e=e}get path(){return dn.isFloat16ArraySupported?new Float16Array(this.#e):new Float32Array(this.#e)}}function aq(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if($n)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function oq(i){if($n&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Sm(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Xf(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const Gb=i=>typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0,lq=i=>typeof i=="object"&&typeof i?.name=="string",cq=q5.bind(null,Gb,lq);class uq{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Ne("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Qf={DATA:1,ERROR:2},en={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function M1(){}function ni(i){if(i instanceof za||i instanceof zb||i instanceof C1||i instanceof $p||i instanceof gv)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||lt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new za(i.message);case"InvalidPDFException":return new zb(i.message);case"PasswordException":return new C1(i.message,i.code);case"ResponseException":return new $p(i.message,i.status,i.missing);case"UnknownErrorException":return new gv(i.message,i.details)}return new gv(i.message,i.toString())}class ch{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Qf.DATA)s.resolve(e.data);else if(e.callback===Qf.ERROR)s.reject(ni(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(o){a.postMessage({sourceName:n,targetName:s,callback:Qf.DATA,callbackId:e.callbackId,data:o})},function(o){a.postMessage({sourceName:n,targetName:s,callback:Qf.ERROR,callbackId:e.callbackId,reason:ni(o)})});return}if(e.streamId){this.#i(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[s]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(o){a.reject(o)}return a.promise}sendWithStream(e,t,n,s){const a=this.streamId++,o=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:c,action:e,streamId:a,data:t,desiredSize:d.desiredSize},s),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:o,targetName:c,stream:en.PULL,streamId:a,desiredSize:d.desiredSize}),p.promise},cancel:d=>{ot(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:o,targetName:c,stream:en.CANCEL,streamId:a,reason:ni(d)}),p.promise}},n)}#i(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,a=this.comObj,o=this,c=this.actionHandler[e.action],h={enqueue(d,p=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:s,stream:en.ENQUEUE,streamId:t,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:en.CLOSE,streamId:t}),delete o.streamSinks[t])},error(d){ot(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:en.ERROR,streamId:t,reason:ni(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){a.postMessage({sourceName:n,targetName:s,stream:en.START_COMPLETE,streamId:t,success:!0})},function(d){a.postMessage({sourceName:n,targetName:s,stream:en.START_COMPLETE,streamId:t,reason:ni(d)})})}#n(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,a=this.comObj,o=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case en.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(ni(e.reason));break;case en.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(ni(e.reason));break;case en.PULL:if(!c){a.postMessage({sourceName:n,targetName:s,stream:en.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||M1).then(function(){a.postMessage({sourceName:n,targetName:s,stream:en.PULL_COMPLETE,streamId:t,success:!0})},function(d){a.postMessage({sourceName:n,targetName:s,stream:en.PULL_COMPLETE,streamId:t,reason:ni(d)})});break;case en.ENQUEUE:if(ot(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case en.CLOSE:if(ot(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#r(o,t);break;case en.ERROR:ot(o,"error should have stream controller"),o.controller.error(ni(e.reason)),this.#r(o,t);break;case en.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(ni(e.reason)),this.#r(o,t);break;case en.CANCEL:if(!c)break;const h=ni(e.reason);Promise.try(c.onCancel||M1,h).then(function(){a.postMessage({sourceName:n,targetName:s,stream:en.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){a.postMessage({sourceName:n,targetName:s,stream:en.CANCEL_COMPLETE,streamId:t,reason:ni(d)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#r(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class EI{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){lt("Abstract method `_createCanvas` called.")}}class hq extends EI{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class SI{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){lt("Abstract method `_fetch` called.")}}class L1 extends SI{async _fetch(e){const t=await ed(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Sm(t)}}class TI{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,a){return"none"}destroy(e=!1){}}class dq extends TI{#e;#t;#i;#n;#r;#a;#s=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#r=t}get#o(){return this.#t||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#i){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#r.createElementNS(Tr,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#r.createElementNS(Tr,"defs"),e.append(n),n.append(this.#i),this.#r.body.append(e)}return this.#i}#d(e){if(e.length===1){const h=e[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=h[m]/255;const p=d.join(",");return[p,p,p]}const[t,n,s]=e,a=new Array(256),o=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=t[h]/255,o[h]=n[h]/255,c[h]=s[h]/255;return[a.join(","),o.join(","),c.join(",")]}#h(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(Tm(t)?Ne('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=mI(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,s,a]=this.#d(e),o=e.length===1?n:`${n}${s}${a}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#s++}`,h=this.#h(c);this.#o.set(e,h),this.#o.set(o,h);const d=this.#m(c);return this.#p(n,s,a,d),h}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let a=this.#c.get(s);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#c.set(s,a)),!e||!t))return a.url;const o=this.#b(e);e=pe.makeHexColor(...o);const c=this.#b(t);if(t=pe.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return a.url;const h=new Array(256);for(let _=0;_<=255;_++){const S=_/255;h[_]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const d=h.join(","),p=`g_${this.#n}_hcm_filter`,m=a.filter=this.#m(p);this.#p(d,d,d,m),this.#g(m);const v=(_,S)=>{const A=o[_]/255,T=c[_]/255,x=new Array(S+1);for(let D=0;D<=S;D++)x[D]=A+D/S*(T-A);return x.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),m),a.url=this.#h(p),a.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#d([e]),s=`alpha_${n}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_alpha_map_${this.#s++}`,o=this.#h(a);this.#o.set(e,o),this.#o.set(s,o);const c=this.#m(a);return this.#y(n,c),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#d([e]),s=`luminosity_${n}`):s="luminosity",t=this.#o.get(s),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_luminosity_map_${this.#s++}`,o=this.#h(a);this.#o.set(e,o),this.#o.set(s,o);const c=this.#m(a);return this.#f(c),e&&this.#y(n,c),o}addHighlightHCMFilter(e,t,n,s,a){const o=`${t}-${n}-${s}-${a}`;let c=this.#c.get(e);if(c?.key===o||(c?(c.filter?.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},this.#c.set(e,c)),!t||!n))return c.url;const[h,d]=[t,n].map(this.#b.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,_]=[s,a].map(this.#b.bind(this));m<p&&([p,m,v,_]=[m,p,_,v]),this.#l.style.color="";const S=(x,D,I)=>{const U=new Array(256),z=(m-p)/I,F=x/255,R=(D-x)/(255*I);let O=0;for(let P=0;P<=I;P++){const j=Math.round(p+P*z),L=F+P*R;for(let V=O;V<=j;V++)U[V]=L;O=j+1}for(let P=O;P<256;P++)U[P]=U[O-1];return U.join(",")},A=`g_${this.#n}_hcm_${e}_filter`,T=c.filter=this.#m(A);return this.#g(T),this.#p(S(v[0],_[0],5),S(v[1],_[1],5),S(v[2],_[2],5),T),c.url=this.#h(A),c.url}destroy(e=!1){e&&this.#a?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#t?.clear(),this.#t=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(e){const t=this.#r.createElementNS(Tr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#g(e){const t=this.#r.createElementNS(Tr,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#m(e){const t=this.#r.createElementNS(Tr,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,n){const s=this.#r.createElementNS(Tr,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#p(e,t,n,s){const a=this.#r.createElementNS(Tr,"feComponentTransfer");s.append(a),this.#u(a,"feFuncR",e),this.#u(a,"feFuncG",t),this.#u(a,"feFuncB",n)}#y(e,t){const n=this.#r.createElementNS(Tr,"feComponentTransfer");t.append(n),this.#u(n,"feFuncA",e)}#b(e){return this.#l.style.color=e,nd(getComputedStyle(this.#l).getPropertyValue("color"))}}class xI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){lt("Abstract method `_fetch` called.")}}class j1 extends xI{async _fetch(e){const t=await ed(e,"arraybuffer");return new Uint8Array(t)}}class CI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){lt("Abstract method `_fetch` called.")}}class B1 extends CI{async _fetch(e){const t=await ed(e,"arraybuffer");return new Uint8Array(t)}}$n&&Ne("Please use the `legacy` build in Node.js environments.");async function h0(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class fq extends TI{}class pq extends EI{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class mq extends SI{async _fetch(e){return h0(e)}}class gq extends xI{async _fetch(e){return h0(e)}}class yq extends CI{async _fetch(e){return h0(e)}}const Gl="__forcedDependency",{floor:U1,ceil:F1}=Math;function Jf(i,e,t,n,s,a){i[e*4+0]=Math.min(i[e*4+0],t),i[e*4+1]=Math.min(i[e*4+1],n),i[e*4+2]=Math.max(i[e*4+2],s),i[e*4+3]=Math.max(i[e*4+3],a)}const Wb=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class vq{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===Wb}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Zf=(i,e)=>{if(!i)return;let t=i.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},i.set(e,t)),t};class bq{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[Gl]:[]};#i=new Map;#n=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(e,t,n=!1){this.#f=e.width,this.#g=e.height,this.#y(t),n&&(this.#p=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#y(e,this.#u)}#y(e,t){const n=new ArrayBuffer(e*4);this.#m=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),t&&t.length>0?(this.#u.set(t),this.#u.fill(Wb,t.length)):this.#u.fill(Wb)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[Gl]:{__proto__:this.#t[Gl]}},this.#s={__proto__:this.#s},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#s=Object.getPrototypeOf(this.#s);const n=this.#n.pop();return n!==void 0&&(Zf(this.#p,e)?.dependencies.add(n),this.#u[e]=this.#u[n]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(Zf(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#r.push(e),this}endMarkedContent(e){const t=this.#r.pop();return t!==void 0&&(Zf(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#a.push(pe.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#i.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#i.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Gl,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(Gl,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,n,s,a,o){const c=pe.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];pe.axialAlignedBoundingBox([n,a,s,o],c,h);const d=pe.intersect(this.#s,h);return d?(this.#s[0]=d[0],this.#s[1]=d[1],this.#s[2]=d[2],this.#s[3]=d[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(e,t,n,s,a,o){const c=this.#s;if(c[0]===1/0)return this;const h=pe.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform());if(c[0]===-1/0)return pe.axialAlignedBoundingBox([n,a,s,o],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return pe.axialAlignedBoundingBox([n,a,s,o],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,a=0,o=0,c){const h=n.bbox;let d,p;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(n),d!==!1&&(p=[0,0,0,0],pe.axialAlignedBoundingBox(h,n.fontMatrix,p),(s!==1||a!==0||o!==0)&&pe.scaleMinMax([s,0,0,-s,a,o],p),d)))return this.recordBBox(e,t,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(e);const m=c();return h&&p&&d===void 0&&(d=p[0]<=a-m.actualBoundingBoxLeft&&p[2]>=a+m.actualBoundingBoxRight&&p[1]<=o-m.actualBoundingBoxAscent&&p[3]>=o+m.actualBoundingBoxDescent,this.#h.set(n,d),d)?this.recordBBox(e,t,p[0],p[2],p[1],p[3]):this.recordBBox(e,t,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,o-m.actualBoundingBoxAscent,o+m.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#g,this.#s[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,s=this.#e,a=this.#t;for(const o of t)o in this.#e?n.add(s[o]):o in a&&a[o].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#i.has(t)&&this.#l.add(this.#i.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Gl]),this.#p){const n=Zf(this.#p,e),{dependencies:s}=n;this.#l.forEach(s.add,s),this.#n.forEach(s.add,s),this.#r.forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=U1(this.#o[0]*256/this.#f),s=U1(this.#o[1]*256/this.#g),a=F1(this.#o[2]*256/this.#f),o=F1(this.#o[3]*256/this.#g);Jf(this.#m,e,n,s,a,o);for(const c of this.#l)c!==e&&Jf(this.#m,c,n,s,a,o);for(const c of this.#n)c!==e&&Jf(this.#m,c,n,s,a,o);for(const c of this.#r)c!==e&&Jf(this.#m,c,n,s,a,o);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#d.get(e);return this.#d.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#h.clear(),new vq(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class Gp{#e;#t;#i;#n=0;#r=0;constructor(e,t,n){if(e instanceof Gp&&e.#i===!!n)return e;this.#e=e,this.#t=t,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#r++,this.#e.save(this.#t),this}restore(e){return this.#r>0&&(this.#e.restore(this.#t),this.#r--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#i||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,s,a,o){return this.#i||this.#e.recordClipBox(this.#t,t,n,s,a,o),this}recordBBox(e,t,n,s,a,o){return this.#i||this.#e.recordBBox(this.#t,t,n,s,a,o),this}recordCharacterBBox(e,t,n,s,a,o,c){return this.#i||this.#e.recordCharacterBBox(this.#t,t,n,s,a,o,c),this}recordFullPageBBox(e){return this.#i||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#i||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Bi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},On={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Kb(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class d0{isModifyingCurrentTransform(){return!1}getPattern(){lt("Abstract method `getPattern` called.")}}class _q extends d0{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let n,s=this._p0,a=this._p1;if(t&&(s=s.slice(),a=a.slice(),pe.applyTransform(s,t),pe.applyTransform(a,t)),this._type==="axial")n=e.createLinearGradient(s[0],s[1],a[0],a[1]);else if(this._type==="radial"){let o=this._r0,c=this._r1;if(t){const h=new Float32Array(2);pe.singularValueDecompose2dScale(t,h),o*=h[0],c*=h[0]}n=e.createRadialGradient(s[0],s[1],o,a[0],a[1],c)}for(const o of this._colorStops)n.addColorStop(o[0],o[1]);return n}getPattern(e,t,n,s){let a;if(s===On.STROKE||s===On.FILL){if(this.isOriginBased()){let v=pe.transform(n,t.baseTransform);this.matrix&&(v=pe.transform(v,this.matrix));const _=.001,S=Math.hypot(v[0],v[1]),A=Math.hypot(v[2],v[3]),T=(v[0]*v[2]+v[1]*v[3])/(S*A);if(Math.abs(T)<_)if(this.isRadial()){if(Math.abs(S-A)<_)return this._createGradient(e,v)}else return this._createGradient(e,v)}const o=t.current.getClippedPathBoundingBox(s,Rt(e))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,d=t.cachedCanvases.getCanvas("pattern",c,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),n=pe.transform(n,[1,0,0,1,o[0],o[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),Kb(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=e.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(n);a.setTransform(m)}else Kb(e,this._bbox),a=this._createGradient(e);return a}}function bv(i,e,t,n,s,a,o,c){const h=e.coords,d=e.colors,p=i.data,m=i.width*4;let v;h[t+1]>h[n+1]&&(v=t,t=n,n=v,v=a,a=o,o=v),h[n+1]>h[s+1]&&(v=n,n=s,s=v,v=o,o=c,c=v),h[t+1]>h[n+1]&&(v=t,t=n,n=v,v=a,a=o,o=v);const _=(h[t]+e.offsetX)*e.scaleX,S=(h[t+1]+e.offsetY)*e.scaleY,A=(h[n]+e.offsetX)*e.scaleX,T=(h[n+1]+e.offsetY)*e.scaleY,x=(h[s]+e.offsetX)*e.scaleX,D=(h[s+1]+e.offsetY)*e.scaleY;if(S>=D)return;const I=d[a],U=d[a+1],z=d[a+2],F=d[o],R=d[o+1],O=d[o+2],P=d[c],j=d[c+1],L=d[c+2],V=Math.round(S),B=Math.round(D);let de,Ce,G,W,ae,we,Oe,H;for(let ee=V;ee<=B;ee++){if(ee<T){const Ae=ee<S?0:(S-ee)/(S-T);de=_-(_-A)*Ae,Ce=I-(I-F)*Ae,G=U-(U-R)*Ae,W=z-(z-O)*Ae}else{let Ae;ee>D?Ae=1:T===D?Ae=0:Ae=(T-ee)/(T-D),de=A-(A-x)*Ae,Ce=F-(F-P)*Ae,G=R-(R-j)*Ae,W=O-(O-L)*Ae}let le;ee<S?le=0:ee>D?le=1:le=(S-ee)/(S-D),ae=_-(_-x)*le,we=I-(I-P)*le,Oe=U-(U-j)*le,H=z-(z-L)*le;const he=Math.round(Math.min(de,ae)),fe=Math.round(Math.max(de,ae));let ke=m*ee+he*4;for(let Ae=he;Ae<=fe;Ae++)le=(de-Ae)/(de-ae),le<0?le=0:le>1&&(le=1),p[ke++]=Ce-(Ce-we)*le|0,p[ke++]=G-(G-Oe)*le|0,p[ke++]=W-(W-H)*le|0,p[ke++]=255}}function wq(i,e,t){const n=e.coords,s=e.colors;let a,o;switch(e.type){case Fb.LATTICE:const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,d=c-1;for(a=0;a<h;a++){let p=a*c;for(let m=0;m<d;m++,p++)bv(i,t,n[p],n[p+1],n[p+c],s[p],s[p+1],s[p+c]),bv(i,t,n[p+c+1],n[p+1],n[p+c],s[p+c+1],s[p+1],s[p+c])}break;case Fb.TRIANGLES:for(a=0,o=n.length;a<o;a+=3)bv(i,t,n[a],n[a+1],n[a+2],s[a],s[a+1],s[a+2]);break;default:throw new Error("illegal figure")}}class Aq extends d0{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),_=d/m,S=p/v,A={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/_,scaleY:1/S},T=m+4,x=v+4,D=n.getCanvas("mesh",T,x),I=D.context,U=I.createImageData(m,v);if(t){const F=U.data;for(let R=0,O=F.length;R<O;R+=4)F[R]=t[0],F[R+1]=t[1],F[R+2]=t[2],F[R+3]=255}for(const F of this._figures)wq(U,F,A);return I.putImageData(U,2,2),{canvas:D.canvas,offsetX:c-2*_,offsetY:h-2*S,scaleX:_,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){Kb(e,this._bbox);const a=new Float32Array(2);if(s===On.SHADING)pe.singularValueDecompose2dScale(Rt(e),a);else if(this.matrix){pe.singularValueDecompose2dScale(this.matrix,a);const[c,h]=a;pe.singularValueDecompose2dScale(t.baseTransform,a),a[0]*=c,a[1]*=h}else pe.singularValueDecompose2dScale(t.baseTransform,a);const o=this._createMeshCanvas(a,s===On.SHADING?null:this._background,t.cachedCanvases);return s!==On.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class Eq extends d0{getPattern(){return"hotpink"}}function Sq(i){switch(i[0]){case"RadialAxial":return new _q(i);case"Mesh":return new Aq(i);case"Dummy":return new Eq}throw new Error(`Unknown IR type: ${i[0]}`)}const z1={COLORED:1,UNCOLORED:2};class f0{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){const{bbox:n,operatorList:s,paintType:a,tilingType:o,color:c,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:p}=this;d=Math.abs(d),p=Math.abs(p),Em("TilingType: "+o);const m=n[0],v=n[1],_=n[2],S=n[3],A=_-m,T=S-v,x=new Float32Array(2);pe.singularValueDecompose2dScale(this.matrix,x);const[D,I]=x;pe.singularValueDecompose2dScale(this.baseTransform,x);const U=D*x[0],z=I*x[1];let F=A,R=T,O=!1,P=!1;const j=Math.ceil(d*U),L=Math.ceil(p*z),V=Math.ceil(A*U),B=Math.ceil(T*z);j>=V?F=d:O=!0,L>=B?R=p:P=!0;const de=this.getSizeAndScale(F,this.ctx.canvas.width,U),Ce=this.getSizeAndScale(R,this.ctx.canvas.height,z),G=e.cachedCanvases.getCanvas("pattern",de.size,Ce.size),W=G.context,ae=h.createCanvasGraphics(W,t);if(ae.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ae,a,c),W.translate(-de.scale*m,-Ce.scale*v),ae.transform(0,de.scale,0,0,Ce.scale,0,0),W.save(),ae.dependencyTracker?.save(),this.clipBbox(ae,m,v,_,S),ae.baseTransform=Rt(ae.ctx),ae.executeOperatorList(s),ae.endDrawing(),ae.dependencyTracker?.restore(),W.restore(),O||P){const we=G.canvas;O&&(F=d),P&&(R=p);const Oe=this.getSizeAndScale(F,this.ctx.canvas.width,U),H=this.getSizeAndScale(R,this.ctx.canvas.height,z),ee=Oe.size,le=H.size,he=e.cachedCanvases.getCanvas("pattern-workaround",ee,le),fe=he.context,ke=O?Math.floor(A/d):0,Ae=P?Math.floor(T/p):0;for(let _t=0;_t<=ke;_t++)for(let ct=0;ct<=Ae;ct++)fe.drawImage(we,ee*_t,le*ct,ee,le,0,0,ee,le);return{canvas:he.canvas,scaleX:Oe.scale,scaleY:H.scale,offsetX:m,offsetY:v}}return{canvas:G.canvas,scaleX:de.scale,scaleY:Ce.scale,offsetX:m,offsetY:v}}getSizeAndScale(e,t,n){const s=Math.max(f0.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=s?a=s:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,s,a){const o=s-t,c=a-n;e.ctx.rect(t,n,o,c),pe.axialAlignedBoundingBox([t,n,s,a],Rt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,a=e.current;switch(t){case z1.COLORED:const{fillStyle:o,strokeStyle:c}=this.ctx;s.fillStyle=a.fillColor=o,s.strokeStyle=a.strokeColor=c;break;case z1.UNCOLORED:s.fillStyle=s.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new L5(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,a){let o=n;s!==On.SHADING&&(o=pe.transform(o,t.baseTransform),this.matrix&&(o=pe.transform(o,this.matrix)));const c=this.createPatternCanvas(t,a);let h=new DOMMatrix(o);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const d=e.createPattern(c.canvas,"repeat");return d.setTransform(h),d}}function Tq({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const c=dn.isLittleEndian?4278190080:255,[h,d]=o?[a,c]:[c,a],p=n>>3,m=n&7,v=i.length;t=new Uint32Array(t.buffer);let _=0;for(let S=0;S<s;S++){for(const T=e+p;e<T;e++){const x=e<v?i[e]:255;t[_++]=x&128?d:h,t[_++]=x&64?d:h,t[_++]=x&32?d:h,t[_++]=x&16?d:h,t[_++]=x&8?d:h,t[_++]=x&4?d:h,t[_++]=x&2?d:h,t[_++]=x&1?d:h}if(m===0)continue;const A=e<v?i[e++]:255;for(let T=0;T<m;T++)t[_++]=A&1<<7-T?d:h}return{srcPos:e,destPos:_}}const V1=16,q1=100,xq=15,H1=10,ii=16,_v=new DOMMatrix,vi=new Float32Array(2),ac=new Float32Array([1/0,1/0,-1/0,-1/0]);function Cq(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},i.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},i.transform=function(t,n,s,a,o,c){e.transform(t,n,s,a,o,c),this.__originalTransform(t,n,s,a,o,c)},i.setTransform=function(t,n,s,a,o,c){e.setTransform(t,n,s,a,o,c),this.__originalSetTransform(t,n,s,a,o,c)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,a,o,c){e.bezierCurveTo(t,n,s,a,o,c),this.__originalBezierCurveTo(t,n,s,a,o,c)},i.rect=function(t,n,s,a){e.rect(t,n,s,a),this.__originalRect(t,n,s,a)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class kq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function ep(i,e,t,n,s,a,o,c,h,d){const[p,m,v,_,S,A]=Rt(i);if(m===0&&v===0){const D=o*p+S,I=Math.round(D),U=c*_+A,z=Math.round(U),F=(o+h)*p+S,R=Math.abs(Math.round(F)-I)||1,O=(c+d)*_+A,P=Math.abs(Math.round(O)-z)||1;return i.setTransform(Math.sign(p),0,0,Math.sign(_),I,z),i.drawImage(e,t,n,s,a,0,0,R,P),i.setTransform(p,m,v,_,S,A),[R,P]}if(p===0&&_===0){const D=c*v+S,I=Math.round(D),U=o*m+A,z=Math.round(U),F=(c+d)*v+S,R=Math.abs(Math.round(F)-I)||1,O=(o+h)*m+A,P=Math.abs(Math.round(O)-z)||1;return i.setTransform(0,Math.sign(m),Math.sign(v),0,I,z),i.drawImage(e,t,n,s,a,0,0,P,R),i.setTransform(p,m,v,_,S,A),[P,R]}i.drawImage(e,t,n,s,a,o,c,h,d);const T=Math.hypot(p,m),x=Math.hypot(v,_);return[T*h,x*d]}class $1{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Ub;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=cn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ac.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=On.FILL,t=null){const n=this.minMax.slice();if(e===On.STROKE){t||lt("Stroke bounding box must include transform."),pe.singularValueDecompose2dScale(t,vi);const s=vi[0]*this.lineWidth/2,a=vi[1]*this.lineWidth/2;n[0]-=s,n[1]-=a,n[2]+=s,n[3]+=a}return n}updateClipFromPath(){const e=pe.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ac,0)}getClippedPathBoundingBox(e=On.FILL,t=null){return pe.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function G1(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%ii,a=(t-s)/ii,o=s===0?a:a+1,c=i.createImageData(n,ii);let h=0,d;const p=e.data,m=c.data;let v,_,S,A;if(e.kind===gp.GRAYSCALE_1BPP){const T=p.byteLength,x=new Uint32Array(m.buffer,0,m.byteLength>>2),D=x.length,I=n+7>>3,U=4294967295,z=dn.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(S=v<a?ii:s,d=0,_=0;_<S;_++){const F=T-h;let R=0;const O=F>I?n:F*8-7,P=O&-8;let j=0,L=0;for(;R<P;R+=8)L=p[h++],x[d++]=L&128?U:z,x[d++]=L&64?U:z,x[d++]=L&32?U:z,x[d++]=L&16?U:z,x[d++]=L&8?U:z,x[d++]=L&4?U:z,x[d++]=L&2?U:z,x[d++]=L&1?U:z;for(;R<O;R++)j===0&&(L=p[h++],j=128),x[d++]=L&j?U:z,j>>=1}for(;d<D;)x[d++]=0;i.putImageData(c,0,v*ii)}}else if(e.kind===gp.RGBA_32BPP){for(_=0,A=n*ii*4,v=0;v<a;v++)m.set(p.subarray(h,h+A)),h+=A,i.putImageData(c,0,_),_+=ii;v<o&&(A=n*s*4,m.set(p.subarray(h,h+A)),i.putImageData(c,0,_))}else if(e.kind===gp.RGB_24BPP)for(S=ii,A=n*S,v=0;v<o;v++){for(v>=a&&(S=s,A=n*S),d=0,_=A;_--;)m[d++]=p[h++],m[d++]=p[h++],m[d++]=p[h++],m[d++]=255;i.putImageData(c,0,v*ii)}else throw new Error(`bad image kind: ${e.kind}`)}function W1(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%ii,a=(t-s)/ii,o=s===0?a:a+1,c=i.createImageData(n,ii);let h=0;const d=e.data,p=c.data;for(let m=0;m<o;m++){const v=m<a?ii:s;({srcPos:h}=Tq({src:d,srcPos:h,dest:p,width:n,height:v,nonBlackColor:0})),i.putImageData(c,0,m*ii)}}function Qu(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function tp(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function K1(i,e){if(e)return!0;pe.singularValueDecompose2dScale(i,vi);const t=Math.fround(tr.pixelRatio*Dc.PDF_TO_CSS_UNITS);return vi[0]<=t&&vi[1]<=t}const Rq=["butt","round","square"],Iq=["miter","round","bevel"],Dq={},Y1={};class _c{constructor(e,t,n,s,a,{optionalContentConfig:o,markedContentStack:c=null},h,d,p){this.ctx=e,this.current=new $1(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new kq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Rt(this.compositeCtx))}this.ctx.save(),tp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Rt(this.ctx)}executeOperatorList(e,t,n,s,a){const o=e.argsArray,c=e.fnArray;let h=t||0;const d=o.length;if(d===h)return h;const p=d-h>H1&&typeof n=="function",m=p?Date.now()+xq:0;let v=0;const _=this.commonObjs,S=this.objs;let A,T;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!a||a(h))if(A=c[h],T=o[h]??null,A!==Lh.dependency)T===null?this[A](h):this[A](h,...T);else for(const x of T){this.dependencyTracker?.recordNamedData(x,h);const D=x.startsWith("g_")?_:S;if(!D.has(x))return D.get(x,n),h}if(h++,h===d)return h;if(p&&++v>H1){if(Date.now()>m)return n(),h;v=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,d="prescale1",p,m;for(;a>2&&c>1||o>2&&h>1;){let v=c,_=h;a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/v),o>2&&h>1&&(_=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/_),p=this.cachedCanvases.getCanvas(d,v,_),m=p.context,m.clearRect(0,0,v,_),m.drawImage(e,0,0,c,h,0,0,v,_),e=p.canvas,c=v,h=_,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:s,height:a}=t,o=this.current.fillColor,c=this.current.patternFill,h=Rt(n);let d,p,m,v;if((t.bitmap||t.data)&&t.count>1){const j=t.bitmap||t.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),o]),d=this._cachedBitmapsMap.get(j),d||(d=new Map,this._cachedBitmapsMap.set(j,d));const L=d.get(p);if(L&&!c){const V=Math.round(Math.min(h[0],h[2])+h[4]),B=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,Bi.transformAndFill),{canvas:L,offsetX:V,offsetY:B}}m=L}m||(v=this.cachedCanvases.getCanvas("maskCanvas",s,a),W1(v.context,t));let _=pe.transform(h,[1/s,0,0,-1/a,0,0]);_=pe.transform(_,[1,0,0,1,0,-a]);const S=ac.slice();pe.axialAlignedBoundingBox([0,0,s,a],_,S);const[A,T,x,D]=S,I=Math.round(x-A)||1,U=Math.round(D-T)||1,z=this.cachedCanvases.getCanvas("fillCanvas",I,U),F=z.context,R=A,O=T;F.translate(-R,-O),F.transform(..._),m||(m=this._scaleImage(v.canvas,Fs(F)),m=m.img,d&&c&&d.set(p,m)),F.imageSmoothingEnabled=K1(Rt(F),t.interpolate),ep(F,m,0,0,m.width,m.height,0,0,s,a),F.globalCompositeOperation="source-in";const P=pe.transform(Fs(F),[1,0,0,1,-R,-O]);return F.fillStyle=c?o.getPattern(n,this,P,On.FILL,e):o,F.fillRect(0,0,s,a),d&&!c&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,z.canvas)),this.dependencyTracker?.recordDependencies(e,Bi.transformAndFill),{canvas:z.canvas,offsetX:Math.round(R),offsetY:Math.round(O)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=Rq[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Iq[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,s]of t)switch(n){case"LW":this.setLineWidth(e,s);break;case"LC":this.setLineCap(e,s);break;case"LJ":this.setLineJoin(e,s);break;case"ML":this.setMiterLimit(e,s);break;case"D":this.setDash(e,s[0],s[1]);break;case"RI":this.setRenderingIntent(e,s);break;case"FL":this.setFlatness(e,s);break;case"Font":this.setFont(e,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const o=this.ctx=a.context;o.setTransform(this.suspendedCtx.getTransform()),Qu(this.suspendedCtx,o),Cq(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Qu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const a=s[0],o=s[1],c=s[2]-a,h=s[3]-o;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,a,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,a,o,c,h,d,p,m){let v=e.canvas,_=h-p,S=d-m;if(o)if(_<0||S<0||_+n>v.width||S+s>v.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,s),x=T.context;x.drawImage(v,-_,-S),x.globalCompositeOperation="destination-atop",x.fillStyle=o,x.fillRect(0,0,n,s),x.globalCompositeOperation="source-over",v=T.canvas,_=S=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(_,S,n,s),e.clip(T),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(_,S,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const A=new Path2D;A.rect(h,d,n,s),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(v,_,S,n,s,h,d,n,s),t.restore()}save(e){this.inSMaskMode&&Qu(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Qu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,a,o,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,a,o,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[a]=n;if(!s){a||=n[0]=new Path2D,this[t](e,a);return}if(this.dependencyTracker!==null){const o=t===Lh.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-o,s[2]+o,s[1]-o,s[3]+o).recordDependencies(e,["transform"])}a instanceof Path2D||(a=n[0]=bI(a)),pe.axialAlignedBoundingBox(s,Rt(this.ctx),this.current.minMax),this[t](e,a),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const s=this.ctx,a=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const o=a.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=a.getPattern(s,this,Fs(s),On.STROKE,e),o){const c=new Path2D;c.addPath(t,s.getTransform().invertSelf().multiplySelf(o)),t=c}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,Bi.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(On.STROKE,Rt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;let c=!1;if(o){const d=a.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(e),s.save(),s.fillStyle=a.getPattern(s,this,Fs(s),On.FILL,e),d){const p=new Path2D;p.addPath(t,s.getTransform().invertSelf().multiplySelf(d)),t=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),this.dependencyTracker?.recordDependencies(e,Bi.fill),c&&(s.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,Bi.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Dq}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Y1}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,a=n.getTransform().invertSelf();for(const{transform:o,x:c,y:h,fontSize:d,path:p}of t)p&&s.addPath(p,new DOMMatrix(o).preMultiplySelf(a).translate(c,h).scale(d,-d));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),a=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=s.fontMatrix||Ub,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Ne("Invalid font matrix for font "+t),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const o=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const d=s.italic?"italic":"normal";let p=n;n<V1?p=V1:n>q1&&(p=q1),this.current.fontSizeScale=n/p,this.ctx.font=`${d} ${h} ${p}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#i(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}paintChar(e,t,n,s,a,o){const c=this.ctx,h=this.current,d=h.font,p=h.textRenderingMode,m=h.fontSize/h.fontSizeScale,v=p&cn.FILL_STROKE_MASK,_=!!(p&cn.ADD_TO_PATH_FLAG),S=h.patternFill&&!d.missingFile,A=h.patternStroke&&!d.missingFile;let T;if((d.disableFontFace||_||S||A)&&!d.missingFile&&(T=d.getPathGenerator(this.commonObjs,t)),T&&(d.disableFontFace||S||A)){c.save(),c.translate(n,s),c.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(e,c,d);let x;if(v===cn.FILL||v===cn.FILL_STROKE)if(a){x=c.getTransform(),c.setTransform(...a);const D=this.#i(T,x,a);c.fill(D)}else c.fill(T);if(v===cn.STROKE||v===cn.FILL_STROKE)if(o){x||=c.getTransform(),c.setTransform(...o);const{a:D,b:I,c:U,d:z}=x,F=pe.inverseTransform(o),R=pe.transform([D,I,U,z,0,0],F);pe.singularValueDecompose2dScale(R,vi),c.lineWidth*=Math.max(vi[0],vi[1])/m,c.stroke(this.#i(T,x,o))}else c.lineWidth/=m,c.stroke(T);c.restore()}else(v===cn.FILL||v===cn.FILL_STROKE)&&(c.fillText(t,n,s),this.dependencyTracker?.recordCharacterBBox(e,c,d,m,n,s,()=>c.measureText(t))),(v===cn.STROKE||v===cn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,d,m,n,s,()=>c.measureText(t)).recordDependencies(e,Bi.stroke),c.strokeText(t,n,s));_&&((this.pendingTextPaths||=[]).push({transform:Rt(c),x:n,y:s,fontSize:m,path:T}),this.dependencyTracker?.recordCharacterBBox(e,c,d,m,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Me(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Bi.showText).resetBBox(e),this.current.textRenderingMode&cn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(e);return}const o=this.ctx,c=n.fontSizeScale,h=n.charSpacing,d=n.wordSpacing,p=n.fontDirection,m=n.textHScale*p,v=t.length,_=s.vertical,S=_?1:-1,A=s.defaultVMetrics,T=a*n.fontMatrix[0],x=n.textRenderingMode===cn.FILL&&!s.disableFontFace&&!n.patternFill;o.save(),n.textMatrix&&o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),p>0?o.scale(m,-1):o.scale(m,1);let D,I;const U=n.textRenderingMode&cn.FILL_STROKE_MASK,z=U===cn.FILL||U===cn.FILL_STROKE,F=U===cn.STROKE||U===cn.FILL_STROKE;if(z&&n.patternFill){o.save();const L=n.fillColor.getPattern(o,this,Fs(o),On.FILL,e);D=Rt(o),o.restore(),o.fillStyle=L}if(F&&n.patternStroke){o.save();const L=n.strokeColor.getPattern(o,this,Fs(o),On.STROKE,e);I=Rt(o),o.restore(),o.strokeStyle=L}let R=n.lineWidth;const O=n.textMatrixScale;if(O===0||R===0?F&&(R=this.getSinglePixelWidth()):R/=O,c!==1&&(o.scale(c,c),R/=c),o.lineWidth=R,s.isInvalidPDFjsFont){const L=[];let V=0;for(const de of t)L.push(de.unicode),V+=de.width;const B=L.join("");if(o.fillText(B,0,0),this.dependencyTracker!==null){const de=o.measureText(B);this.dependencyTracker.recordBBox(e,this.ctx,-de.actualBoundingBoxLeft,de.actualBoundingBoxRight,-de.actualBoundingBoxAscent,de.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=V*T*m,o.restore(),this.compose();return}let P=0,j;for(j=0;j<v;++j){const L=t[j];if(typeof L=="number"){P+=S*L*a/1e3;continue}let V=!1;const B=(L.isSpace?d:0)+h,de=L.fontChar,Ce=L.accent;let G,W,ae=L.width;if(_){const H=L.vmetric||A,ee=-(L.vmetric?H[1]:ae*.5)*T,le=H[2]*T;ae=H?-H[0]:ae,G=ee/c,W=(P+le)/c}else G=P/c,W=0;let we;if(s.remeasure&&ae>0){we=o.measureText(de);const H=we.width*1e3/a*c;if(ae<H&&this.isFontSubpixelAAEnabled){const ee=ae/H;V=!0,o.save(),o.scale(ee,1),G/=ee}else ae!==H&&(G+=(ae-H)/2e3*a/c)}if(this.contentVisible&&(L.isInFont||s.missingFile)){if(x&&!Ce)o.fillText(de,G,W),this.dependencyTracker?.recordCharacterBBox(e,o,we?{bbox:null}:s,a/c,G,W,()=>we??o.measureText(de));else if(this.paintChar(e,de,G,W,D,I),Ce){const H=G+a*Ce.offset.x/c,ee=W-a*Ce.offset.y/c;this.paintChar(e,Ce.fontChar,H,ee,D,I)}}const Oe=_?ae*T-B*p:ae*T+B*p;P+=Oe,V&&o.restore()}_?n.y-=P:n.x+=P*m,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,a=s.font,o=s.fontSize,c=s.fontDirection,h=a.vertical?1:-1,d=s.charSpacing,p=s.wordSpacing,m=s.textHScale*c,v=s.fontMatrix||Ub,_=t.length,S=s.textRenderingMode===cn.INVISIBLE;let A,T,x,D;if(S||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(m,c);const I=this.dependencyTracker;for(this.dependencyTracker=I?new Gp(I,e):null,A=0;A<_;++A){if(T=t[A],typeof T=="number"){D=h*T*o/1e3,this.ctx.translate(D,0),s.x+=D*m;continue}const U=(T.isSpace?p:0)+d,z=a.charProcOperatorList[T.operatorListId];z?this.contentVisible&&(this.save(),n.scale(o,o),n.transform(...v),this.executeOperatorList(z),this.restore()):Ne(`Type3 character "${T.operatorListId}" is not available.`);const F=[T.width,0];pe.applyTransform(F,v),x=F[0]*o+U,n.translate(x,0),s.x+=x*m}n.restore(),I&&(this.dependencyTracker=I)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,a,o,c){const h=new Path2D;h.rect(s,a,o-s,c-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,s,o,a,c).recordClipBox(e,this.ctx,s,o,a,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Rt(this.ctx),a={createCanvasGraphics:(o,c)=>new _c(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Gp(this.dependencyTracker,c,!0):null)};n=new f0(t,this.ctx,a,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=Sq(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,Fs(n),On.SHADING,e);const a=Fs(n);if(a){const{width:o,height:c}=n.canvas,h=ac.slice();pe.axialAlignedBoundingBox([0,0,o,c],a,h);const[d,p,m,v]=h;this.ctx.fillRect(d,p,m-d,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Bi.transform).recordDependencies(e,Bi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){lt("Should not call beginInlineImage")}beginImageData(){lt("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Rt(this.ctx),n)){pe.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,a,o,c]=n,h=new Path2D;h.rect(s,a,o-s,c-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,s,o,a,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Em("TODO: Support non-isolated groups."),t.knockout&&Ne("Knockout groups not supported.");const s=Rt(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=ac.slice();pe.axialAlignedBoundingBox(t.bbox,Rt(n),a);const o=[0,0,n.canvas.width,n.canvas.height];a=pe.intersect(a,o)||[0,0,0,0];const c=Math.floor(a[0]),h=Math.floor(a[1]),d=Math.max(Math.ceil(a[2])-c,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,p]);let m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,d,p),_=v.context;_.translate(-c,-h),_.transform(...s);let S=new Path2D;const[A,T,x,D]=t.bbox;if(S.rect(A,T,x-A,D-T),t.matrix){const I=new Path2D;I.addPath(S,new DOMMatrix(t.matrix)),S=I}_.clip(S),t.smask&&this.smaskStack.push({canvas:v.canvas,context:_,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),Qu(n,_),this.ctx=_,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Rt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=ac.slice();pe.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,o),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,n,s,a,o){if(this.#e(),tp(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,pe.singularValueDecompose2dScale(Rt(this.ctx),vi);const{viewportScale:d}=this,p=Math.ceil(c*this.outputScaleX*d),m=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:v,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(vi[0],0,0,-vi[1],0,h*vi[1]),tp(this.ctx)}else{tp(this.ctx),this.endPath(e);const d=new Path2D;d.rect(n[0],n[1],c,h),this.ctx.clip(d)}}this.current=new $1(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...a)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,a=this._createMaskCanvas(e,t),o=a.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,a.offsetX,a.offsetX+o.width,a.offsetY,a.offsetY+o.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,a=0,o,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const d=Rt(h);h.transform(n,s,a,o,0,0);const p=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(e);for(let m=0,v=c.length;m<v;m+=2){const _=pe.transform(d,[n,s,a,o,c[m],c[m+1]]);h.drawImage(p.canvas,_[4],_[5]),this.dependencyTracker?.recordBBox(e,this.ctx,_[4],_[4]+p.canvas.width,_[5],_[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,Bi.transformAndFill);for(const o of t){const{data:c,width:h,height:d,transform:p}=o,m=this.cachedCanvases.getCanvas("maskCanvas",h,d),v=m.context;v.save();const _=this.getObject(e,c,o);W1(v,_),v.globalCompositeOperation="source-in",v.fillStyle=a?s.getPattern(v,this,Fs(n),On.FILL,e):s,v.fillRect(0,0,h,d),v.restore(),n.save(),n.transform(...p),n.scale(1,-1),ep(n,m.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,d),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,a){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Ne("Dependent image isn't ready yet");return}const c=o.width,h=o.height,d=[];for(let p=0,m=a.length;p<m;p+=2)d.push({transform:[n,0,0,s,a[p],a[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,o,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,s),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",a.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,s=t.height,a=this.ctx;this.save(e);const{filter:o}=a;o!=="none"&&o!==""&&(a.filter="none"),a.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const p=this.cachedCanvases.getCanvas("inlineImage",n,s).context;G1(p,t),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,Fs(a));a.imageSmoothingEnabled=K1(Rt(a),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,a,0,n,-s,0).recordDependencies(e,Bi.imageXObject).recordOperation(e),ep(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const s=this.ctx;let a;if(t.bitmap)a=t.bitmap;else{const o=t.width,c=t.height,d=this.cachedCanvases.getCanvas("inlineImage",o,c).context;G1(d,t),a=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(e);for(const o of n)s.save(),s.transform(...o.transform),s.scale(1,-1),ep(s,a,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Bi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(s||(this.pendingClip===Y1?a.clip(t,"evenodd"):a.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Rt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:a}=this.ctx.getTransform();let o,c;if(n===0&&s===0){const h=Math.abs(t),d=Math.abs(a);if(h===d)if(e===0)o=c=1/h;else{const p=h*e;o=c=p<1?1/p:1}else if(e===0)o=1/h,c=1/d;else{const p=h*e,m=d*e;o=p<1?1/p:1,c=m<1?1/m:1}}else{const h=Math.abs(t*a-n*s),d=Math.hypot(t,n),p=Math.hypot(s,a);if(e===0)o=p/h,c=d/h;else{const m=e*h;o=p>m?p/m:1,c=d>m?d/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[a,o]=this.getScaleForStroking();if(a===o){n.lineWidth=(s||1)*a,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(a,o),_v.a=1/a,_v.d=1/o;const h=new Path2D;if(h.addPath(e,_v),c.length>0){const d=Math.max(a,o);n.setLineDash(c.map(p=>p/d)),n.lineDashOffset/=d}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const i in Lh)_c.prototype[i]!==void 0&&(_c.prototype[Lh[i]]=_c.prototype[i]);class wc{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class Oq{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const tc=Symbol("INTERNAL");class Pq{#e=!1;#t=!1;#i=!1;#n=!0;constructor(e,{name:t,intent:n,usage:s,rbGroups:a}){this.#e=!!(e&gi.DISPLAY),this.#t=!!(e&gi.PRINT),this.name=t,this.intent=n,this.usage=s,this.rbGroups=a}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==tc&&lt("Internal method `_setVisible` called."),this.#i=n,this.#n=t}}class Nq{#e=null;#t=new Map;#i=null;#n=null;constructor(e,t=gi.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const n of e.groups)this.#t.set(n.id,new Pq(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(tc,!1);for(const n of e.on)this.#t.get(n)._setVisible(tc,!0);for(const n of e.off)this.#t.get(n)._setVisible(tc,!1);this.#i=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const a=e[s];let o;if(Array.isArray(a))o=this.#r(a);else if(this.#t.has(a))o=this.#t.get(a).visible;else return Ne(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Em("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ne(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ne(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ne(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ne(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ne(`Unknown optional content policy ${e.policy}.`),!0}return Ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const s=this.#t.get(e);if(!s){Ne(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&this.#t.get(o)?._setVisible(tc,!1,!0);s._setVisible(tc,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const a=this.#t.get(s);if(a)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!a.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new wI;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class Cm{#e=null;#t=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(e,t,n){this._source=e,this.#e=t,this.#t=n}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return ot(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#e(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new this.#t(this,e,t);return this._rangeReaders.add(n),n}cancelAllRequests(e){this._fullReader?.cancel(e);for(const t of new Set(this._rangeReaders))t.cancel(e)}}class km{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(e){this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){lt("Abstract method `read` called")}cancel(e){lt("Abstract method `cancel` called")}}class Rm{_stream=null;constructor(e,t,n){this._stream=e}async read(){lt("Abstract method `read` called")}cancel(e){lt("Abstract method `cancel` called")}}function X1(i){return i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}class Mq extends Cm{_progressiveDone=!1;_queuedChunks=[];constructor(e){super(e,Lq,jq);const{pdfDataRangeTransport:t}=e,{initialData:n,progressiveDone:s}=t;if(n?.length>0){const a=X1(n);this._queuedChunks.push(a)}this._progressiveDone=s,t.addRangeListener((a,o)=>{this.#e(a,o)}),t.addProgressListener((a,o)=>{o!==void 0&&this._fullReader?.onProgress?.({loaded:a,total:o})}),t.addProgressiveReadListener(a=>{this.#e(void 0,a)}),t.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),t.transportReady()}#e(e,t){const n=X1(t);if(e===void 0)this._fullReader?this._fullReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.keys().find(a=>a._begin===e);ot(s,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),s._enqueue(n)}}getFullReader(){const e=super.getFullReader();return this._queuedChunks=null,e}getRangeReader(e,t){const n=super.getRangeReader(e,t);return n&&(n.onDone=()=>this._rangeReaders.delete(n),this._source.pdfDataRangeTransport.requestDataRange(e,t)),n}cancelAllRequests(e){super.cancelAllRequests(e),this._source.pdfDataRangeTransport.abort()}}class Lq extends km{_done=!1;_queuedChunks=null;_requests=[];constructor(e){super(e);const{pdfDataRangeTransport:t,disableRange:n,disableStream:s}=e._source,{length:a,contentDispositionFilename:o}=t;this._queuedChunks=e._queuedChunks||[];for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._done=e._progressiveDone,this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!n,o0(o)&&(this._filename=o),this._headersCapability.resolve()}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class jq extends Rm{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(e,t,n){super(e,t,n),this._begin=t}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function Bq(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let p=c(t);return p=unescape(p),p=h(p),p=d(p),a(p)}if(t=o(i),t){const p=d(t);return a(p)}if(t=n("filename","i").exec(i),t){t=t[1];let p=c(t);return p=d(p),a(p)}function n(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function s(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(p,{fatal:!0}),_=Sm(m);m=v.decode(_),e=!1}catch{}}return m}function a(p){return e&&/[\x80-\xff]/.test(p)&&(p=s("utf-8",p),e&&(p=s("iso-8859-1",p))),p}function o(p){const m=[];let v;const _=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=_.exec(p))!==null;){let[,A,T,x]=v;if(A=parseInt(A,10),A in m){if(A===0)break;continue}m[A]=[T,x]}const S=[];for(let A=0;A<m.length&&A in m;++A){let[T,x]=m[A];x=c(x),T&&(x=unescape(x),A===0&&(x=h(x))),S.push(x)}return S.join("")}function c(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let v=0;v<m.length;++v){const _=m[v].indexOf('"');_!==-1&&(m[v]=m[v].slice(0,_),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const v=p.slice(0,m),S=p.slice(m+1).replace(/^[^']*'/,"");return s(v,S)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,_,S){if(_==="q"||_==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,T){return String.fromCharCode(parseInt(T,16))}),s(v,S);try{S=atob(S)}catch{}return s(v,S)})}return""}function kI(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function Im(i){return URL.parse(i)?.origin??null}function RI({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(i.get("Content-Length"),10);return!Number.isInteger(a)||(s.suggestedLength=a,a<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function II(i){const e=i.get("Content-Disposition");if(e){let t=Bq(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(o0(t))return t}return null}function Dm(i,e){return new $p(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function DI(i,e){if(i!==e)throw new Error(`Expected range response-origin "${i}" to match "${e}".`)}function OI(i,e,t,n){return fetch(i,{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"})}function PI(i,e){if(i!==200&&i!==206)throw Dm(i,e)}function NI(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Ne(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class Uq extends Cm{_responseOrigin=null;constructor(e){super(e,Fq,zq),this.isHttp=/^https?:/i.test(e.url),this.headers=kI(this.isHttp,e.httpHeaders)}}class Fq extends km{_abortController=new AbortController;_reader=null;constructor(e){super(e);const{disableRange:t,disableStream:n,length:s,rangeChunkSize:a,url:o,withCredentials:c}=e._source;this._contentLength=s,this._isStreamingSupported=!n,this._isRangeSupported=!t;const h=new Headers(e.headers);OI(o,h,c,this._abortController).then(d=>{e._responseOrigin=Im(d.url),PI(d.status,o),this._reader=d.body.getReader();const p=d.headers,{allowRangeRequests:m,suggestedLength:v}=RI({responseHeaders:p,isHttp:e.isHttp,rangeChunkSize:a,disableRange:t});this._isRangeSupported=m,this._contentLength=v||this._contentLength,this._filename=II(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new za("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:NI(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class zq extends Rm{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(e,t,n){super(e,t,n);const{url:s,withCredentials:a}=e._source,o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`),OI(s,o,a,this._abortController).then(c=>{const h=Im(c.url);DI(h,e._responseOrigin),PI(c.status,s),this._reader=c.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:{value:NI(e),done:!1}}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const wv=200,Q1=206;function Vq(i){return typeof i!="string"?i:Sm(i).buffer}class qq extends Cm{#e=new WeakMap;_responseOrigin=null;constructor(e){super(e,Hq,$q),this.url=e.url,this.isHttp=/^https?:/i.test(this.url),this.headers=kI(this.isHttp,e.httpHeaders)}_request(e){const t=new XMLHttpRequest,n={validateStatus:null,onHeadersReceived:e.onHeadersReceived,onDone:e.onDone,onError:e.onError,onProgress:e.onProgress};this.#e.set(t,n),t.open("GET",this.url),t.withCredentials=this._source.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.validateStatus=s=>s===Q1||s===wv):n.validateStatus=s=>s===wv,t.responseType="arraybuffer",ot(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>e.onError(t.status),t.onreadystatechange=this.#i.bind(this,t),t.onprogress=this.#t.bind(this,t),t.send(null),t}#t(e,t){this.#e.get(e)?.onProgress?.(t)}#i(e,t){const n=this.#e.get(e);if(!n||(e.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),e.readyState!==4)||!this.#e.has(e))return;if(this.#e.delete(e),e.status===0&&this.isHttp){n.onError(e.status);return}const s=e.status||wv;if(!n.validateStatus(s)){n.onError(e.status);return}const a=Vq(e.response);if(s===Q1){const o=e.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(o)?n.onDone(a):(Ne('Missing or invalid "Content-Range" header.'),n.onError(0))}else a?n.onDone(a):n.onError(e.status)}_abortRequest(e){this.#e.has(e)&&(this.#e.delete(e),e.abort())}getRangeReader(e,t){const n=super.getRangeReader(e,t);return n&&(n.onClosed=()=>this._rangeReaders.delete(n)),n}}class Hq extends km{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(e){super(e);const{length:t}=e._source;this._contentLength=t,this._fullRequestXhr=e._request({onHeadersReceived:this.#e.bind(this),onDone:this.#t.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#e(){const e=this._stream,{disableRange:t,rangeChunkSize:n}=e._source,s=this._fullRequestXhr;e._responseOrigin=Im(s.responseURL);const a=s.getAllResponseHeaders(),o=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[p,...m]=d.split(": ");return[p,m.join(": ")]}):[]),{allowRangeRequests:c,suggestedLength:h}=RI({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:n,disableRange:t});c&&(this._isRangeSupported=!0),this._contentLength=h||this._contentLength,this._filename=II(o),this._isRangeSupported&&e._abortRequest(s),this._headersCapability.resolve()}#t(e){if(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._cachedChunks.push(e),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}#i(e){this._storedError=Dm(e,this._stream.url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class $q extends Rm{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(e,t,n){super(e,t,n),this._requestXhr=e._request({begin:t,end:n,onHeadersReceived:this.#e.bind(this),onDone:this.#t.bind(this),onError:this.#i.bind(this),onProgress:null})}#e(){const e=Im(this._requestXhr?.responseURL);try{DI(e,this._stream._responseOrigin)}catch(t){this._storedError=t,this.#i(0)}}#t(e){this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(e){this._storedError??=Dm(e,this._stream.url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const Gq=/^[a-z][a-z0-9\-+.]+:/i;function Wq(i){if(Gq.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}function MI(i){const{Readable:e}=process.getBuiltinModule("stream");return typeof e.toWeb=="function"?e.toWeb(i):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(i)}function LI(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Ne(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class Kq extends Cm{constructor(e){super(e,Yq,Xq),this.url=Wq(e.url),ot(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class Yq extends km{_reader=null;constructor(e){super(e);const{disableRange:t,disableStream:n,length:s,rangeChunkSize:a}=e._source;this._contentLength=s,this._isStreamingSupported=!n,this._isRangeSupported=!t;const o=e.url,c=process.getBuiltinModule("fs");c.promises.lstat(o).then(h=>{const d=c.createReadStream(o),p=MI(d);this._reader=p.getReader();const{size:m}=h;m<=2*a&&(this._isRangeSupported=!1),this._contentLength=m,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new za("Streaming is disabled.")),this._headersCapability.resolve()}).catch(h=>{h.code==="ENOENT"&&(h=Dm(0,o.href)),this._headersCapability.reject(h)})}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:LI(e),done:!1})}cancel(e){this._reader?.cancel(e)}}class Xq extends Rm{_readCapability=Promise.withResolvers();_reader=null;constructor(e,t,n){super(e,t,n);const s=e.url,a=process.getBuiltinModule("fs");try{const o=a.createReadStream(s,{start:t,end:n-1}),c=MI(o);this._reader=c.getReader(),this._readCapability.resolve()}catch(o){this._readCapability.reject(o)}}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:{value:LI(e),done:!1}}cancel(e){this._reader?.cancel(e)}}const Ju=Symbol("INITIAL_DATA");class jI{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Ju}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===Ju)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==Ju}delete(e){const t=this.#e[e];return!t||t.data===Ju?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Ju&&(yield[e,t])}}}const Qq=1e5,J1=30;class yi{#e=Promise.withResolvers();#t=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#b=new Map;static#v=new Map;static#T=new WeakMap;static#E=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#m=e;else if(typeof e=="object")this.#m=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#h=n.scale*tr.pixelRatio,this.#d=n.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:a,pageX:o,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-o,c+a],this.#o=s,this.#s=a,yi.#R(),t.style.setProperty("--min-font-size",yi.#E),qo(t,n),this.#e.promise.finally(()=>{yi.#w.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=dn.platform;return Me(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#f,t.styles),this.#C(t.items),e()},this.#e.reject)};return this.#c=this.#m.getReader(),yi.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*tr.pixelRatio,s=e.rotation;if(s!==this.#d&&(t?.(),this.#d=s,qo(this.#l,{rotation:s})),n!==this.#h){t?.(),this.#h=n;const a={div:null,properties:null,ctx:yi.#I(this.#r)};for(const o of this.#u)a.properties=this.#p.get(o),a.div=o,this.#S(a)}}cancel(){const e=new za("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(e){if(this.#i)return;this.#a.ctx??=yi.#I(this.#r);const t=this.#u,n=this.#g;for(const s of e){if(t.length>Qq){Ne("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const a=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id&&this.#t.setAttribute("id",`${s.id}`),s.tag==="Artifact"&&(this.#t.ariaHidden=!0),a.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#_(s)}}#_(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const s=pe.transform(this.#y,e.transform);let a=Math.atan2(s[1],s[0]);const o=this.#f[e.fontName];o.vertical&&(a+=Math.PI/2);let c=this.#n&&o.fontSubstitution||o.fontFamily;c=yi.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),d=h*yi.#j(c,o,this.#r);let p,m;a===0?(p=s[4],m=s[5]-d):(p=s[4]+d*Math.sin(a),m=s[5]-d*Math.cos(a));const v=t.style;v.left=`${(100*p/this.#o).toFixed(2)}%`,v.top=`${(100*m/this.#s).toFixed(2)}%`,v.setProperty("--font-height",`${h.toFixed(2)}px`),v.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),a!==0&&(n.angle=a*(180/Math.PI));let _=!1;if(e.str.length>1)_=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const S=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);S!==A&&Math.max(S,A)/Math.min(S,A)>1.5&&(_=!0)}if(_&&(n.canvasWidth=o.vertical?e.height:e.width),this.#p.set(t,n),this.#a.div=t,this.#a.properties=n,this.#S(this.#a),n.hasText&&this.#t.append(t),n.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#t.append(S)}}#S(e){const{div:t,properties:n,ctx:s}=e,{style:a}=t;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:o}=a,{canvasWidth:c,fontSize:h}=n;yi.#k(s,h*this.#h,o);const{width:d}=s.measureText(t.textContent);d>0&&a.setProperty("--scale-x",c*this.#h/d)}n.angle!==0&&a.setProperty("--rotate",`${n.angle}deg`)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#I(e=null){let t=this.#v.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#T.set(t,{size:0,family:""})}return t}static#k(e,t,n){const s=this.#T.get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)}static#R(){if(this.#E!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#E=e.getBoundingClientRect().height,e.remove()}static#j(e,t,n){const s=this.#b.get(e);if(s)return s;const a=this.#I(n);a.canvas.width=a.canvas.height=J1,this.#k(a,J1,e);const o=a.measureText(""),c=o.fontBoundingBoxAscent,h=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let d=.8;return c?d=c/(c+h):(dn.platform.isFirefox&&Ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),this.#b.set(e,d),d}}const Jq=100;function BI(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new p0,{docId:t}=e,n=i.url?aq(i.url):null,s=i.data?oq(i.data):null,a=i.httpHeaders||null,o=i.withCredentials===!0,c=i.password??null,h=i.range instanceof UI?i.range:null,d=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let p=i.worker instanceof Bh?i.worker:null;const m=i.verbosity,v=typeof i.docBaseUrl=="string"&&!Tm(i.docBaseUrl)?i.docBaseUrl:null,_=Xf(i.cMapUrl),S=i.cMapPacked!==!1,A=i.CMapReaderFactory||($n?mq:L1),T=Xf(i.iccUrl),x=Xf(i.standardFontDataUrl),D=i.StandardFontDataFactory||($n?gq:j1),I=Xf(i.wasmUrl),U=i.WasmFactory||($n?yq:B1),z=i.stopAtErrors!==!0,F=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,R=i.isEvalSupported!==!1,O=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!$n,P=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!$n&&(dn.platform.isFirefox||!globalThis.chrome),j=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,L=typeof i.disableFontFace=="boolean"?i.disableFontFace:$n,V=i.fontExtraProperties===!0,B=i.enableXfa===!0,de=i.ownerDocument||globalThis.document,Ce=i.disableRange===!0,G=i.disableStream===!0,W=i.disableAutoFetch===!0,ae=i.pdfBug===!0,we=i.CanvasFactory||($n?pq:hq),Oe=i.FilterFactory||($n?fq:dq),H=i.enableHWA===!0,ee=i.useWasm!==!1,le=h?h.length:i.length??NaN,he=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!$n&&!L,fe=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(A===L1&&D===j1&&U===B1&&_&&x&&I&&lh(_,document.baseURI)&&lh(x,document.baseURI)&&lh(I,document.baseURI)),ke=null;P5(m);const Ae={canvasFactory:new we({ownerDocument:de,enableHWA:H}),filterFactory:new Oe({docId:t,ownerDocument:de}),cMapReaderFactory:fe?null:new A({baseUrl:_,isCompressed:S}),standardFontDataFactory:fe?null:new D({baseUrl:x}),wasmFactory:fe?null:new U({baseUrl:I})};p||(p=Bh.create({verbosity:m,port:wc.workerPort}),e._worker=p);const _t={docId:t,apiVersion:"5.4.624",data:s,password:c,disableAutoFetch:W,rangeChunkSize:d,length:le,docBaseUrl:v,enableXfa:B,evaluatorOptions:{maxImageSize:F,disableFontFace:L,ignoreErrors:z,isEvalSupported:R,isOffscreenCanvasSupported:O,isImageDecoderSupported:P,canvasMaxAreaInBytes:j,fontExtraProperties:V,useSystemFonts:he,useWasm:ee,useWorkerFetch:fe,cMapUrl:_,iccUrl:T,standardFontDataUrl:x,wasmUrl:I}},ct={ownerDocument:de,pdfBug:ae,styleElement:ke,enableHWA:H,loadingParams:{disableAutoFetch:W,enableXfa:B}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const sr=p.messageHandler.sendWithPromise("GetDocRequest",_t,s?[s.buffer]:null);let ms;if(h)ms=new Mq({pdfDataRangeTransport:h,disableRange:Ce,disableStream:G});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const gs=lh(n)?Uq:$n?Kq:qq;ms=new gs({url:n,length:le,httpHeaders:a,withCredentials:o,rangeChunkSize:d,disableRange:Ce,disableStream:G})}return sr.then(gs=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const rr=new ch(t,gs,p.port),Ei=new tH(rr,e,ms,ct,Ae);e._transport=Ei,rr.send("Ready",null)})}).catch(e._capability.reject),e}class p0{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${p0.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class UI{#e=Promise.withResolvers();#t=[];#i=[];#n=[];#r=[];constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){this.#r.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#i.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#r)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#n)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#i)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){lt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Zq{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Me(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class eH{#e=!1;#t=rt.instance;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new R1:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new jI,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}={}){return new td({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Me(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:a=xa.ENABLE,transform:o=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:_=!1,operationsFilter:S=null}){this._stats?.time("Overall");const A=this._transport.getRenderingIntent(s,a,m,v),{renderingIntent:T,cacheKey:x}=A;this.#e=!1,h||=this._transport.getOptionalContentConfig(T);let D=this._intentStates.get(x);D||(D=Object.create(null),this._intentStates.set(x,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const I=!!(T&gi.PRINT);D.displayReadyCapability||(D.displayReadyCapability=Promise.withResolvers(),D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(A));const U=!!(this._pdfBug&&globalThis.StepperManager?.enabled),z=!this.recordedBBoxes&&(_||U),F=P=>{if(D.renderTasks.delete(R),z){const j=R.gfx?.dependencyTracker.take();j&&(R.stepper&&R.stepper.setOperatorBBoxes(j,R.gfx.dependencyTracker.takeDebugMetadata()),_&&(this.recordedBBoxes=j))}I&&(this.#e=!0),this.#i(),P?(R.capability.reject(P),this._abortOperatorList({intentState:D,reason:P instanceof Error?P:new Error(P)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new oc({callback:F,params:{canvas:t,canvasContext:e,dependencyTracker:z?new bq(t,D.operatorList.length,U):null,viewport:n,transform:o,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!I,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:S});(D.renderTasks||=new Set).add(R);const O=R.task;return Promise.all([D.displayReadyCapability.promise,h]).then(([P,j])=>{if(this.destroyed){F();return}if(this._stats?.time("Rendering"),!(j.renderingIntent&T))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:P,optionalContentConfig:j}),R.operatorListChanged()}).catch(F),O}getOperatorList({intent:e="display",annotationMode:t=xa.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#t.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>jh.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function a(){o.read().then(function({value:h,done:d}){if(d){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),a()},s)}const o=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#i();return e&&t&&(this._stats&&=new R1),t}#i(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:a,transfer:o}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#t.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:s},o).getReader(),d=this._intentStates.get(t);d.streamReader=h;const p=()=>{h.read().then(({value:m,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),p())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#i()}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof a0){let s=Jq;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new za(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,a]of this._intentStates)if(a===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Ca,os,kr,No,Kp,Mo,Lo,Gn,yp,FI,zI,uh,Ac,vp;const xt=class xt{constructor({name:e=null,port:t=null,verbosity:n=N5()}={}){Bs(this,Gn);Bs(this,Ca,Promise.withResolvers());Bs(this,os,null);Bs(this,kr,null);Bs(this,No,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(Tt(xt,Lo).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Tt(xt,Lo).set(t,this),Us(this,Gn,FI).call(this,t)}else Us(this,Gn,zI).call(this)}get promise(){return Tt(this,Ca).promise}get port(){return Tt(this,kr)}get messageHandler(){return Tt(this,os)}destroy(){this.destroyed=!0,Tt(this,No)?.terminate(),ti(this,No,null),Tt(xt,Lo).delete(Tt(this,kr)),ti(this,kr,null),Tt(this,os)?.destroy(),ti(this,os,null)}static create(e){const t=Tt(this,Lo).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new xt(e)}static get workerSrc(){if(wc.workerSrc)return wc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Me(this,"_setupFakeWorkerGlobal",(async()=>Tt(this,Ac,vp)?Tt(this,Ac,vp):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ca=new WeakMap,os=new WeakMap,kr=new WeakMap,No=new WeakMap,Kp=new WeakMap,Mo=new WeakMap,Lo=new WeakMap,Gn=new WeakSet,yp=function(){Tt(this,Ca).resolve(),Tt(this,os).send("configure",{verbosity:this.verbosity})},FI=function(e){ti(this,kr,e),ti(this,os,new ch("main","worker",e)),Tt(this,os).on("ready",()=>{}),Us(this,Gn,yp).call(this)},zI=function(){if(Tt(xt,Mo)||Tt(xt,Ac,vp)){Us(this,Gn,uh).call(this);return}let{workerSrc:e}=xt;try{xt._isSameOrigin(window.location,e)||(e=xt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new ch("main","worker",t),s=()=>{a.abort(),n.destroy(),t.terminate(),this.destroyed?Tt(this,Ca).reject(new Error("Worker was destroyed")):Us(this,Gn,uh).call(this)},a=new AbortController;t.addEventListener("error",()=>{Tt(this,No)||s()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){s();return}ti(this,os,n),ti(this,kr,t),ti(this,No,t),Us(this,Gn,yp).call(this)}),n.on("ready",c=>{if(a.abort(),this.destroyed){s();return}try{o()}catch{Us(this,Gn,uh).call(this)}});const o=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};o();return}catch{Em("The worker has been disabled.")}Us(this,Gn,uh).call(this)},uh=function(){Tt(xt,Mo)||(Ne("Setting up fake worker."),ti(xt,Mo,!0)),xt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Tt(this,Ca).reject(new Error("Worker was destroyed"));return}const t=new uq;ti(this,kr,t);const n=`fake${VE(xt,Kp)._++}`,s=new ch(n+"_worker",n,t);e.setup(s,t),ti(this,os,new ch(n,n+"_worker",t)),Us(this,Gn,yp).call(this)}).catch(e=>{Tt(this,Ca).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Ac=new WeakSet,vp=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Bs(xt,Ac),Bs(xt,Kp,0),Bs(xt,Mo,!1),Bs(xt,Lo,new WeakMap),$n&&(ti(xt,Mo,!0),wc.workerSrc||="./pdf.worker.mjs"),xt._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},xt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},xt.fromPort=e=>{if(G5("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return xt.create(e)};let Bh=xt;class tH{downloadInfoCapability=Promise.withResolvers();#e=null;#t=new Map;#i=null;#n=new Map;#r=new Map;#a=new Map;#s=null;#o=rt.instance;constructor(e,t,n,s,a){this.messageHandler=e,this.loadingTask=t,this.#i=n,this.commonObjs=new jI,this.fontLoader=new iq({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.enableHWA=s.enableHWA,this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const e=new Map,t=new Map;for(let n=0,s=this.#o.pagesNumber;n<s;n++){const a=this.#o.getPrevPageNumber(n+1)-1,o=this.#n.get(a);o&&e.set(n,o);const c=this.#r.get(a);c&&t.set(n,c)}this.#n=e,this.#r=t}#l(e,t=null){const n=this.#t.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#t.set(e,s),s}#d({loaded:e,total:t}){this.loadingTask.onProgress?.({loaded:e,total:t,percent:In(Math.round(e/t*100),0,100)})}get annotationStorage(){return Me(this,"annotationStorage",new u0)}getRenderingIntent(e,t=xa.ENABLE,n=null,s=!1,a=!1){let o=gi.DISPLAY,c=$b;switch(e){case"any":o=gi.ANY;break;case"display":break;case"print":o=gi.PRINT;break;default:Ne(`getRenderingIntent - invalid intent: ${e}`)}const h=o&gi.PRINT&&n instanceof AI?n:this.annotationStorage;switch(t){case xa.DISABLE:o+=gi.ANNOTATIONS_DISABLE;break;case xa.ENABLE:break;case xa.ENABLE_FORMS:o+=gi.ANNOTATIONS_FORMS;break;case xa.ENABLE_STORAGE:o+=gi.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Ne(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=gi.IS_EDITING),a&&(o+=gi.OPLIST);const{ids:d,hash:p}=h.modifiedIds,m=[o,c.hash,p];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#n.values())e.push(n._destroy());this.#n.clear(),this.#r.clear(),this.#a.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),yi.cleanup(),this.#i?.cancelAllRequests(new za("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{ot(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#e=this.#i.getFullReader(),this.#e.onProgress=a=>this.#d(a),s.onPull=()=>{this.#e.read().then(function({value:a,done:o}){if(o){s.close();return}ot(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{this.#e.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async n=>{await this.#e.headersReady;const{isStreamingSupported:s,isRangeSupported:a,contentLength:o}=this.#e;return s&&a&&(this.#e.onProgress=null),{isStreamingSupported:s,isRangeSupported:a,contentLength:o}}),e.on("GetRangeReader",(n,s)=>{ot(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const a=this.#i.getRangeReader(n.begin,n.end);if(!a){s.close();return}s.onPull=()=>{a.read().then(function({value:o,done:c}){if(c){s.close();return}ot(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{a.cancel(o),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this.#o.pagesNumber=n.numPages,this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Zq(n,this))}),e.on("DocException",n=>{t._capability.reject(ni(n))}),e.on("PasswordRequest",n=>{this.#s=Promise.withResolvers();try{if(!t.onPassword)throw ni(n);const s=a=>{a instanceof Error?this.#s.reject(a):this.#s.resolve({password:a})};t.onPassword(s,n.code)}catch(s){this.#s.reject(s)}return this.#s.promise}),e.on("DataLoaded",n=>{this.#d({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#n.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in a){const m=a.error;Ne(`Error during font loading: ${m}`),this.commonObjs.resolve(n,m);break}const o=new yt(a),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(m,v)=>globalThis.FontInspector.fontAdded(m,v):null,h=new sq(o,c,a.extra,a.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:d}=a;ot(d,"The imageRef must be defined.");for(const m of this.#n.values())for(const[,v]of m.objs)if(v?.ref===d)return v.dataLen?(this.commonObjs.resolve(n,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new rq(a));break;case"Image":this.commonObjs.resolve(n,a);break;case"Pattern":const p=new gn(a);this.commonObjs.resolve(n,p.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,a,o])=>{if(this.destroyed)return;const c=this.#n.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",n=>{this.destroyed||this.#d(n)}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this.#e?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#o.getPageId(e)-1,s=this.#r.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#a.set(o.refStr,n);const c=new eH(t,o,this,this._params.pdfBug);return this.#n.set(t,c),c});return this.#r.set(t,a),a}async getPageIndex(e){if(!Gb(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return this.#o.getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(e+1)-1,intent:t})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#l("GetOptionalContentConfig").then(t=>new Nq(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#t.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new Oq(s[1]):null,contentDispositionFilename:this.#e?.filename??null,contentLength:this.#e?.contentLength??null,hasStructTree:s[2]}));return this.#t.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#n.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),yi.cleanup()}}cachedPageNumber(e){if(!Gb(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`,n=this.#a.get(t);return n>=0?this.#o.getPageNumber(n+1):null}}class nH{_internalRenderTask=null;onContinue=null;onError=null;constructor(e){this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(e=0){this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&t?.size>0}}class oc{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:a,operatorList:o,pageIndex:c,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:_=!1,operationsFilter:S=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new nH(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=_,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(oc.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");oc.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:a,dependencyTracker:o}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new _c(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),oc.#t.delete(this._canvas),e||=new a0(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),oc.#t.delete(this._canvas),this.callback())))}}const iH="5.4.624",sH="384c6208b";class Ui{#e=null;#t=null;#i;#n=null;#r=!1;#a=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Me(this,"_keyboardManager",new id([[["Escape","mac+Escape"],Ui.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ui.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ui.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ui.prototype._moveToPrevious],[["Home","mac+Home"],Ui.prototype._moveToBeginning],[["End","mac+End"],Ui.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#a=!1,this.#s=e):this.#a=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#i=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ui.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#s&&(e.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#g.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,e.append(n),e}renderMainDropdown(){const e=this.#n=this.#h();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#h(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Hi,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(e.id=`${this.#s.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=n,a.setAttribute("data-l10n-id",Ui.#d[n]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=s,a.ariaSelected=s===this.#i,a.addEventListener("click",this.#f.bind(this,s),{signal:t}),e.append(a)}return e.addEventListener("keydown",this.#g.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ye.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#m(e);return}if(e.target===this.#e){this.#n.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#m(e);return}this.#n.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#m(e);return}this.#n.lastElementChild?.focus()}#g(e){Ui._keyboardManager.exec(this,e)}#m(e){if(this.#p){this.hideDropdown();return}if(this.#r=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#h();this.#e.append(t)}#u(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class Uh{#e=null;#t=null;#i=null;static#n=null;constructor(e){this.#t=e,this.#i=e._uiManager,Uh.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:n}=this.#t,s=this.#e=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Uh.#n[e]),s.addEventListener("input",()=>{this.#i.updateParams(t,s.value)},{signal:this.#i._signal}),s}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function Z1(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Zu(i){return Math.max(0,Math.min(255,255*i))}class ex{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Zu(e),[e,e,e]}static G_HTML([e]){const t=Z1(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Zu)}static RGB_HTML(e){return`#${e.map(Z1).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[Zu(1-Math.min(1,e+s)),Zu(1-Math.min(1,n+s)),Zu(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,a=1-t,o=1-n,c=Math.min(s,a,o);return["CMYK",s,a,o,c]}}class rH{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){lt("Abstract method `_createSVG` called.")}}class Wp extends rH{_createSVG(e){return document.createElementNS(Tr,e)}}const aH=9,Ho=new WeakSet,oH=new Date().getTimezoneOffset()*60*1e3;class Av{static create(e){switch(e.data.annotationType){case tn.LINK:return new m0(e);case tn.TEXT:return new cH(e);case tn.WIDGET:switch(e.data.fieldType){case"Tx":return new uH(e);case"Btn":return e.data.radioButton?new VI(e):e.data.checkBox?new dH(e):new fH(e);case"Ch":return new pH(e);case"Sig":return new hH(e)}return new Jo(e);case tn.POPUP:return new Yb(e);case tn.FREETEXT:return new qI(e);case tn.LINE:return new gH(e);case tn.SQUARE:return new yH(e);case tn.CIRCLE:return new vH(e);case tn.POLYLINE:return new HI(e);case tn.CARET:return new _H(e);case tn.INK:return new g0(e);case tn.POLYGON:return new bH(e);case tn.HIGHLIGHT:return new $I(e);case tn.UNDERLINE:return new wH(e);case tn.SQUIGGLY:return new AH(e);case tn.STRIKEOUT:return new EH(e);case tn.STAMP:return new GI(e);case tn.FILEATTACHMENT:return new SH(e);default:return new Pt(e)}}}class Pt{#e=null;#t=!1;#i=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Pt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let a=-1/0,o=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>o?(o=t[c+1],a=t[c+2]):t[c+1]===o&&(a=Math.max(a,t[c+2]));return[a,o]}if(n?.length>=1){for(const c of n)for(let h=0,d=c.length;h<d;h+=2)c[h+1]>o?(o=c[h+1],a=c[h]):c[h+1]===o&&(a=Math.max(a,c[h]));if(a!==1/0)return[a,o]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-a)/n,e[1]=100*(e[1]-o)/s,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${Mh}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${Mh}${t.id}`,{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#n(t);let s=this.#i?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#i.popup),s&&(s.updateEdited(e),n?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#i?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(o-e[3]+h)/o}%`,s===0?(t.width=`${100*(e[2]-e[0])/a}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),!(this instanceof Jo)&&!(this instanceof m0)&&(a.tabIndex=0);const{style:o}=a;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof Yb){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,a),a}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,T=t.borderStyle.verticalCornerRadius;if(A>0||T>0){const D=`calc(${A}px * var(--total-scale-factor)) / calc(${T}px * var(--total-scale-factor))`;o.borderRadius=D}else if(this instanceof VI){const D=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;o.borderRadius=D}switch(t.borderStyle.style){case ec.SOLID:o.borderStyle="solid";break;case ec.DASHED:o.borderStyle="dashed";break;case ec.BEVELED:Ne("Unimplemented border style: beveled");break;case ec.INSET:Ne("Unimplemented border style: inset");break;case ec.UNDERLINE:o.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(this.#t=!0,o.borderColor=pe.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):o.borderWidth=0}const d=pe.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:m,pageX:v,pageY:_}=s.rawDims;o.left=`${100*(d[0]-v)/p}%`,o.top=`${100*(d[1]-_)/m}%`;const{rotation:S}=t;return t.hasOwnCanvas||S===0?(o.width=`${100*c/p}%`,o.height=`${100*h/m}%`):this.setRotation(S,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:a,height:o}=this;e%180!==0&&([a,o]=[o,a]),t.style.width=`${100*a/n}%`,t.style.height=`${100*o/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const a=s.detail[t],o=a[0],c=a.slice(1);s.target.style[n]=ex[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:ex[`${o}_rgb`](c)})};return Me(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,a]of Object.entries(t)){const o=n[s];if(o){const c={detail:{[s]:a},target:e};o(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,a]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,T,x,D]=e.subarray(2,6);if(s===A&&a===T&&t===x&&n===D)return}const{style:o}=this.container;let c;if(this.#t){const{borderColor:A,borderWidth:T}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const h=s-t,d=a-n,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=p.createElement("defs");m.append(v);const _=p.createElement("clipPath"),S=`clippath_${this.data.id}`;_.setAttribute("id",S),_.setAttribute("clipPathUnits","objectBoundingBox"),v.append(_);for(let A=2,T=e.length;A<T;A+=8){const x=e[A],D=e[A+1],I=e[A+2],U=e[A+3],z=p.createElement("rect"),F=(I-t)/h,R=(a-D)/d,O=(x-I)/h,P=(D-U)/d;z.setAttribute("x",F),z.setAttribute("y",R),z.setAttribute("width",O),z.setAttribute("height",P),_.append(z),c?.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${R}" width="${O}" height="${P}"/>`)}this.#t&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${S})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate),this.#i=new Yb({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){lt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:a,id:o,exportValues:c}of s){if(a===-1||o===t)continue;const h=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!Ho.has(d)){Ne(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:h,domElement:d})}return n}for(const s of document.getElementsByName(e)){const{exportValue:a}=s,o=s.getAttribute("data-element-id");o!==t&&Ho.has(s)&&n.push({id:o,exportValue:a,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class lH extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class m0 extends Pt{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(this.#i(n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=n,this.container.append(n)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",s=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#i(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const a=n.get(s);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:a,include:o}=t,c=[];if(s.length!==0||a.length!==0){const p=new Set(a);for(const m of s){const v=this._fieldObjects[m]||[];for(const{id:_}of v)p.add(_)}for(const m of Object.values(this._fieldObjects))for(const v of m)p.has(v.id)===o&&c.push(v)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,d=[];for(const p of c){const{id:m}=p;switch(d.push(m),p.type){case"text":{const _=p.defaultValue||"";h.setValue(m,{value:_});break}case"checkbox":case"radiobutton":{const _=p.defaultValue===p.exportValues;h.setValue(m,{value:_});break}case"combobox":case"listbox":{const _=p.defaultValue||"";h.setValue(m,{value:_});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!Ho.has(v)){Ne(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class cH extends Pt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Jo extends Pt{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return dn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,a){n.includes("mouse")?e.addEventListener(n,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(o)}})})}_setEventListeners(e,t,n,s){for(const[a,o]of n)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,a,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":pe.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||aH,a=e.style;let o;const c=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(d/(mv*s))||1,m=d/p;o=Math.min(s,h(m/mv))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(s,h(d/mv))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=pe.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class uH extends Jo{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const a=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),a.setValue(o.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let a=s.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Ho.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:m}=this.data,v=!!p&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",S=>{e.setValue(t,{value:S.target.value}),this.setPropertyOnSiblings(n,"value",S.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",S=>{const A=this.data.defaultFieldValue??"";n.value=h.userValue=A,h.formattedValue=null});let _=S=>{const{formattedValue:A}=h;A!=null&&(S.target.value=A),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",A=>{if(h.focused)return;const{target:T}=A;if(v&&(T.type=p,m&&(T.step=m)),h.userValue){const x=h.userValue;if(v)if(p==="time"){const D=new Date(x),I=[D.getHours(),D.getMinutes(),D.getSeconds()];T.value=I.map(U=>U.toString().padStart(2,"0")).join(":")}else T.value=new Date(x-oH).toISOString().split(p==="date"?"T":".",1)[0];else T.value=x}h.lastCommittedValue=T.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const T={value(x){h.userValue=x.detail.value??"",v||e.setValue(t,{value:h.userValue.toString()}),x.target.value=h.userValue},formattedValue(x){const{formattedValue:D}=x.detail;h.formattedValue=D,D!=null&&x.target!==document.activeElement&&(x.target.value=D);const I={formattedValue:D};v&&(I.value=D),e.setValue(t,I)},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{const{charLimit:D}=x.detail,{target:I}=x;if(D===0){I.removeAttribute("maxLength");return}I.setAttribute("maxLength",D);let U=h.userValue;!U||U.length<=D||(U=U.slice(0,D),I.value=h.userValue=U,e.setValue(t,{value:U}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:U,willCommit:!0,commitKey:1,selStart:I.selectionStart,selEnd:I.selectionEnd}}))}};this._dispatchEventFromSandbox(T,A)}),n.addEventListener("keydown",A=>{h.commitKey=1;let T=-1;if(A.key==="Escape"?T=0:A.key==="Enter"&&!this.data.multiLine?T=2:A.key==="Tab"&&(h.commitKey=3),T===-1)return;const{value:x}=A.target;h.lastCommittedValue!==x&&(h.lastCommittedValue=x,h.userValue=x,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:T,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const S=_;_=null,n.addEventListener("blur",A=>{if(!h.focused||!A.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:T}=A;let{value:x}=T;if(v){if(x&&p==="time"){const D=x.split(":").map(I=>parseInt(I,10));x=new Date(2e3,0,1,D[0],D[1],D[2]||0).valueOf(),T.step=""}else x.includes("T")||(x=`${x}T00:00`),x=new Date(x).valueOf();T.type="text"}h.userValue=x,h.lastCommittedValue!==x&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:h.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}),S(A)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",A=>{h.lastCommittedValue=null;const{data:T,target:x}=A,{value:D,selectionStart:I,selectionEnd:U}=x;let z=I,F=U;switch(A.inputType){case"deleteWordBackward":{const R=D.substring(0,I).match(/\w*[^\w]*$/);R&&(z-=R[0].length);break}case"deleteWordForward":{const R=D.substring(I).match(/^[^\w]*\w*/);R&&(F+=R[0].length);break}case"deleteContentBackward":I===U&&(z-=1);break;case"deleteContentForward":I===U&&(F+=1);break}A.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:D,change:T||"",willCommit:!1,selStart:z,selEnd:F}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(_&&n.addEventListener("blur",_),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing=`calc(${A}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class hH extends Jo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class dH extends Jo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Ho.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,s&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=0,a.addEventListener("change",o=>{const{name:c,checked:h}=o.target;for(const d of this._getElementsByName(c,n)){const p=h&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=p),e.setValue(d.id,{value:p})}e.setValue(n,{value:h})}),a.addEventListener("resetform",o=>{const c=t.defaultFieldValue||"Off";o.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class VI extends Jo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});const a=document.createElement("input");if(Ho.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,s&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",o=>{const{name:c,checked:h}=o.target;for(const d of this._getElementsByName(c,n))e.setValue(d.id,{value:!1});e.setValue(n,{value:h})}),a.addEventListener("resetform",o=>{const c=t.defaultFieldValue;o.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const h={value:d=>{const p=o===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const v=p&&m.id===n;m.domElement&&(m.domElement.checked=v),e.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class fH extends m0{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class pH extends Jo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Ho.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,n.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),a=!1),s.append(m)}let o=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),s.prepend(p),o=()=>{p.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const c=p=>{const m=p?"value":"textContent",{options:v,multiple:_}=s;return _?Array.prototype.filter.call(v,S=>S.selected).map(S=>S[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let h=c(!1);const d=p=>{const m=p.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",p=>{const m={value(v){o?.();const _=v.detail.value,S=new Set(Array.isArray(_)?_:[_]);for(const A of s.options)A.selected=S.has(A.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(v){s.multiple=!0},remove(v){const _=s.options,S=v.detail.remove;_[S].selected=!1,s.remove(S),_.length>0&&Array.prototype.findIndex.call(_,T=>T.selected)===-1&&(_[0].selected=!0),e.setValue(t,{value:c(!0),items:d(v)}),h=c(!1)},clear(v){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(v){const{index:_,displayValue:S,exportValue:A}=v.detail.insert,T=s.children[_],x=document.createElement("option");x.textContent=S,x.value=A,T?T.before(x):s.append(x),e.setValue(t,{value:c(!0),items:d(v)}),h=c(!1)},items(v){const{items:_}=v.detail;for(;s.length!==0;)s.remove(0);for(const S of _){const{displayValue:A,exportValue:T}=S,x=document.createElement("option");x.textContent=A,x.value=T,s.append(x)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:d(v)}),h=c(!1)},indices(v){const _=new Set(v.detail.indices);for(const S of v.target.options)S.selected=_.has(S.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,p)}),s.addEventListener("input",p=>{const m=c(!0),v=c(!1);e.setValue(t,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):s.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Yb extends Pt{constructor(e){const{data:t,elements:n,parent:s}=e,a=!!s._commentManager;if(super(e,{isRenderable:!a&&Pt._hasPopupData(t)}),this.elements=n,a&&Pt._hasPopupData(t)){const o=this.popup=this.#e();for(const c of n)c.popup=o}else this.popup=null}#e(){return new mH({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${rc}${s}`).join(",")),this.container}}class mH{#e=null;#t=this.#H.bind(this);#i=this.#U.bind(this);#n=this.#P.bind(this);#r=this.#A.bind(this);#a=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#b=null;#v=null;#T=null;#E=null;#w=null;#C=!1;#_=null;#S=null;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:a,contentsObj:o,richText:c,parent:h,rect:d,parentRect:p,open:m,commentManager:v=null}){this.#s=e,this.#E=s,this.#o=o,this.#T=c,this.#d=h,this.#a=t,this.#v=d,this.#h=p,this.#l=n,this.#e=v,this.#_=n[0],this.#c=Vb.toDateObject(a),this.trigger=n.flatMap(_=>_.getElementsToTriggerPopup()),v||(this.#I(),this.#s.hidden=!0,m&&this.#A())}#I(){if(this.#m)return;this.#m=new AbortController;const{signal:e}=this.#m;for(const t of this.trigger)t.addEventListener("click",this.#r,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#i,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#k(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#_.container.after(this.#p);return}if(this.#y||this.#k(),!this.#y)return;const{signal:e}=this.#m=new AbortController,t=this.#_.hasOwnCommentButton,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},s=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},a=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#_.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",s,{signal:e}),o.addEventListener("pointerleave",a,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const c=this.#_.container;o.style.zIndex=c.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#R(),o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",s,{signal:e}),o.addEventListener("pointerleave",a,{signal:e}),c.after(o)}}#R(){if(this.#_.extraPopupElement&&!this.#_.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#y,{style:n}=this.#p;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#j(){this.#_.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#_.commentData;return e?this.#d._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:a}=this.#_.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#S||=this.#_.commentText,this.#S}set comment(e){e!==this.comment&&(this.#_.commentText=this.#S=e)}focus(){this.#_.container?.focus()}get parentBoundingClientRect(){return this.#_.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:e,y:t,height:n}=this.#p.getBoundingClientRect(),{x:s,y:a,width:o,height:c}=this.#_.layer.getBoundingClientRect();return[(e-s)/o,(t+n-a)/c]}set commentPopupPosition(e){this.#b=e}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#b||this.commentButtonPosition.map(d=>d/100),s=this.parentBoundingClientRect,{x:a,y:o,width:c,height:h}=s;this.#e.showDialog(null,this,a+t*c,o+n*h,{...e,parentDimensions:s})}render(){if(this.#g)return;const e=this.#g=document.createElement("div");if(e.className="popup",this.#a){const n=e.style.outlineColor=pe.makeHexColor(...this.#a);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#E?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#E}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}vI({html:this.#O||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#s.append(e)}get#O(){const e=this.#T,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#T.html||null}get#N(){return this.#O?.attributes?.style?.fontSize||0}get#B(){return this.#O?.attributes?.style?.color||null}#M(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#B,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:s});return n}#H(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#S=null):t&&(t.deleted?this.remove():(this.#j(),this.#S=t.text)),e&&(this.#y=null,this.#k(),this.#R());return}if(n||t?.deleted){this.remove();return}this.#I(),this.#w||={contentsObj:this.#o,richText:this.#T},e&&(this.#u=null),t&&t.text&&(this.#T=this.#M(t.text),this.#c=Vb.toDateObject(t.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#T}=this.#w,this.#w=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#x(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:a}}}=this.#d;let o=!!this.#h,c=o?this.#h:this.#v;for(const S of this.#l)if(!c||pe.intersect(S.data.rect,c)!==null){c=S.data.rect,o=!0;break}const h=pe.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=o?c[2]-c[0]+5:0,m=h[0]+p,v=h[1];this.#u=[100*(m-s)/t,100*(v-a)/n];const{style:_}=this.#s;_.left=`${this.#u[0]}%`,_.top=`${this.#u[1]}%`}#A(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#P(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#t)):(this.#U(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#t))}#P(){this.#g||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#x(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#U(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#e||(this.#I(),this.#C&&(this.#g||this.#P(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#e?!1:this.#s.hidden===!1}}class qI extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ue.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class gH extends Pt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class yH extends Pt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",t-a),o.setAttribute("height",n-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class vH extends Pt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-a/2),o.setAttribute("ry",n/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class HI extends Pt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:a,height:o}=this;if(!t)return this.container;const c=this.svgFactory.create(a,o,!0);let h=[];for(let p=0,m=t.length;p<m;p+=2){const v=t[p]-e[0],_=e[3]-t[p+1];h.push(`${v},${_}`)}h=h.join(" ");const d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class bH extends HI{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _H extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class g0 extends Pt{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ue.HIGHLIGHT:Ue.INK}#i(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:a}}=this,{transform:o,width:c,height:h}=this.#i(t,e),d=this.svgFactory.create(c,h,!0),p=this.#e=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let m=0,v=n.length;m<v;m++){const _=this.svgFactory.createElement(this.svgElementName);this.#t.push(_),_.setAttribute("points",n[m].join(",")),p.append(_)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,a=this.#e;if(t>=0&&a.setAttribute("stroke-width",t||1),n)for(let o=0,c=this.#t.length;o<c;o++)this.#t[o].setAttribute("points",n[o].join(","));if(s){const{transform:o,width:c,height:h}=this.#i(this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class $I extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ue.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class wH extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class AH extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class EH extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class GI extends Pt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ue.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class SH extends Pt{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=dn.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class y0{#e=null;#t=null;#i=null;#n=new Map;#r=null;#a=null;#s=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:a,viewport:o,structTreeLayer:c,commentManager:h,linkService:d,annotationStorage:p}){this.div=e,this.#e=t,this.#t=n,this.#r=c||null,this.#a=d||null,this.#i=p||new u0,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(e){const{annotations:t}=e,n=this.div;qo(n,this.viewport);const s=new Map,a=[],o={data:null,layer:n,linkService:this.#a,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Wp,annotationStorage:this.#i,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===tn.POPUP;if(h){const m=s.get(c.id);if(!m)continue;if(!this._commentManager){a.push(c);continue}o.elements=m}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;o.data=c;const d=Av.create(o);if(!d.isRenderable)continue;if(!h&&(this.#s.push(d),c.popupRef)){const m=s.get(c.popupRef);m?m.push(d):s.set(c.popupRef,[d])}const p=d.render();c.hidden&&(p.style.visibility="hidden"),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}await this.#c();for(const c of a){const h=o.elements=s.get(c.id);o.data=c;const d=Av.create(o);if(!d.isRenderable)continue;const p=d.render();d.contentElement.id=`${rc}${c.id}`,c.hidden&&(p.style.visibility="hidden"),h.at(-1).container.after(p)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:s}}of this.#s){const a=n.id=`${rc}${s}`;e.push(this.#r?.getAriaAttributes(a).then(o=>{if(o)for(const[c,h]of o)n.setAttribute(c,h)}))}}this.#s.sort(({data:{rect:[n,s,a,o]}},{data:{rect:[c,h,d,p]}})=>{if(n===a&&s===o)return 1;if(c===d&&h===p)return-1;const m=o,v=s,_=(s+o)/2,S=p,A=h,T=(h+p)/2;if(_>=S&&T<=v)return-1;if(T>=m&&_<=A)return 1;const x=(n+a)/2,D=(c+d)/2;return x-D});const t=document.createDocumentFragment();for(const n of this.#s)t.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&t.append(n.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const n of this.#s)this.#e.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#a,svgFactory:new Wp,parent:this};for(const n of e){n.borderStyle||=y0._defaultBorderStyle,t.data=n;const s=Av.create(t);s.isRenderable&&(s.render(),s.contentElement.id=`${rc}${n.id}`,this.#s.push(s))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,qo(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n);const o=this.#n.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,n),o._hasNoCanvas=!1):o.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:s}=e,a=new lH({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#i});return a.render(),a.contentElement.id=`${rc}${n}`,a.createOrUpdatePopup(),this.#s.push(a),a}removeAnnotation(e){const t=this.#s.findIndex(s=>s.data.id===e);if(t<0)return;const[n]=this.#s.splice(t,1);this.#e?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Me(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ec.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const np=/\r\n?|\n/g;class yn extends Se{#e="";#t=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=yn.prototype,t=a=>a.isEmpty(),n=Va.TRANSLATE_SMALL,s=Va.TRANSLATE_BIG;return Me(this,"_keyboardManager",new id([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=Ue.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||yn._defaultColor||Se._defaultLineColor,this.#n=e.fontSize||yn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){Se.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Ye.FREETEXT_SIZE:yn._defaultFontSize=t;break;case Ye.FREETEXT_COLOR:yn._defaultColor=t;break}}updateParams(e,t){switch(e){case Ye.FREETEXT_SIZE:this.#r(t);break;case Ye.FREETEXT_COLOR:this.#a(t);break}}static get defaultPropertiesToUpdate(){return[[Ye.FREETEXT_SIZE,yn._defaultFontSize],[Ye.FREETEXT_COLOR,yn._defaultColor||Se._defaultLineColor]]}get propertiesToUpdate(){return[[Ye.FREETEXT_SIZE,this.#n],[Ye.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Uh(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ye.FREETEXT_COLOR}#r(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#o()},n=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ye.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(e){const t=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ye.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-yn._internalPadding*e,-(yn._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(yn.#c(n)),t=n);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#s().trimEnd();if(e===t)return;const n=s=>{if(this.#e=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){yn._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[d,p]=this.pageDimensions,[m,v]=this.pageTranslation;let _,S;switch(this.rotation){case 0:_=e+(o[0]-m)/d,S=t+this.height-(o[1]-v)/p;break;case 90:_=e+(o[0]-m)/d,S=t-(o[1]-v)/p,[c,h]=[h,-c];break;case 180:_=e-this.width+(o[0]-m)/d,S=t-(o[1]-v)/p,[c,h]=[-c,-h];break;case 270:_=e+(o[0]-m-this.height*p)/d,S=t+(o[1]-v-this.width*d)/p,[c,h]=[-h,c];break}this.setAt(_*s,S*a,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(np,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=yn.#h(t.getData("text")||"").replaceAll(np,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=o,d=[],p=[];if(c.nodeType===Node.TEXT_NODE){const _=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(np,"")),_!==this.editorDiv){let S=d;for(const A of this.editorDiv.childNodes){if(A===_){S=p;continue}S.push(yn.#c(A))}}d.push(c.nodeValue.slice(0,h).replaceAll(np,""))}else if(c===this.editorDiv){let _=d,S=0;for(const A of this.editorDiv.childNodes)S++===h&&(_=p),_.push(yn.#c(A))}this.#e=`${d.join(`
`)}${s}${p.join(`
`)}`,this.#l();const m=new Range;let v=Math.sumPrecise(d.map(_=>_.length));for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const S=_.nodeValue.length;if(v<=S){m.setStart(_,v),m.setEnd(_,v);break}v-=S}a.removeAllRanges(),a.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#e.replaceAll(""," ")}static#h(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=yn._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let s=null;if(e instanceof qI){const{data:{defaultAppearanceData:{fontSize:o,fontColor:c},rect:h,rotation:d,id:p,popupRef:m,richText:v,contentsObj:_,creationDate:S,modificationDate:A},textContent:T,textPosition:x,parent:{page:{pageNumber:D}}}=e;if(!T||T.length===0)return null;s=e={annotationType:Ue.FREETEXT,color:Array.from(c),fontSize:o,value:T.join(`
`),position:x,pageIndex:D-1,rect:h.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:_?.str||null,richText:v,creationDate:S,modificationDate:A}}const a=await super.deserialize(e,t,n);return a.#n=e.fontSize,a.color=pe.makeHexColor(...e.color),a.#e=yn.#h(e.value),a._initialData=s,e.comment&&a.setCommentData(e),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Se._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#d()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((o,c)=>o!==s[c])||e.pageIndex!==a}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const s of this.#e.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),t.append(a)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ge{static PRECISION=1e-4;toSVGPath(){lt("Abstract method `toSVGPath` must be implemented.")}get box(){lt("Abstract getter `box` must be implemented.")}serialize(e,t){lt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,a,o){o||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)o[c]=t+e[c]*s,o[c+1]=n+e[c+1]*a;return o}static _rescaleAndSwap(e,t,n,s,a,o){o||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)o[c]=t+e[c+1]*s,o[c+1]=n+e[c]*a;return o}static _translate(e,t,n,s){s||=new Float32Array(e.length);for(let a=0,o=e.length;a<o;a+=2)s[a]=t+e[a],s[a+1]=n+e[a+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,a){switch(a){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,a,o){return[(e+5*n)/6,(t+5*s)/6,(5*n+a)/6,(5*s+o)/6,(n+a)/2,(s+o)/2]}}class Po{#e;#t=[];#i;#n;#r=[];#a=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=Po.#g+Po.#m;constructor({x:e,y:t},n,s,a,o,c=0){this.#e=n,this.#h=a*s,this.#n=o,this.#a.set([NaN,NaN,NaN,NaN,e,t],6),this.#i=c,this.#l=Po.#g*s,this.#c=Po.#u*s,this.#d=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#a[8])}#p(){const e=this.#a.subarray(4,6),t=this.#a.subarray(16,18),[n,s,a,o]=this.#e;return[(this.#s+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-s)/o,(this.#s+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-s)/o]}add({x:e,y:t}){this.#s=e,this.#o=t;const[n,s,a,o]=this.#e;let[c,h,d,p]=this.#a.subarray(8,12);const m=e-d,v=t-p,_=Math.hypot(m,v);if(_<this.#c)return!1;const S=_-this.#l,A=S/_,T=A*m,x=A*v;let D=c,I=h;c=d,h=p,d+=T,p+=x,this.#f?.push(e,t);const U=-x/S,z=T/S,F=U*this.#h,R=z*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([d+F,p+R],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([d-F,p-R],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([c+F,h+R],2),this.#r.push(NaN,NaN,NaN,NaN,(c+F-n)/a,(h+R-s)/o),this.#a.set([c-F,h-R],14),this.#t.push(NaN,NaN,NaN,NaN,(c-F-n)/a,(h-R-s)/o)),this.#a.set([D,I,c,h,d,p],6),!this.isEmpty()):(this.#a.set([D,I,c,h,d,p],6),Math.abs(Math.atan2(I-h,D-c)-Math.atan2(x,T))<Math.PI/2?([c,h,d,p]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((c+d)/2-n)/a,((h+p)/2-s)/o),[c,h,D,I]=this.#a.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((D+c)/2-n)/a,((I+h)/2-s)/o),!0):([D,I,c,h,d,p]=this.#a.subarray(0,6),this.#r.push(((D+5*c)/6-n)/a,((I+5*h)/6-s)/o,((5*c+d)/6-n)/a,((5*h+p)/6-s)/o,((c+d)/2-n)/a,((h+p)/2-s)/o),[d,p,c,h,D,I]=this.#a.subarray(12,18),this.#t.push(((D+5*c)/6-n)/a,((I+5*h)/6-s)/o,((5*c+d)/6-n)/a,((5*h+p)/6-s)/o,((c+d)/2-n)/a,((h+p)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#v(n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#b(n),n.join(" ")}#y(){const[e,t,n,s]=this.#e,[a,o,c,h]=this.#p();return`M${(this.#a[2]-e)/n} ${(this.#a[3]-t)/s} L${(this.#a[4]-e)/n} ${(this.#a[5]-t)/s} L${a} ${o} L${c} ${h} L${(this.#a[16]-e)/n} ${(this.#a[17]-t)/s} L${(this.#a[14]-e)/n} ${(this.#a[15]-t)/s} Z`}#b(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,n,s,a]=this.#e,o=this.#a.subarray(4,6),c=this.#a.subarray(16,18),[h,d,p,m]=this.#p();e.push(`L${(o[0]-t)/s} ${(o[1]-n)/a} L${h} ${d} L${p} ${m} L${(c[0]-t)/s} ${(c[1]-n)/a}`)}newFreeDrawOutline(e,t,n,s,a,o){return new WI(e,t,n,s,a,o)}getOutlines(){const e=this.#r,t=this.#t,n=this.#a,[s,a,o,c]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let m=0,v=h.length-2;m<v;m+=2)h[m]=(this.#f[m]-s)/o,h[m+1]=(this.#f[m+1]-a)/c;if(h[h.length-2]=(this.#s-s)/o,h[h.length-1]=(this.#o-a)/c,isNaN(n[6])&&!this.isEmpty())return this.#T(h);const d=new Float32Array(this.#r.length+24+this.#t.length);let p=e.length;for(let m=0;m<p;m+=2){if(isNaN(e[m])){d[m]=d[m+1]=NaN;continue}d[m]=e[m],d[m+1]=e[m+1]}p=this.#w(d,p);for(let m=t.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(t[m+v])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=t[m+v],d[p+1]=t[m+v+1],p+=2}return this.#E(d,p),this.newFreeDrawOutline(d,h,this.#e,this.#d,this.#i,this.#n)}#T(e){const t=this.#a,[n,s,a,o]=this.#e,[c,h,d,p]=this.#p(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-n)/a,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-n)/a,(t[5]-s)/o,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(t[16]-n)/a,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-n)/a,(t[15]-s)/o],0),this.newFreeDrawOutline(m,e,this.#e,this.#d,this.#i,this.#n)}#E(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#w(e,t){const n=this.#a.subarray(4,6),s=this.#a.subarray(16,18),[a,o,c,h]=this.#e,[d,p,m,v]=this.#p();return e.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-o)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(s[0]-a)/c,(s[1]-o)/h],t),t+=24}}class WI extends ge{#e;#t=new Float32Array(4);#i;#n;#r;#a;#s;constructor(e,t,n,s,a,o){super(),this.#s=e,this.#r=t,this.#e=n,this.#a=s,this.#i=a,this.#n=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[c,h,d,p]=this.#t;for(let m=0,v=e.length;m<v;m+=2)e[m]=(e[m]-c)/d,e[m+1]=(e[m+1]-h)/p;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-c)/d,t[m+1]=(t[m+1]-h)/p}toSVGPath(){const e=[`M${this.#s[4]} ${this.#s[5]}`];for(let t=6,n=this.#s.length;t<n;t+=6){if(isNaN(this.#s[t])){e.push(`L${this.#s[t+4]} ${this.#s[t+5]}`);continue}e.push(`C${this.#s[t]} ${this.#s[t+1]} ${this.#s[t+2]} ${this.#s[t+3]} ${this.#s[t+4]} ${this.#s[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],a){const o=n-e,c=s-t;let h,d;switch(a){case 0:h=ge._rescale(this.#s,e,s,o,-c),d=ge._rescale(this.#r,e,s,o,-c);break;case 90:h=ge._rescaleAndSwap(this.#s,e,t,o,c),d=ge._rescaleAndSwap(this.#r,e,t,o,c);break;case 180:h=ge._rescale(this.#s,n,t,-o,c),d=ge._rescale(this.#r,n,t,-o,c);break;case 270:h=ge._rescaleAndSwap(this.#s,n,s,-o,-c),d=ge._rescaleAndSwap(this.#r,n,s,-o,-c);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(e){const t=this.#s;let n=t[4],s=t[5];const a=[n,s,n,s];let o=n,c=s,h=n,d=s;const p=e?Math.max:Math.min,m=new Float32Array(4);for(let _=6,S=t.length;_<S;_+=6){const A=t[_+4],T=t[_+5];isNaN(t[_])?(pe.pointBoundingBox(A,T,a),c>T?(o=A,c=T):c===T&&(o=p(o,A)),d<T?(h=A,d=T):d===T&&(h=p(h,A))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,pe.bezierBoundingBox(n,s,...t.slice(_,_+6),m),pe.rectBoundingBox(m[0],m[1],m[2],m[3],a),c>m[1]?(o=m[0],c=m[1]):c===m[1]&&(o=p(o,m[0])),d<m[3]?(h=m[2],d=m[3]):d===m[3]&&(h=p(h,m[2]))),n=A,s=T}const v=this.#t;v[0]=a[0]-this.#i,v[1]=a[1]-this.#i,v[2]=a[2]-a[0]+2*this.#i,v[3]=a[3]-a[1]+2*this.#i,this.firstPoint=[o,c],this.lastPoint=[h,d]}get box(){return this.#t}newOutliner(e,t,n,s,a,o=0){return new Po(e,t,n,s,a,o)}getNewOutline(e,t){const[n,s,a,o]=this.#t,[c,h,d,p]=this.#e,m=a*d,v=o*p,_=n*d+c,S=s*p+h,A=this.newOutliner({x:this.#r[0]*m+_,y:this.#r[1]*v+S},this.#e,this.#a,e,this.#n,t??this.#i);for(let T=2;T<this.#r.length;T+=2)A.add({x:this.#r[T]*m+_,y:this.#r[T+1]*v+S});return A.getOutlines()}}class Xb{#e;#t;#i;#n=[];#r=[];constructor(e,t=0,n=0,s=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:A,y:T,width:x,height:D}of e){const I=Math.floor((A-t)/o)*o,U=Math.ceil((A+x+t)/o)*o,z=Math.floor((T-t)/o)*o,F=Math.ceil((T+D+t)/o)*o,R=[I,z,F,!0],O=[U,z,F,!1];this.#n.push(R,O),pe.rectBoundingBox(I,z,U,F,a)}const c=a[2]-a[0]+2*n,h=a[3]-a[1]+2*n,d=a[0]-n,p=a[1]-n;let m=s?-1/0:1/0,v=1/0;const _=this.#n.at(s?-1:-2),S=[_[0],_[2]];for(const A of this.#n){const[T,x,D,I]=A;!I&&s?x<v?(v=x,m=T):x===v&&(m=Math.max(m,T)):I&&!s&&(x<v?(v=x,m=T):x===v&&(m=Math.min(m,T))),A[0]=(T-d)/c,A[1]=(x-p)/h,A[2]=(D-p)/h}this.#e=new Float32Array([d,p,c,h]),this.#t=[m,v],this.#i=S}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#a(e)}#a(e){const t=[],n=new Set;for(const o of e){const[c,h,d]=o;t.push([c,h,o],[c,d,o])}t.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=t.length;o<c;o+=2){const h=t[o][2],d=t[o+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const s=[];let a;for(;n.size>0;){const o=n.values().next().value;let[c,h,d,p,m]=o;n.delete(o);let v=c,_=h;for(a=[c,d],s.push(a);;){let S;if(n.has(p))S=p;else if(n.has(m))S=m;else break;n.delete(S),[c,h,d,p,m]=S,v!==c&&(a.push(v,_,c,_===h?h:d),v=c),_=_===h?d:h}a.push(v,_)}return new TH(s,this.#e,this.#t,this.#i)}#s(e){const t=this.#r;let n=0,s=t.length-1;for(;n<=s;){const a=n+s>>1,o=t[a][0];if(o===e)return a;o<e?n=a+1:s=a-1}return s+1}#o([,e,t]){const n=this.#s(e);this.#r.splice(n,0,[e,t])}#c([,e,t]){const n=this.#s(e);for(let s=n;s<this.#r.length;s++){const[a,o]=this.#r[s];if(a!==e)break;if(a===e&&o===t){this.#r.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[a,o]=this.#r[s];if(a!==e)break;if(a===e&&o===t){this.#r.splice(s,1);return}}}#l(e){const[t,n,s]=e,a=[[t,n,s]],o=this.#s(s);for(let c=0;c<o;c++){const[h,d]=this.#r[c];for(let p=0,m=a.length;p<m;p++){const[,v,_]=a[p];if(!(d<=v||_<=h)){if(v>=h){if(_>d)a[p][1]=d;else{if(m===1)return[];a.splice(p,1),p--,m--}continue}a[p][2]=h,_>d&&a.push([t,d,_])}}}return a}}class TH extends ge{#e;#t;constructor(e,t,n,s){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let a=2;a<t.length;a+=2){const o=t[a],c=t[a+1];o===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${o}`),n=o)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],a){const o=[],c=n-e,h=s-t;for(const d of this.#t){const p=new Array(d.length);for(let m=0;m<d.length;m+=2)p[m]=e+d[m]*c,p[m+1]=s-d[m+1]*h;o.push(p)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Qb extends Po{newFreeDrawOutline(e,t,n,s,a,o){return new xH(e,t,n,s,a,o)}}class xH extends WI{newOutliner(e,t,n,s,a,o=0){return new Qb(e,t,n,s,a,o)}}class Vt extends Se{#e=null;#t=0;#i;#n=null;#r=null;#a=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ue.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Vt.prototype;return Me(this,"_keyboardManager",new id([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Vt._defaultColor,this.#p=e.thickness||Vt._defaultThickness,this.opacity=e.opacity||Vt._defaultOpacity,this.#i=e.boxes||null,this.#y=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#h=!0,this.#v(e),this.#_()):this.#i&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#s=e.focusNode,this.#o=e.focusOffset,this.#b(),this.#_(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#b(){const e=new Xb(this.#i,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Xb(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#a=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:s}=this.#a;this.#g=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const s=1.5;if(this.#a=e.getNewOutline(this.#p/2+s,.0025),t>=0)this.#d=t,this.#n=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Vt.#S(this.#l.box,(m-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:Vt.#S(this.#a.box,m),path:{d:this.#a.toSVGPath()}})}const[a,o,c,h]=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=h;break;case 90:{const[m,v]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*v/m,this.height=h*m/v;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=h;break;case 270:{const[m,v]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*v/m,this.height=h*m/v;break}}const{firstPoint:d}=e;this.#f=[(d[0]-a)/c,(d[1]-o)/h];const{lastPoint:p}=this.#a;this.#g=[(p[0]-a)/c,(p[1]-o)/h]}static initialize(e,t){Se.initialize(e,t),Vt._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Ye.HIGHLIGHT_COLOR:Vt._defaultColor=t;break;case Ye.HIGHLIGHT_THICKNESS:Vt._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case Ye.HIGHLIGHT_COLOR:this.#T(t);break;case Ye.HIGHLIGHT_THICKNESS:this.#E(t);break}}static get defaultPropertiesToUpdate(){return[[Ye.HIGHLIGHT_COLOR,Vt._defaultColor],[Ye.HIGHLIGHT_THICKNESS,Vt._defaultThickness]]}get propertiesToUpdate(){return[[Ye.HIGHLIGHT_COLOR,this.color||Vt._defaultColor],[Ye.HIGHLIGHT_THICKNESS,this.#p||Vt._defaultThickness],[Ye.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#T(e){const t=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:t.bind(this,e,Vt._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ye.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#E(e){const t=this.#p,n=s=>{this.#p=s,this.#w(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ye.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new Ui({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#R())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#_(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#C():e&&(this.#_(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#_(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#S([e,t,n,s],a){switch(a){case 90:return[1-t-s,e,s,n];case 180:return[1-e-n,1-t-s,n,s];case 270:return[t,1-e-n,s,n]}return[e,t,n,s]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#h?(e=(e-this.rotation+360)%360,n=Vt.#S(this.#l.box,e)):n=Vt.#S([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#m,{bbox:Vt.#S(this.#a.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#h?e.classList.add("free"):this.div.addEventListener("keydown",this.#I.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(),_I(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#I(e){Vt._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#s,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#k(!1))}get _mustFixPosition(){return!this.#h}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!e}}))}#R(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,a=this.#i,o=new Float32Array(a.length*8);let c=0;for(const{x:h,y:d,width:p,height:m}of a){const v=h*e+n,_=(1-d)*t+s;o[c]=o[c+4]=v,o[c+1]=o[c+3]=_,o[c+2]=o[c+6]=v+p*e,o[c+5]=o[c+7]=_-m*t,c+=8}return o}#O(e){return this.#l.serialize(e,this.#R())}static startHighlighting(e,t,{target:n,x:s,y:a}){const{x:o,y:c,width:h,height:d}=n.getBoundingClientRect(),p=new AbortController,m=e.combinedSignal(p),v=_=>{p.abort(),this.#B(e,_)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",jt,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Hi,{signal:m}),n.addEventListener("pointermove",this.#N.bind(this,e),{signal:m}),this._freeHighlight=new Qb({x:s,y:a},[o,c,h,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let s=null;if(e instanceof $I){const{data:{quadPoints:S,rect:A,rotation:T,id:x,color:D,opacity:I,popupRef:U,richText:z,contentsObj:F,creationDate:R,modificationDate:O},parent:{page:{pageNumber:P}}}=e;s=e={annotationType:Ue.HIGHLIGHT,color:Array.from(D),opacity:I,quadPoints:S,boxes:null,pageIndex:P-1,rect:A.slice(0),rotation:T,annotationElementId:x,id:x,deleted:!1,popupRef:U,richText:z,comment:F?.str||null,creationDate:R,modificationDate:O}}else if(e instanceof g0){const{data:{inkLists:S,rect:A,rotation:T,id:x,color:D,borderStyle:{rawWidth:I},popupRef:U,richText:z,contentsObj:F,creationDate:R,modificationDate:O},parent:{page:{pageNumber:P}}}=e;s=e={annotationType:Ue.HIGHLIGHT,color:Array.from(D),thickness:I,inkLists:S,boxes:null,pageIndex:P-1,rect:A.slice(0),rotation:T,annotationElementId:x,id:x,deleted:!1,popupRef:U,richText:z,comment:F?.str||null,creationDate:R,modificationDate:O}}const{color:a,quadPoints:o,inkLists:c,opacity:h}=e,d=await super.deserialize(e,t,n);d.color=pe.makeHexColor(...a),d.opacity=h||1,c&&(d.#p=e.thickness),d._initialData=s,e.comment&&d.setCommentData(e);const[p,m]=d.pageDimensions,[v,_]=d.pageTranslation;if(o){const S=d.#i=[];for(let A=0;A<o.length;A+=8)S.push({x:(o[A]-v)/p,y:1-(o[A+1]-_)/m,width:(o[A+2]-o[A])/p,height:(o[A+1]-o[A+5])/m});d.#b(),d.#_(),d.rotate(d.rotation)}else if(c){d.#h=!0;const S=c[0],A={x:S[0]-v,y:m-(S[1]-_)},T=new Qb(A,[0,0,p,m],1,d.#p/2,!0,.001);for(let I=0,U=S.length;I<U;I+=2)A.x=S[I]-v,A.y=m-(S[I+1]-_),T.add(A);const{id:x,clipPathId:D}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:T.toSVGPath()}},!0,!0);d.#v({highlightOutlines:T.getOutlines(),highlightId:x,clipPathId:D}),d.#_(),d.rotate(d.parentRotation)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=Se._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#O(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#M(n)?null:(n.id=this.annotationElementId,n)}#M(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,s)=>n!==t[s])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class KI{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){lt("Not implemented")}}class st extends Se{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#r=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#a(e),this.#c())}#a({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#s(e,this.parent),this.#h(e.box)}#s(e,t){const{id:n}=t.drawLayer.draw(st._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,a]of Object.entries(t))n.has(s)?Object.assign(e[s],a):e[s]=a;return e}static getDefaultDrawingOptions(e){lt("Not implemented")}static get typesMap(){lt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(st.#i.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,a=s[t],o=c=>{s.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,st._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,st._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,st._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#e,e)}}#l([e,t,n,s]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(o/a),s*(a/o)];case 180:return[1-e,1-t,n,s];case 270:return[1-t,e,n*(o/a),s*(a/o)];default:return[e,t,n,s]}}#d(){const{x:e,y:t,width:n,height:s,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(a/o),s*(o/a)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(a/o),s*(o/a)];default:return[e,t,n,s]}}#h(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:n,height:s,rotation:a,parentRotation:o,parentDimensions:[c,h]}=this;switch((a*4+o)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(c/h),s*(h/c),n*(c/h)];case 5:return[1-t,e,n*(c/h),s*(h/c)];case 6:return[1-e-s*(h/c),1-t,s*(h/c),n*(c/h)];case 7:return[t-n*(c/h),1-e-s*(h/c),n*(c/h),s*(h/c)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(h/c),t,s*(h/c),n*(c/h)];case 13:return[1-t-n*(c/h),e-s*(h/c),n*(c/h),s*(h/c)];case 14:return[1-e,1-t-n*(c/h),s*(h/c),n*(c/h)];case 15:return[t,1-e,n*(c/h),s*(h/c)];default:return[e,t,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,st._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,a){lt("Not implemented")}static startDrawing(e,t,n,s){const{target:a,offsetX:o,offsetY:c,pointerId:h,pointerType:d}=s;if(at.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:p}}=e,{width:m,height:v}=a.getBoundingClientRect(),_=st.#n=new AbortController,S=e.combinedSignal(_);if(at.setPointer(d,h),window.addEventListener("pointerup",A=>{at.isSamePointerIdOrRemove(A.pointerId)&&this._endDraw(A)},{signal:S}),window.addEventListener("pointercancel",A=>{at.isSamePointerIdOrRemove(A.pointerId)&&this._currentParent.endDrawingSession()},{signal:S}),window.addEventListener("pointerdown",A=>{at.isSamePointerType(A.pointerType)&&(at.initializeAndAddPointerId(A.pointerId),st.#i.isCancellable()&&(st.#i.removeLastElement(),st.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",Hi,{signal:S}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),a.addEventListener("touchmove",A=>{at.isSameTimeStamp(A.timeStamp)&&jt(A)},{signal:S}),e.toggleDrawing(),t._editorUndoBar?.hide(),st.#i){e.drawLayer.updateProperties(this._currentDrawId,st.#i.startNew(o,c,m,v,p));return}t.updateUIForDefaultProperties(this),st.#i=this.createDrawerInstance(o,c,m,v,p),st.#r=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(st.#r.toSVGProperties(),st.#i.defaultSVGProperties),!0,!1)}static _drawMove(e){if(at.isSameTimeStamp(e.timeStamp),!st.#i)return;const{offsetX:t,offsetY:n,pointerId:s}=e;if(at.isSamePointerId(s)){if(at.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,st.#i.add(t,n)),at.setTimeStamp(e.timeStamp),jt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,st.#i=null,st.#r=null,at.clearTimeStamp()),st.#n&&(st.#n.abort(),st.#n=null,at.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,st.#i.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=st.#i,s=this._currentDrawId,a=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,n.setLastElement(a))},undo:()=>{t.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Ye.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Ye.DRAW_STEP),!st.#i.isEmpty()){const{pageDimensions:[n,s],scale:a}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:st.#i.getOutlines(n*a,s*a,a,this._INNER_MARGIN),drawingOptions:st.#r,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,a,o){lt("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:c}}=t.viewport,h=this.deserializeDraw(o,c,s,a,this._INNER_MARGIN,e),d=await super.deserialize(e,t,n);return d.createDrawingOptions(e),d.#a({drawOutlines:h}),d.#c(),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[t,n]=this.pageTranslation,[s,a]=this.pageDimensions;return this.#e.serialize([t,n,s,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class CH{#e=new Float64Array(6);#t;#i;#n;#r;#a;#s="";#o=0;#c=new sd;#l;#d;constructor(e,t,n,s,a,o){this.#l=n,this.#d=s,this.#n=a,this.#r=o,[e,t]=this.#h(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#a=[e,t],this.#i=[{line:c,points:this.#a}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#h(e,t){return ge._normalizePoint(e,t,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#a.length<=10}add(e,t){[e,t]=this.#h(e,t);const[n,s,a,o]=this.#e.subarray(2,6),c=e-a,h=t-o;return Math.hypot(this.#l*c,this.#d*h)<=2?null:(this.#a.push(e,t),isNaN(n)?(this.#e.set([a,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,s,a,o,e,t],0),this.#t.push(...ge.createBezierPoints(n,s,a,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,a){this.#l=n,this.#d=s,this.#n=a,[e,t]=this.#h(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#a=[e,t];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:o,points:this.#a}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(e){return this.#i?(this.#i.push(e),this.#t=e.line,this.#a=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#s="";for(let e=0,t=this.#i.length;e<t;e++){const{line:n,points:s}=this.#i[e];this.#t=n,this.#a=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const e=ge.svgRound(this.#t[4]),t=ge.svgRound(this.#t[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${e} ${t} Z`,this.#s;if(this.#a.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${e} ${t}`,this.#o=6}if(this.#a.length===4){const s=ge.svgRound(this.#t[10]),a=ge.svgRound(this.#t[11]);return this.#s=`${this.#s} L ${s} ${a}`,this.#o=12,this.#s}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let s=this.#o,a=this.#t.length;s<a;s+=6){const[o,c,h,d,p,m]=this.#t.slice(s,s+6).map(ge.svgRound);n.push(`C${o} ${c} ${h} ${d} ${p} ${m}`)}return this.#s+=n.join(" "),this.#o=this.#t.length,this.#s}getOutlines(e,t,n,s){const a=this.#i.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#i,e,t,n,this.#n,this.#r,s),this.#e=null,this.#t=null,this.#i=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class sd extends ge{#e;#t=0;#i;#n;#r;#a;#s;#o;#c;build(e,t,n,s,a,o,c){this.#r=t,this.#a=n,this.#s=s,this.#o=a,this.#c=o,this.#i=c??0,this.#n=e,this.#h()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${ge.svgRound(t[4])} ${ge.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${ge.svgRound(t[10])} ${ge.svgRound(t[11])}`);continue}for(let n=6,s=t.length;n<s;n+=6){const[a,o,c,h,d,p]=t.subarray(n,n+6).map(ge.svgRound);e.push(`C${a} ${o} ${c} ${h} ${d} ${p}`)}}return e.join("")}serialize([e,t,n,s],a){const o=[],c=[],[h,d,p,m]=this.#d();let v,_,S,A,T,x,D,I,U;switch(this.#o){case 0:U=ge._rescale,v=e,_=t+s,S=n,A=-s,T=e+h*n,x=t+(1-d-m)*s,D=e+(h+p)*n,I=t+(1-d)*s;break;case 90:U=ge._rescaleAndSwap,v=e,_=t,S=n,A=s,T=e+d*n,x=t+h*s,D=e+(d+m)*n,I=t+(h+p)*s;break;case 180:U=ge._rescale,v=e+n,_=t,S=-n,A=s,T=e+(1-h-p)*n,x=t+d*s,D=e+(1-h)*n,I=t+(d+m)*s;break;case 270:U=ge._rescaleAndSwap,v=e+n,_=t+s,S=-n,A=-s,T=e+(1-d-m)*n,x=t+(1-h-p)*s,D=e+(1-d)*n,I=t+(1-h)*s;break}for(const{line:z,points:F}of this.#n)o.push(U(z,v,_,S,A,a?new Array(z.length):null)),c.push(U(F,v,_,S,A,a?new Array(F.length):null));return{lines:o,points:c,rect:[T,x,D,I]}}static deserialize(e,t,n,s,a,{paths:{lines:o,points:c},rotation:h,thickness:d}){const p=[];let m,v,_,S,A;switch(h){case 0:A=ge._rescale,m=-e/n,v=t/s+1,_=1/n,S=-1/s;break;case 90:A=ge._rescaleAndSwap,m=-t/s,v=-e/n,_=1/s,S=1/n;break;case 180:A=ge._rescale,m=e/n+1,v=-t/s,_=-1/n,S=1/s;break;case 270:A=ge._rescaleAndSwap,m=t/s+1,v=e/n+1,_=-1/s,S=-1/n;break}if(!o){o=[];for(const x of c){const D=x.length;if(D===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(D===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const I=new Float32Array(3*(D-2));o.push(I);let[U,z,F,R]=x.subarray(0,4);I.set([NaN,NaN,NaN,NaN,U,z],0);for(let O=4;O<D;O+=2){const P=x[O],j=x[O+1];I.set(ge.createBezierPoints(U,z,F,R,P,j),(O-2)*3),[U,z,F,R]=[F,R,P,j]}}}for(let x=0,D=o.length;x<D;x++)p.push({line:A(o[x].map(I=>I??NaN),m,v,_,S),points:A(c[x].map(I=>I??NaN),m,v,_,S)});const T=new this.prototype.constructor;return T.build(p,n,s,1,h,d,a),T}#l(e=this.#c){const t=this.#i+e/2*this.#s;return this.#o%180===0?[t/this.#r,t/this.#a]:[t/this.#a,t/this.#r]}#d(){const[e,t,n,s]=this.#e,[a,o]=this.#l(0);return[e+a,t+o,n-2*a,s-2*o]}#h(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let c=4,h=s.length;c<h;c+=6)pe.pointBoundingBox(s[c],s[c+1],e);continue}let a=s[4],o=s[5];for(let c=6,h=s.length;c<h;c+=6){const[d,p,m,v,_,S]=s.subarray(c,c+6);pe.bezierBoundingBox(a,o,d,p,m,v,_,S,e),a=_,o=S}}const[t,n]=this.#l();e[0]=In(e[0]-t,0,1),e[1]=In(e[1]-n,0,1),e[2]=In(e[2]+t,0,1),e[3]=In(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[s,a]=this.#l(),[o,c]=[s-t,a-n],h=this.#e;return h[0]-=o,h[1]-=c,h[2]+=2*o,h[3]+=2*c,h}updateParentDimensions([e,t],n){const[s,a]=this.#l();this.#r=e,this.#a=t,this.#s=n;const[o,c]=this.#l(),h=o-s,d=c-a,p=this.#e;return p[0]-=h,p[1]-=d,p[2]+=2*h,p[3]+=2*d,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ge.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,s=0,a=0,o=0,c=0,h=0;switch(this.#t){case 90:s=t/e,a=-e/t,c=e;break;case 180:n=-1,o=-1,c=e,h=t;break;case 270:s=-t/e,a=e/t,h=t;break;default:return""}return`matrix(${n} ${s} ${a} ${o} ${ge.svgRound(c)} ${ge.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,s]){const[a,o]=this.#l(),[c,h,d,p]=this.#e;if(Math.abs(d-a)<=ge.PRECISION||Math.abs(p-o)<=ge.PRECISION){const A=e+n/2-(c+d/2),T=t+s/2-(h+p/2);return{path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:`${this.rotationTransform} translate(${A} ${T})`}}}const m=(n-2*a)/(d-2*a),v=(s-2*o)/(p-2*o),_=d/n,S=p/s;return{path:{"transform-origin":`${ge.svgRound(c)} ${ge.svgRound(h)}`,transform:`${this.rotationTransform} scale(${_} ${S}) translate(${ge.svgRound(a)} ${ge.svgRound(o)}) scale(${m} ${v}) translate(${ge.svgRound(-a)} ${ge.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,n,s]){const[a,o]=this.#l(),c=this.#e,[h,d,p,m]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=s,Math.abs(p-a)<=ge.PRECISION||Math.abs(m-o)<=ge.PRECISION){const T=e+n/2-(h+p/2),x=t+s/2-(d+m/2);for(const{line:D,points:I}of this.#n)ge._translate(D,T,x,D),ge._translate(I,T,x,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(n-2*a)/(p-2*a),_=(s-2*o)/(m-2*o),S=-v*(h+a)+e+a,A=-_*(d+o)+t+o;if(v!==1||_!==1||S!==0||A!==0)for(const{line:T,points:x}of this.#n)ge._rescale(T,S,A,v,_,T),ge._rescale(x,S,A,v,_,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[s,a]=n,o=this.#e,c=e-o[0],h=t-o[1];if(this.#r===s&&this.#a===a)for(const{line:d,points:p}of this.#n)ge._translate(d,c,h,d),ge._translate(p,c,h,p);else{const d=this.#r/s,p=this.#a/a;this.#r=s,this.#a=a;for(const{line:m,points:v}of this.#n)ge._rescale(m,c,h,d,p,m),ge._rescale(v,c,h,d,p,v);o[2]*=d,o[3]*=p}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(e[0])} ${ge.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Om extends KI{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Se._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Om(this._viewParameters);return e.updateAll(this),e}}class v0 extends st{static _type="ink";static _editorType=Ue.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Se.initialize(e,t),this._defaultDrawingOptions=new Om(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Me(this,"typesMap",new Map([[Ye.INK_THICKNESS,"stroke-width"],[Ye.INK_COLOR,"stroke"],[Ye.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,a){return new CH(e,t,n,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,a,o){return sd.deserialize(e,t,n,s,a,o)}static async deserialize(e,t,n){let s=null;if(e instanceof g0){const{data:{inkLists:o,rect:c,rotation:h,id:d,color:p,opacity:m,borderStyle:{rawWidth:v},popupRef:_,richText:S,contentsObj:A,creationDate:T,modificationDate:x},parent:{page:{pageNumber:D}}}=e;s=e={annotationType:Ue.INK,color:Array.from(p),thickness:v,opacity:m,paths:{points:o},boxes:null,pageIndex:D-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:_,richText:S,comment:A?.str||null,creationDate:T,modificationDate:x}}const a=await super.deserialize(e,t,n);return a._initialData=s,e.comment&&a.setCommentData(e),a}get toolbarButtons(){return this._colorPicker||=new Uh(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ye.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=v0.getDefaultDrawingOptions({stroke:pe.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":o}}=this,c=Object.assign(super.serialize(e),{color:Se._colorManager.convert(s),opacity:a,thickness:o,paths:{lines:t,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:n,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,c)=>o!==t[c])||e.thickness!==n||e.opacity!==s||e.pageIndex!==a}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class Jb extends sd{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const ip=8,eh=3;class nc{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,n,s,a,o,c){const h=this.#t(n,s,a,o);for(let d=0;d<8;d++){const p=(-d+h-c+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(e[(n+m)*t+(s+v)]!==0)return p}return-1}static#r(e,t,n,s,a,o,c){const h=this.#t(n,s,a,o);for(let d=0;d<8;d++){const p=(d+h+c+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(e[(n+m)*t+(s+v)]!==0)return p}return-1}static#a(e,t,n,s){const a=e.length,o=new Int32Array(a);for(let p=0;p<a;p++)o[p]=e[p]<=s?1:0;for(let p=1;p<n-1;p++)o[p*t]=o[p*t+t-1]=0;for(let p=0;p<t;p++)o[p]=o[t*n-1-p]=0;let c=1,h;const d=[];for(let p=1;p<n-1;p++){h=1;for(let m=1;m<t-1;m++){const v=p*t+m,_=o[v];if(_===0)continue;let S=p,A=m;if(_===1&&o[v-1]===0)c+=1,A-=1;else if(_>=1&&o[v+1]===0)c+=1,A+=1,_>1&&(h=_);else{_!==1&&(h=Math.abs(_));continue}const T=[m,p],x=A===m+1,D={isHole:x,points:T,id:c,parent:0};d.push(D);let I;for(const L of d)if(L.id===h){I=L;break}I?I.isHole?D.parent=x?I.parent:h:D.parent=x?h:I.parent:D.parent=x?h:0;const U=this.#n(o,t,p,m,S,A,0);if(U===-1){o[v]=-c,o[v]!==1&&(h=Math.abs(o[v]));continue}let z=this.#i[2*U],F=this.#i[2*U+1];const R=p+z,O=m+F;S=R,A=O;let P=p,j=m;for(;;){const L=this.#r(o,t,P,j,S,A,1);z=this.#i[2*L],F=this.#i[2*L+1];const V=P+z,B=j+F;T.push(B,V);const de=P*t+j;if(o[de+1]===0?o[de]=-c:o[de]===1&&(o[de]=c),V===p&&B===m&&P===R&&j===O){o[v]!==1&&(h=Math.abs(o[v]));break}else S=P,A=j,P=V,j=B}}}return d}static#s(e,t,n,s){if(n-t<=4){for(let R=t;R<n-2;R+=2)s.push(e[R],e[R+1]);return}const a=e[t],o=e[t+1],c=e[n-4]-a,h=e[n-3]-o,d=Math.hypot(c,h),p=c/d,m=h/d,v=p*o-m*a,_=h/c,S=1/d,A=Math.atan(_),T=Math.cos(A),x=Math.sin(A),D=S*(Math.abs(T)+Math.abs(x)),I=S*(1-D+D**2),U=Math.max(Math.atan(Math.abs(x+T)*I),Math.atan(Math.abs(x-T)*I));let z=0,F=t;for(let R=t+2;R<n-2;R+=2){const O=Math.abs(v-p*e[R+1]+m*e[R]);O>z&&(F=R,z=O)}z>(d*U)**2?(this.#s(e,t,F+2,s),this.#s(e,F,n,s)):s.push(a,o)}static#o(e){const t=[],n=e.length;return this.#s(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,s,a,o){const c=new Float32Array(o**2),h=-2*s**2,d=o>>1;for(let A=0;A<o;A++){const T=(A-d)**2;for(let x=0;x<o;x++)c[A*o+x]=Math.exp((T+(x-d)**2)/h)}const p=new Float32Array(256),m=-2*a**2;for(let A=0;A<256;A++)p[A]=Math.exp(A**2/m);const v=e.length,_=new Uint8Array(v),S=new Uint32Array(256);for(let A=0;A<n;A++)for(let T=0;T<t;T++){const x=A*t+T,D=e[x];let I=0,U=0;for(let F=0;F<o;F++){const R=A+F-d;if(!(R<0||R>=n))for(let O=0;O<o;O++){const P=T+O-d;if(P<0||P>=t)continue;const j=e[R*t+P],L=c[F*o+O]*p[Math.abs(j-D)];I+=j*L,U+=L}}const z=_[x]=Math.round(I/U);S[z]++}return[_,S]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#d(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,a=1/0;for(let c=0,h=n.length;c<h;c++){const d=n[c]=e[c<<2];s=Math.max(s,d),a=Math.min(a,d)}const o=255/(s-a);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-a)*o;return n}static#h(e){let t,n=-1/0,s=-1/0;const a=e.findIndex(h=>h!==0);let o=a,c=a;for(t=a;t<256;t++){const h=e[t];h>n&&(t-o>s&&(s=t-o,c=t-1),n=h,o=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:s}=e,{maxDim:a}=this.#e;let o=n,c=s;if(n>a||s>a){let v=n,_=s,S=Math.log2(Math.max(n,s)/a);const A=Math.floor(S);S=S===A?A-1:A;for(let x=0;x<S;x++){o=Math.ceil(v/2),c=Math.ceil(_/2);const D=new OffscreenCanvas(o,c);D.getContext("2d").drawImage(e,0,0,v,_,0,0,o,c),v=o,_=c,e!==t&&e.close(),e=D.transferToImageBitmap()}const T=Math.min(a/o,a/c);o=Math.round(o*T),c=Math.round(c*T)}const d=new OffscreenCanvas(o,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,o,c),d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,o,c);const p=d.getImageData(0,0,o,c).data;return[this.#d(p),o,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},a,o,c,h){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const m=200,v=p.font=`${n} ${s} ${m}px ${t}`,{actualBoundingBoxLeft:_,actualBoundingBoxRight:S,actualBoundingBoxAscent:A,actualBoundingBoxDescent:T,fontBoundingBoxAscent:x,fontBoundingBoxDescent:D,width:I}=p.measureText(e),U=1.5,z=Math.ceil(Math.max(Math.abs(_)+Math.abs(S)||0,I)*U),F=Math.ceil(Math.max(Math.abs(A)+Math.abs(T)||m,Math.abs(x)+Math.abs(D)||m)*U);d=new OffscreenCanvas(z,F),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,z,F),p.fillStyle="black",p.fillText(e,z*(U-1)/2,F*(3-U)/2);const R=this.#d(p.getImageData(0,0,z,F).data),O=this.#l(R),P=this.#h(O),j=this.#a(R,z,F,P);return this.processDrawnLines({lines:{curves:j,width:z,height:F},pageWidth:a,pageHeight:o,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,a){const[o,c,h]=this.#f(e),[d,p]=this.#c(o,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),m=this.#h(p),v=this.#a(d,c,h,m);return this.processDrawnLines({lines:{curves:v,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:a,mustSmooth:o,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:d,height:p}=e,m=e.thickness??0,v=[],_=Math.min(t/d,n/p),S=_/t,A=_/n,T=[];for(const{points:D}of h){const I=o?this.#o(D):D;if(!I)continue;T.push(I);const U=I.length,z=new Float32Array(U),F=new Float32Array(3*(U===2?2:U-2));if(v.push({line:F,points:z}),U===2){z[0]=I[0]*S,z[1]=I[1]*A,F.set([NaN,NaN,NaN,NaN,z[0],z[1]],0);continue}let[R,O,P,j]=I;R*=S,O*=A,P*=S,j*=A,z.set([R,O,P,j],0),F.set([NaN,NaN,NaN,NaN,R,O],0);for(let L=4;L<U;L+=2){const V=z[L]=I[L]*S,B=z[L+1]=I[L+1]*A;F.set(ge.createBezierPoints(R,O,P,j,V,B),(L-2)*3),[R,O,P,j]=[P,j,V,B]}}if(v.length===0)return null;const x=c?new Jb:new sd;return x.build(v,t,n,1,s,c?0:m,a),{outline:x,newCurves:T,areContours:c,thickness:m,width:d,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:a}){let o=1/0,c=-1/0,h=0;for(const I of e){h+=I.length;for(let U=2,z=I.length;U<z;U++){const F=I[U]-I[U-2];o=Math.min(o,F),c=Math.max(c,F)}}let d;o>=-128&&c<=127?d=Int8Array:o>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const p=e.length,m=ip+eh*p,v=new Uint32Array(m);let _=0;v[_++]=m*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*d.BYTES_PER_ELEMENT,v[_++]=0,v[_++]=s,v[_++]=a,v[_++]=t?0:1,v[_++]=Math.max(0,Math.floor(n??0)),v[_++]=p,v[_++]=d.BYTES_PER_ELEMENT;for(const I of e)v[_++]=I.length-2,v[_++]=I[0],v[_++]=I[1];const S=new CompressionStream("deflate-raw"),A=S.writable.getWriter();await A.ready,A.write(v);const T=d.prototype.constructor;for(const I of e){const U=new T(I.length-2);for(let z=2,F=I.length;z<F;z++)U[z-2]=I[z]-I[z-2];A.write(U)}A.close();const x=await new Response(S.readable).arrayBuffer();return new Uint8Array(x).toBase64()}static async decompressSignature(e){try{const t=Uint8Array.fromBase64(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),a=s.getWriter();await a.ready,a.write(t).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,c=0;for await(const I of n)o||=new Uint8Array(new Uint32Array(I.buffer,0,4)[0]),o.set(I,c),c+=I.length;const h=new Uint32Array(o.buffer,0,o.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=h[2],m=h[3],v=h[4]===0,_=h[5],S=h[6],A=h[7],T=[],x=(ip+eh*S)*Uint32Array.BYTES_PER_ELEMENT;let D;switch(A){case Int8Array.BYTES_PER_ELEMENT:D=new Int8Array(o.buffer,x);break;case Int16Array.BYTES_PER_ELEMENT:D=new Int16Array(o.buffer,x);break;case Int32Array.BYTES_PER_ELEMENT:D=new Int32Array(o.buffer,x);break}c=0;for(let I=0;I<S;I++){const U=h[eh*I+ip],z=new Float32Array(U+2);T.push(z);for(let F=0;F<eh-1;F++)z[F]=h[eh*I+ip+F+1];for(let F=0;F<U;F++)z[F+2]=z[F]+D[c++]}return{areContours:v,thickness:_,outlines:T,width:p,height:m}}catch(t){return Ne(`decompressSignature: ${t}`),null}}}class b0 extends KI{constructor(){super(),super.updateProperties({fill:Se._defaultLineColor,"stroke-width":0})}clone(){const e=new b0;return e.updateAll(this),e}}class _0 extends Om{constructor(e){super(e),super.updateProperties({stroke:Se._defaultLineColor,"stroke-width":1})}clone(){const e=new _0(this._viewParameters);return e.updateAll(this),e}}class Vs extends st{#e=!1;#t=null;#i=null;#n=null;static _type="signature";static _editorType=Ue.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Se.initialize(e,t),this._defaultDrawingOptions=new b0,this._defaultDrawnSignatureOptions=new _0(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Me(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:a,areContours:o,description:c,uuid:h,heightInPage:d}=this.#i,{rawDims:{pageWidth:p,pageHeight:m},rotation:v}=this.parent.viewport,_=nc.processDrawnLines({lines:s,pageWidth:p,pageHeight:m,rotation:v,innerMargin:Vs._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(_,d,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:a}=this.#i,o=Math.max(s,a),c=nc.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:a,y:o}=this,{outline:c}=this.#i=e;this.#e=c instanceof Jb,this.description=n;let h;this.#e?h=Vs.getDefaultDrawingOptions():(h=Vs._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,d]=this.pageDimensions;let p=t/d;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return nc.process(e,t,n,s,Vs._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:a}=this.parent.viewport;return nc.extractContoursFromText(e,t,n,s,a,Vs._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return nc.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:Vs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Vs.getDefaultDrawingOptions():(this._drawingOptions=Vs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:s});return this.addComment(a),e?(a.paths={lines:t,points:n},a.uuid=this.#n,a.isCopy=!0):a.lines=t,this.#t&&(a.accessibilityData={type:"Figure",alt:this.#t}),a}static deserializeDraw(e,t,n,s,a,o){return o.areContours?Jb.deserialize(e,t,n,s,a,o):sd.deserialize(e,t,n,s,a,o)}static async deserialize(e,t,n){const s=await super.deserialize(e,t,n);return s.#e=e.areContours,s.description=e.accessibilityData?.alt||"",s.#n=e.uuid,s}}class kH extends Se{#e=null;#t=null;#i=null;#n=null;#r=null;#a="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Ue.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#r=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Se.initialize(e,t)}static isHandlingMimeForPasting(e){return qb.includes(e)}static paste(e,t){t.pasteEditor({mode:Ue.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#a=e.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#h(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#h(s)).finally(()=>this.#f());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(s=>this.#h(s)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=qb.join(",");const t=this._uiManager._signal;this.#i=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#s===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#i||this.#e||this.#n||this.#r||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,s&&(this.#e=s),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#m(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,a]=this.pageDimensions,o=.75;if(this.width)t=this.width*s,n=this.height*a;else if(t>o*s||n>o*a){const h=Math.min(o*s/t,o*a/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#s=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/s,this.height=n/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:s,height:a}=this.#e,o=new tr;let c=this.#e,h=s,d=a,p=null;if(t){if(s>t||a>t){const F=Math.min(t/s,t/a);h=Math.floor(s*F),d=Math.floor(a*F)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*o.sx),_=p.height=Math.ceil(d*o.sy);this.#l||(c=this.#u(v,_));const S=p.getContext("2d");S.filter=this._uiManager.hcmFilter;let A="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":Y5.isDarkMode&&(A="#8f8f9d",T="#42414d");const x=15,D=x*o.sx,I=x*o.sy,U=new OffscreenCanvas(D*2,I*2),z=U.getContext("2d");z.fillStyle=A,z.fillRect(0,0,D*2,I*2),z.fillStyle=T,z.fillRect(0,0,D,I),z.fillRect(D,I,D,I),S.fillStyle=S.createPattern(U,"repeat"),S.fillRect(0,0,v,_),S.drawImage(c,0,0,c.width,c.height,0,0,v,_)}let m=null;if(n){let v,_;if(o.symmetric&&c.width<e&&c.height<e)v=c.width,_=c.height;else if(c=this.#e,s>e||a>e){const T=Math.min(e/s,e/a);v=Math.floor(s*T),_=Math.floor(a*T),this.#l||(c=this.#u(v,_))}const A=new OffscreenCanvas(v,_).getContext("2d",{willReadFrequently:!0});A.drawImage(c,0,0,c.width,c.height,0,0,v,_),m={width:v,height:_,data:A.getImageData(0,0,v,_).data}}return{canvas:p,width:h,height:d,imageData:m}}#u(e,t){const{width:n,height:s}=this.#e;let a=n,o=s,c=this.#e;for(;a>2*e||o>2*t;){const h=a,d=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(a,o);p.getContext("2d").drawImage(c,0,0,h,d,0,0,a,o),c=p.transferToImageBitmap()}return c}#p(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,a=new tr,o=Math.ceil(n*e*a.sx),c=Math.ceil(s*t*a.sy),h=this.#s;if(!h||h.width===o&&h.height===c)return;h.width=o,h.height=c;const d=this.#l?this.#e:this.#u(o,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,o,c)}#y(e){if(e){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*Dc.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*Dc.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let s=null,a=!1;if(e instanceof GI){const{data:{rect:A,rotation:T,id:x,structParent:D,popupRef:I,richText:U,contentsObj:z,creationDate:F,modificationDate:R},container:O,parent:{page:{pageNumber:P}},canvas:j}=e;let L,V;j?(delete e.canvas,{id:L,bitmap:V}=n.imageManager.getFromCanvas(O.id,j),j.remove()):(a=!0,e._hasNoCanvas=!0);const B=(await t._structTree.getAriaAttributes(`${rc}${x}`))?.get("aria-label")||"";s=e={annotationType:Ue.STAMP,bitmapId:L,bitmap:V,pageIndex:P-1,rect:A.slice(0),rotation:T,annotationElementId:x,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:B},isSvg:!1,structParent:D,popupRef:I,richText:U,comment:z?.str||null,creationDate:F,modificationDate:R}}const o=await super.deserialize(e,t,n),{rect:c,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:m,accessibilityData:v}=e;a?(n.addMissingCanvas(e.id,o),o.#o=!0):p&&n.imageManager.isValidId(p)?(o.#t=p,h&&(o.#e=h)):o.#n=d,o.#l=m;const[_,S]=o.pageDimensions;return o.width=(c[2]-c[0])/_,o.height=(c[3]-c[1])/S,v&&(o.altTextData=v),o._initialData=s,e.comment&&o.setCommentData(e),o.#d=!!s,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#b(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const o=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=t.stamps.get(this.#t);o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#b(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===t,a=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Cr{#e;#t=!1;#i=null;#n=null;#r=null;#a=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([yn,v0,kH,Vt,Vs].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:a,annotationLayer:o,drawLayer:c,textLayer:h,viewport:d,l10n:p}){const m=[...Cr.#p.values()];if(!Cr._initialized){Cr._initialized=!0;for(const v of m)v.initialize(p,e)}e.registerEditorTypes(m),this.#u=e,this.pageIndex=t,this.div=n,this.#e=a,this.#i=o,this.viewport=d,this.#h=h,this.drawLayer=c,this._structTree=s,this.#u.addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Ue.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#w(),e){case Ue.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ue.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ue.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ue.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of Cr.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#h?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#i?.togglePointerEvents(e)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const e=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#i;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const s=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:d}=a,p=this.#m;if(d-p>500){this.#m=d;return}this.#m=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const v=document.elementsFromPoint(c,h);if(m.toggle("getElements",!1),!this.div.contains(v[0]))return;let _;const S=new RegExp(`^${Mh}[0-9]+$`);for(const T of v)if(S.test(T.id)){_=T.id;break}if(!_)return;const A=this.#a.get(_);A?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),A.dblclick(a))},{signal:s,capture:!0})}const e=this.#i,t=[];if(e){const s=new Map,a=new Map;for(const c of this.#y){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const o=e.getEditableAnnotations();for(const c of o){const{id:h}=c.data;if(this.#u.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let d=a.get(h);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=s.get(h),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of Cr.#p.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#i?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const e=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#b.bind(this),{signal:e}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#b(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#h.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#h.div.contains(t)){const{isMac:n}=dn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),Vt.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:e.x,y:e.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#a.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#a.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e),Se.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#r&&(e._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#a.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#v(){return Cr.#p.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#T(e){const t=this.#v;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:n,offsetY:s}=this.#E(),a=this.getNextId(),o=this.#T({parent:this,id:a,x:n,y:s,uiManager:this.#u,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Cr.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),a=this.#T({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...n});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#E(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,a=Math.max(0,e),o=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),d=(a+c)/2-e,p=(o+h)/2-t,[m,v]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:m,offsetY:v}}addNewEditor(e={}){this.createAndAddNewEditor(this.#E(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=dn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#s||(this.#s=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#u.getMode();if(n===Ue.STAMP||n===Ue.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===Ue.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:t}=dn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#s=!0,this.#v?.isDrawer){this.startDrawingSession(e);return}const n=this.#u.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:t}),this.#v.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#d=t);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(e)):null}findNewParent(e,t,n){const s=this.#u.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const e of this.#a.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#w(){for(const e of this.#a.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,qo(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#w();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,qo(this.div,{rotation:n}),t!==n)for(const s of this.#a.values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class Rn{#e=null;#t=new Map;#i=new Map;static#n=0;setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Me(this,"_svgFactory",new Wp)}static#r(e,[t,n,s,a]){const{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*a}%`}#a(){const e=Rn._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#s(e,t){const n=Rn._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const a=Rn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),s}#o(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)}draw(e,t=!1,n=!1){const s=Rn.#n++,a=this.#a(),o=Rn._svgFactory.createElement("defs");a.append(o);const c=Rn._svgFactory.createElement("path");o.append(c);const h=`path_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(s,c);const d=n?this.#s(o,h):null,p=Rn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,e),this.#t.set(s,a),{id:s,clipPathId:`url(#${d})`}}drawOutline(e,t){const n=Rn.#n++,s=this.#a(),a=Rn._svgFactory.createElement("defs");s.append(a);const o=Rn._svgFactory.createElement("path");a.append(o);const c=`path_${n}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const m=Rn._svgFactory.createElement("mask");a.append(m),h=`mask_${n}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const v=Rn._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const _=Rn._svgFactory.createElement("use");m.append(_),_.setAttribute("href",`#${c}`),_.setAttribute("stroke","none"),_.setAttribute("fill","black"),_.setAttribute("fill-rule","nonzero"),_.classList.add("mask")}const d=Rn._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${c}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return s.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(n,s),n}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:a,path:o}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#o(c,n),s&&Rn.#r(c,s),a){const{classList:h}=c;for(const[d,p]of Object.entries(a))h.toggle(d,p)}if(o){const d=c.firstElementChild.firstElementChild;this.#o(d,o)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Xb};globalThis.pdfjsLib={AbortException:za,AnnotationEditorLayer:Cr,AnnotationEditorParamsType:Ye,AnnotationEditorType:Ue,AnnotationEditorUIManager:Va,AnnotationLayer:y0,AnnotationMode:xa,AnnotationType:tn,applyOpacity:Q5,build:sH,ColorPicker:Ui,createValidAbsoluteUrl:pI,CSSConstants:X5,DOMSVGFactory:Wp,DrawLayer:Rn,FeatureTest:dn,fetchData:ed,findContrastColor:J5,getDocument:BI,getFilenameFromUrl:H5,getPdfFilenameFromUrl:$5,getRGB:nd,getUuid:gI,getXfaPageViewport:W5,GlobalWorkerOptions:wc,ImageKind:gp,InvalidPDFException:zb,isDataScheme:Tm,isPdfFile:o0,isValidExplicitDest:cq,MathClamp:In,noContextMenu:Hi,normalizeUnicode:V5,OPS:Lh,OutputScale:tr,PagesMapper:rt,PasswordResponses:O5,PDFDataRangeTransport:UI,PDFDateString:Vb,PDFWorker:Bh,PermissionFlag:D5,PixelsPerInch:Dc,RenderingCancelledException:a0,renderRichText:vI,ResponseException:$p,setLayerDimensions:qo,shadow:Me,SignatureExtractor:nc,stopEvent:jt,SupportedImageMimeTypes:qb,TextLayer:yi,TouchManager:xm,updateUrlHash:mI,Util:pe,VerbosityLevel:wm,version:iH,XfaLayer:yI};const RH="/assets/pdf.worker-BA9kU3Pw.mjs";var Ev,tx;function IH(){return tx||(tx=1,Ev={stopwords:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","?","?","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," "," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","6","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}),Ev}var Sv,nx;function DH(){return nx||(nx=1,Sv={stopwords:["a","aby","ahoj","aj","ale","anebo","ani","ani","ano","asi","aspo","atd","atp","az","akoli","a","bez","beze","blzko","bohuel","brzo","bude","budem","budeme","budes","budete","bude","budou","budu","by","byl","byla","byli","bylo","byly","bys","byt","bt","bhem","chce","chceme","chcete","chce","chci","chtt","chtj","chut'","chuti","ci","clanek","clanku","clanky","co","coz","co","cz","daleko","dalsi","dal","den","deset","design","devatenct","devt","dnes","do","dobr","docela","dva","dvacet","dvanct","dv","dl","dle","dkovat","dkujeme","dkuji","email","ho","hodn","i","jak","jakmile","jako","jako","jde","je","jeden","jedenct","jedna","jedno","jednou","jedou","jeho","jeho","jej","jeji","jejich","jej","jeliko","jemu","jen","jenom","jen","jeste","jestli","jestlie","jet","je","ji","jich","jimi","jinak","jine","jin","jiz","ji","jsem","jses","jse","jsi","jsme","jsou","jste","j","j","jm","j","jte","k","kam","kad","kde","kdo","kdy","kdyz","kdy","ke","kolik","krom","ktera","ktere","kteri","kterou","ktery","kter","kter","kter","ktei","kte","ku","kvli","ma","maj","mate","me","mezi","mi","mit","mne","mnou","mn","moc","mohl","mohou","moje","moji","mon","muj","mus","muze","my","m","mlo","mm","mme","mte","m","m","m","mt","m","mj","me","na","nad","nade","nam","napiste","napite","naproti","nas","nasi","nae","nae","nai","ne","nebo","nebyl","nebyla","nebyli","nebyly","nech","nedlaj","nedl","nedlm","nedlme","nedlte","nedl","neg","nejsi","nejsou","nemaj","nemme","nemte","neml","neni","nen","nesta","nevad","nez","ne","nic","nich","nimi","nove","novy","nov","nov","nula","n","nm","nmi","ns","n","n","nm","n","nco","njak","nkde","nkdo","nmu","nmu","o","od","ode","on","ona","oni","ono","ony","osm","osmnct","pak","patnct","po","pod","podle","pokud","potom","pouze","pozd","pod","prave","prav","pred","pres","pri","pro","proc","prost","prosm","proti","proto","protoze","protoe","pro","prvni","prvn","prve","pta","pt","ped","pede","pes","pese","pi","piem","re","rovn","s","se","sedm","sedmnct","si","sice","skoro","sm","smj","snad","spolu","sta","sto","strana","st","sve","svych","svym","svymi","sv","svch","svm","svmi","svj","ta","tady","tak","take","takhle","taky","takze","tak","take","tam","tamhle","tamhleto","tamto","tato","te","tebe","tebou","ted'","tedy","tema","ten","tento","teto","ti","tim","timto","tipy","tisc","tisce","to","tob","tohle","toho","tohoto","tom","tomto","tomu","tomuto","toto","troku","tu","tuto","tvoje","tv","tv","tvj","ty","tyto","tma","tto","tm","tmto","t","tm","tma","tmu","teba","ti","tinct","u","urit","uz","u","v","vam","vas","vase","vae","vai","ve","vedle","veer","vice","vlastn","vsak","vy","vm","vmi","vs","v","vce","vak","vechen","vechno","vichni","vbec","vdy","z","za","zatmco","za","zda","zde","ze","zpet","zpravy","zprvy","zpt","au","i","lnek","lnku","lnky","trnct","tyi","est","estnct","e"]}),Sv}var Tv,ix;function OH(){return ix||(ix=1,Tv={stopwords:["ad","af","aldrig","alle","alt","altid","anden","andet","andre","at","bagved","begge","blev","blive","bliver","da","de","dem","den","denne","der","deres","det","dette","dig","din","disse","dog","du","efter","ej","eller","en","end","endnu","ene","eneste","enhver","er","et","fem","fire","fjernt","flere","fleste","for","foran","fordi","forrige","fra","f","fr","gennem","god","ham","han","hans","har","havde","have","hende","hendes","her","hos","hovfor","hun","hurtig","hvad","hvem","hver","hvilken","hvis","hvonr","hvor","hvordan","hvorfor","hvorhen","hvornr","i","ikke","imod","ind","ingen","intet","ja","jeg","jer","jeres","jo","kan","kom","kommer","kunne","langsom","lav","lidt","lille","man","mand","mange","med","meget","mellem","men","mens","mere","mig","min","mindre","mine","mit","mod","mske","ned","nede","nej","ni","nogen","noget","nogle","nok","nu","ny","nyt","nr","nr","nste","nsten","og","ogs","om","op","oppe","os","otte","over","p","rask","sammen","se","seks","selv","ses","sig","sin","sine","sit","skal","skulle","som","stor","store","syv","sdan","temmelig","thi","ti","til","to","tre","ud","uden","udenfor","under","var","ved","vi","vil","ville","vor","vre","vret"]}),Tv}var xv,sx;function PH(){return sx||(sx=1,xv={stopwords:["a","ab","aber","ach","acht","achte","achten","achter","achtes","ag","alle","allein","allem","allen","aller","allerdings","alles","allgemeinen","als","also","am","an","andere","anderen","andern","anders","au","auch","auf","aus","ausser","auer","ausserdem","auerdem","b","bald","bei","beide","beiden","beim","beispiel","bekannt","bereits","besonders","besser","besten","bin","bis","bisher","bist","c","d","da","dabei","dadurch","dafr","dagegen","daher","dahin","dahinter","damals","damit","danach","daneben","dank","dann","daran","darauf","daraus","darf","darfst","darin","darber","darum","darunter","das","dasein","daselbst","dass","da","dasselbe","davon","davor","dazu","dazwischen","dein","deine","deinem","deiner","dem","dementsprechend","demgegenber","demgemss","demgem","demselben","demzufolge","den","denen","denn","denselben","der","deren","derjenige","derjenigen","dermassen","dermaen","derselbe","derselben","des","deshalb","desselben","dessen","deswegen","d.h","dich","die","diejenige","diejenigen","dies","diese","dieselbe","dieselben","diesem","diesen","dieser","dieses","dir","doch","dort","drei","drin","dritte","dritten","dritter","drittes","du","durch","durchaus","drfen","drft","durfte","durften","e","eben","ebenso","ehrlich","ei","ei,","eigen","eigene","eigenen","eigener","eigenes","ein","einander","eine","einem","einen","einer","eines","einige","einigen","einiger","einiges","einmal","eins","elf","en","ende","endlich","entweder","er","Ernst","erst","erste","ersten","erster","erstes","es","etwa","etwas","euch","f","frher","fnf","fnfte","fnften","fnfter","fnftes","fr","g","gab","ganz","ganze","ganzen","ganzer","ganzes","gar","gedurft","gegen","gegenber","gehabt","gehen","geht","gekannt","gekonnt","gemacht","gemocht","gemusst","genug","gerade","gern","gesagt","geschweige","gewesen","gewollt","geworden","gibt","ging","gleich","gott","gross","gro","grosse","groe","grossen","groen","grosser","groer","grosses","groes","gut","gute","guter","gutes","h","habe","haben","habt","hast","hat","hatte","htte","hatten","htten","heisst","her","heute","hier","hin","hinter","hoch","i","ich","ihm","ihn","ihnen","ihr","ihre","ihrem","ihren","ihrer","ihres","im","immer","in","indem","infolgedessen","ins","irgend","ist","j","ja","jahr","jahre","jahren","je","jede","jedem","jeden","jeder","jedermann","jedermanns","jedoch","jemand","jemandem","jemanden","jene","jenem","jenen","jener","jenes","jetzt","k","kam","kann","kannst","kaum","kein","keine","keinem","keinen","keiner","kleine","kleinen","kleiner","kleines","kommen","kommt","knnen","knnt","konnte","knnte","konnten","kurz","l","lang","lange","leicht","leide","lieber","los","m","machen","macht","machte","mag","magst","mahn","man","manche","manchem","manchen","mancher","manches","mann","mehr","mein","meine","meinem","meinen","meiner","meines","mensch","menschen","mich","mir","mit","mittel","mochte","mchte","mochten","mgen","mglich","mgt","morgen","muss","mu","mssen","musst","msst","musste","mussten","n","na","nach","nachdem","nahm","natrlich","neben","nein","neue","neuen","neun","neunte","neunten","neunter","neuntes","nicht","nichts","nie","niemand","niemandem","niemanden","noch","nun","nur","o","ob","oben","oder","offen","oft","ohne","Ordnung","p","q","r","recht","rechte","rechten","rechter","rechtes","richtig","rund","s","sa","sache","sagt","sagte","sah","satt","schlecht","Schluss","schon","sechs","sechste","sechsten","sechster","sechstes","sehr","sei","seid","seien","sein","seine","seinem","seinen","seiner","seines","seit","seitdem","selbst","sich","sie","sieben","siebente","siebenten","siebenter","siebentes","sind","so","solang","solche","solchem","solchen","solcher","solches","soll","sollen","sollte","sollten","sondern","sonst","sowie","spter","statt","t","tag","tage","tagen","tat","teil","tel","tritt","trotzdem","tun","u","ber","berhaupt","brigens","uhr","um","und","und?","uns","unser","unsere","unserer","unter","v","vergangenen","viel","viele","vielem","vielen","vielleicht","vier","vierte","vierten","vierter","viertes","vom","von","vor","w","wahr?","whrend","whrenddem","whrenddessen","wann","war","wre","waren","wart","warum","was","wegen","weil","weit","weiter","weitere","weiteren","weiteres","welche","welchem","welchen","welcher","welches","wem","wen","wenig","wenige","weniger","weniges","wenigstens","wenn","wer","werde","werden","werdet","wessen","wie","wieder","will","willst","wir","wird","wirklich","wirst","wo","wohl","wollen","wollt","wollte","wollten","worden","wurde","wrde","wurden","wrden","x","y","z","z.b","zehn","zehnte","zehnten","zehnter","zehntes","zeit","zu","zuerst","zugleich","zum","zunchst","zur","zurck","zusammen","zwanzig","zwar","zwei","zweite","zweiten","zweiter","zweites","zwischen","zwlf","\uFEFFaber","euer","eure","hattest","hattet","jedes","mut","mt","sollst","sollt","soweit","weshalb","wieso","woher","wohin"]}),xv}var Cv,rx;function NH(){return rx||(rx=1,Cv={stopwords:["a","a's","able","about","above","according","accordingly","across","actually","after","afterwards","again","against","ain't","all","allow","allows","almost","alone","along","already","also","although","always","am","among","amongst","an","and","another","any","anybody","anyhow","anyone","anything","anyway","anyways","anywhere","apart","appear","appreciate","appropriate","are","aren't","around","as","aside","ask","asking","associated","at","available","away","awfully","b","be","became","because","become","becomes","becoming","been","before","beforehand","behind","being","believe","below","beside","besides","best","better","between","beyond","both","brief","but","by","c","c'mon","c's","came","can","can't","cannot","cant","cause","causes","certain","certainly","changes","clearly","co","com","come","comes","concerning","consequently","consider","considering","contain","containing","contains","corresponding","could","couldn't","course","currently","d","definitely","described","despite","did","didn't","different","do","does","doesn't","doing","don't","done","down","downwards","during","e","each","edu","eg","eight","either","else","elsewhere","enough","entirely","especially","et","etc","even","ever","every","everybody","everyone","everything","everywhere","ex","exactly","example","except","f","far","few","fifth","first","five","followed","following","follows","for","former","formerly","forth","four","from","further","furthermore","g","get","gets","getting","given","gives","go","goes","going","gone","got","gotten","greetings","h","had","hadn't","happens","hardly","has","hasn't","have","haven't","having","he","he's","hello","help","hence","her","here","here's","hereafter","hereby","herein","hereupon","hers","herself","hi","him","himself","his","hither","hopefully","how","howbeit","however","i","i'd","i'll","i'm","i've","ie","if","ignored","immediate","in","inasmuch","inc","indeed","indicate","indicated","indicates","inner","insofar","instead","into","inward","is","isn't","it","it'd","it'll","it's","its","itself","j","just","k","keep","keeps","kept","know","knows","known","l","last","lately","later","latter","latterly","least","less","lest","let","let's","like","liked","likely","little","look","looking","looks","ltd","m","mainly","many","may","maybe","me","mean","meanwhile","merely","might","more","moreover","most","mostly","much","must","my","myself","n","name","namely","nd","near","nearly","necessary","need","needs","neither","never","nevertheless","new","next","nine","no","nobody","non","none","noone","nor","normally","not","nothing","novel","now","nowhere","o","obviously","of","off","often","oh","ok","okay","old","on","once","one","ones","only","onto","or","other","others","otherwise","ought","our","ours","ourselves","out","outside","over","overall","own","p","particular","particularly","per","perhaps","placed","please","plus","possible","presumably","probably","provides","q","que","quite","qv","r","rather","rd","re","really","reasonably","regarding","regardless","regards","relatively","respectively","right","s","said","same","saw","say","saying","says","second","secondly","see","seeing","seem","seemed","seeming","seems","seen","self","selves","sensible","sent","serious","seriously","seven","several","shall","she","should","shouldn't","since","six","so","some","somebody","somehow","someone","something","sometime","sometimes","somewhat","somewhere","soon","sorry","specified","specify","specifying","still","sub","such","sup","sure","t","t's","take","taken","tell","tends","th","than","thank","thanks","thanx","that","that's","thats","the","their","theirs","them","themselves","then","thence","there","there's","thereafter","thereby","therefore","therein","theres","thereupon","these","they","they'd","they'll","they're","they've","think","third","this","thorough","thoroughly","those","though","three","through","throughout","thru","thus","to","together","too","took","toward","towards","tried","tries","truly","try","trying","twice","two","u","un","under","unfortunately","unless","unlikely","until","unto","up","upon","us","use","used","useful","uses","using","usually","uucp","v","value","various","very","via","viz","vs","w","want","wants","was","wasn't","way","we","we'd","we'll","we're","we've","welcome","well","went","were","weren't","what","what's","whatever","when","whence","whenever","where","where's","whereafter","whereas","whereby","wherein","whereupon","wherever","whether","which","while","whither","who","who's","whoever","whole","whom","whose","why","will","willing","wish","with","within","without","won't","wonder","would","would","wouldn't","x","y","yes","yet","you","you'd","you'll","you're","you've","your","yours","yourself","yourselves","z","zero"]}),Cv}var kv,ax;function MH(){return ax||(ax=1,kv={stopwords:["0","1","2","3","4","5","6","7","8","9","_","a","actualmente","acuerdo","adelante","ademas","adems","adrede","afirm","agreg","ahi","ahora","ah","al","algo","alguna","algunas","alguno","algunos","algn","alli","all","alrededor","ambos","ampleamos","antano","antao","ante","anterior","antes","apenas","aproximadamente","aquel","aquella","aquellas","aquello","aquellos","aqui","aqul","aqulla","aqullas","aqullos","aqu","arriba","arribaabajo","asegur","asi","as","atras","aun","aunque","ayer","aadi","an","b","bajo","bastante","bien","breve","buen","buena","buenas","bueno","buenos","c","cada","casi","cerca","cierta","ciertas","cierto","ciertos","cinco","claro","coment","como","con","conmigo","conocer","conseguimos","conseguir","considera","consider","consigo","consigue","consiguen","consigues","contigo","contra","cosas","creo","cual","cuales","cualquier","cuando","cuanta","cuantas","cuanto","cuantos","cuatro","cuenta","cul","cules","cundo","cunta","cuntas","cunto","cuntos","cmo","d","da","dado","dan","dar","de","debajo","debe","deben","debido","decir","dej","del","delante","demasiado","dems","dentro","deprisa","desde","despacio","despues","despus","detras","detrs","dia","dias","dice","dicen","dicho","dieron","diferente","diferentes","dijeron","dijo","dio","donde","dos","durante","da","das","dnde","e","ejemplo","el","ella","ellas","ello","ellos","embargo","empleais","emplean","emplear","empleas","empleo","en","encima","encuentra","enfrente","enseguida","entonces","entre","era","erais","eramos","eran","eras","eres","es","esa","esas","ese","eso","esos","esta","estaba","estabais","estaban","estabas","estad","estada","estadas","estado","estados","estais","estamos","estan","estando","estar","estaremos","estar","estarn","estars","estar","estaris","estara","estarais","estaramos","estaran","estaras","estas","este","estemos","esto","estos","estoy","estuve","estuviera","estuvierais","estuvieran","estuvieras","estuvieron","estuviese","estuvieseis","estuviesen","estuvieses","estuvimos","estuviste","estuvisteis","estuviramos","estuvisemos","estuvo","est","estbamos","estis","estn","ests","est","estis","estn","ests","ex","excepto","existe","existen","explic","expres","f","fin","final","fue","fuera","fuerais","fueran","fueras","fueron","fuese","fueseis","fuesen","fueses","fui","fuimos","fuiste","fuisteis","furamos","fusemos","g","general","gran","grandes","gueno","h","ha","haber","habia","habida","habidas","habido","habidos","habiendo","habla","hablan","habremos","habr","habrn","habrs","habr","habris","habra","habrais","habramos","habran","habras","habis","haba","habais","habamos","haban","habas","hace","haceis","hacemos","hacen","hacer","hacerlo","haces","hacia","haciendo","hago","han","has","hasta","hay","haya","hayamos","hayan","hayas","hayis","he","hecho","hemos","hicieron","hizo","horas","hoy","hube","hubiera","hubierais","hubieran","hubieras","hubieron","hubiese","hubieseis","hubiesen","hubieses","hubimos","hubiste","hubisteis","hubiramos","hubisemos","hubo","i","igual","incluso","indic","informo","inform","intenta","intentais","intentamos","intentan","intentar","intentas","intento","ir","j","junto","k","l","la","lado","largo","las","le","lejos","les","lleg","lleva","llevar","lo","los","luego","lugar","m","mal","manera","manifest","mas","mayor","me","mediante","medio","mejor","mencion","menos","menudo","mi","mia","mias","mientras","mio","mios","mis","misma","mismas","mismo","mismos","modo","momento","mucha","muchas","mucho","muchos","muy","ms","m","ma","mas","mo","mos","n","nada","nadie","ni","ninguna","ningunas","ninguno","ningunos","ningn","no","nos","nosotras","nosotros","nuestra","nuestras","nuestro","nuestros","nueva","nuevas","nuevo","nuevos","nunca","o","ocho","os","otra","otras","otro","otros","p","pais","para","parece","parte","partir","pasada","pasado","pas","peor","pero","pesar","poca","pocas","poco","pocos","podeis","podemos","poder","podria","podra","podriais","podriamos","podrian","podrias","podr","podrn","podra","podran","poner","por","por qu","porque","posible","primer","primera","primero","primeros","principalmente","pronto","propia","propias","propio","propios","proximo","prximo","prximos","pudo","pueda","puede","pueden","puedo","pues","q","qeu","que","qued","queremos","quien","quienes","quiere","quiza","quizas","quiz","quizs","quin","quines","qu","r","raras","realizado","realizar","realiz","repente","respecto","s","sabe","sabeis","sabemos","saben","saber","sabes","sal","salvo","se","sea","seamos","sean","seas","segun","segunda","segundo","segn","seis","ser","sera","seremos","ser","sern","sers","ser","seris","sera","serais","seramos","seran","seras","seis","seal","si","sido","siempre","siendo","siete","sigue","siguiente","sin","sino","sobre","sois","sola","solamente","solas","solo","solos","somos","son","soy","soyos","su","supuesto","sus","suya","suyas","suyo","suyos","s","s","slo","t","tal","tambien","tambin","tampoco","tan","tanto","tarde","te","temprano","tendremos","tendr","tendrn","tendrs","tendr","tendris","tendra","tendrais","tendramos","tendran","tendras","tened","teneis","tenemos","tener","tenga","tengamos","tengan","tengas","tengo","tengis","tenida","tenidas","tenido","tenidos","teniendo","tenis","tena","tenais","tenamos","tenan","tenas","tercera","ti","tiempo","tiene","tienen","tienes","toda","todas","todavia","todava","todo","todos","total","trabaja","trabajais","trabajamos","trabajan","trabajar","trabajas","trabajo","tras","trata","travs","tres","tu","tus","tuve","tuviera","tuvierais","tuvieran","tuvieras","tuvieron","tuviese","tuvieseis","tuviesen","tuvieses","tuvimos","tuviste","tuvisteis","tuviramos","tuvisemos","tuvo","tuya","tuyas","tuyo","tuyos","t","u","ultimo","un","una","unas","uno","unos","usa","usais","usamos","usan","usar","usas","uso","usted","ustedes","v","va","vais","valor","vamos","van","varias","varios","vaya","veces","ver","verdad","verdadera","verdadero","vez","vosotras","vosotros","voy","vuestra","vuestras","vuestro","vuestros","w","x","y","ya","yo","z","l","ramos","sa","sas","se","sos","sta","stas","ste","stos","ltima","ltimas","ltimo","ltimos"]}),kv}var Rv,ox;function LH(){return ox||(ox=1,Rv={stopwords:["1","2","3","4","5","6","7","8","9","0","","","","","","","","","","","","!",'"',"'","`","","","{","}","(",")","%","","","-",";","","","","","","","","","","","]","[","@","#","$","%","&","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","?","",":","","NULL","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","?","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","?","","?","?","?","?","?","?","","?","","","?","?","","?","","?","","","","","","","","?","","","","","","","","","","","?","","?","","","","?","","","?","","?","?","??","?","?","?","?","?","","","","?","","","?","","?","","?","?","","","","","?","?","?","?","?","","","?","","","?","   ","   ","?   ","?   ","   ","?   ","??   ","?","?","","","","?   ","","","?   ","??   ","","?","","","?","?   ","","","   ","?   ","?   ","   ","?   ","   ","?   ","??  ","?","?","","","","?","?","??","","?","?","","?","","","","",""," ","","","","","??","?","?","","??","","?","","?","","?","","","?","?","?","","?","?","","??","","","","?","","?","?","","","","?","??","","","","","","","","","","?","?","","","","","","","","","","?","","","","","","","","?","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","?","","","","","?","","","","","","","","","","","","","","","","","","","","","","","?","","?","","","","","","","","",".","","","","","","","","","?","","","","?","?","","","","?","?","?","","?","?","","","_","","?","?a","","",".","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","	","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","	","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","!",'"',"#","(",")","*",",","-",".","/",":","[","]","","","","","","","","","","","",""," ","","","",""," ","","","","","","","","","",""," ","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","  "," "," ","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","",""," "," "," ","","","","","","","","","","","","",""," ",""," "," ","","","","","",""," ",""," ","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","",""," ","","   ","","","","","","",""," ","","","",""," ","","","","","","","",""," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","  ","  "," "," "," "," "," ","  "," "," "," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," "," "," "," "," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ",""," ","","","","","","","","","","",""," ","","",""," ","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","",""," ","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","  "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," "," "," "," "," "," "," "," "," ",""," ","","","  ",""," "," ","","","","","",""," ","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","  ",""," "," "," ","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","  ","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","  "," ","",""," "," ","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","  ","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","",""," ","","","","","","","","","","",""," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","  ","  ","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","  "," ","  "," ","","","","","","","","","","","","","","  ",""," "," ","","  ","  ","","","","","",""," "," "," ","","","",""," ","","","","","","",""," ","","","",""," ","","",""," ","","","","","","","  "," ","","","","","","",""," ","","",""," ","","","","","","","","","","","","","",""," ","","","","",""," "," ",""," ","",""," ",""," ","","","","","","","","","","","","",""," "," ","","","","","",""," ","","","","",""," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ",""," "," "," ","","","","","","","","","","","","","","","","","\uFEFF","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","!",'"',"#","(",")","*","-",".","/",":","[","]","","","","","","","","","","","","","","","","","$","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","  ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","  ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}),Rv}var Iv,lx;function jH(){return lx||(lx=1,Iv={stopwords:["a","","","abord","afin","ah","ai","aie","ainsi","allaient","allo","all","allons","aprs","assez","attendu","au","aucun","aucune","aujourd","aujourd'hui","auquel","aura","auront","aussi","autre","autres","aux","auxquelles","auxquels","avaient","avais","avait","avant","avec","avoir","ayant","b","bah","beaucoup","bien","bigre","boum","bravo","brrr","c","a","car","ce","ceci","cela","celle","celle-ci","celle-l","celles","celles-ci","celles-l","celui","celui-ci","celui-l","cent","cependant","certain","certaine","certaines","certains","certes","ces","cet","cette","ceux","ceux-ci","ceux-l","chacun","chaque","cher","chre","chres","chers","chez","chiche","chut","ci","cinq","cinquantaine","cinquante","cinquantime","cinquime","clac","clic","combien","comme","comment","compris","concernant","contre","couic","crac","d","da","dans","de","debout","dedans","dehors","del","depuis","derrire","des","ds","dsormais","desquelles","desquels","dessous","dessus","deux","deuxime","deuximement","devant","devers","devra","diffrent","diffrente","diffrentes","diffrents","dire","divers","diverse","diverses","dix","dix-huit","dixime","dix-neuf","dix-sept","doit","doivent","donc","dont","douze","douzime","dring","du","duquel","durant","e","effet","eh","elle","elle-mme","elles","elles-mmes","en","encore","entre","envers","environ","es","s","est","et","etant","taient","tais","tait","tant","etc","t","etre","tre","eu","euh","eux","eux-mmes","except","f","faon","fais","faisaient","faisant","fait","feront","fi","flac","floc","font","g","gens","h","ha","h","hein","hlas","hem","hep","hi","ho","hol","hop","hormis","hors","hou","houp","hue","hui","huit","huitime","hum","hurrah","i","il","ils","importe","j","je","jusqu","jusque","k","l","la","l","laquelle","las","le","lequel","les","ls","lesquelles","lesquels","leur","leurs","longtemps","lorsque","lui","lui-mme","m","ma","maint","mais","malgr","me","mme","mmes","merci","mes","mien","mienne","miennes","miens","mille","mince","moi","moi-mme","moins","mon","moyennant","n","na","ne","nanmoins","neuf","neuvime","ni","nombreuses","nombreux","non","nos","notre","ntre","ntres","nous","nous-mmes","nul","o","o|","","oh","oh","ol","oll","on","ont","onze","onzime","ore","ou","o","ouf","ouias","oust","ouste","outre","p","paf","pan","par","parmi","partant","particulier","particulire","particulirement","pas","pass","pendant","personne","peu","peut","peuvent","peux","pff","pfft","pfut","pif","plein","plouf","plus","plusieurs","plutt","pouah","pour","pourquoi","premier","premire","premirement","prs","proche","psitt","puisque","q","qu","quand","quant","quanta","quant--soi","quarante","quatorze","quatre","quatre-vingt","quatrime","quatrimement","que","quel","quelconque","quelle","quelles","quelque","quelques","quelqu'un","quels","qui","quiconque","quinze","quoi","quoique","r","revoici","revoil","rien","s","sa","sacrebleu","sans","sapristi","sauf","se","seize","selon","sept","septime","sera","seront","ses","si","sien","sienne","siennes","siens","sinon","six","sixime","soi","soi-mme","soit","soixante","son","sont","sous","stop","suis","suivant","sur","surtout","t","ta","tac","tant","te","t","tel","telle","tellement","telles","tels","tenant","tes","tic","tien","tienne","tiennes","tiens","toc","toi","toi-mme","ton","touchant","toujours","tous","tout","toute","toutes","treize","trente","trs","trois","troisime","troisimement","trop","tsoin","tsouin","tu","u","un","une","unes","uns","v","va","vais","vas","v","vers","via","vif","vifs","vingt","vivat","vive","vives","vlan","voici","voil","vont","vos","votre","vtre","vtres","vous","vous-mmes","vu","w","x","y","z","zut","\uFEFFalors","aucuns","bon","devrait","dos","droite","dbut","essai","faites","fois","force","haut","ici","juste","maintenant","mine","mot","nomms","nouveaux","parce","parole","personnes","pice","plupart","seulement","soyez","sujet","tandis","valeur","voie","voient","tat","tions"]}),Iv}var Dv,cx;function BH(){return cx||(cx=1,Dv={stopwords:["a","anda","al","aquel","aquela","aquelas","aqueles","aquilo","aqu","ao","aos","as","as","","ben","cando","che","co","coa","comigo","con","connosco","contigo","convosco","coas","cos","cun","cuns","cunha","cunhas","da","dalgunha","dalgunhas","dalgn","dalgns","das","de","del","dela","delas","deles","desde","deste","do","dos","dun","duns","dunha","dunhas","e","el","ela","elas","eles","en","era","eran","esa","esas","ese","eses","esta","estar","estaba","est","estn","este","estes","estiven","estou","eu","","facer","foi","foron","fun","haba","hai","iso","isto","la","las","lle","lles","lo","los","mais","me","meu","meus","min","mia","mias","moi","na","nas","neste","nin","no","non","nos","nosa","nosas","noso","nosos","ns","nun","nunha","nuns","nunhas","o","os","ou","","s","para","pero","pode","pois","pola","polas","polo","polos","por","que","se","senn","ser","seu","seus","sexa","sido","sobre","sa","sas","tamn","tan","te","ten","teen","teo","ter","teu","teus","ti","tido","tia","tiven","ta","tas","un","unha","unhas","uns","vos","vosa","vosas","voso","vosos","vs"]}),Dv}var Ov,ux;function UH(){return ux||(ux=1,Ov={stopwords:["a","adesso","ai","al","alla","allo","allora","altre","altri","altro","anche","ancora","avere","aveva","avevano","ben","buono","che","chi","cinque","comprare","con","consecutivi","consecutivo","cosa","cui","da","del","della","dello","dentro","deve","devo","di","doppio","due","e","ecco","fare","fine","fino","fra","gente","giu","ha","hai","hanno","ho","il","indietro","invece","io","la","lavoro","le","lei","lo","loro","lui","lungo","ma","me","meglio","molta","molti","molto","nei","nella","no","noi","nome","nostro","nove","nuovi","nuovo","o","oltre","ora","otto","peggio","pero","persone","piu","poco","primo","promesso","qua","quarto","quasi","quattro","quello","questo","qui","quindi","quinto","rispetto","sara","secondo","sei","sembra","sembrava","senza","sette","sia","siamo","siete","solo","sono","sopra","soprattutto","sotto","stati","stato","stesso","su","subito","sul","sulla","tanto","te","tempo","terzo","tra","tre","triplo","ultimo","un","una","uno","va","vai","voi","volte","vostro","a","abbastanza","accidenti","ad","affinche","agli","ahime","ahim","alcuna","alcuni","alcuno","all","alle","altrimenti","altrui","anni","anno","ansa","assai","attesa","avanti","avendo","avente","aver","avete","avuta","avute","avuti","avuto","basta","bene","benissimo","berlusconi","brava","bravo","c","casa","caso","cento","certa","certe","certi","certo","chicchessia","chiunque","ci","ciascuna","ciascuno","cima","cio","ci","cioe","cio","circa","citta","citt","codesta","codesti","codesto","cogli","coi","col","colei","coll","coloro","colui","come","concernente","consiglio","contro","cortesia","cos","cosi","cos","d","dagli","dai","dal","dall","dalla","dalle","dallo","davanti","degli","dei","dell","delle","detto","dice","dietro","dire","dirimpetto","dopo","dove","dovra","dovr","dunque","durante","","ed","egli","ella","eppure","era","erano","esse","essendo","esser","essere","essi","ex","fa","fatto","favore","fin","finalmente","finche","forse","fuori","gia","gi","giacche","giorni","giorno","gli","gliela","gliele","glieli","glielo","gliene","grande","grazie","gruppo","i","ieri","improvviso","in","infatti","insieme","intanto","intorno","l","l","li","lontano","macche","magari","mai","male","malgrado","malissimo","medesimo","mediante","meno","mentre","mesi","mezzo","mi","mia","mie","miei","mila","miliardi","milioni","ministro","mio","moltissimo","ne","negli","nel","nell","nelle","nello","nemmeno","neppure","nessuna","nessuno","niente","non","nondimeno","nostra","nostre","nostri","nulla","od","oggi","ogni","ognuna","ognuno","oppure","ore","osi","ossia","paese","parecchi","parecchie","parecchio","parte","partendo","peccato","per","perche","perch","percio","perci","perfino","per","piedi","pieno","piglia","pi","po","pochissimo","poi","poiche","press","prima","proprio","puo","pu","pure","purtroppo","qualche","qualcuna","qualcuno","quale","quali","qualunque","quando","quanta","quante","quanti","quanto","quantunque","quel","quella","quelli","quest","questa","queste","questi","riecco","salvo","sar","sarebbe","scopo","scorso","se","seguente","sempre","si","solito","sta","staranno","stata","state","sua","successivo","sue","sugli","sui","sull","sulle","sullo","suo","suoi","tale","talvolta","ti","tranne","troppo","tu","tua","tue","tuo","tuoi","tutta","tuttavia","tutte","tutti","tutto","uguali","uomo","vale","varia","varie","vario","verso","vi","via","vicino","visto","vita","volta","vostra","vostre","vostri"]}),Ov}var Pv,hx;function FH(){return hx||(hx=1,Pv={stopwords:["","","","","","","","","","","","","","","","","","","","","","","","",""," "," ","","","","","","","","","","",""," "," "," "," "," ","",""," ","","","",""," "," ","","","",""," ","  ","","","","","","","","","",""," "," ","",""," ","","","","","",""," ","","",""," ","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","",""," "," "," "," ","","","","","","","","","","",""," ","","","","","","","","","","","",""," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," "," ","","","","","","","","","","","","","","","","","","",""," "," ","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","",""," ","","","",""," "," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","",""," ","",""," "," ","","","","","","","","","","","",""," "," ","","","","","","","","","","","","","","","","  ","  ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","",""," "," "," ","","","","","","","",""," ","","","",""," "," ","","","","","","","","","","","",""," ","",""," "," ","",""," "," ","","","","","","","","","","","","","",""," ","","","","","","","","","","","",""," ","","","  ","",""," ","","",""," "," "," ","","","","","","","",""," ","","","","","","","","","","","","","",""," "," ",""," "," ","",""," ",""," ",""," ","  ","   "," ","",""," "," ","",""," ","","","","",""," ","","","","","",""," ","  ","","","","","","","","","","","","","","","","","","",""," ",""," ","   ",""," ","  "," ","",""," ","","","","  "," ","","","",""," "," ",""," ",""," "," "," ","",""," "," ","","","",""," "," "," ",""," ","","",""," ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}),Pv}var Nv,dx;function zH(){return dx||(dx=1,Nv={stopwords:["aan","af","al","als","bij","dan","dat","die","dit","een","en","er","had","heb","hem","het","hij","hoe","hun","ik","in","is","je","kan","me","men","met","mij","nog","nu","of","ons","ook","te","tot","uit","van","was","wat","we","wel","wij","zal","ze","zei","zij","zo","zou","aan","aangaande","aangezien","achter","achterna","afgelopen","al","aldaar","aldus","alhoewel","alias","alle","allebei","alleen","alsnog","altijd","altoos","ander","andere","anders","anderszins","behalve","behoudens","beide","beiden","ben","beneden","bent","bepaald","betreffende","bij","binnen","binnenin","boven","bovenal","bovendien","bovengenoemd","bovenstaand","bovenvermeld","buiten","daar","daarheen","daarin","daarna","daarnet","daarom","daarop","daarvanlangs","dan","dat","de","die","dikwijls","dit","door","doorgaand","dus","echter","eer","eerdat","eerder","eerlang","eerst","elk","elke","en","enig","enigszins","enkel","er","erdoor","even","eveneens","evenwel","gauw","gedurende","geen","gehad","gekund","geleden","gelijk","gemoeten","gemogen","geweest","gewoon","gewoonweg","haar","had","hadden","hare","heb","hebben","hebt","heeft","hem","hen","het","hierbeneden","hierboven","hij","hoe","hoewel","hun","hunne","ik","ikzelf","in","inmiddels","inzake","is","jezelf","jij","jijzelf","jou","jouw","jouwe","juist","jullie","kan","klaar","kon","konden","krachtens","kunnen","kunt","later","liever","maar","mag","meer","met","mezelf","mij","mijn","mijnent","mijner","mijzelf","misschien","mocht","mochten","moest","moesten","moet","moeten","mogen","na","naar","nadat","net","niet","noch","nog","nogal","nu","of","ofschoon","om","omdat","omhoog","omlaag","omstreeks","omtrent","omver","onder","ondertussen","ongeveer","ons","onszelf","onze","ook","op","opnieuw","opzij","over","overeind","overigens","pas","precies","reeds","rond","rondom","sedert","sinds","sindsdien","slechts","sommige","spoedig","steeds","tamelijk","tenzij","terwijl","thans","tijdens","toch","toen","toenmaals","toenmalig","tot","totdat","tussen","uit","uitgezonderd","vaakwat","van","vandaan","vanuit","vanwege","veeleer","verder","vervolgens","vol","volgens","voor","vooraf","vooral","vooralsnog","voorbij","voordat","voordezen","voordien","voorheen","voorop","vooruit","vrij","vroeg","waar","waarom","wanneer","want","waren","was","weer","weg","wegens","wel","weldra","welk","welke","wie","wiens","wier","wij","wijzelf","zal","ze","zelfs","zichzelf","zij","zijn","zijne","zo","zodra","zonder","zou","zouden","zowat","zulke","zullen","zult"]}),Nv}var Mv,fx;function VH(){return fx||(fx=1,Mv={stopwords:["a","aby","ach","acz","aczkolwiek","aj","albo","ale","alez","ale","ani","az","a","bardziej","bardzo","bo","bowiem","by","byli","bynajmniej","byc","by","byl","by","byla","bylo","byly","bya","byo","byy","bedzie","bdzie","beda","bd","cali","cala","caa","caly","cay","ci","cie","ci","ciebie","co","cokolwiek","cos","co","czasami","czasem","czemu","czy","czyli","daleko","dla","dlaczego","dlatego","do","dobrze","dokad","dokd","dosc","do","duzo","duo","dwa","dwaj","dwie","dwoje","dzis","dzi","dzisiaj","gdy","gdyby","gdyz","gdy","gdzie","gdziekolwiek","gdzies","gdzie","go","i","ich","ile","im","inna","inne","inny","innych","iz","i","ja","j","jak","jakas","jaka","jakby","jaki","jakichs","jakich","jakie","jakis","jaki","jakiz","jaki","jakkolwiek","jako","jakos","jako","je","jeden","jedna","jedno","jednak","jednakze","jednake","jego","jej","jemu","jest","jestem","jeszcze","jesli","jeli","jezeli","jeeli","juz","ju","kazdy","kady","kiedy","kilka","kims","kim","kto","ktokolwiek","ktos","kto","ktora","ktore","ktre","ktorego","ktorej","ktory","ktorych","ktorym","ktorzy","ktra","ktrego","ktrej","ktry","ktrych","ktrym","ktrzy","ku","lat","lecz","lub","ma","maj","mao","mam","mi","mimo","miedzy","midzy","mna","mn","mnie","moga","mog","moi","moim","moja","moje","moze","moe","mozliwe","mozna","moliwe","mona","moj","mj","mu","musi","my","na","nad","nam","nami","nas","nasi","nasz","nasza","nasze","naszego","naszych","natomiast","natychmiast","nawet","nia","ni","nic","nich","nie","niech","niego","niej","niemu","nigdy","nim","nimi","niz","ni","no","o","obok","od","okoo","on","ona","one","oni","ono","oraz","oto","owszem","pan","pana","pani","po","pod","podczas","pomimo","ponad","poniewaz","poniewa","powinien","powinna","powinni","powinno","poza","prawie","przeciez","przecie","przed","przede","przedtem","przez","przy","roku","rowniez","rwnie","sam","sama","s","sie","si","skad","skd","sobie","soba","sob","sposob","sposb","swoje","ta","tak","taka","taki","takie","takze","take","tam","te","tego","tej","ten","teraz","te","to","toba","tob","tobie","totez","tote","trzeba","tu","tutaj","twoi","twoim","twoja","twoje","twym","twoj","twj","ty","tych","tylko","tym","u","w","wam","wami","was","wasz","wasza","wasze","we","wedug","wiele","wielu","wic","wicej","wszyscy","wszystkich","wszystkie","wszystkim","wszystko","wtedy","wy","wlasnie","wanie","z","za","zapewne","zawsze","ze","znowu","znow","znw","zostal","zosta","zaden","zadna","zadne","zadnych","ze","zeby","aden","adna","adne","adnych","e","eby"]}),Mv}var Lv,px;function qH(){return px||(px=1,Lv={stopwords:["a","","adeus","agora","a","ainda","alm","algo","algumas","alguns","ali","ano","anos","antes","ao","aos","apenas","apoio","aps","aquela","aquelas","aquele","aqueles","aqui","aquilo","rea","as","s","assim","at","atrs","atravs","baixo","bastante","bem","boa","boas","bom","bons","breve","c","cada","catorze","cedo","cento","certamente","certeza","cima","cinco","coisa","com","como","conselho","contra","custa","da","d","do","daquela","daquelas","daquele","daqueles","dar","das","de","debaixo","demais","dentro","depois","desde","dessa","dessas","desse","desses","desta","destas","deste","destes","deve","dever","dez","dezanove","dezasseis","dezassete","dezoito","dia","diante","diz","dizem","dizer","do","dois","dos","doze","duas","dvida","e","","ela","elas","ele","eles","em","embora","entre","era","s","essa","essas","esse","esses","esta","est","esto","estar","estas","ests","estava","este","estes","esteve","estive","estivemos","estiveram","estiveste","estivestes","estou","eu","exemplo","fao","falta","favor","faz","fazeis","fazem","fazemos","fazer","fazes","fez","fim","final","foi","fomos","for","foram","forma","foste","fostes","fui","geral","grande","grandes","grupo","h","hoje","hora","horas","isso","isto","j","l","lado","local","logo","longe","lugar","maior","maioria","mais","mal","mas","mximo","me","meio","menor","menos","ms","meses","meu","meus","mil","minha","minhas","momento","muito","muitos","na","nada","no","naquela","naquelas","naquele","naqueles","nas","nem","nenhuma","nessa","nessas","nesse","nesses","nesta","nestas","neste","nestes","nvel","no","noite","nome","nos","ns","nossa","nossas","nosso","nossos","nova","novas","nove","novo","novos","num","numa","nmero","nunca","o","obra","obrigada","obrigado","oitava","oitavo","oito","onde","ontem","onze","os","ou","outra","outras","outro","outros","para","parece","parte","partir","paucas","pela","pelas","pelo","pelos","perto","pode","pde","podem","poder","pe","pem","ponto","pontos","por","porque","porqu","posio","possvel","possivelmente","posso","pouca","pouco","poucos","primeira","primeiras","primeiro","primeiros","prpria","prprias","prprio","prprios","prxima","prximas","prximo","prximos","puderam","quis","qual","quando","quanto","quarta","quarto","quatro","que","qu","quem","quer","quereis","querem","queremas","queres","quero","questo","quinta","quinto","quinze","relao","sabe","sabem","so","se","segunda","segundo","sei","seis","sem","sempre","ser","seria","sete","stima","stimo","seu","seus","sexta","sexto","sim","sistema","sob","sobre","sois","somos","sou","sua","suas","tal","talvez","tambm","tanta","tantas","tanto","to","tarde","te","tem","tm","temos","tendes","tenho","tens","ter","terceira","terceiro","teu","teus","teve","tive","tivemos","tiveram","tiveste","tivestes","toda","todas","todo","todos","trabalho","trs","treze","tu","tua","tuas","tudo","um","uma","umas","uns","vai","vais","vo","vrios","vem","vm","vens","ver","vez","vezes","viagem","vindo","vinte","voc","vocs","vos","vs","vossa","vossas","vosso","vossos","zero"]}),Lv}var jv,mx;function HH(){return mx||(mx=1,jv={stopwords:["a","abia","acea","aceasta","aceast","aceea","aceeasi","acei","aceia","acel","acela","acelasi","acele","acelea","acest","acesta","aceste","acestea","acestei","acestia","acestui","aceti","acetia","acolo","acord","acum","adica","ai","aia","aib","aici","aiurea","al","ala","alaturi","ale","alea","alt","alta","altceva","altcineva","alte","altfel","alti","altii","altul","am","anume","apoi","ar","are","as","asa","asemenea","asta","astazi","astea","astfel","astzi","asupra","atare","atat","atata","atatea","atatia","ati","atit","atita","atitea","atitia","atunci","au","avea","avem","avei","avut","azi","a","aadar","ai","b","ba","bine","bucur","bun","c","ca","cam","cand","capat","care","careia","carora","caruia","cat","catre","caut","ce","cea","ceea","cei","ceilalti","cel","cele","celor","ceva","chiar","ci","cinci","cind","cine","cineva","cit","cita","cite","citeva","citi","citiva","conform","contra","cu","cui","cum","cumva","curnd","curnd","cnd","ct","cte","ctva","ci","cnd","ct","cte","ctva","ci","c","cci","crei","cror","crui","ctre","d","da","daca","dac","dar","dat","datorit","dat","dau","de","deasupra","deci","decit","degraba","deja","deoarece","departe","desi","despre","dei","din","dinaintea","dintr","dintr-","dintre","doar","doi","doilea","dou","drept","dupa","dup","d","e","ea","ei","el","ele","era","eram","este","eu","exact","eti","f","face","fara","fata","fel","fi","fie","fiecare","fii","fim","fiu","fii","foarte","fost","frumos","fr","g","geaba","graie","h","halb","i","ia","iar","ieri","ii","il","imi","in","inainte","inapoi","inca","incit","insa","intr","intre","isi","iti","j","k","l","la","le","li","lor","lui","lng","lng","m","ma","mai","mare","mea","mei","mele","mereu","meu","mi","mie","mine","mod","mult","multa","multe","multi","mult","muli","mulumesc","mine","mine","m","n","ne","nevoie","ni","nici","niciodata","nicieri","nimeni","nimeri","nimic","niste","nite","noastre","noastr","noi","noroc","nostri","nostru","nou","noua","nou","notri","nu","numai","o","opt","or","ori","oricare","orice","oricine","oricum","oricnd","orict","oricnd","orict","oriunde","p","pai","parca","patra","patru","patrulea","pe","pentru","peste","pic","pina","plus","poate","pot","prea","prima","primul","prin","printr-","putini","puin","puina","puin","pn","pn","r","rog","s","sa","sa-mi","sa-ti","sai","sale","sau","se","si","sint","sintem","spate","spre","sub","sunt","suntem","suntei","sus","sut","snt","sntem","sntei","s","si","su","t","ta","tale","te","ti","timp","tine","toata","toate","toat","tocmai","tot","toti","totul","totusi","totui","toi","trei","treia","treilea","tu","tuturor","ti","tu","u","ul","ului","un","una","unde","undeva","unei","uneia","unele","uneori","unii","unor","unora","unu","unui","unuia","unul","v","va","vi","voastre","voastr","voi","vom","vor","vostru","vou","votri","vreme","vreo","vreun","v","x","z","zece","zero","zi","zice","i","l","mi","mpotriva","n","nainte","naintea","ncotro","nct","nct","ntre","ntruct","ntruct","i","la","lea","sta","stea","tia","apte","ase","i","tiu","i","ie"]}),jv}var Bv,gx;function $H(){return gx||(gx=1,Bv={stopwords:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}),Bv}var Uv,yx;function GH(){return yx||(yx=1,Uv={stopwords:["aderton","adertonde","adj","aldrig","alla","allas","allt","alltid","allts","n","andra","andras","annan","annat","nnu","artonde","artonn","tminstone","att","tta","ttio","ttionde","ttonde","av","ven","bda","bdas","bakom","bara","bst","bttre","behva","behvas","behvde","behvt","beslut","beslutat","beslutit","bland","blev","bli","blir","blivit","bort","borta","bra","d","dag","dagar","dagarna","dagen","dr","drfr","de","del","delen","dem","den","deras","dess","det","detta","dig","din","dina","dit","ditt","dock","du","efter","eftersom","elfte","eller","elva","en","enkel","enkelt","enkla","enligt","er","era","ert","ett","ettusen","f","fanns","fr","ftt","fem","femte","femtio","femtionde","femton","femtonde","fick","fin","finnas","finns","fjrde","fjorton","fjortonde","fler","flera","flesta","fljande","fr","fre","frlt","frra","frsta","fram","framfr","frn","fyra","fyrtio","fyrtionde","g","glla","gller","gllt","gr","grna","gtt","genast","genom","gick","gjorde","gjort","god","goda","godare","godast","gr","gra","gott","ha","hade","haft","han","hans","har","hr","heller","hellre","helst","helt","henne","hennes","hit","hg","hger","hgre","hgst","hon","honom","hundra","hundraen","hundraett","hur","i","ibland","idag","igr","igen","imorgon","in","infr","inga","ingen","ingenting","inget","innan","inne","inom","inte","inuti","ja","jag","jmfrt","kan","kanske","knappast","kom","komma","kommer","kommit","kr","kunde","kunna","kunnat","kvar","lnge","lngre","lngsam","lngsammare","lngsammast","lngsamt","lngst","lngt","ltt","lttare","lttast","legat","ligga","ligger","lika","likstlld","likstllda","lilla","lite","liten","litet","man","mnga","mste","med","mellan","men","mer","mera","mest","mig","min","mina","mindre","minst","mitt","mittemot","mjlig","mjligen","mjligt","mjligtvis","mot","mycket","ngon","ngonting","ngot","ngra","nr","nsta","ned","nederst","nedersta","nedre","nej","ner","ni","nio","nionde","nittio","nittionde","nitton","nittonde","ndvndig","ndvndiga","ndvndigt","ndvndigtvis","nog","noll","nr","nu","nummer","och","ocks","ofta","oftast","olika","olikt","om","oss","ver","vermorgon","verst","vre","p","rakt","rtt","redan","redigera","s","sade","sga","sger","sagt","samma","smre","smst","se","sedan","senare","senast","sent","sex","sextio","sextionde","sexton","sextonde","sig","sin","sina","sist","sista","siste","sitt","sjtte","sju","sjunde","sjuttio","sjuttionde","sjutton","sjuttonde","ska","skall","skulle","slutligen","sm","smtt","snart","som","stor","stora","strre","strst","stort","tack","tidig","tidigare","tidigast","tidigt","till","tills","tillsammans","tio","tionde","tjugo","tjugoen","tjugoett","tjugonde","tjugotre","tjugotv","tjungo","tolfte","tolv","tre","tredje","trettio","trettionde","tretton","trettonde","tv","tvhundra","under","upp","ur","urskt","ut","utan","utanfr","ute","vad","vnster","vnstra","vr","vara","vra","varfr","varifrn","varit","varken","vrre","varsgod","vart","vrt","vem","vems","verkligen","vi","vid","vidare","viktig","viktigare","viktigast","viktigt","vilka","vilken","vilket","vill","r","r","ven","dessa","wikitext","wikipedia","tyngre","tung","tyngst","kall","var","minimum","min","max","maximum","kning","ka","kallar","hjlp","anvnder","betydligt","stt","denna","detta","det","hjlpa","anvnds","bestr","trnger","igenom","denna","utka","utarmat","ungefr","sprids","betydligt","omgivande","via","huvudartikel","exempel","exempelvis","vanligt","per","strsta","stor","ord","ordet","kallas","pbrjad","hra","frmst","ihop","antalet","the","uttryck","uttrycket","ndra","presenteras","presenterades","tnka","delar","ska","hmta","innehll","definera","anvnda","pekar","istllet","stllet","pekar","standard","vanligaste","heter","precist","felaktigt","kllor","hga","mottagare","eng","bildade","bytte","bildades","grundades","svar","betyder","betydelse","mjligheter","mjlig","mjlighet","syfte","gamla","tiorig","r","vergngsperiod","ersttas","anvndes","anvnds","utgrs","drygt","alla","allt","allts","andra","att","bara","bli","blir","borde","bra","mitt","ser","dem","den","denna","det","detta","dig","din","dock","dom","dr","edit","efter","eftersom","eller","ett","fast","fel","fick","finns","fram","frn","fr","ftt","fr","frsta","genom","ger","gr","gr","gra","hade","han","har","hela","helt","honom","hur","hr","iaf","igen","ingen","inget","inte","jag","kan","kanske","kommer","lika","lite","man","med","men","mer","mig","min","mot","mycket","mnga","mste","nog","nr","ngon","ngot","ngra","nn","nt","och","ocks","rtt","samma","sedan","sen","sig","sin","sjlv","ska","skulle","som","stt","tar","till","tror","tycker","typ","upp","utan","vad","var","vara","vet","vid","vilket","vill","vl","ven","ver","frekommer","varierar","representera","representerar","itu","pbrjades","le","tgrder","tgrd","sdant","srskilt","eftersom","som","efter","syftet","syfte","ersatts","erstts","ersatt","erstt","tagits","byter","benmningar","ler","rvs","rv","rvd","januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december","on","vriga","anvnts","anvnd","anvnds","anvnt","syftar","ex","svrt","svr","ltt","ltta","lttast","lttare","svrare","svrast","list","anvndningsomrde","anvndningsomrden","vissa","ii","hembyggda","krav","lugnt","nd","stycken","styck","lnga","korta","sm","stora","smala","tjocka","brjan","tungt","ltt","tim","st","kg","km","tid","ny","gammal","nyare","antal","snabbare","brjade","ansvar","ansvarar","bde","ca","lg","hg","ro","ton","kap","of","and","vars","kr/km","rr","gllande","placeras","placerades","tckt","samt","hos","sdana","endast","tillstnd","beror","p","marken","minska","orsaker","lsningar","problem","namn","frvntas","frvntan","frvntats","varning","utfrdas","utfrda","km/h","ndde","stod","omrdet","omrden","klla","behvs","drabbade","drabbat","which","top","that","lgre","allmnt","drog","drar","enorma","nda","enda","officiella","bekrftats","bekrftas","fall","sjunker","nedt","vrms","samtidigt","efterfljd","problematik","uppt","utom","frutom","hrnet","st","salt","svag","stark","ren","smutsig","frr","tiden","mngdag","tisdag","onsdag","torsdag","fredag","lrdag","sndag","mndagar","tisdagar","onsdagar","torsdagar","fredagar","lrdagar","sndagar","efterlikna","som","lik","bergis","bekymmer","s","lista","dig","dej","mig","mej","fri","vanlig","ovanlig","sllan","ofta","avskiljs","use","slkte","slktet","slkt","kategori","kategoriseras","rensas","renas","timmar","minuter","sekunder"]}),Uv}var Fv,vx;function WH(){return vx||(vx=1,Fv={stopwords:["a","acaba","alt","altm","ama","ancak","arada","artk","asla","aslnda","aslnda","ayrca","az","bana","bazen","baz","bazlar","belki","ben","benden","beni","benim","beri","be","bile","bilhassa","bin","bir","biraz","birou","birok","biri","birisi","birka","birey","biz","bizden","bize","bizi","bizim","byle","bylece","bu","buna","bunda","bundan","bunlar","bunlar","bunlarn","bunu","bunun","burada","btn","ou","ounu","ok","nk","da","daha","dahi","dan","de","defa","deil","dier","dieri","dierleri","diye","doksan","dokuz","dolay","dolaysyla","drt","e","edecek","eden","ederek","edilecek","ediliyor","edilmesi","ediyor","eer","elbette","elli","en","etmesi","etti","ettii","ettiini","fakat","falan","filan","gene","gerei","gerek","gibi","gre","hala","halde","halen","hangi","hangisi","hani","hatta","hem","henz","hep","hepsi","her","herhangi","herkes","herkese","herkesi","herkesin","hi","hibir","hibiri","i","","iin","iinde","iki","ile","ilgili","ise","ite","itibaren","itibariyle","ka","kadar","karn","kendi","kendilerine","kendine","kendini","kendisi","kendisine","kendisini","kez","ki","kim","kime","kimi","kimin","kimisi","kimse","krk","madem","mi","m","milyar","milyon","mu","m","nasl","ne","neden","nedenle","nerde","nerede","nereye","neyse","niin","nin","nn","niye","nun","nn","o","br","olan","olarak","oldu","olduu","olduunu","olduklarn","olmad","olmad","olmak","olmas","olmayan","olmaz","olsa","olsun","olup","olur","olur","olursa","oluyor","on","n","ona","nce","ondan","onlar","onlara","onlardan","onlar","onlarn","onu","onun","orada","te","tr","otuz","yle","oysa","pek","ramen","sana","sanki","sanki","ayet","ekilde","sekiz","seksen","sen","senden","seni","senin","ey","eyden","eye","eyi","eyler","imdi","siz","siz","sizden","sizden","size","sizi","sizi","sizin","sizin","sonra","yle","u","una","unlar","unu","ta","tabii","tam","tamam","tamamen","tarafndan","trilyon","tm","tm","u","","","un","n","zere","var","vard","ve","veya","ya","yani","yapacak","yaplan","yaplmas","yapyor","yapmak","yapt","yapt","yaptn","yaptklar","ye","yedi","yerine","yetmi","yi","y","yine","yirmi","yoksa","yu","yz","zaten","zira"]}),Fv}var zv,bx;function KH(){return bx||(bx=1,zv={stopwords:["a l","a ha","ai","ai ai","ai ny","ai ","al","amen","anh","anh y","ba","ba ba","ba bn","ba cng","ba h","ba ngy","ba ngi","ba tng","bao gi","bao lu","bao nhiu","bao n","bay bin","bit","bit bao","bit bao nhiu","bit chc","bit chng no","bit mnh","bit my","bit th","bit trc","bit vic","bit u","bit u chng","bit u y","bit c","bui","bui lm","bui mi","bui ngy","bui sm","b","b y","bi","bi bc","bi b","bi ci","bc","bn","bn cp","bn d","bn th","by by","by ch","by gi","by nhiu","bn","bng","bn","bn b","bn c","bn cnh","bng","bc","bc khi","bc ti","bc i","bn","bn","bn b","bn ring","bn thn","bn ","bt cht","bt c","bt gic","bt k","bt k","bt k","bt lun","bt ng","bt nhc","bt qu","bt qu ch","bt thnh lnh","bt t","bt ","by","by chy","by ch","by gi","by lu","by lu nay","by nay","by nhiu","bp b bp bm","bp bm","bt u","bt u t","bng","bng c","bng khng","bng ngi","bng nhau","bng nh","bng no","bng ny","bng vo","bng c","bng y","bn","bt","b","b ch","b v","b","b b","b cha","b cuc","b khng","b li","b mnh","b mt","b m","b nh","b qu","b ra","b ring","b vic","b xa","bng","bng chc","bng dng","bng khng","bng nhin","bng nhng","bng thy","bng u","b","b thuc","b iu","bi phn","b","bi","bi ai","bi chng","bi nhng","bi sao","bi th","bi th cho nn","bi ti","bi v","bi vy","bi u","bc","cao","cao lu","cao ro","cao rng","cao sang","cao s","cao thp","cao th","cao xa","cha","cha ch","chao i","chia s","chic","cho","cho bit","cho chc","cho hay","cho nhau","cho nn","cho rng","cho ri","cho thy","cho tin","cho ti","cho ti khi","cho v","cho n","cho ang","cho c","cho n","cho n khi","cho n ni","choa","chu cha","chui cha","chung","chung cho","chung chung","chung cuc","chung cc","chung nhau","chung qui","chung quy","chung quy li","chung i","chuyn","chuyn t","chuyn t","chuyn","chun b","chnh chnh","ch cht","chnh","chnh bn","chnh gia","chnh l","chnh th","chnh im","chn chn","chn chn","ch","ch dn","ch khch","ch my","ch mnh","chng","chng mnh","chng ta","chng ti","chng ng","chn chn","chng","chng chc","chng na","chi","chi h","cha","cha bao gi","cha chc","cha c","cha cn","cha dng","cha d","cha k","cha tnh","cha tng","chm chp","chc","chc","chc chn","chc d","chc hn","chc lng","chc ngi","chc vo","chc n","chng l","chng nhng","chng na","chng phi","cht ni","cht tht","cht tit","ch","ch chnh","ch c","ch l","ch tn","chn","ch","ch b","ch y","chu","chu cha","chu li","chu tt","chu n","chn","chn bn","chn ra","chc chc","ch","ch chi","ch g","ch khng","ch k","ch nh","cht","cht nghe","cht nhn","chn","ch","ch ai","ch cn","ch g","ch khng","ch khng phi","ch li","ch l","ch nh","ch sao","coi b","coi mi","con","con con","con d","con nh","con tnh","cu cu","cui","cui cng","cui im","cun","cuc","cng","cng cng","cng hay","c nhn","cc","cc cu","cch","cch bc","cch khng","cch nhau","cch u","ci","ci g","ci h","ci ","ci ","ci y","cu hi","cy","cy nc","cn","cn nh","cn na","cn thi gian","cn v","c","c ai","c chuyn","c chng","c chng l","c ch","c c","c d","c h","c khi","c ngy","c ngi","c nhiu","c nh","c phi","c s","c thng","c th","c th","c v","c ","c n","c iu","c iu kin","c ng","c u","c c","cc kh","c","c mnh","c qu","c tng","c y","cng nhin","cng","cng chung","cng cc","cng nhau","cng tui","cng tt","cng vi","cng n","cn","cn ci","cn ct","cn tnh","cng","cng nh","cng nn","cng th","cng vy","cng vy thi","cng c","c","c ch","c chng","c cng","c dn","c h","c hi","c m","cn","c","c nghe","c ngh","c ngy","c ngi","c nh","c nm","c thy","c th","c tin","c n","c n","cm thy","cm n","cp","cp s","cp trc tip","cn","cn cp","cn g","cn s","ct lc","ct sc","cu","c lai","c th","c th l","c th nh","ca","ca ngt","ca tin","c","c nh","c vic","c im","cc lc","do","do v","do vy","do ","duy","duy ch","duy c","di","di li","di ra","dnh","dnh dnh","do","d","d","d cho","d d","d g","d rng","d sao","dng","dng cho","dng ht","dng lm","dng n","di","di nc","d","d bn","d con","d di","d d","d khch","dn d","dn dn","du sao","dn","du","du m","du rng","du sao","d","d dng","d g","d khin","d nghe","d ngi","d nh chi","d s","d s dng","d thng","d thy","d n","d u","d chng","d","d cch","em","em em","gi tr","gi tr thc t","gim","gim chnh","gim thp","gim th","ging","ging ngi","ging nhau","ging nh","gi","gi lu","gi ny","gi i","gi y","gi n","gi","gi ly","gi ","gia","gia lc","gy","gy cho","gy ging","gy ra","gy thm","g","g g","g ","gn","gn bn","gn ht","gn ngy","gn nh","gn xa","gn y","gn n","gp","gp kh khn","gp phi","gm","hay","hay bit","hay hay","hay khng","hay l","hay lm","hay nh","hay ni","hay sao","hay tin","hay u","hiu","hin nay","hin ti","hon ton","hoc","hoc l","hy","hy cn","hn","hn c","hn ht","hn l","hn na","hn trc","hu ht","ht","ht chuyn","ht c","ht ca","ht ni","ht ro","ht ri","ht ","h","h gn","h xa","hi","hi li","hi xem","hi xin","h tr","khi","khi khc","khi khng","khi no","khi nn","khi trc","khin","khong","khong cch","khong khng","kh","kh tt","khc","khc g","khc khc","khc nhau","khc no","khc thng","khc xa","khch","kh","kh bit","kh chi","kh khn","kh lm","kh m","kh nghe","kh ngh","kh ni","kh thy","kh trnh","khng","khng ai","khng bao gi","khng bao lu","khng bit","khng bn","khng ch","khng cn","khng c","khng c g","khng cng","khng cn","khng c","khng dng","khng g","khng hay","khng khi","khng k","khng ngoi","khng nhn","khng nhng","khng phi","khng phi khng","khng th","khng tnh","khng iu kin","khng c","khng y","khng ","khng nh","khi","khi ni","k","k c","k nh","k ti","k t","lin quan","loi","loi t","lun","lun c","lun lun","lun tay","l","l cng","l l","l nhiu","l phi","l th no","l v","l t","lm","lm bng","lm cho","lm dn dn","lm g","lm lng","lm li","lm ly","lm mt","lm ngay","lm nh","lm nn","lm ra","lm ring","lm sao","lm theo","lm th no","lm tin","lm ti","lm tng","lm ti","lm tp l","lm v","lm ng","lm c","lu","lu cc","lu lu","lu nay","lu ngy","ln","ln cao","ln cn","ln mnh","ln ngi","ln nc","ln s","ln xung","ln n","lng","lng khng","lc","lc khc","lc lu","lc no","lc ny","lc sng","lc trc","lc i","lc ","lc n","lc y","l do","lng","lng c","lng s","lng t","li","li b","li ci","li cn","li ging","li lm","li ngi","li ni","li na","li qu","li thi","li n","li y","ly","ly c","ly c","ly ging","ly lm","ly l do","ly li","ly ra","ly ro","ly sau","ly s","ly thm","ly th","ly vo","ly xung","ly c","ly ","ln","ln khc","ln ln","ln no","ln ny","ln sang","ln sau","ln theo","ln trc","ln tm","ln","ln ln","ln nh","li","li ch","li ni","mang","mang li","mang mang","mang nng","mang v","mun","m","m c","m khng","m li","m thi","m vn","mnh","mnh","mt","mt cn","mi","mi gi","mi khi","mi lc","mi ngi","mi ni","mi s","mi th","mi vic","mi","mi","mi lc","mi ln","mi mt","mi ngy","mi ngi","mt","mt cch","mt cn","mt khi","mt lc","mt s","mt vi","mt t","mi","mi hay","mi ri","mi y","m","m mang","m nc","m ra","m","mc","nay","ngay","ngay by gi","ngay c","ngay khi","ngay khi n","ngay lc","ngay lc ny","ngay lp tc","ngay tht","ngay tc khc","ngay tc th","ngay t","nghe","nghe chng","nghe hiu","nghe khng","nghe li","nghe nhn","nghe nh","nghe ni","nghe ra","nghe r","nghe thy","nghe tin","nghe trc tip","nghe u","nghe u nh","nghe c","nghen","nghim nhin","ngh","ngh li","ngh ra","ngh ti","ngh xa","ngh n","nghm","ngoi","ngoi ny","ngoi ra","ngoi xa","ngoi","ngun","ngy","ngy cng","ngy cp","ngy gi","ngy ngy","ngy no","ngy ny","ngy n","ngy qua","ngy ry","ngy thng","ngy xa","ngy xa","ngy n","ngy y","ngi","ngi nh","ngi th","ng hu","ngn ngt","ngi","ngi","ngi hi","ngi khc","ngi khch","ngi mnh","ngi nghe","ngi ngi","ngi nhn","ngn","ngn ngun","ngt","ngi","ngi bt","ngi khng","ngi sau","ngi trt","ng nh","nhanh","nhanh ln","nhanh tay","nhau","nhin hu","nhiu","nhiu t","nhit lit","nhung nhng","nh","nh chung","nh kh","nh lm","nh ngoi","nh ngi","nh ti","nh vic","nhn dp","nhn tin","nh","nhn","nhn chung","nhn li","nhn nhn","nhn theo","nhn thy","nhn xung","nhm","nhn nhn","nh","nh ai","nh chi","nh khng","nh l","nh nhau","nh qu","nh sau","nh thng","nh th","nh th no","nh th","nh trn","nh trc","nh tung","nh vy","nh ","nhng","nhng m","nhc bng","nht","nht lot","nht lut","nht l","nht mc","nht nht","nht quyt","nht sinh","nht thit","nht th","nht tm","nht t","nht n","nht nh","nhn","nhn bit","nhn h","nhn lm","nhn nhau","nhn ra","nhn thy","nhn vic","nhn c","nhm","nhm khi","nhm lc","nhm vo","nhm ","nh","nh","nh ngi","nh","nh bp bm","nh li","nh ly","nh ra","nh","nh chuyn","nh c","nh nh","nh ","nh ra","nhng","nhng ai","nhng khi","nhng l","nhng lc","nhng mun","nhng nh","no","no cng","no hay","no l","no phi","no u","no ","ny","ny n","nn","nn chi","nn chng","nn lm","nn ngi","nn trnh","n","nc","ni","ni bng","ni chung","ni kh","ni l","ni ln","ni li","ni nh","ni phi","ni qua","ni ra","ni ring","ni r","ni thm","ni tht","ni tot","ni trc","ni tt","ni vi","ni xa","ni ","ni n","ni ","nm","nm thng","ni","ni ni","nc","nc bi","nc cng","nc ln","nc nng","nc qu","nc xung","nc n","nc n","ny","nng","nng cn","nng mnh","nng v","nu","nu c","nu cn","nu khng","nu m","nu nh","nu th","nu vy","nu c","nn","n","n","nc n","na","na khi","na l","na ri","oai oi","oi","pho","ph","ph ph","pha","pha bn","pha bn","pha di","pha sau","pha trong","pha trn","pha trc","phc","pht","ph hp","phn pht","phng chi","phi","phi bit","phi chi","phi chng","phi cch","phi ci","phi gi","phi khi","phi khng","phi li","phi li","phi ngi","phi nh","phi ri","phi tay","phn","phn ln","phn nhiu","phn no","phn sau","phn vic","pht","ph phui","phng","phng nh","phng nc","phng theo","phng tnh","phc","pht","pht","qua","qua chuyn","qua khi","qua li","qua ln","qua ngy","qua tay","qua th","qua i","quan trng","quan trng vn ","quan tm","quay","quay bc","quay li","quay s","quay i","qu","qu bn","qu b","qu gi","qu li","qu mc","qu nhiu","qu tay","qu th","qu tin","qu trnh","qu tui","qu ng","qu ","qu","qu l","qu tht","qu th","qu vy","qun","ra","ra bi","ra b","ra chi","ra g","ra li","ra li","ra ngi","ra ngi","ra sao","ra tay","ra vo","ra ","ra iu","ra y","ren rn","riu ru","ring","ring tng","rit","ry","ro","ro c","ro nc","ro tri","rn","rn bc","rch","rn rn","r","r l","r tht","rt cc","rng","rng rng","rt","rt lu","rng","rng l","rt cuc","rt cc","ri","ri na","ri ra","ri sao","ri sau","ri tay","ri th","ri xem","ri y","ra","sa s","sang","sang nm","sang sng","sang tay","sao","sao bn","sao bng","sao cho","sao vy","sao ang","sau","sau cht","sau cui","sau cng","sau ht","sau ny","sau na","sau sau","sau y","sau ","so","so vi","song le","sut","sut na","sng","sng ngy","sng r","sng th","sng ","s","s s","st","sp","sp t","s","s bit","s hay","s","s cho bit","s c th","s loi","s l","s ngi","s phn","s thiu","st st","sm","sm ngy","s d","s dng","s","s th","s vic","tanh","tanh tanh","tay","tay quay","tha h","tha h chi","tha h n","than i","thanh","thanh ba","thanh chuyn","thanh khng","thanh thanh","thanh tnh","thanh iu kin","thanh im","thay i","thay i tnh trng","theo","theo bc","theo nh","theo tin","thi thong","thiu","thiu g","thiu im","thot","thot nghe","thot nhin","thot","thun","thun i","thuc","thuc bi","thuc cch","thuc li","thuc t","th","th l","th rng","thnh ra","thnh th","thi qu","thng","thng ngy","thng nm","thng thng","thm","thm chuyn","thm gi","thm vo","th","th gi","th l","th phi","th ra","th thi","thnh lnh","thch","thch c","thch thuc","thch t","thch ","thm","thi","thi vic","thng thng","thng i","thng","thng b","thng hay","thng khi","thng s","thng s","thng thi","thng thng","thng tnh","thng ti","thng xut hin","thng n","tho hn","tho no","thp","thp c","thp thm","thp xung","thy","thy thng","thy","thm","thm ch","thm cp","thm t","tht","tht chc","tht l","tht lc","tht qu","tht ra","tht s","tht th","tht tt","tht vy","th","th chun b","th l","th li","th m","th no","th nn","th ra","th s","th th","th thi","th thng","th th","th ","th ","thch","thnh thong","thm","thc","thc tho","tht","tht nhin","tht ni","tht thi","thc","thi gian","thi gian s dng","thi gian tnh","thi im","thc mng","th","th bn","th n","tha","thc hin","thc hin ng","thc ra","thc s","thc t","thc vy","tin","tin thm","tin vo","tip theo","tip tc","tip ","tin th","to","to khi","tot","trong","trong khi","trong lc","trong mnh","trong ngoi","trong ny","trong s","trong vng","trong ","trong y","trnh","trnh khi","trnh ra","trnh tnh trng","trnh xa","trn","trn b","trn di","trc","trc ht","trc khi","trc kia","trc nay","trc ngy","trc nht","trc sau","trc tin","trc tui","trc y","trc ","tr","tr ca","tr li","tr ngay","tr trc","tru tro","trn","trt","tru tro","trng","tri t i","tr thnh","tr phi","trc tip","trc tip lm","tuy","tuy c","tuy l","tuy nhin","tuy rng","tuy th","tuy vy","tuy ","tuyt nhin","tun t","tut lut","tut tun tut","tut tut","tui","tui c","tui ti","t t","tn","tn chnh","tn ci","tn h","tn t","tnh","tnh tnh","tm","tm bn","tm cch","tm hiu","tm ra","tm vic","tnh trng","tnh","tnh cch","tnh cn","tnh ngi","tnh phng","tnh t","tt m","t te","ti","ti con","tng tc","t t","tm tp","tng","tng chng","tng cp","tng gim","tng thm","tng th","ti","ti lng","ti ni","ti sao","ti ti","ti v","ti u","ti y","ti ","to","to c hi","to nn","to ra","to ","to iu kin","tm","tm bn","tm cc","tn","tn ti","tt c","tt c bao nhiu","tt thy","tt tn tt","tt tt","tp trung","tp","tp l","tp tp","tt","t ra","t v","tc t","ti ","tt","tt bn","tt b","tt hn","tt mi","tt ngy","tt","tt cng","t","ti","ti gn","ti mc","ti ni","ti th","tc th","tc tc","t","t cn","t gi","t khi","t loi","t nay","t th","t tnh","t ti","t t","t i","t iu","t ","t y","tng","tng ci","tng gi","tng nh","tng phn","tng thi gian","tng n v","tng y","t","t cao","t khi","t lng","t tnh","t to","t v","t ","t n","tu trung","veo","veo veo","vic","vic g","vung thin a","vung tn tn","vung tn tn","v","vi","vi ba","vi ngi","vi nh","vi ni","vi tn","vi iu","vo","vo gp","vo khong","vo lc","vo vng","vo n","vng","vng chu","vng d","vng vng","vng ","vo","vo vo","v","v chng","v rng","v sao","v th","v vy","v bng","v d","v phng","v th","v hnh trung","v k","v lun","v vn","vng","vng ln","vng nc","vng t","vt","vt khi","vt qu","vn nht","v chng","v li","vn ","vn  quan trng","vn","vn th","vy","vy l","vy m","vy nn","vy ra","vy th","vy ","v","v khng","v nc","v phn","v sau","v tay","v tr","v tt","vn d","vi","vi li","vi nhau","v","vt","va","va khi","va lc","va mi","va qua","va ri","va va","xa","xa cch","xa gn","xa nh","xa tanh","xa tp","xa xa","xa x","xem","xem li","xem ra","xem s","xin","xin gp","xin vng","xit bao","xon xn","xonh xoch","xot","xon","xot","xut hin","xut k bt ","xut k bt ","xu","xung","xm xi","xm xm","xm xm","xy ra","xnh xch","xp","x l","yu cu",""," ny"," i","o","o vo","o o",""," ","i","i ch","i d","ng","ng nh","u l","t","t bit","t c","t hn","t khi","t lu","t nhiu","t nht","t na","t qu","t ra","t thi","t thy"," hay"," h"," k"," ka","i chao","i thi","ng","ng nh","ng to","ng t","ng y","ng ng","i","i ch","i do",""," chng"," da"," hoc","n","n chung","n chc","n chu","n cuc","n ht","n hi","n lm","n ngi","n ngi","n qu","n ring","n sng","n tay","n trn","n v","ang","ang tay","ang th","iu","iu g","iu kin","im","im chnh","im gp","im u tin","nh ch","ng","ng k","ng l","ng l","ng l","ng s","nh gi","nh ng","o ","u","u c","u cng","u nh","u no","u phi","u u","u y","u ","y","y ny","y ri","y ",""," hay"," khng"," l"," lu"," th"," vy"," ",""," y","ng","ng ngy","ng ra","ng tui","ng vi","n v","a","a cho","a chuyn","a em","a ra","a tay","a tin","a ti","a vo","a v","a xung","a n","c","c ci","c li","c nc","c tin","i loi","i nhn","i phm","i ","t","m bo","u tin","y","y nm","y ph","y tui","c bit","t","t lm","t mnh","t mc","t ra","t trc","t ","n","n bao gi","n cng","n cng cc","n c","n gi","n gn","n hay","n khi","n lc","n li","n nay","n ngy","n ni","n ni","n th","n th","n tui","n xem","n iu","n u","u","u bc","u nhau","u u",""," cho"," ging"," khng"," lng"," li"," m"," phn"," c"," n ni","i vi","ng thi",""," dng"," ni"," s"," iu"," im",""," hay"," ka","i","i l","",""," i","y","y l","u ","t","t hn","t l","t phi","t tht","i do","i gii","i gii i",""," ","ng",""," ny",""," ",""," li"," nh"," nh"," nm"," trn"," vo"," y"," "," c","a"," h"," ",""," nh"," th"," o"," ",""]}),zv}var Vv,_x;function YH(){return _x||(_x=1,Vv={ar:IH().stopwords,cs:DH().stopwords,da:OH().stopwords,de:PH().stopwords,en:NH().stopwords,es:MH().stopwords,fa:LH().stopwords,fr:jH().stopwords,gl:BH().stopwords,it:UH().stopwords,ko:FH().stopwords,nl:zH().stopwords,pl:VH().stopwords,pt:qH().stopwords,ro:HH().stopwords,ru:$H().stopwords,sv:GH().stopwords,tr:WH().stopwords,vi:KH().stopwords}),Vv}var qv,wx;function XH(){if(wx)return qv;wx=1;const i=["ar","cs","da","de","en","es","fa","fr","gl","it","ko","nl","pl","pt","ro","ru","sv","tr","vi"],e=YH();function t(o,c={remove_digits:!0,return_changed_case:!0}){if(!o)return[];const h=c.return_changed_case,d=c.return_chained_words,p=c.remove_digits;let m=c.language||"en";const v=c.remove_duplicates||!1,_=c.return_max_ngrams;m=s(m);const S=o.replace(/(<([^>]+)>)/gi,"").trim();if(S){const A=S.split(/\s/),T=[],x=[];for(let R=0;R<A.length;R++){let O=A[R].match(/https?:\/\/.*[\r\n]*/g)?A[R]:A[R].replace(/\.|,|;|!|\?|\(|\)|:|"|^'|'$||||/g,"");O.length===1&&(O=O.replace(/_|@|&|#/g,""));const P=O.match(/\d/g);p&&P&&P.length===O.length&&(O=""),O.length>0&&(x.push(O.toLowerCase()),T.push(O))}let D=[];const I=c.stopwords||n({language:m});let U=0,z=0,F=!1;for(let R=0;R<x.length;R++)if(I.indexOf(x[R])<0){U!==R-1?(z=R,F=!1):F=!0;const O=h&&!T[R].match(/https?:\/\/.*[\r\n]*/g)?x[R]:T[R];if(_&&F&&!d&&_>R-z&&U===R-1){const P=D.length-1<0?0:D.length-1;D[P]=D[P]?D[P]+" "+O:O}else if(d&&U===R-1){const P=D.length-1<0?0:D.length-1;D[P]=D[P]?D[P]+" "+O:O}else D.push(O);U=R}else F=!1;return v&&(D=D.filter((R,O,P)=>P.indexOf(R)===O)),D}else return[]}function n(o){o=o||{};let c=o.language||"en";return c=s(c),e[c]}function s(o){const c="Language must be one of ["+i.join(", ")+"]";if(typeof o!="string")throw new Error(c);const h=o.length===2?o:a(o);if(i.indexOf(h)<0)throw new Error(c);return h}function a(o){return typeof o!="string"?"":{arabic:"ar",czech:"cs",danish:"da",dutch:"nl",english:"en",french:"fr",galician:"gl",german:"de",italian:"it",korean:"ko",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",spanish:"es",swedish:"sv",turkish:"tr",vietnam:"vt"}[o]||""}return qv={getStopwords:n,extract:t,supported_language_codes:i},qv}var Hv,Ax;function QH(){return Ax||(Ax=1,Hv=XH()),Hv}var JH=QH();const ZH=Zb(JH);wc.workerSrc=RH;function e$(){const[i,e]=Y.useState([]),[t,n]=Y.useState(null),[s,a]=Y.useState([]),[o,c]=Y.useState(!1),[h,d]=Y.useState(!1),[p,m]=Y.useState(!1),[v,_]=Y.useState(0),[S,A]=Y.useState(""),[T,x]=Y.useState(null);Y.useEffect(()=>{D()},[]);const D=async()=>{c(!0);try{const{data:j,error:L}=await Fi.from("articles").select("*").eq("status","LIT_APPROVED").order("created_at",{ascending:!1});if(L)throw L;e(j||[])}catch(j){console.error("Error loading articles:",j)}finally{c(!1)}},I=j=>{n(j);let L=j.tags||[];if(j.keywords){const V=j.keywords.split(",").map(B=>B.trim()).filter(B=>B.length>0);L=Array.from(new Set([...L,...V]))}a(L),A(""),x(null),_(0)},U=async j=>{const L=await BI({data:j}).promise;let V="";for(let B=1;B<=L.numPages;B++){const G=(await(await L.getPage(B)).getTextContent()).items.map(W=>W.str).join(" ");V+=G+" ",_(Math.round(B/L.numPages*100))}return V},z=async j=>{const L=j.target.files?.[0];if(L){if(L.type!=="application/pdf"){alert("Please upload a PDF file.");return}A(L.name),x(L),d(!0),_(0);try{const V=await L.arrayBuffer(),B=await U(V);_(90),await new Promise(fe=>setTimeout(fe,300));const de=ZH.extract(B,{language:"english",remove_digits:!0,return_changed_case:!0,remove_duplicates:!0}),Ce=/\b[A-Z][a-zA-Z]+\b/g,G=B.match(Ce)||[],W=["The","A","An","This","That","It","In","On","For","Of","With","And","But"],we=[...G.filter(fe=>!W.includes(fe)&&fe.length>3),...de],Oe=Array.from(new Set(we)),H=B.split(/\s+/).length,ee=Math.min(100,Math.max(30,Math.ceil(H/30))),le=Oe.filter(fe=>fe.length>3).slice(0,ee),he=Array.from(new Set([...s,...le]));a(he),_(100),await new Promise(fe=>setTimeout(fe,200))}catch(V){console.error("PDF Parsing error:",V),alert("Error parsing PDF file: "+V.message),_(0)}finally{d(!1)}}},F=j=>{if(!j.trim())return;const L=j.split(",").map(V=>V.trim()).filter(V=>V.length>0);if(L.length>0){const V=L.filter(B=>!s.includes(B));V.length>0&&a([...s,...V])}},R=j=>{if(j.key==="Enter"){const L=j.target;F(L.value),L.value=""}},O=j=>{a(s.filter(L=>L!==j))},P=async()=>{if(t?.id){if(!T){alert("Please scan a PDF file before publishing. This PDF will be the version displayed on the website.");return}if(!(s.length===0&&!window.confirm("Publish without keywords?"))){m(!0);try{const j=await hs.uploadFile(T,"articles");await hs.updateArticleDetails(t.id,{tags:s,file_url:j,status:"PUBLISHED"}),alert("Article is now LIVE! The Google Doc link has been replaced with the permanent PDF archive.");const L=i.findIndex(B=>B.id===t.id),V=i[L+1]||i[L-1];e(i.filter(B=>B.id!==t.id)),V?I(V):n(null),a([]),x(null),A(""),_(0)}catch(j){alert("Error publishing: "+j.message)}finally{m(!1)}}}};return o?w.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading articles for analysis..."}):w.jsxs("div",{className:"card-premium",style:{marginBottom:"3rem"},children:[w.jsx("h2",{children:"Step 4: Final Archive & Publication (PDF)"}),w.jsx("p",{style:{color:"#666",marginBottom:"1.5rem"},children:"Analyze approved articles. Download the final Google Doc as a PDF, scan it for keywords here, and publish it to the live archive."}),w.jsxs("div",{style:{display:"flex",gap:"2rem",flexWrap:"wrap"},children:[w.jsxs("div",{style:{flex:1,minWidth:"300px",borderRight:"1px solid #eee",paddingRight:"2rem"},children:[w.jsx("h3",{children:"Ready for Archiving"}),w.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:i.length===0?w.jsx("p",{children:"No articles waiting for analysis."}):w.jsx("ul",{style:{listStyle:"none",padding:0},children:i.map(j=>w.jsxs("li",{onClick:()=>I(j),style:{padding:"1rem",border:t?.id===j.id?"2px solid var(--primary)":"1px solid #eee",marginBottom:"0.5rem",borderRadius:"8px",cursor:"pointer",background:t?.id===j.id?"#e3f2fd":"white"},children:[w.jsx("strong",{style:{display:"block"},children:j.title}),w.jsx("small",{children:j.author_name})]},j.id))})})]}),w.jsx("div",{style:{flex:2,minWidth:"300px"},children:t?w.jsxs("div",{children:[w.jsxs("h3",{style:{marginTop:0},children:["Processing: ",t.title]}),t.file_url&&w.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"#e3f2fd",borderRadius:"8px",border:"1px solid #90caf9"},children:[w.jsxs("p",{style:{margin:0,fontWeight:500,color:"#1565c0"},children:["Current Google Doc: "," ",w.jsx("a",{href:t.file_url,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline"},children:"Open Document for Export "})]}),w.jsx("small",{style:{display:"block",marginTop:"0.5rem",color:"#555"},children:"Instructions: 1. Open Google Doc. 2. File > Download > PDF Document. 3. Upload the PDF below to replace the link with the permanent file."})]}),w.jsxs("div",{style:{background:"#f5f5f5",padding:"1.5rem",borderRadius:"8px",marginBottom:"2rem"},children:[w.jsx("label",{style:{fontWeight:"bold",display:"block",marginBottom:"0.5rem"},children:"Step 1: Upload Final PDF for Scanning"}),w.jsxs("div",{style:{position:"relative"},children:[w.jsx("input",{type:"file",id:"pdf-upload",accept:".pdf",onChange:z,disabled:h||p,style:{display:"none"}}),w.jsxs("label",{htmlFor:"pdf-upload",style:{display:"block",padding:"2rem",border:"2px dashed #bbb",borderRadius:"8px",textAlign:"center",background:S?"#e8f5e9":"white",cursor:h||p?"not-allowed":"pointer",transition:"all 0.2s ease",color:S?"#2e7d32":"#666"},onMouseEnter:j=>!(h||p)&&(j.currentTarget.style.borderColor="var(--primary)"),onMouseLeave:j=>!(h||p)&&(j.currentTarget.style.borderColor="#bbb"),children:[w.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:h?"":S?"":""}),h?w.jsx("span",{style:{fontWeight:"bold"},children:"Scanning Document Content..."}):S?w.jsxs(w.Fragment,{children:[w.jsx("span",{style:{display:"block",fontWeight:"bold",fontSize:"1.1rem"},children:"Scan Complete!"}),w.jsxs("span",{style:{fontSize:"0.9rem"},children:["File ready: ",S]}),w.jsx("span",{style:{display:"block",fontSize:"0.8rem",marginTop:"0.5rem",color:"#666"},children:"(Click to upload different version)"})]}):w.jsxs(w.Fragment,{children:[w.jsx("span",{style:{display:"block",fontWeight:"bold"},children:"Click to Upload PDF"}),w.jsx("span",{style:{fontSize:"0.8rem"},children:"(Downloaded from Google Docs)"})]})]})]}),h&&w.jsxs("div",{style:{marginTop:"1rem"},children:[w.jsx("div",{style:{height:"8px",background:"#ccc",borderRadius:"4px",overflow:"hidden"},children:w.jsx("div",{style:{width:`${v}%`,height:"100%",background:"var(--primary)",transition:"width 0.3s ease"}})}),w.jsxs("p",{style:{fontSize:"0.8rem",textAlign:"right",marginTop:"4px"},children:[v,"% Scanned"]})]})]}),w.jsxs("div",{style:{marginBottom:"2rem"},children:[w.jsx("label",{style:{fontWeight:"bold",display:"block",marginBottom:"0.5rem"},children:"Step 2: Review Keywords"}),w.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem",minHeight:"50px",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px"},children:[s.map(j=>w.jsxs("span",{style:{background:"var(--secondary, #eee)",color:"black",padding:"4px 10px",borderRadius:"16px",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"5px"},children:[j,w.jsx("button",{onClick:()=>O(j),style:{background:"none",border:"none",color:"black",cursor:"pointer",padding:0,fontWeight:"bold"},children:""})]},j)),s.length===0&&w.jsx("span",{style:{color:"#999",padding:"4px"},children:"No keywords yet. Upload file or add manually."})]}),w.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[w.jsx("input",{type:"text",id:"manual-keyword-input",placeholder:"Type keyword...",onKeyDown:R,style:{flex:1,padding:"0.8rem",borderRadius:"4px",border:"1px solid #ccc"}}),w.jsx("button",{onClick:()=>{const j=document.getElementById("manual-keyword-input");j&&(F(j.value),j.value="")},className:"cta-button",style:{padding:"0 1.5rem",borderRadius:"4px",background:"var(--primary)",height:"auto",display:"flex",alignItems:"center"},children:"Add"})]})]}),w.jsx("button",{onClick:P,disabled:p||!T,className:`cta-button ${p?"loading":""}`,style:{width:"100%",fontSize:"1.2rem",padding:"1rem",background:p?"#999":"linear-gradient(45deg, #43a047, #2e7d32)",cursor:p||!T?"not-allowed":"pointer"},children:p?"Uploading PDF & Publishing...":" Replace Link & Publish Live"})]}):w.jsx("div",{style:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center",color:"#999",border:"2px dashed #ddd",borderRadius:"8px"},children:w.jsx("p",{children:"Select an article to archive (from left)"})})})]})]})}function t$(){const[i,e]=Y.useState(null),[t,n]=Y.useState("admin"),[s,a]=Y.useState(""),[o,c]=Y.useState(""),[h,d]=Y.useState(!0),[p,m]=Y.useState(0);Y.useEffect(()=>{const A=uz(fv,T=>{if(e(T),T&&T.email){const x=T.email.toLowerCase();x.includes("itmuseum.literaturereview")||x.includes("literaturereview")||x.includes("litreview")?n("reviewer_literature"):x.includes("itmuseum.technicalreview")||x.includes("technicalreview")||x.includes("techreview")?n("reviewer_technical"):x.includes("itmuseum.itreview")||x.includes("itreview")?n("reviewer_first"):(x.includes("itmuseum.admin")||x.includes("admin"),n("admin"))}d(!1)});return()=>A()},[]);const v=async A=>{A.preventDefault();try{await oz(fv,s,o)}catch(T){alert("Login Failed: "+T.message)}},_=async()=>{await hz(fv),window.location.reload()};if(h)return w.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading..."});if(!i)return w.jsx("div",{className:"page active",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"80vh"},children:w.jsxs("div",{className:"card-premium",style:{width:"90%",maxWidth:"450px",padding:"3rem"},children:[w.jsx("h2",{style:{textAlign:"center",marginBottom:"0.5rem"},children:"Portal Login"}),w.jsx("p",{style:{textAlign:"center",color:"var(--text-muted)",marginBottom:"2.5rem",fontSize:"0.9rem"},children:"IT Museum Administrative Access"}),w.jsxs("form",{onSubmit:v,children:[w.jsxs("div",{style:{marginBottom:"1.5rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-muted)",fontWeight:600},children:"Email Address"}),w.jsx("input",{type:"email",required:!0,placeholder:"email@christuniversity.in",value:s,onChange:A=>a(A.target.value),className:"enhanced-input",style:{width:"100%",padding:"12px 16px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",transition:"all 0.3s ease"}})]}),w.jsxs("div",{style:{marginBottom:"2rem"},children:[w.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-muted)",fontWeight:600},children:"Password"}),w.jsx("input",{type:"password",required:!0,placeholder:"Enter your password",value:o,onChange:A=>c(A.target.value),className:"enhanced-input",style:{width:"100%",padding:"12px 16px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",transition:"all 0.3s ease"}})]}),w.jsx("button",{type:"submit",className:"cta-button",style:{width:"100%",border:"none",marginBottom:"1rem",fontSize:"1rem",padding:"14px"},children:"Sign In"})]})]})});const S=()=>{switch(t){case"reviewer_first":return w.jsx(Kf,{title:"IT Review Panel",currentStageStatus:"ADMIN_APPROVED",nextStageStatus:"IT_APPROVED",rejectionStatus:"ADMIN_REJECTED",reviewerName:i.email||"IT Reviewer"});case"reviewer_technical":return w.jsx(Kf,{title:"Technical Review Panel",currentStageStatus:"IT_APPROVED",nextStageStatus:"TECH_APPROVED",rejectionStatus:"IT_REJECTED",reviewerName:i.email||"Tech Reviewer"});case"reviewer_literature":return w.jsxs(w.Fragment,{children:[w.jsx(Kf,{title:"Literature Review Panel",currentStageStatus:"TECH_APPROVED",nextStageStatus:"LIT_APPROVED",rejectionStatus:"TECH_REJECTED",reviewerName:i.email||"Lit Reviewer",onActionComplete:()=>m(A=>A+1)}),w.jsx("div",{style:{borderTop:"2px solid #eee",margin:"4rem 0"}}),w.jsx(e$,{},p)]});default:return w.jsx(Kf,{title:"Admin Triage & Review",currentStageStatus:"SUBMITTED",nextStageStatus:"ADMIN_APPROVED",rejectionStatus:"ADMIN_REJECTED",reviewerName:i.email||"Admin"})}};return w.jsxs("div",{className:"page active",style:{display:"block"},children:[w.jsx("section",{className:"hero",style:{minHeight:"40vh"},children:w.jsxs("div",{className:"hero-content",children:[w.jsx("h1",{children:t==="admin"?"Admin Dashboard":"Reviewer Portal"}),w.jsx("p",{children:"Manage submissions, review articles, and curate the digital museum content."})]})}),w.jsx("div",{className:"section",style:{marginTop:"-4rem",position:"relative",zIndex:10},children:w.jsxs("div",{className:"card-premium",style:{minHeight:"600px"},children:[w.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"3rem",borderBottom:"1px solid #eee",paddingBottom:"1rem"},children:[w.jsxs("div",{children:[w.jsx("h2",{style:{margin:0,fontSize:"1.8rem"},children:"Welcome Back"}),w.jsxs("p",{style:{color:"var(--text-muted)"},children:["Logged in as: ",w.jsx("strong",{children:i.email})," ",w.jsx("span",{style:{background:"var(--primary-light)",color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"0.8em",marginLeft:"10px"},children:t})]})]}),w.jsx("button",{onClick:_,className:"cta-button secondary",style:{fontSize:"0.9rem",padding:"0.5rem 1.5rem"},children:"Logout"})]}),S()]})})]})}function n$(){return w.jsx(s2,{children:w.jsx(g2,{children:w.jsxs(NP,{children:[w.jsx(ba,{path:"/",element:w.jsx(iL,{})}),w.jsx(ba,{path:"/collection",element:w.jsx(n5,{})}),w.jsx(ba,{path:"/team",element:w.jsx(p5,{})}),w.jsx(ba,{path:"/contact",element:w.jsx(m5,{})}),w.jsx(ba,{path:"/article/:id",element:w.jsx(g5,{})}),w.jsx(ba,{path:"/submission",element:w.jsx(y5,{})}),w.jsx(ba,{path:"/admin",element:w.jsx(t$,{})})]})})})}LO.createRoot(document.getElementById("root")).render(w.jsx(kO.StrictMode,{children:w.jsx(n$,{})}));
